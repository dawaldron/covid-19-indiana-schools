define("article-loader",["module","jquery","page","utils","storage","jquery-utils"],function(t,d,n,s,l){const u={name:t.id,class:"."+t.id};s.broadcast(u.name,"loaded"),s.createModule(u.name,function(e){const a=this;a.$el=e,a.module=u,a.init=function(){var n;a.broadcast("init"),n=a.getElements("button"),o&&i<t?n.text("Loading next article...").prop("disabled",!0).show().observeIntersections((t,e)=>{t.isIntersecting&&(e.unobserve(t.target),r(function(t){t?(a.broadcast("nextArticleReceived",{sectionHtml:t}),n.hide(),c(d(t).find(".grid__section"))):(n.text("Unable to load next article"),a.broadcast("nextArticleFailed"))}))},{rootMargin:"500px 0px 500px 0px"}):r(function(e){if(e){let t=d(e).find(".grid__section");var i=t.find(".article").attr("data-title");t.each(function(){a.broadcast("nextArticleReceived",{sectionHtml:e})}),n.addClass("article__next_manual_true").html("<strong>Up next: </strong>"+i).show().on("click",function(){n.hide(),c(d(e).find(".grid__section"))})}else a.broadcast("nextArticleFailed")}),a.broadcast("ready")};const t=5;var i=e.closest(".grid").find(".article").length;const o="IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype;function r(e){var t=d(".article"),t={provider:"database",originalId:t.first()[0].dataset.articleId,currentId:l.get("viewedArticles").join(","),section:t.first()[0].dataset.section,subsection:t.first()[0].dataset.subsection,topic:"",subtopic:"",articleNumber:t.length,siteId:n.model.siteid,platform:n.model.platform,pageUrl:n.model.targetingUrl};d.ajax({url:"/ajax/content/cscroll",method:"POST",dataType:"text",contentType:"application/json",data:JSON.stringify(t)}).done(function(t){e(t)}).fail(function(){e(null)}),a.broadcast("requestingNextArticle",t)}function c(t){window.COMSCORE&&window.COMSCORE.beacon&&(s.broadcast(u.name,"comscoreBeacon",{comscoreId:n.model.comscoreid}),window.COMSCORE.beacon({c1:"2",c2:n.model.comscoreid})),a.broadcast("showingNextArticle",{articleHtml:t}),t.each(function(){var t=d(this),i=d(".article").length+1;t.find('[id*="::articleNumber::"]').each(function(){var t=d(this).attr("id"),e=t.replace("::articleNumber::",i);d(this).attr("id",e),a.broadcast("updatedId",{old:t,new:e})}),e.closest(".grid").append(t),s.broadcastNoJQ("grid","addedSection",{$el:t,el:t[0]}),s.broadcast("grid","addedSection",{$el:t,el:t[0]})})}})});
//# sourceMappingURL=article-loader_5.8.4.js.map