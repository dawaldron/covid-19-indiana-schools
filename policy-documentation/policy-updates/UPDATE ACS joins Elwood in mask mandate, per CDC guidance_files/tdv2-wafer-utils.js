"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){function i(){var n=c.YAHOO&&c.YAHOO.context||c.Af&&c.Af.context||{},o="";return e.forEach(function(e){"undefined"!==_typeof(n[e])&&(o+="&".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(n[e])))}),o}function a(e,n,o,t){e&&n||t&&t("Missing required params - type: ".concat(e,", src: ").concat(n));var r=o||{};n&&(r.src=n),r._rdn=(new Date).getTime().toString().substr(7);var n=Object.keys(r).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(r[e])}).join("&"),a="".concat("/_td_api/beacon","/").concat(e,"?").concat(n).concat(i(),"&site=").concat(u.site);if(!(n=!(window.navigator&&"sendBeacon"in window.navigator)))try{window.navigator.sendBeacon(a)}catch(e){n=!0}n&&((n=new Image).onerror=function(e){e=e instanceof Error?e.toString():e;t&&t(e)},n.onload=function(){t&&t()},n.src=a,c.__testError&&(c.__testImg=n))}function r(e,n){if(n){var o="string"==typeof n?n:n.message;if(!o||!d.test(o)){var t,o=n.toString();if(n){switch(o){case"[object String]":t={code:999,message:n};break;case"[object Error]":t={code:n.code||n.name||999,file:n.fileName||"",line:n.lineNumber||"",message:n.message};break;case"[object Object]":t=n;break;default:try{t={code:999,message:JSON.stringify(n)}}catch(e){}}t.message=t.message&&t.message.substring(0,300)||""}a("error",e,t)}}}var c=window,s=c.onerror,e=["rid","bucketId","bucket","device","osName","browserName","browserVersion"],f=/^resource:\/\//,d=/ActionScript|Decompress\sfail/,u={beaconPath:"p.gif",site:"fp"};c.onerror=function(e,n,o){try{var t;f.test(n)||(t={code:e.name,file:e.fileName||"",line:e.lineNumber||o||"",message:e.message||e,url:n&&n.substring(0,300)},r("winerror",t))}catch(e){}return"function"==typeof s&&s(e,n,o)},addEventListener("ybar.error",function(e){var e=e&&e.detail||{},n=e.error||{},o=e.message||n.message||n.toString();try{var t={code:n.name,file:n.fileName||"",line:n.lineNumber||"",message:o};r("ybar",t)}catch(e){}});function n(e){e&&"IDB-connection-success"===e.name&&window.wafer.base.clearOldCache({timeDiffToDelete:13824e5})}function o(e){var n,o,t;e&&(n=e.meta,o=e.name,t=e.stack,e={downlink:(e=c.navigator&&(navigator.connection||navigator.mozConnection||navigator.webkitConnection)||{}).downlink||"",downlinkMax:e.downlinkMax||"",effectiveType:e.effectiveType||"",rtt:e.rtt||"",saveData:e.saveData||"",type:e.type||""},t=t&&t.message||"",e="/".concat(u.beaconPath,"?err=").concat(o,"&beaconType=wafer_err&info=").concat(escape(JSON.stringify(n)),"&stack=").concat(t,"&connection=").concat(escape(JSON.stringify(e))).concat(i()),c.wafer.utils.fireBeacon(e),c.__testError&&(c.__testBeaconUrl=e))}function t(){if(w)return 1;window.wafer.on("log",n),window.wafer.on("error",o),w=!0,window.YAHOO&&window.YAHOO.errBeaconConfig&&Object.assign(u,window.YAHOO.errBeaconConfig),"ReportingObserver"in window&&new window.ReportingObserver(function(e,n){for(var o=0;o<e.length;o++){var t,r=e[o];r&&"csp-violation"!==r.type&&((t=r.body).url=r.url,a("reporting-observer",r.type,{meta:JSON.stringify(t)}))}},{buffered:!0}).observe()}var w;window.wafer.ready?window.wafer.ready(function(){t()}):window.addEventListener("load",function(){t()}),c.__testError&&t()}();