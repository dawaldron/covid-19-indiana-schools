// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/PooledArray ../../../webgl/Program ../../../webgl/RenderingContext".split(" "),function(g,l,h,m,e,n){e=function(k){function f(a,b,c){a=k.call(this,a,b.generateSource("vertex"),b.generateSource("fragment"),c)||this;a._textures=new Map;a._freeTextureUnits=new m({deallocator:null});a._fragmentUniforms=n.webglDebugEnabled()?b.fragmentUniforms.entries:null;return a}l._inheritsLoose(f,k);var d=f.prototype;
d.stop=function(){this._textures.clear();this._freeTextureUnits.clear()};d.bindTexture=function(a,b){if(h.isNone(a)||null==a.glName){if(a=this._textures.get(b))this._context.bindTexture(null,a.unit),this._freeTextureUnit(a),this._textures.delete(b);return null}let c=this._textures.get(b);null==c?(c=this._allocTextureUnit(a),this._textures.set(b,c)):c.texture=a;this._context.useProgram(this);this.setUniform1i(b,c.unit);this._context.bindTexture(a,c.unit);return c.unit};d.rebindTextures=function(){this._context.useProgram(this);
this._textures.forEach((a,b)=>{this._context.bindTexture(a.texture,a.unit);this.setUniform1i(b,a.unit)});h.isSome(this._fragmentUniforms)&&this._fragmentUniforms.forEach(a=>{if(("sampler2D"===a.type||"samplerCube"===a.type)&&!this._textures.has(a.name))throw Error(`Texture sampler ${a.name} has no bound texture`);})};d._allocTextureUnit=function(a){return{texture:a,unit:0===this._freeTextureUnits.length?this._textures.size:this._freeTextureUnits.pop()}};d._freeTextureUnit=function(a){this._freeTextureUnits.push(a.unit)};
return f}(e.Program);g.Program=e;Object.defineProperty(g,"__esModule",{value:!0})});