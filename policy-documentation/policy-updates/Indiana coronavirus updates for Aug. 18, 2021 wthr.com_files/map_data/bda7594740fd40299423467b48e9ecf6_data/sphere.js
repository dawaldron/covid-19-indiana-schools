// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define("exports ../core/has ../core/Logger ../core/mathUtils ../core/maybe ./mat4 ./vec3 ./vec3f64 ./vec4 ./vec4f64 ../geometry/support/ray ../geometry/support/vector ../geometry/support/vectorStacks".split(" "),function(e,C,Q,p,R,D,d,q,S,r,T,U,h){function t(){return r.create()}function u(a,b=t()){return S.copy(b,a)}function E(a,b){return r.fromValues(a[0],a[1],a[2],b)}function F(a){return a}function G(a){a[0]=a[1]=a[2]=a[3]=0}function H(a){return a}function n(a){return Array.isArray(a)?a[3]:a}function k(a){return Array.isArray(a)?
a:V}function I(a,b,c,f){return r.fromValues(a,b,c,f)}function J(a,b,c){a!==c&&d.copy(c,a);c[3]=a[3]+b;return c}function K(a,b,c){W.error("sphere.setExtent is not yet supported");return a===c?c:u(a,c)}function m(a,b,c){if(R.isNone(b))return!1;var f=d.subtract(h.sv3d.get(),b.origin,k(a)),g=d.dot(b.direction,b.direction);const l=2*d.dot(b.direction,f);a=d.dot(f,f)-a[3]*a[3];a=l*l-4*g*a;if(0>a)return!1;f=Math.sqrt(a);a=(-l-f)/(2*g);g=(-l+f)/(2*g);if(0>a||g<a&&0<g)a=g;if(0>a)return!1;c&&d.add(c,b.origin,
d.scale(h.sv3d.get(),b.direction,a));return!0}function L(a,b){return m(a,b,null)}function M(a,b,c){if(m(a,b,c))return c;a=v(a,b,h.sv3d.get());d.add(c,b.origin,d.scale(h.sv3d.get(),b.direction,d.distance(b.origin,a)/d.length(b.direction)));return c}function v(a,b,c){const f=h.sv3d.get(),g=h.sm4d.get();d.cross(f,b.origin,b.direction);const l=n(a);d.cross(c,f,b.origin);d.scale(c,c,1/d.length(c)*l);a=w(a,b.origin);b=U.angle(b.origin,c);D.identity(g);D.rotate(g,g,b+a,f);d.transformMat4(c,c,g);return c}
function N(a,b,c){if(m(a,b,c))return c;T.closestPoint(b,k(a),c);return x(a,c,c)}function x(a,b,c){b=d.subtract(h.sv3d.get(),b,k(a));b=d.scale(h.sv3d.get(),b,a[3]/d.length(b));return d.add(c,b,k(a))}function O(a,b){b=d.subtract(h.sv3d.get(),b,k(a));b=d.squaredLength(b);return Math.sqrt(Math.abs(b-a[3]*a[3]))}function w(a,b){b=d.subtract(h.sv3d.get(),b,k(a));b=d.length(b);a=n(a);return p.acosClamped(a/(a+Math.abs(a-b)))}function y(a,b,c,f){a=d.subtract(z,b,k(a));switch(c){case 0:return c=p.cartesianToSpherical(a,
z)[2],d.set(f,-Math.sin(c),Math.cos(c),0);case 1:return a=p.cartesianToSpherical(a,z),c=a[1],a=a[2],b=Math.sin(c),d.set(f,-b*Math.cos(a),-b*Math.sin(a),Math.cos(c));case 2:return d.normalize(f,a)}}function A(a,b){b=d.subtract(B,b,k(a));return d.length(b)-a[3]}function P(a,b,c,f){const g=A(a,b);a=y(a,b,2,B);c=d.scale(B,a,c-g);return d.add(f,b,c)}const W=Q.getLogger("esri.geometry.support.sphere"),z=q.create(),V=q.create(),B=q.create();C=Object.freeze({__proto__:null,create:t,copy:u,fromCenterAndRadius:E,
wrap:F,clear:G,fromRadius:H,getRadius:n,getCenter:k,fromValues:I,elevate:J,setExtent:K,intersectRay:m,intersectsRay:L,intersectRayClosestSilhouette:M,closestPointOnSilhouette:v,closestPoint:N,projectPoint:x,distanceToSilhouette:O,angleToSilhouette:w,axisAt:y,altitudeAt:A,setAltitudeAt:P});e.altitudeAt=A;e.angleToSilhouette=w;e.axisAt=y;e.clear=G;e.closestPoint=N;e.closestPointOnSilhouette=v;e.copy=u;e.create=t;e.distanceToSilhouette=O;e.elevate=J;e.fromCenterAndRadius=E;e.fromRadius=H;e.fromValues=
I;e.getCenter=k;e.getRadius=n;e.intersectRay=m;e.intersectRayClosestSilhouette=M;e.intersectsRay=L;e.projectPoint=x;e.setAltitudeAt=P;e.setExtent=K;e.sphere=C;e.wrap=F});