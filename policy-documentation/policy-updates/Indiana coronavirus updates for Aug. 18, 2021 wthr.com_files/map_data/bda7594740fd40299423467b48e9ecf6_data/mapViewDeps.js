// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/Stage":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/events ../../../core/has ../../../core/scheduling ../../../core/watchUtils ../../../chunks/common ../../../chunks/mat2d ../../../chunks/mat2df64 ../../../chunks/vec2 ../../../chunks/vec2f64 ../../webgl/BufferObject ../../webgl/FramebufferObject ../../webgl/Program ../../webgl/ProgramCache ../../webgl/Renderbuffer ../../webgl/RenderingContext ../../webgl/ShaderCompiler ../../webgl/Texture ../../webgl/VertexArrayObject ../../webgl/programUtils ../../webgl/context-util ./Container ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/cpuMapped/BufferDataPool ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n,u,t,m,w,v,C,A,y,p,z,D,G,I,K,N){g=function(L){function M(H,J){var P=L.call(this)||this;P._trash=new Set;P._clipData=new Float32Array(8);P._upperLeft=f.create();P._upperRight=f.create();P._lowerLeft=f.create();P._lowerRight=f.create();P._mat2=b.create();P._clipRendererInitialized=!1;P._supersampleScreenshots=!0;P._pools={bufferData:new G.BufferDataPool};P.renderRequested=!1;P.stage=F._assertThisInitialized(P);P._stationary=!0;const {canvas:Q=document.createElement("canvas"),
alpha:U=!0,stencil:aa=!0,renderContext:ba="webgl",supersampleScreenshots:ia=!0,contextOptions:ha={}}=J;P._canvas=Q;const ca=C.createContextOrErrorHTML(Q,{alpha:U,antialias:!1,depth:!0,stencil:aa},ba);P.context=new u["default"](ca,ha);P.painter=new p(P.context,F._assertThisInitialized(P));k("esri-2d-profiler")&&(P._debugOutput=document.createElement("div"),P._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),H.appendChild(P._debugOutput));P._renderParameters={drawPhase:0,
state:P.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1,blendMode:null,deltaTime:-1,time:0,inFadeTransition:!1,effects:null,context:P.context,painter:P.painter,timeline:J.timeline||new K.Timeline,renderingOptions:J.renderingOptions,requireFBO:!1,driverTestResult:D.testWebGLDriver(P.context),profiler:new z.Profiler(P.context,P._debugOutput),dataUploadCounter:0};P._taskHandle=h.addFrameTask({render:S=>P.renderFrame(S)});P._taskHandle.pause();P._supersampleScreenshots=ia;P._lostWebGLContextHandle=
B.on(Q,"webglcontextlost",()=>{P.emit("webgl-error",{error:new E("webgl-context-lost")})});Q.setAttribute("style","width: 100%; height:100%; display:block;");H.appendChild(Q);return P}F._inheritsLoose(M,L);var O=M.prototype;O.destroy=function(){this.removeAllChildren();this._emptyTrash();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&
(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.highlightOptions=null;this._pools.bufferData.destroy();this.painter.dispose();this.context.dispose();this._canvas=null};O.trashDisplayObject=
function(H){this._trash.add(H);this.requestRender()};O.untrashDisplayObject=function(H){return this._trash.delete(H)};O.requestRender=function(){this._lastRenderRequestTime=performance.now();this.renderRequested||(this.renderRequested=!0,this.emit("will-render"),this._taskHandle.resume())};O.renderFrame=function(H){2E3<=H.time-this._lastRenderRequestTime&&this._taskHandle.pause();this.renderRequested=!1;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=
window.devicePixelRatio;this._renderParameters.globalOpacity=1;this._renderParameters.time=H.time;this._renderParameters.deltaTime=H.deltaTime;this._renderParameters.effects=null;this.processRender(this._renderParameters);this._emptyTrash();this.emit("post-render")};O.renderChildren=function(H){for(const J of this.children)J.beforeRender(H);this._renderChildren(this.children,H);for(const J of this.children)J.afterRender(H)};O._renderChildren=function(H,J){const P=this.context;J.profiler.recordStart("drawLayers");
J.dataUploadCounter=0;this._beforeRenderChildren(J);J.drawPhase=y.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(P,this.background);for(const Q of H)Q.processRender(J);this.painter.renderLayers(P);J.drawPhase=y.WGLDrawPhase.HIGHLIGHT;this.painter.beforeRenderLayers(P);for(const Q of H)Q.processRender(J);this.painter.renderLayers(P);if(this._isLabelDrawPhaseRequired(H)){J.drawPhase=y.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(P);for(const Q of H)Q.processRender(J);this.painter.renderLayers(P)}if(k("esri-tiles-debug")){J.drawPhase=
y.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(P);for(const Q of H)Q.processRender(J);this.painter.renderLayers(P)}J.profiler.recordEnd("drawLayers");this._afterRenderChildren()};O._beforeRenderChildren=function(H){const {context:J}=this,{state:P,pixelRatio:Q}=H;J.enforceState();J.setClearDepth(1);J.setClearColor(0,0,0,0);J.clear(J.gl.COLOR_BUFFER_BIT|J.gl.DEPTH_BUFFER_BIT);const {size:U,rotation:aa}=P;var ba=Math.round(U[0]*Q);H=Math.round(U[1]*Q);this._boundFBO=J.getBoundFramebufferObject();
if(P.spatialReference&&(P.spatialReference._isWrappable?P.spatialReference._isWrappable():P.spatialReference.isWrappable)){var ia=d.toRadian(aa),ha=Math.abs(Math.cos(ia)),ca=Math.abs(Math.sin(ia)),S=Math.round(P.worldScreenWidth);if(Math.round(ba*ha+H*ca)<=S)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===ba&&this._clipFBO.height===H||(this._clipFBO=new q(J,{colorTarget:0,depthStencilTarget:3,width:ba,height:H}));var R=(this.state.padding.left-this.state.padding.right)/2,Y=(this.state.padding.bottom-
this.state.padding.top)/2,ea=.5*ba,T=.5*H,W=1/ba,X=1/H;S=.5*S*Q;var fa=.5*(ba*ca+H*ha);ba=this._upperLeft;ha=this._upperRight;ca=this._lowerLeft;var ja=this._lowerRight;e.set(ba,-S,-fa);e.set(ha,S,-fa);e.set(ca,-S,fa);e.set(ja,S,fa);c.identity(this._mat2);c.translate(this._mat2,this._mat2,[ea+R,T+Y]);0!==aa&&c.rotate(this._mat2,this._mat2,ia);e.transformMat2d(ba,ba,this._mat2);e.transformMat2d(ha,ha,this._mat2);e.transformMat2d(ca,ca,this._mat2);e.transformMat2d(ja,ja,this._mat2);ia=this._clipData;
ia.set([2*ca[0]*W-1,2*(H-ca[1])*X-1,2*ja[0]*W-1,2*(H-ja[1])*X-1,2*ba[0]*W-1,2*(H-ba[1])*X-1,2*ha[0]*W-1,2*(H-ha[1])*X-1]);this._clipRendererInitialized||this._initializeClipRenderer(J);this._clipVBO.setData(ia);this._boundFBO=J.getBoundFramebufferObject();J.bindFramebuffer(this._clipFBO);J.setDepthWriteEnabled(!0);J.setStencilWriteMask(255);J.setClearColor(0,0,0,0);J.setClearDepth(1);J.setClearStencil(0);J.clear(J.gl.COLOR_BUFFER_BIT|J.gl.DEPTH_BUFFER_BIT|J.gl.STENCIL_BUFFER_BIT);J.setDepthWriteEnabled(!1);
this._clipFrame=!0}}else this._clipFrame=!1};O._afterRenderChildren=function(){const H=this.context;H.logIno();if(this._clipFrame&&this._clipRendererInitialized){H.bindFramebuffer(this._boundFBO);this._boundFBO=null;H.bindVAO(this._clipVAO);H.useProgram(this._clipStencilProgram);H.setDepthWriteEnabled(!1);H.setDepthTestEnabled(!1);H.setStencilTestEnabled(!0);H.setBlendingEnabled(!1);H.setColorMask(!1,!1,!1,!1);H.setStencilOp(7680,7680,7681);H.setStencilWriteMask(255);H.setStencilFunction(519,1,255);
H.drawElements(4,6,5123,0);H.bindVAO();H.setColorMask(!0,!0,!0,!0);if(null!=this.background){const {r:J,g:P,b:Q,a:U}=this.background.color;H.setClearColor(U*J/255,U*P/255,U*Q/255,U)}else H.setClearColor(0,0,0,0);H.clear(H.gl.COLOR_BUFFER_BIT);H.setBlendingEnabled(!0);H.setStencilFunction(514,1,255);this.painter.blitTexture(H,this._clipFBO.colorTexture,9728,1);H.setStencilTestEnabled(!1)}};O.doRender=function(H){const J=this.context,{state:P,pixelRatio:Q}=H;this._resizeCanvas(H);this.context.enforceState();
J.setViewport(0,0,Q*P.size[0],Q*P.size[1]);J.setDepthWriteEnabled(!0);J.setStencilWriteMask(255);L.prototype.doRender.call(this,H)};O.takeScreenshot=function(){var H=F._asyncToGenerator(function*(J,P){var Q=N.screenshotSuperSampleSettings(J,this._supersampleScreenshots,this._state.padding);const {framebufferWidth:U,framebufferHeight:aa}=Q;var ba=this.context,ia=J.layers;let ha=this.children;const ca={...this._renderParameters,drawPhase:null,globalOpacity:1,stationary:!0,state:this._renderParameters.state.clone(),
pixelRatio:Q.pixelRatio,time:Date.now(),deltaTime:0,blendMode:null,effects:null,inFadeTransition:!1};if(null!=J.rotation){var S=ca.state.viewpoint;S.rotation=J.rotation;ca.state.viewpoint=S}0<ia.length&&(ha=[],ia.forEach(Y=>{const ea=P.find(T=>T.layer.id===Y.id);ea&&"container"in ea&&ea.container&&ha.push(ea.container)}));const R=new q(ba,{colorTarget:0,depthStencilTarget:3,width:U,height:aa});ia=ba.getBoundFramebufferObject();S=ba.getViewport();ba.bindFramebuffer(R);ba.setViewport(0,0,U,aa);this._renderChildren(ha,
ca);Q=this._readbackScreenshot(Q);ba.bindFramebuffer(ia);ba.setViewport(S.x,S.y,S.width,S.height);this.requestRender();ba=this._ensureScreenshotEncodeCanvas();return N.encodeResult(Q,J,ba,{flipY:!0,premultipliedAlpha:!0})});return function(J,P){return H.apply(this,arguments)}}();O._ensureScreenshotEncodeCanvas=function(){this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas"));return this._screenshotEncodeCanvas};O._readbackScreenshot=function(H){const {framebufferWidth:J,
framebufferHeight:P,region:Q,resample:U}=H;H=this.context.gl;if(U){var aa=N.createEmptyImageData(J,P,this._ensureScreenshotEncodeCanvas());H.readPixels(0,0,J,P,6408,5121,new Uint8Array(aa.data.buffer));H=N.createEmptyImageData(Q.width,Q.height,this._ensureScreenshotEncodeCanvas());return N.resampleHermite(aa,H,!0,U.region.x,P-(U.region.y+U.region.height),U.region.width,U.region.height)}aa=N.createEmptyImageData(Q.width,Q.height,this._ensureScreenshotEncodeCanvas());H.readPixels(Q.x,P-(Q.y+Q.height),
Q.width,Q.height,6408,5121,new Uint8Array(aa.data.buffer));return aa};O._resizeCanvas=function(H){const J=this._canvas,P=J.style,{state:{size:Q},pixelRatio:U}=H;H=Q[0];const aa=Q[1],ba=Math.round(H*U),ia=Math.round(aa*U);if(J.width!==ba||J.height!==ia)J.width=ba,J.height=ia;P.width=H+"px";P.height=aa+"px"};O._initializeClipRenderer=function(H){if(this._clipRendererInitialized)return!0;const J=I.stencil.attributes,P=v.createProgram(H,I.stencil);if(!P)return!1;const Q=r.createVertex(H,35040,32);var U=
new Uint16Array([0,1,2,2,1,3]);U=r.createIndex(H,35044,U);H=new w(H,J,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:Q},U);this._clipStencilProgram=P;this._clipVBO=Q;this._clipVAO=H;return this._clipRendererInitialized=!0};O._emptyTrash=function(){for(;0<this._trash.size;){const H=Array.from(this._trash);this._trash.clear();for(const J of H)J.processDetach()}};O._isLabelDrawPhaseRequired=function(H){let J=!1;for(const P of H){if(!(P instanceof A.Container)){J=
J||!1;break}if(P.hasLabels)return!0;J=J||this._isLabelDrawPhaseRequired(P.children)}return J};F._createClass(M,[{key:"background",get:function(){return this._background},set:function(H){this._background=H;this.requestRender()}},{key:"highlightOptions",get:function(){return this._highlightOptions},set:function(H){this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=H)this._highlightOptionsHandle=a.init(this._highlightOptions,
"version",()=>{this.painter.setHighlightOptions(H);this.requestRender()})}},{key:"pools",get:function(){return this._pools}},{key:"renderingOptions",get:function(){return this._renderingOptions},set:function(H){this._renderingOptions=H;this.requestRender()}},{key:"state",get:function(){return this._state},set:function(H){this._state=H;this.requestRender()}},{key:"stationary",get:function(){return this._stationary},set:function(H){this._stationary!==H&&(this._stationary=H,this.requestRender())}}]);
return M}(A.Container);x.EXTRA_RENDER_TIME=2E3;x.Stage=g;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/Container":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/has","./DisplayObject","../../layers/effects/EffectList"],function(x,F,E,B,k){const h=E("mapview-transitions-duration");E=function(a){function d(){var b=a.apply(this,arguments)||this;b._childrenSet=new Set;b.children=[];b._effectList=null;return b}F._inheritsLoose(d,a);var c=
d.prototype;c.updateTransitionProperties=function(b,e){a.prototype.updateTransitionProperties.call(this,b,e);this._effectList&&(this._effectList.transitionStep(b,e),this._effectList.transitioning&&this.requestRender())};c.doRender=function(b){b=this.createRenderParams(b);this.renderChildren(b)};c.addChild=function(b){return this.addChildAt(b,this.children.length)};c.addChildAt=function(b,e=this.children.length){if(!b||this.contains(b))return b;const f=b.parent;f&&f!==this&&f.removeChild(b);e>=this.children.length?
this.children.push(b):this.children.splice(e,0,b);this._childrenSet.add(b);b.parent=this;b.stage=this.stage;this!==this.stage&&(b.clips=this.clips);this.requestRender();return b};c.contains=function(b){return this._childrenSet.has(b)};c.removeAllChildren=function(){this._childrenSet.clear();for(const b of this.children)this!==this.stage&&(b.clips=null),b.stage=null,b.parent=null;this.children.length=0};c.removeChild=function(b){return this.contains(b)?this.removeChildAt(this.children.indexOf(b)):
b};c.removeChildAt=function(b){if(0>b||b>=this.children.length)return null;b=this.children.splice(b,1)[0];this._childrenSet.delete(b);this!==this.stage&&(b.clips=null);b.stage=null;b.parent=null;return b};c.sortChildren=function(b){return this.children.sort(b)};c.onAttach=function(){a.prototype.onAttach.call(this);const b=this.stage;for(const e of this.children)e.stage=b};c.onDetach=function(){a.prototype.onDetach.call(this);for(const b of this.children)b.stage=null};c.renderChildren=function(b){for(const e of this.children)e.beforeRender(b);
for(const e of this.children)e.processRender(b);for(const e of this.children)e.afterRender(b)};c.createRenderParams=function(b){return{...b,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:b.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition}};F._createClass(d,[{key:"blendMode",get:function(){return this._blendMode},set:function(b){this._blendMode=b;this.requestRender()}},{key:"clips",get:function(){return this._clips},set:function(b){this._clips=b;this.children.forEach(e=>
e.clips=b)}},{key:"computedEffects",get:function(){var b,e;return null!=(b=null==(e=this._effectList)?void 0:e.effects)?b:null}},{key:"effect",get:function(){var b,e;return null!=(b=null==(e=this._effectList)?void 0:e.effect)?b:""},set:function(b){if(this._effectList||b)this._effectList||(this._effectList=new k["default"](h)),this._effectList.effect=b,this.requestRender()}}]);return d}(B.DisplayObject);x.Container=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/DisplayObject":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../../../core/Evented","../../../core/has","../../../core/promiseUtils"],function(x,F,E,B,k){const h=1/B("mapview-transitions-duration");E=function(a){function d(){var b=a.apply(this,arguments)||this;b._fadeOutResolver=null;b._fadeInResolver=null;b._clips=null;b.computedVisible=!0;b.computedOpacity=1;b.fadeTransitionEnabled=!1;b.inFadeTransition=!1;b._isReady=!1;b._opacity=1;b._stage=null;b._visible=!0;return b}F._inheritsLoose(d,a);var c=d.prototype;c.fadeIn=
function(){if(this._fadeInResolver)return this._fadeInResolver.promise;this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null);this.computedOpacity=0;this.fadeTransitionEnabled=!0;this._fadeInResolver=k.createResolver();this.requestRender();return this._fadeInResolver.promise};c.fadeOut=function(){if(this._fadeOutResolver)return this._fadeOutResolver.promise;this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this.fadeTransitionEnabled=!0;this._fadeOutResolver=
k.createResolver();this.requestRender();return this._fadeOutResolver.promise};c.beforeRender=function(b){this.updateTransitionProperties(b.deltaTime,b.state.scale)};c.afterRender=function(b){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)};c.remove=function(){var b;null==(b=this.parent)?void 0:b.removeChild(this)};c.setTransform=function(b){};
c.processRender=function(b){this.stage&&this.computedVisible&&this.doRender(b)};c.requestRender=function(){this.stage&&this.stage.requestRender()};c.processDetach=function(){this.onDetach();this.emit("detach")};c.updateTransitionProperties=function(b,e){if(this.fadeTransitionEnabled){e=this._fadeOutResolver||!this.visible?0:this.opacity;const f=this.computedOpacity;f===e?this.computedVisible=this.visible:(b*=h,this.computedOpacity=f>e?Math.max(e,f-b):Math.min(e,f+b),this.computedVisible=0<this.computedOpacity,
b=e===this.computedOpacity,this.inFadeTransition=!b,b||this.requestRender())}else this.computedOpacity=this.opacity,this.computedVisible=this.visible};c.onAttach=function(){};c.onDetach=function(){};c.doRender=function(b){};c.ready=function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())};F._createClass(d,[{key:"clips",get:function(){return this._clips},set:function(b){this._clips=b;this.requestRender()}},{key:"isReady",get:function(){return this._isReady}},{key:"opacity",
get:function(){return this._opacity},set:function(b){this._opacity!==b&&(this._opacity=Math.min(1,Math.max(b,0)),this.requestRender())}},{key:"stage",get:function(){return this._stage},set:function(b){if(this._stage!==b){var e=this._stage;(this._stage=b)?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):e.trashDisplayObject(this)}}},{key:"visible",get:function(){return this._visible},set:function(b){this._visible!==b&&(this._visible=b,this.requestRender())}}]);return d}(E);
x.DisplayObject=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/layers/effects/EffectList":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../colorUtils ../../../core/Error ../../../core/lang ../../../core/Logger ./effects ./parser".split(" "),function(x,F,E,B,k,h,a,d){function c(l){if(!l)return[];if("string"===typeof l){var n=d.parse(l);return n.error?n.error:[{scale:-1,effects:n.effects}]}n=[];for(var u of l){if(!isFinite(u.scale)||0>=u.scale)return new B("effect:invalid-scale",
"scale must be finite and greater than 0",{stop:u});l=d.parse(u.value);if(l.error)return l.error;n.push({scale:u.scale,effects:l.effects})}n.sort((t,m)=>m.effects.length-t.effects.length);for(u=0;u<n.length-1;u++){if(!e(n[u].effects,n[u+1].effects))return new B("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:n[u].effects,b:n[u+1].effects});f(n[u].effects,n[u+1].effects)}n.sort((t,m)=>m.scale-t.scale);return n}function b(l){switch(l.type){case "grayscale":case "sepia":case "invert":return new a.ColorMatrixEffect(l.type,
0);case "saturate":case "brightness":case "contrast":return new a.ColorMatrixEffect(l.type,1);case "opacity":return new a.OpacityEffect(1);case "hue-rotate":return new a.HueRotateEffect(0);case "blur":return new a.BlurEffect(0);case "drop-shadow":return new a.DropShadowEffect(0,0,0,[...E.getNamedColor("transparent")]);case "bloom":return new a.BloomEffect(0,0,0)}}function e(l,n){const u=l.length>n.length?l:n;return(l.length>n.length?n:l).every((t,m)=>t.type===u[m].type)}function f(l,n){const u=l.length>
n.length?l:n;l=l.length>n.length?n:l;for(n=l.length;n<u.length;n++)l.push(b(u[n]))}function r(l,n,u){var t,m,w,v;return null!=(t=l[0])&&t.effects&&null!=(m=n[0])&&m.effects?(-1===(null==(w=l[0])?void 0:w.scale)||-1===(null==(v=n[0])?void 0:v.scale))&&(1<l.length||1<n.length)&&0>=u?!1:e(l[0].effects,n[0].effects):!0}function q(l,n,u){var t,m;const w=l.length>n.length?l:n;l=l.length>n.length?n:l;const v=l[l.length-1];n=null!=(t=null==v?void 0:v.scale)?t:u;t=null!=(m=null==v?void 0:v.effects)?m:[];for(m=
l.length;m<w.length;m++)l.push({scale:n,effects:[...t]});for(m=0;m<w.length;m++)l[m].scale=-1===l[m].scale?u:l[m].scale,w[m].scale=-1===w[m].scale?u:w[m].scale,f(l[m].effects,w[m].effects)}let g=function(){function l(u=200){this.duration=u;this._final=this._to=this._from=null;this._current=[];this._time=0;this._effect="";this._effects=[];this._scale=0}var n=l.prototype;n.transitionStep=function(u,t){this._applyTimeTransition(u);this._updateForScale(t)};n._transitionTo=function(u){0<this.scale&&r(this._current,
u,this.scale)?(this._final=u,this._to=k.clone(u),q(this._current,this._to,this.scale),this._from=k.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=u);this._effects=this._current[0]?k.clone(this._current[0].effects):[]};n._applyTimeTransition=function(u){if(this._to){this._time+=u;u=Math.min(1,this._time/this.duration);for(let m=0;m<this._current.length;m++){const w=this._current[m],v=this._from[m],C=this._to[m];var t=v.scale;w.scale=t+(C.scale-t)*u;for(t=0;t<
w.effects.length;t++)w.effects[t].interpolate(v.effects[t],C.effects[t],u)}1===u&&(this._current=this._final,this._effects=this._current[0]?k.clone(this._current[0].effects):[],this._from=this._to=this._final=null)}};n._updateForScale=function(u){if(0!==this._current.length){this._scale=u;var t=this._current,m=this._current.length-1,w,v=1;if(1===t.length||u>=t[0].scale)var C=w=t[0].effects;else if(u<=t[m].scale)C=w=t[m].effects;else for(let A=0;A<m;A++){const y=t[A],p=t[A+1];if(y.scale>=u&&p.scale<=
u){v=(u-y.scale)/(p.scale-y.scale);w=y.effects;C=p.effects;break}}for(u=0;u<this._effects.length;u++)this._effects[u].interpolate(w[u],C[u],v)}};F._createClass(l,[{key:"effect",get:function(){return this._effect},set:function(u){u=u||"";if(this._effect!==u){this._effect=u;var t=c(u);Array.isArray(t)?this._transitionTo(t):(this._transitionTo([]),h.getLogger("esri.views.layers.effects.EffectList").warn("Invalid Effect",{effect:u,error:t}))}}},{key:"hasEffects",get:function(){return this.transitioning||
!!this._effects.length}},{key:"effects",get:function(){return this._effects}},{key:"scale",get:function(){return this._scale}},{key:"transitioning",get:function(){return null!==this._to}}]);return l}();x.canInterpolateEffectStops=r;x.canInterpolateEffects=e;x.convertEffectToStops=c;x.default=g;x.normalizeEffectStops=q;x.normalizeEffects=f;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/layers/effects/effects":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../../../chunks/mat4f32","./colorMatrixFunctions"],function(x,F,E,B){function k(f,r,q){return f+(r-f)*q}let h=function(){function f(q,g,l){this.strength=q;this.radius=g;this.threshold=l;this.type="bloom"}var r=f.prototype;r.interpolate=function(q,g,l){this.strength=k(q.strength,g.strength,l);this.radius=k(q.radius,g.radius,l);this.threshold=k(q.threshold,g.threshold,l)};r.clone=function(){return new f(this.strength,this.radius,this.threshold)};return f}(),a=function(){function f(q){this.radius=q;
this.type="blur"}var r=f.prototype;r.interpolate=function(q,g,l){this.radius=Math.round(k(q.radius,g.radius,l))};r.clone=function(){return new f(this.radius)};return f}(),d=function(){function f(q,g){this.type=q;this.amount=g;if("invert"===this.type||"grayscale"===this.type||"sepia"===this.type)this.amount=Math.min(this.amount,1)}var r=f.prototype;r.interpolate=function(q,g,l){this.amount=k(q.amount,g.amount,l);this._updateMatrix()};r.clone=function(){return new f(this.type,this.amount)};r._updateMatrix=
function(){const q=this._colorMatrix||E.create();switch(this.type){case "brightness":this._colorMatrix=B.brightness(q,this.amount);break;case "contrast":this._colorMatrix=B.contrast(q,this.amount);break;case "grayscale":this._colorMatrix=B.grayscale(q,this.amount);break;case "invert":this._colorMatrix=B.invert(q,this.amount);break;case "saturate":this._colorMatrix=B.saturate(q,this.amount);break;case "sepia":this._colorMatrix=B.sepia(q,this.amount)}};F._createClass(f,[{key:"colorMatrix",get:function(){this._colorMatrix||
this._updateMatrix();return this._colorMatrix}}]);return f}(),c=function(){function f(q,g,l,n){this.offsetX=q;this.offsetY=g;this.blurRadius=l;this.color=n;this.type="drop-shadow"}var r=f.prototype;r.interpolate=function(q,g,l){this.offsetX=k(q.offsetX,g.offsetX,l);this.offsetY=k(q.offsetY,g.offsetY,l);this.blurRadius=k(q.blurRadius,g.blurRadius,l);this.color[0]=Math.round(k(q.color[0],g.color[0],l));this.color[1]=Math.round(k(q.color[1],g.color[1],l));this.color[2]=Math.round(k(q.color[2],g.color[2],
l));this.color[3]=k(q.color[3],g.color[3],l)};r.clone=function(){return new f(this.offsetX,this.offsetY,this.blurRadius,[...this.color])};return f}(),b=function(){function f(q){this.angle=q;this.type="hue-rotate"}var r=f.prototype;r.interpolate=function(q,g,l){this.angle=k(q.angle,g.angle,l);this._updateMatrix()};r.clone=function(){return new f(this.angle)};r._updateMatrix=function(){const q=this._colorMatrix||E.create();this._colorMatrix=B.rotateHue(q,this.angle)};F._createClass(f,[{key:"colorMatrix",
get:function(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}}]);return f}(),e=function(){function f(q){this.amount=q;this.type="opacity";this.amount=Math.min(this.amount,1)}var r=f.prototype;r.interpolate=function(q,g,l){this.amount=k(q.amount,g.amount,l)};r.clone=function(){return new f(this.amount)};return f}();x.BloomEffect=h;x.BlurEffect=a;x.ColorMatrixEffect=d;x.DropShadowEffect=c;x.HueRotateEffect=b;x.OpacityEffect=e;x.isColorMatrixEffect=function(f){return"colorMatrix"in
f};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/chunks/mat4f32":function(){define(["exports"],function(x){function F(){const d=new Float32Array(16);d[0]=1;d[5]=1;d[10]=1;d[15]=1;return d}function E(d){const c=new Float32Array(16);c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return c}function B(d,c,b,e,f,r,q,g,l,n,u,t,m,w,v,C){const A=new Float32Array(16);A[0]=
d;A[1]=c;A[2]=b;A[3]=e;A[4]=f;A[5]=r;A[6]=q;A[7]=g;A[8]=l;A[9]=n;A[10]=u;A[11]=t;A[12]=m;A[13]=w;A[14]=v;A[15]=C;return A}function k(d,c){return new Float32Array(d,c,16)}const h=F();var a=Object.freeze({__proto__:null,create:F,clone:E,fromValues:B,createView:k,IDENTITY:h});x.IDENTITY=h;x.clone=E;x.create=F;x.createView=k;x.fromValues=B;x.mat4f32=a})},"esri/views/layers/effects/colorMatrixFunctions":function(){define(["exports","../../../chunks/mat4"],function(x,F){x.brightness=(E,B)=>{E=F.set(E,B,
0,0,0,0,B,0,0,0,0,B,0,0,0,0,1);return F.transpose(E,E)};x.contrast=(E,B)=>{E=F.set(E,B,0,0,.5-.5*B,0,B,0,.5-.5*B,0,0,B,.5-.5*B,0,0,0,1);return F.transpose(E,E)};x.grayscale=(E,B)=>{B=1-B;E=F.set(E,.2126+.7874*B,.7152-.7152*B,.0722-.0722*B,0,.2126-.2126*B,.7152+.2848*B,.0722-.0722*B,0,.2126-.2126*B,.7152-.7152*B,.0722+.9278*B,0,0,0,0,1);return F.transpose(E,E)};x.invert=(E,B)=>{const k=1-2*B;E=F.set(E,k,0,0,B,0,k,0,B,0,0,k,B,0,0,0,1);return F.transpose(E,E)};x.rotateHue=(E,B)=>{const k=Math.sin(B*
Math.PI/180);B=Math.cos(B*Math.PI/180);E=F.set(E,.213+.787*B-.213*k,.715-.715*B-.715*k,.072-.072*B+.928*k,0,.213-.213*B+.143*k,.715+.285*B+.14*k,.072-.072*B-.283*k,0,.213-.213*B-.787*k,.715-.715*B+.715*k,.072+.928*B+.072*k,0,0,0,0,1);return F.transpose(E,E)};x.saturate=(E,B)=>{E=F.set(E,.213+.787*B,.715-.715*B,.072-.072*B,0,.213-.213*B,.715+.285*B,.072-.072*B,0,.213-.213*B,.715-.715*B,.072+.928*B,0,0,0,0,1);return F.transpose(E,E)};x.sepia=(E,B)=>{B=1-B;E=F.set(E,.393+.607*B,.769-.769*B,.189-.189*
B,0,.349-.349*B,.686+.314*B,.168-.168*B,0,.272-.272*B,.534-.534*B,.131+.869*B,0,0,0,0,1);return F.transpose(E,E)};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/layers/effects/parser":function(){define(["exports","../../../colorUtils","../../../core/Error","./effects","../../../chunks/_commonjsHelpers"],function(x,F,E,B,k){function h(t){try{switch(t.name){case "grayscale":case "sepia":case "saturate":case "invert":case "brightness":case "contrast":var m,w=1;a(t.parameters,1);1===
t.parameters.length&&(w=b(t.parameters[0]));return m=new B.ColorMatrixEffect(t.name,w);case "opacity":var v;w=1;a(t.parameters,1);1===t.parameters.length&&(w=b(t.parameters[0]));return v=new B.OpacityEffect(w);case "hue-rotate":var C;w=0;a(t.parameters,1);if(1===t.parameters.length){var A=t.parameters[0];if("quantity"!==A.type||(0!==A.value||null!==A.unit)&&null==g[A.unit])throw new E("effect:type-error",`Expected <angle>, Actual: ${d(A)}`,{term:A});w=A.value*g[A.unit]||0}return C=new B.HueRotateEffect(w);
case "blur":var y;w=0;a(t.parameters,1);1===t.parameters.length&&(w=f(t.parameters[0]),c(w,t.parameters[0]));return y=new B.BlurEffect(w);case "drop-shadow":v=[];for(const G of t.parameters)if("color"===G.type){v.length&&Object.freeze(v);if(z)throw new E("effect:type-error","Accepts only one color",{});a:{var p=void 0;m=G;switch(m.colorType){case "hex":var z=F.hex2rgba(m.value);break a;case "named":z=r(m.value);break a;case "function":var D=m.value;a(D.parameters,4);if(n.test(D.name))p=[b(D.parameters[0]),
b(D.parameters[1]),b(D.parameters[2]),D.parameters[3]?b(D.parameters[3]):1];else if(u.test(D.name))p=F.hsla2rgba(e(D.parameters[0]),b(D.parameters[1]),b(D.parameters[2]),D.parameters[3]?b(D.parameters[3]):1);else throw new E("effect:syntax-error",`Invalid color function '${D.name}'`,{colorFunction:D});z=p;break a}z=void 0}}else{const I=f(G);if(Object.isFrozen(v))throw new E("effect:type-error","\x3clength\x3e parameters not consecutive",{lengths:v});v.push(I);3===v.length&&c(I,G)}if(2>v.length||3<
v.length)throw new E("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${v.length}}`,{lengths:v});return w=new B.DropShadowEffect(v[0],v[1],v[2]||0,z||r("black"));case "bloom":return w=1,z=D=0,a(t.parameters,3),t.parameters[0]&&(w=b(t.parameters[0])),t.parameters[1]&&(D=f(t.parameters[1]),c(D,t.parameters[1])),t.parameters[2]&&(z=b(t.parameters[2])),p=new B.BloomEffect(w,D,z)}}catch(G){throw G.details.filter=t,G;}throw new E("effect:unknown-effect",`Effect '${t.name}' is not supported`,
{effect:t});}function a(t,m){if(t.length>m)throw new E("effect:type-error",`Function supports up to ${m} parameters, Actual: ${t.length}`,{parameters:t});}function d(t){return"color"===t.type?"\x3ccolor\x3e":l[t.unit]?"\x3clength\x3e":g[t.unit]?"\x3cangle\x3e":"%"===t.unit?"\x3cpercentage\x3e":"\x3cdouble\x3e"}function c(t,m){if(0>t)throw new E("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:m});}function b(t){if("quantity"!==t.type||null!==t.unit&&"%"!==t.unit)throw new E("effect:type-error",
`Expected <double> or <percentage>, Actual: ${d(t)}`,{term:t});const m=t.value;c(m,t);return"%"===t.unit?.01*m:m}function e(t){if("quantity"!==t.type||null!==t.unit)throw new E("effect:type-error",`Expected <double>, Actual: ${d(t)}`,{term:t});c(t.value,t);return t.value}function f(t){if("quantity"!==t.type||(0!==t.value||null!==t.unit)&&null==l[t.unit])throw new E("effect:type-error",`Expected <length>, Actual: ${d(t)}`,{term:t});return t.value*l[t.unit]||0}function r(t){const m=F.getNamedColorCopy(t);
if(!m)throw new E("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return m}var q={exports:{}};(function(t){(function(m,w){t.exports&&(t.exports=w())})(k.commonjsGlobal,function(){function m(w,v,C,A){this.message=w;this.expected=v;this.found=C;this.location=A;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,m)}(function(w,v){function C(){this.constructor=w}C.prototype=v.prototype;w.prototype=new C})(m,Error);m.buildMessage=function(w,
v){function C(z){return z.charCodeAt(0).toString(16).toUpperCase()}function A(z){return z.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(D){return"\\x0"+C(D)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(D){return"\\x"+C(D)})}function y(z){return z.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,
"\\r").replace(/[\x00-\x0F]/g,function(D){return"\\x0"+C(D)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(D){return"\\x"+C(D)})}var p={literal:function(z){return'"'+A(z.text)+'"'},"class":function(z){var D="",G;for(G=0;G<z.parts.length;G++)D+=z.parts[G]instanceof Array?y(z.parts[G][0])+"-"+y(z.parts[G][1]):y(z.parts[G]);return"["+(z.inverted?"^":"")+D+"]"},any:function(z){return"any character"},end:function(z){return"end of input"},other:function(z){return z.description}};return"Expected "+function(z){var D=
Array(z.length),G;for(G=0;G<z.length;G++){var I=G;var K=z[G];K=p[K.type](K);D[I]=K}D.sort();if(0<D.length){for(z=G=1;G<D.length;G++)D[G-1]!==D[G]&&(D[z]=D[G],z++);D.length=z}switch(D.length){case 1:return D[0];case 2:return D[0]+" or "+D[1];default:return D.slice(0,-1).join(", ")+", or "+D[D.length-1]}}(w)+" but "+(v?'"'+A(v)+'"':"end of input")+" found."};return{SyntaxError:m,parse:function(w,v){function C(la,V){return{type:"literal",text:la,ignoreCase:V}}function A(la,V,da){return{type:"class",
parts:la,inverted:V,ignoreCase:da}}function y(la){return{type:"other",description:la}}function p(la){var V=Ja[la],da;if(!V){for(da=la-1;!Ja[da];)da--;V=Ja[da];for(V={line:V.line,column:V.column};da<la;)10===w.charCodeAt(da)?(V.line++,V.column=1):V.column++,da++;Ja[la]=V}return V}function z(la,V){var da=p(la),ma=p(V);return{start:{offset:la,line:da.line,column:da.column},end:{offset:V,line:ma.line,column:ma.column}}}function D(la){Z<Ba||(Z>Ba&&(Ba=Z,Ka=[]),Ka.push(la))}function G(){oa++;var la=Z;var V=
N();V!==H?(w.substr(Z,4)===U?(V=U,Z+=4):(V=H,0===oa&&D(aa)),V!==H?(V=N(),V!==H?(ta=la,la=V=[]):(Z=la,la=H)):(Z=la,la=H)):(Z=la,la=H);oa--;la===H&&(V=H,0===oa&&D(Q));if(la===H)if(la=[],V=I(),V!==H)for(;V!==H;)la.push(V),V=I();else la=H;return la}function I(){var la=Z;var V=N();if(V!==H){oa++;V=Z;var da=L();if(da!==H){if(40===w.charCodeAt(Z)){var ma=T;Z++}else ma=H,0===oa&&D(W);ma!==H?(ta=V,V=da):(Z=V,V=H)}else Z=V,V=H;oa--;V===H&&(da=H,0===oa&&D(ea));if(V!==H)if(da=N(),da!==H){ma=Z;var ya=K();if(ya!==
H){da=[];var sa=Z;var Ea=N();if(Ea!==H){if(44===w.charCodeAt(Z)){var za=ha;Z++}else za=H,0===oa&&D(ca);za===H&&(za=null);if(za!==H){var Ha=N();if(Ha!==H){var Ia=K();Ia!==H?sa=Ea=[Ea,za,Ha,Ia]:(Z=sa,sa=H)}else Z=sa,sa=H}else Z=sa,sa=H}else Z=sa,sa=H;for(;sa!==H;)da.push(sa),sa=Z,Ea=N(),Ea!==H?(44===w.charCodeAt(Z)?(za=ha,Z++):(za=H,0===oa&&D(ca)),za===H&&(za=null),za!==H?(Ha=N(),Ha!==H?(Ia=K(),Ia!==H?sa=Ea=[Ea,za,Ha,Ia]:(Z=sa,sa=H)):(Z=sa,sa=H)):(Z=sa,sa=H)):(Z=sa,sa=H);da!==H?(ta=ma,ma=ya,ma=ya=0<
da.length?[ma].concat(O(da,3)):[ma]):(Z=ma,ma=H)}else Z=ma,ma=H;da=ma;da===H&&(da=null);da!==H?(ma=N(),ma!==H?(41===w.charCodeAt(Z)?(ma=ba,Z++):(ma=H,0===oa&&D(ia)),ma!==H?(ma=N(),ma!==H?(ta=la,la=V={type:"function",name:V,parameters:da||[]}):(Z=la,la=H)):(Z=la,la=H)):(Z=la,la=H)):(Z=la,la=H)}else Z=la,la=H;else Z=la,la=H}else Z=la,la=H;return la}function K(){var la=Z;oa++;var V=Z;var da=N();if(da!==H)if(da=M(),da!==H){if(37===w.charCodeAt(Z)){var ma=na;Z++}else ma=H,0===oa&&D(qa);ma!==H?(ta=V,V=
da={value:da,unit:"%"}):(Z=V,V=H)}else Z=V,V=H;else Z=V,V=H;oa--;V===H&&(da=H,0===oa&&D(ka));V===H&&(oa++,V=Z,da=N(),da!==H?(da=M(),da!==H?(w.substr(Z,2)===ra?(ma=ra,Z+=2):(ma=H,0===oa&&D(ua)),ma!==H?(ta=V,V=da={value:da,unit:"px"}):(Z=V,V=H)):(Z=V,V=H)):(Z=V,V=H),V===H&&(V=Z,da=N(),da!==H?(da=M(),da!==H?(w.substr(Z,2)===va?(ma=va,Z+=2):(ma=H,0===oa&&D(xa)),ma!==H?(ta=V,V=da={value:da,unit:"cm"}):(Z=V,V=H)):(Z=V,V=H)):(Z=V,V=H),V===H&&(V=Z,da=N(),da!==H?(da=M(),da!==H?(w.substr(Z,2)===wa?(ma=wa,Z+=
2):(ma=H,0===oa&&D(Ga)),ma!==H?(ta=V,V=da={value:da,unit:"mm"}):(Z=V,V=H)):(Z=V,V=H)):(Z=V,V=H),V===H&&(V=Z,da=N(),da!==H?(da=M(),da!==H?(w.substr(Z,2)===Fa?(ma=Fa,Z+=2):(ma=H,0===oa&&D(Aa)),ma!==H?(ta=V,V=da={value:da,unit:"in"}):(Z=V,V=H)):(Z=V,V=H)):(Z=V,V=H),V===H&&(V=Z,da=N(),da!==H?(da=M(),da!==H?(w.substr(Z,2)===La?(ma=La,Z+=2):(ma=H,0===oa&&D(Va)),ma!==H?(ta=V,V=da={value:da,unit:"pt"}):(Z=V,V=H)):(Z=V,V=H)):(Z=V,V=H),V===H&&(V=Z,da=N(),da!==H?(da=M(),da!==H?(w.substr(Z,2)===Ma?(ma=Ma,Z+=
2):(ma=H,0===oa&&D(Wa)),ma!==H?(ta=V,V=da={value:da,unit:"pc"}):(Z=V,V=H)):(Z=V,V=H)):(Z=V,V=H)))))),oa--,V===H&&(da=H,0===oa&&D(pa)),V===H&&(oa++,V=Z,da=M(),da!==H?(w.substr(Z,3)===Na?(ma=Na,Z+=3):(ma=H,0===oa&&D(Xa)),ma!==H?(ta=V,V=da={value:da,unit:"deg"}):(Z=V,V=H)):(Z=V,V=H),V===H&&(V=Z,da=M(),da!==H?(w.substr(Z,3)===Oa?(ma=Oa,Z+=3):(ma=H,0===oa&&D(Ya)),ma!==H?(ta=V,V=da={value:da,unit:"rad"}):(Z=V,V=H)):(Z=V,V=H),V===H&&(V=Z,da=M(),da!==H?(w.substr(Z,4)===Pa?(ma=Pa,Z+=4):(ma=H,0===oa&&D(Za)),
ma!==H?(ta=V,V=da={value:da,unit:"grad"}):(Z=V,V=H)):(Z=V,V=H),V===H&&(V=Z,da=M(),da!==H?(w.substr(Z,4)===Qa?(ma=Qa,Z+=4):(ma=H,0===oa&&D($a)),ma!==H?(ta=V,V=da={value:da,unit:"turn"}):(Z=V,V=H)):(Z=V,V=H)))),oa--,V===H&&(da=H,0===oa&&D(ab)),V===H&&(oa++,V=Z,da=N(),da!==H?(da=M(),da!==H?(ta=V,V=da={value:da,unit:null}):(Z=V,V=H)):(Z=V,V=H),oa--,V===H&&(da=H,0===oa&&D(bb)))));V!==H&&(ta=la,V={type:"quantity",value:V.value,unit:V.unit});la=V;if(la===H){la=Z;oa++;V=Z;35===w.charCodeAt(Z)?(da=cb,Z++):
(da=H,0===oa&&D(db));if(da!==H){da=[];Ra.test(w.charAt(Z))?(ma=w.charAt(Z),Z++):(ma=H,0===oa&&D(Sa));if(ma!==H)for(;ma!==H;)da.push(ma),Ra.test(w.charAt(Z))?(ma=w.charAt(Z),Z++):(ma=H,0===oa&&D(Sa));else da=H;da!==H?(ta=V,V=da={type:"hex",value:w.substring(ta,Z)}):(Z=V,V=H)}else Z=V,V=H;V===H&&(V=Z,da=I(),da!==H&&(ta=V,da={type:"function",value:da}),V=da,V===H&&(V=Z,da=L(),da!==H&&(ta=V,da={type:"named",value:w.substring(ta,Z)}),V=da));oa--;V===H&&(da=H,0===oa&&D(eb));V!==H&&(ta=la,V={type:"color",
colorType:V.type,value:V.value});la=V}return la}function N(){oa++;var la=[];if(R.test(w.charAt(Z))){var V=w.charAt(Z);Z++}else V=H,0===oa&&D(Y);for(;V!==H;)la.push(V),R.test(w.charAt(Z))?(V=w.charAt(Z),Z++):(V=H,0===oa&&D(Y));oa--;la===H&&(V=H,0===oa&&D(S));return la}function L(){oa++;var la=Z;var V=[];if(fa.test(w.charAt(Z))){var da=w.charAt(Z);Z++}else da=H,0===oa&&D(ja);if(da!==H)for(;da!==H;)V.push(da),fa.test(w.charAt(Z))?(da=w.charAt(Z),Z++):(da=H,0===oa&&D(ja));else V=H;V!==H&&(ta=la,V=w.substring(ta,
Z));la=V;oa--;la===H&&(V=H,0===oa&&D(X));return la}function M(){var la=Z;if(Ta.test(w.charAt(Z))){var V=w.charAt(Z);Z++}else V=H,0===oa&&D(Ua);V===H&&(V=null);if(V!==H){var da=Z;V=[];if(Ca.test(w.charAt(Z))){var ma=w.charAt(Z);Z++}else ma=H,0===oa&&D(Da);for(;ma!==H;)V.push(ma),Ca.test(w.charAt(Z))?(ma=w.charAt(Z),Z++):(ma=H,0===oa&&D(Da));if(V!==H)if(46===w.charCodeAt(Z)?(ma=fb,Z++):(ma=H,0===oa&&D(gb)),ma!==H){var ya=[];if(Ca.test(w.charAt(Z))){var sa=w.charAt(Z);Z++}else sa=H,0===oa&&D(Da);if(sa!==
H)for(;sa!==H;)ya.push(sa),Ca.test(w.charAt(Z))?(sa=w.charAt(Z),Z++):(sa=H,0===oa&&D(Da));else ya=H;ya!==H?da=V=[V,ma,ya]:(Z=da,da=H)}else Z=da,da=H;else Z=da,da=H;if(da===H)if(da=[],Ca.test(w.charAt(Z))?(V=w.charAt(Z),Z++):(V=H,0===oa&&D(Da)),V!==H)for(;V!==H;)da.push(V),Ca.test(w.charAt(Z))?(V=w.charAt(Z),Z++):(V=H,0===oa&&D(Da));else da=H;if(da!==H){V=Z;101===w.charCodeAt(Z)?(ma=hb,Z++):(ma=H,0===oa&&D(ib));if(ma!==H)if(Ta.test(w.charAt(Z))?(ya=w.charAt(Z),Z++):(ya=H,0===oa&&D(Ua)),ya===H&&(ya=
null),ya!==H){sa=[];Ca.test(w.charAt(Z))?(da=w.charAt(Z),Z++):(da=H,0===oa&&D(Da));if(da!==H)for(;da!==H;)sa.push(da),Ca.test(w.charAt(Z))?(da=w.charAt(Z),Z++):(da=H,0===oa&&D(Da));else sa=H;sa!==H?V=ma=[ma,ya,sa]:(Z=V,V=H)}else Z=V,V=H;else Z=V,V=H;V===H&&(V=null);V!==H?(ta=la,la=V=parseFloat(w.substring(ta,Z))):(Z=la,la=H)}else Z=la,la=H}else Z=la,la=H;return la}function O(la,V){return la.map(function(da){return da[V]})}v=void 0!==v?v:{};var H={},J={start:G},P=G,Q=y("none"),U="none",aa=C("none",
!1),ba=")",ia=C(")",!1),ha=",",ca=C(",",!1),S=y("whitespace"),R=/^[ \t\n\r]/,Y=A([" ","\t","\n","\r"],!1,!1),ea=y("function"),T="(",W=C("(",!1),X=y("identifier"),fa=/^[a-z\-]/,ja=A([["a","z"],"-"],!1,!1),ka=y("percentage"),na="%",qa=C("%",!1),pa=y("length"),ra="px",ua=C("px",!1),va="cm",xa=C("cm",!1),wa="mm",Ga=C("mm",!1),Fa="in",Aa=C("in",!1),La="pt",Va=C("pt",!1),Ma="pc",Wa=C("pc",!1),ab=y("angle"),Na="deg",Xa=C("deg",!1),Oa="rad",Ya=C("rad",!1),Pa="grad",Za=C("grad",!1),Qa="turn",$a=C("turn",!1),
bb=y("number"),eb=y("color"),cb="#",db=C("#",!1),Ra=/^[0-9a-fA-F]/,Sa=A([["0","9"],["a","f"],["A","F"]],!1,!1),Ta=/^[+\-]/,Ua=A(["+","-"],!1,!1),Ca=/^[0-9]/,Da=A([["0","9"]],!1,!1),fb=".",gb=C(".",!1),hb="e",ib=C("e",!1),Z=0,ta=0,Ja=[{line:1,column:1}],Ba=0,Ka=[],oa=0;if("startRule"in v){if(!(v.startRule in J))throw Error("Can't start parsing from rule \""+v.startRule+'".');P=J[v.startRule]}v=P();if(v!==H&&Z===w.length)return v;v!==H&&Z<w.length&&D({type:"end"});throw function(la,V,da){return new m(m.buildMessage(la,
V),la,V,da)}(Ka,Ba<w.length?w.charAt(Ba):null,Ba<w.length?z(Ba,Ba+1):z(Ba,Ba));}}})})(q);const g={deg:1,grad:.9,rad:180/Math.PI,turn:360},l={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/73},n=/^rgba?/i,u=/^hsla?/i;x.parse=function(t){let m;try{m=t?q.exports.parse(t):[]}catch(w){return{input:t,parsedFunctions:[],effects:[],error:new E("effect:invalid-syntax","Invalid effect syntax",{input:t,error:w})}}t={input:t,parsedFunctions:m,effects:[],error:null};try{for(const w of m)t.effects.push(h(w))}catch(w){t.effects.length=
0,t.error=w}return t};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/chunks/_commonjsHelpers":function(){define(["exports"],function(x){x.commonjsGlobal="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};x.commonjsRequire=function(F){throw Error('Could not dynamically require "'+F+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');
};x.getDefaultExportFromCjs=function(F){return F&&F.__esModule&&Object.prototype.hasOwnProperty.call(F,"default")?F["default"]:F}})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(x){x.WGLGeometryType=void 0;(function(F){F[F.FILL=0]="FILL";F[F.LINE=1]="LINE";F[F.MARKER=2]="MARKER";F[F.TEXT=3]="TEXT";F[F.LABEL=4]="LABEL"})(x.WGLGeometryType||(x.WGLGeometryType={}));x.WGLGeometryTransactionStatus=void 0;(function(F){F[F.SUCCEEDED=0]="SUCCEEDED";F[F.FAILED_OUT_OF_MEMORY=1]=
"FAILED_OUT_OF_MEMORY"})(x.WGLGeometryTransactionStatus||(x.WGLGeometryTransactionStatus={}));x.WGLDrawPhase=void 0;(function(F){F[F.NONE=0]="NONE";F[F.MAP=1]="MAP";F[F.LABEL=2]="LABEL";F[F.LABEL_ALPHA=4]="LABEL_ALPHA";F[F.HITTEST=8]="HITTEST";F[F.HIGHLIGHT=16]="HIGHLIGHT";F[F.CLIP=32]="CLIP";F[F.DEBUG=64]="DEBUG";F[F.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(x.WGLDrawPhase||(x.WGLDrawPhase={}));x.VVType=void 0;(function(F){F[F.SIZE=0]="SIZE";F[F.COLOR=1]="COLOR";F[F.OPACITY=2]="OPACITY";F[F.ROTATION=
3]="ROTATION"})(x.VVType||(x.VVType={}));x.WGLVVFlag=void 0;(function(F){F[F.NONE=0]="NONE";F[F.OPACITY=1]="OPACITY";F[F.COLOR=2]="COLOR";F[F.ROTATION=4]="ROTATION";F[F.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";F[F.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";F[F.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";F[F.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(x.WGLVVFlag||(x.WGLVVFlag={}));x.WGLVVTarget=void 0;(function(F){F[F.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";F[F.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";
F[F.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";F[F.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(x.WGLVVTarget||(x.WGLVVTarget={}));x.MosaicType=void 0;(function(F){F[F.SPRITE=0]="SPRITE";F[F.GLYPH=1]="GLYPH"})(x.MosaicType||(x.MosaicType={}));Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Painter":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/ProgramCache ../../../webgl/Renderbuffer ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ../../../webgl/Texture ../../../webgl/VertexArrayObject ../brushes ../vectorTiles/shaders/VTLMaterialManager ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/BlendEffect ./effects/FeatureEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/post-processing/EffectManager ./painter/RenderPass".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n,u,t,m,w,v,C,A){function y(p,z,D){return 1!==D||F.isSome(p)&&"normal"!==p||F.isSome(z)&&0<z.length}return function(){function p(D,G){this.context=D;this._blitRenderer=new q.BitBlitRenderer;this._brushCache=new Map;this._vtlMaterialManager=new r;this._blendEffect=new t.BlendEffect;this.effects={highlight:new w,hittest:new v.HittestEffect,integrate:new u.AnimationEffect,insideEffect:new m.FeatureEffect("inside"),outsideEffect:new m.FeatureEffect("outside")};
this.materialManager=new l(D);this.textureManager=new n(G);this._effectsManager=new C.EffectManager(G)}var z=p.prototype;z.getRenderTarget=function(){return this._renderTarget};z.setRenderTarget=function(D){this._renderTarget=D};z.getFbos=function(D,G){if(D!==this._lastWidth||G!==this._lastHeight){this._lastWidth=D;this._lastHeight=G;if(this._fbos){for(var I in this._fbos)this._fbos[I].resize(D,G);return this._fbos}I={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:D,
height:G};const K={colorTarget:0,depthStencilTarget:3};this._stencilBuf=D=new a(this.context,{width:D,height:G,internalFormat:34041});this._fbos={output:new B(this.context,K,I,D),blend:new B(this.context,K,I,D),effect0:new B(this.context,K,I,D)}}return this._fbos};z.getSharedStencilBuffer=function(){return this._stencilBuf};z.beforeRenderLayers=function(D,G=null){const {width:I,height:K}=D.getViewport();this._prevFBO=D.getBoundFramebufferObject();const N=this.getFbos(I,K);D.bindFramebuffer(N.output);
D.setColorMask(!0,!0,!0,!0);D.setDepthWriteEnabled(!0);if(F.isSome(G)){const {r:L,g:M,b:O,a:H}=G.color;D.setClearColor(H*L/255,H*M/255,H*O/255,H)}else D.setClearColor(0,0,0,0);D.setClearDepth(1);D.clear(D.gl.COLOR_BUFFER_BIT|D.gl.DEPTH_BUFFER_BIT);D.setDepthWriteEnabled(!1)};z.beforeRenderLayer=function(D,G,I){const {context:K,blendMode:N,effects:L,requireFBO:M}=D;M||y(N,L,I)?(K.bindFramebuffer(this._fbos.blend),K.setColorMask(!0,!0,!0,!0),K.setClearColor(0,0,0,0),K.setDepthWriteEnabled(!0),K.setClearDepth(1),
K.clear(K.gl.COLOR_BUFFER_BIT|K.gl.DEPTH_BUFFER_BIT),K.setDepthWriteEnabled(!1)):(D=this._getOutputFBO(),K.bindFramebuffer(D));K.setDepthWriteEnabled(!1);K.setDepthTestEnabled(!1);K.setStencilTestEnabled(!0);K.setClearStencil(G);K.setStencilWriteMask(255);K.clear(K.gl.STENCIL_BUFFER_BIT)};z.compositeLayer=function(D,G){const {context:I,blendMode:K,effects:N,requireFBO:L}=D;if(L||y(K,N,G)){F.isSome(N)&&0<N.length&&D.drawPhase===g.WGLDrawPhase.MAP&&this._applyEffects(D,N);var M=this._getOutputFBO();
I.bindFramebuffer(M);I.setStencilTestEnabled(!1);I.setStencilWriteMask(0);I.setBlendingEnabled(!0);I.setBlendFunctionSeparate(1,771,1,771);I.setColorMask(!0,!0,!0,!0);M=F.isSome(K)?K:"normal";this._blendEffect.draw(D,this._fbos.blend.colorTexture,9728,M,G)}};z.renderLayers=function(D){D.bindFramebuffer(this._prevFBO);if(this._fbos){var G=this._getOutputFBO();D.setStencilTestEnabled(!1);D.setStencilWriteMask(0);this.blitTexture(D,G.colorTexture,9728)}};z.dispose=function(){this.materialManager.dispose();
this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._brushCache&&(this._brushCache.forEach(D=>D.dispose()),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(const D in this._fbos)this._fbos[D]&&this._fbos[D].dispose();if(this.effects)for(const D in this.effects)this.effects[D]&&this.effects[D].dispose();this._vtlMaterialManager&&(this._vtlMaterialManager.dispose(),this._vtlMaterialManager=null);this._prevFBO=null};z.getGeometryBrush=
function(D){D={[g.WGLGeometryType.FILL]:f.brushes.fill,[g.WGLGeometryType.LINE]:f.brushes.line,[g.WGLGeometryType.MARKER]:f.brushes.marker,[g.WGLGeometryType.TEXT]:f.brushes.text}[D];let G=this._brushCache.get(D);void 0===G&&(G=new D,this._brushCache.set(D,G));return this._brushCache.get(D)};z.renderObject=function(D,G,I,K){I=f.brushes[I];if(!I)return null;let N=this._brushCache.get(I);void 0===N&&(N=new I,this._brushCache.set(I,N));N.prepareState(D,G,K);N.draw(D,G,K)};z.renderObjects=function(D,
G,I,K){I=f.brushes[I];if(!I)return null;let N=this._brushCache.get(I);void 0===N&&(N=new I,this._brushCache.set(I,N));N.drawMany(D,G,K)};z.registerRenderPass=function(D){const G=D.brushes.map(I=>{this._brushCache.has(I)||this._brushCache.set(I,new I);return this._brushCache.get(I)});return new A(G,D)};z.setHighlightOptions=function(D){this.effects.highlight.setHighlightOptions(D)};z.blitTexture=function(D,G,I,K=1){D.setBlendingEnabled(!0);D.setBlendFunctionSeparate(1,771,1,771);D.setColorMask(!0,
!0,!0,!0);this._blitRenderer.render(D,G,I,K)};z.getPostProcessingEffects=function(D){return this._effectsManager.getPostProcessingEffects(D)};z._getOutputFBO=function(){return null!=this._renderTarget?this._renderTarget:this._fbos.output};z._applyEffects=function(D,G){const {context:I}=D;G=this._effectsManager.getPostProcessingEffects(G);for(const {postProcessingEffect:K,effect:N}of G)I.bindFramebuffer(this._fbos.blend),K.draw(D,this._fbos.blend,N)};x._createClass(p,[{key:"vectorTilesMaterialManager",
get:function(){return this._vtlMaterialManager}}]);return p}()})},"esri/views/2d/engine/brushes":function(){define("exports ./webgl/brushes/BrushBitmap ./webgl/brushes/BrushClip ./webgl/brushes/WGLBrushInfo ./webgl/brushes/WGLBrushStencil ./webgl/brushes/WGLBrushVTLBackground ./webgl/brushes/WGLBrushVTLCircle ./webgl/brushes/WGLBrushVTLFill ./webgl/brushes/WGLBrushVTLLine ./webgl/brushes/WGLBrushVTLSymbol ./webgl/brushes/WGLGeometryBrushFill ./webgl/brushes/WGLGeometryBrushLabel ./webgl/brushes/WGLGeometryBrushLine ./webgl/brushes/WGLGeometryBrushMarker ./webgl/brushes/WGLGeometryBrushText ./webgl/brushes/raster/BrushRasterBitmap".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l){const n={vtlBackground:h.WGLBrushVTLBackground,vtlFill:d.WGLBrushVTLFill,vtlLine:c.WGLBrushVTLLine,vtlCircle:a.WGLBrushVTLCircle,vtlSymbol:b.WGLBrushVTLSymbol};x.brushes={marker:q,line:r,fill:e,text:g,label:f,clip:E,stencil:k,bitmap:F,raster:l,tileInfo:B,vtlBackground:h.WGLBrushVTLBackground,vtlFill:d.WGLBrushVTLFill,vtlLine:c.WGLBrushVTLLine,vtlCircle:a.WGLBrushVTLCircle,vtlSymbol:b.WGLBrushVTLSymbol};x.vtlBrushes=n;Object.defineProperty(x,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../definitions","../VertexStream","./WGLBrush"],function(x,F,E,B){const k={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,mips:!1},trilinear:{defines:[],samplingMode:9987,mips:!0}};return function(h){function a(){var c=h.apply(this,arguments)||this;c._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",
attributes:new Map([["a_position",0],["a_texcoord",1]])};return c}x._inheritsLoose(a,h);var d=a.prototype;d.dispose=function(){this._quad&&this._quad.dispose()};d.prepareState=function({context:c},b){c.setBlendingEnabled(!0);"additive"===b.blendFunction?c.setBlendFunctionSeparate(1,1,1,1):c.setBlendFunctionSeparate(1,771,1,771);c.setColorMask(!0,!0,!0,!0);c.setStencilWriteMask(0);c.setStencilTestEnabled(!0);c.setStencilFunction(514,b.stencilRef,255)};d.draw=function(c,b){const {context:e,renderingOptions:f,
painter:r}=c;if(b.source){c.timeline.begin(this.name);this._quad||(this._quad=new E(e,[0,0,1,0,0,1,1,1]));if("dynamic"===f.samplingMode){({state:l}=c);var q=b.resolution/b.pixelRatio/l.resolution,g=Math.round(c.pixelRatio)!==c.pixelRatio;q=1.05<q||.95>q;var l=l.rotation||q||g||b.isSourceScaled||b.rotation?k.bilinear:k.nearest}else l=k[f.samplingMode];g=r.materialManager.getProgram(c,this._desc,l.defines);var {coordScale:n,computedOpacity:u,transforms:t}=b;b.setSamplingProfile(l);b.bind(c.context,
F.TEXTURE_BINDING_BITMAP);e.useProgram(g);g.setUniformMatrix3fv("u_dvsMat3",t.dvs);g.setUniform1i("u_texture",F.TEXTURE_BINDING_BITMAP);g.setUniform2fv("u_coordScale",n);g.setUniform1f("u_opacity",u);this._quad.draw();c.timeline.end(this.name)}};return a}(B)})},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],function(x){x.ANGLE_FACTOR_256=256/360;x.ATTRIBUTE_DATA_ANIMATION=1;x.ATTRIBUTE_DATA_DD0=3;x.ATTRIBUTE_DATA_DD1=3;x.ATTRIBUTE_DATA_FILTER_FLAGS=0;x.ATTRIBUTE_DATA_VV=2;
x.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;x.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};x.BUFFER_DATA_MINIMUM_SIZE=128;x.BUFFER_DATA_POOL_SIZE=4;x.COLLISION_BOX_PADDING=16;x.COLLISION_BUCKET_SIZE=128;x.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;x.COLLISION_MAX_ZOOM_DELTA=1;x.COLLISION_PLACEMENT_PADDING=8;x.COLLISION_TILE_BOX_SIZE=4;x.DEBUG_LABELS=!1;x.DISPLAY_RECORD_INT_PER_ELEMENT=7;x.DOT_DENSITY_MAX_FIELDS=8;x.EFFECT_FLAG_0=4;x.ENABLE_EARLY_LABEL_DISCARD=!1;x.EXTRUDE_SCALE=
64;x.FILTER_FLAG_0=2;x.GLYPH_SIZE=24;x.HEURISTIC_GLYPHS_PER_FEATURE=10;x.HEURISTIC_GLYPHS_PER_LINE=50;x.HIGHLIGHT_FLAG=1;x.HITTEST_SEARCH_SIZE=6;x.MAGIC_LABEL_LINE_HEIGHT=29;x.MAX_FILTERS=2;x.MAX_GPU_UPLOADS_PER_FRAME=2;x.MIN_MAX_ZOOM_PRECISION_FACTOR=10;x.NAN_MAGIC_NUMBER=1E-30;x.PATCH_PIXEL_BUFFER_ALLOC_SIZE=500;x.PICTURE_FILL_COLOR=4294967295;x.RASTER_TILE_SIZE=256;x.SPRITE_PADDING=2;x.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;x.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;x.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;
x.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;x.TEXTURE_BINDING_BITMAP=0;x.TEXTURE_BINDING_GLYPH_ATLAS=0;x.TEXTURE_BINDING_HIGHLIGHT_0=5;x.TEXTURE_BINDING_HIGHLIGHT_1=6;x.TEXTURE_BINDING_RENDERER_0=5;x.TEXTURE_BINDING_RENDERER_1=6;x.TEXTURE_BINDING_SPRITE_ATLAS=0;x.TEXT_PLACEMENT_PADDING=8;x.THIN_LINE_HALF_WIDTH_THRESHOLD=1.05;x.TILE_SIZE=512;x.VTL_HIGH_RES_CUTOFF=1.15;x.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;x.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;x.WEBGL_MAX_INNER_STOPS=6;x.WEBGL_MAX_STOPS=8;Object.defineProperty(x,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/VertexStream":function(){define("../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/ProgramCache ../../../webgl/Renderbuffer ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ../../../webgl/Texture ../../../webgl/VertexArrayObject".split(" "),function(x,F,E,B,k,h,a,d,c){return function(){function b(f,r){this.rctx=f;this._vertexBuffer=x.createVertex(f,35044,new Uint16Array(r));this._vao=
new c(f,new Map([["a_position",0]]),{geometry:[{name:"a_position",count:2,type:5122,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer});this._count=r.length/2}var e=b.prototype;e.bind=function(){this._vao.bind()};e.unbind=function(){this._vao.unbind()};e.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};e.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(5,0,this._count)};return b}()})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(function(){return function(){function x(){this.name=
this.constructor.name||"UnnamedBrush"}var F=x.prototype;F.prepareState=function(E,B,k){};F.draw=function(E,B,k){};F.drawMany=function(E,B,k){for(const h of B)this.draw(E,h,k)};return x}()})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/programUtils".split(" "),function(x,F,E,B,k,h,a){return function(d){function c(){var e=
d.apply(this,arguments)||this;e._color=E.fromValues(0,1,0,1);return e}x._inheritsLoose(c,d);var b=c.prototype;b.dispose=function(){this._program&&this._program.dispose()};b.prepareState=function({context:e}){e.setStencilTestEnabled(!0);e.setBlendingEnabled(!1);e.setFaceCullingEnabled(!1);e.setColorMask(!1,!1,!1,!1);e.setStencilOp(7680,7680,7681);e.setStencilWriteMask(255);e.setStencilFunction(519,0,255)};b.draw=function(e,f){const {context:r,state:q}=e;e=B.createProgramDescriptor("clip",{geometry:[{location:0,
name:"a_pos",count:2,type:5122}]});f=f.getVAO(r,q,e.attributes,e.bufferLayouts);F.isNone(f.indexBuffer)||(this._program||(this._program=a.createProgram(r,h.background)),r.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",q.displayMat3),r.bindVAO(f),r.drawElements(4,f.indexBuffer.size,5125,0),r.bindVAO())};return c}(k)})},"esri/chunks/vec4f32":function(){define(["exports"],function(x){function F(){return new Float32Array(4)}
function E(t){const m=new Float32Array(4);m[0]=t[0];m[1]=t[1];m[2]=t[2];m[3]=t[3];return m}function B(t,m,w,v){const C=new Float32Array(4);C[0]=t;C[1]=m;C[2]=w;C[3]=v;return C}function k(t,m){return new Float32Array(t,m,4)}function h(){return F()}function a(){return B(1,1,1,1)}function d(){return B(1,0,0,0)}function c(){return B(0,1,0,0)}function b(){return B(0,0,1,0)}function e(){return B(0,0,0,1)}const f=F(),r=a(),q=d(),g=c(),l=b(),n=e();var u=Object.freeze({__proto__:null,create:F,clone:E,fromValues:B,
createView:k,zeros:h,ones:a,unitX:d,unitY:c,unitZ:b,unitW:e,ZEROS:f,ONES:r,UNIT_X:q,UNIT_Y:g,UNIT_Z:l,UNIT_W:n});x.ONES=r;x.UNIT_W=n;x.UNIT_X=q;x.UNIT_Y=g;x.UNIT_Z=l;x.ZEROS=f;x.clone=E;x.create=F;x.createView=k;x.fromValues=B;x.ones=a;x.unitW=e;x.unitX=d;x.unitY=c;x.unitZ=b;x.vec4f32=u;x.zeros=h})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ./color ./enums ./SymbolProperties ../../../webgl/Texture".split(" "),
function(x,F,E,B,k,h,a,d,c){function b(L){const M={};for(const O of L)M[O.name]=O.strideInBytes;return M}function e(L){switch(L){case a.WGLGeometryType.MARKER:return z;case a.WGLGeometryType.FILL:return D;case a.WGLGeometryType.LINE:return G;case a.WGLGeometryType.TEXT:return I;case a.WGLGeometryType.LABEL:return K}}function f(L){switch(L%4){case 0:case 2:return 4;case 1:case 3:return 1}}function r(L){switch(L){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}
function q(L){const M={};for(const O in L){let H=0;M[O]=L[O].map(J=>{const P={...J,normalized:J.normalized||!1,divisor:J.divisor||0,offset:H,stride:0};H+=J.count*r(J.type);return P});M[O].forEach(J=>J.stride=H)}return M}const g=E.getLogger("esri.views.2d.engine.webgl.Utils");E=[{name:"geometry",strideInBytes:36,divisor:0}];const l=[{name:"geometry",strideInBytes:36,divisor:0}],n=[{name:"geometry",strideInBytes:12,divisor:0}],u=[{name:"geometry",strideInBytes:40,divisor:0}],t=[{name:"geometry",strideInBytes:36,
divisor:0}],m=[{name:"geometry",strideInBytes:36,divisor:0}],w=b(E),v=b(l),C=b(n),A=b(u),y=b(t),p=b(m),z=["geometry"],D=["geometry"],G=["geometry"],I=["geometry"],K=["geometry"],N=new Map;x.C_FILL_STRIDE_SPEC=v;x.C_FILL_STRIDE_SPEC_DD=C;x.C_FILL_VERTEX_DEF=l;x.C_FILL_VERTEX_DEF_DD=n;x.C_ICON_STRIDE_SPEC=w;x.C_ICON_VERTEX_DEF=E;x.C_LABEL_STRIDE_SPEC=p;x.C_LABEL_VERTEX_DEF=m;x.C_LINE_STRIDE_SPEC=A;x.C_LINE_VERTEX_DEF=u;x.C_TEXT_STRIDE_SPEC=y;x.C_TEXT_VERTEX_DEF=t;x.C_VBO_GEOMETRY="geometry";x.C_VBO_INFO=
{["geometry"]:35044};x.C_VBO_PERINSTANCE="per_instance";x.C_VBO_PERINSTANCE_VV="per_instance_vv";x.allocateTypedArrayBuffer=function(L,M){switch(M%4){case 0:case 2:return new Uint32Array(Math.floor(L*M/4));case 1:case 3:return new Uint8Array(L*M)}};x.allocateTypedArrayBufferwithData=function(L,M){switch(M%4){case 0:case 2:return new Uint32Array(L);case 1:case 3:return new Uint8Array(L)}};x.copyMeshData=function(L,M,O,H,J,P,Q){for(const ba in P){var U=P[ba].stride,aa=f(U);const ia=P[ba].data,ha=O[ba].data,
ca=U*J.vertexCount/aa,S=U*L/aa;U=U*J.vertexFrom/aa;for(aa=0;aa<ca;++aa)ha[aa+S]=ia[aa+U]}O=J.indexCount;for(P=0;P<O;++P)H[P+M]=Q[P+J.indexFrom]-J.vertexFrom+L};x.createGeometryData=function(L,M){const O=[];for(let H=0;5>H;++H){const J=e(H),P={};for(const Q of J)P[Q]={data:M(H,Q)};O.push({data:L(H),buffers:P})}return O};x.createProgramDescriptor=(L,M)=>{if(!N.has(L)){const J=q(M);var O=J;var H={};for(const P in O){const Q=O[P];H[P]=Q.length?Q[0].stride:0}O=H;H=new Map;for(const P in M)for(const Q of M[P])H.set(Q.name,
Q.location);M=H;N.set(L,{strides:O,bufferLayouts:J,attributes:M})}return N.get(L)};x.createTextureFromTexelData=function(L,M){let O,H;B.isPowerOfTwo(M.width)&&B.isPowerOfTwo(M.height)?(O=!0,H=9987):(O=!1,H=9729);return new c(L,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:O,samplingMode:H,wrapMode:33071,flipped:!0},M)};x.forEachGeometryType=function(L){L(a.WGLGeometryType.FILL);L(a.WGLGeometryType.LINE);L(a.WGLGeometryType.MARKER);L(a.WGLGeometryType.TEXT);L(a.WGLGeometryType.LABEL)};
x.geometryToMappedGeometry=function(L){return{vertexFrom:void 0,vertexTo:void 0,geometry:L}};x.getBytes=r;x.getCapType=function(L){switch(L){case "butt":return 0;case "round":return 1;case "square":return 2;default:return g.error(new F("mapview-invalid-type",`Cap type ${L} is not a valid option. Defaulting to round`)),1}};x.getJoinType=function(L){switch(L){case "miter":return 2;case "bevel":return 0;case "round":return 1;default:return g.error(new F("mapview-invalid-type",`Join type ${L} is not a valid option. Defaulting to round`)),
1}};x.getNamedBuffers=e;x.getPixelArrayCtor=function(L){switch(L){case 5121:return Uint8Array;case 32819:return Uint16Array;case 5126:return Float32Array;default:g.error(new F("webgl-utils",`Unable to handle type ${L}`))}};x.getPixelBytes=function(L){switch(L){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:g.error(new F("webgl-utils",`Unable to handle type ${L}`))}};x.getStrides=function(L,M){switch(L){case a.WGLGeometryType.MARKER:return w;case a.WGLGeometryType.FILL:return M?
C:v;case a.WGLGeometryType.LINE:return A;case a.WGLGeometryType.TEXT:return y;case a.WGLGeometryType.LABEL:return p}};x.getTextProperties=function(L){return d.TextProperties.pool.acquire(L.color?h.copyAndPremultiply(L.color):[255,255,255,255],L.haloColor?h.copyAndPremultiply(L.haloColor):[255,255,255,255],k.pt2px(L.haloSize),k.pt2px(L.font.size),L.angle*Math.PI/180,L.xoffset/L.font.size,L.yoffset/L.font.size,"left"===L.horizontalAlignment?0:"right"===L.horizontalAlignment?1:.5,"top"===L.verticalAlignment?
0:"bottom"===L.verticalAlignment?1:.5)};x.getTransformParams=function(L){const {transform:M,hasZ:O,hasM:H}=L;return{transform:M,hasZ:O,hasM:H}};x.getVVType=function(L){switch(L){case "opacity":return a.VVType.OPACITY;case "color":return a.VVType.COLOR;case "rotation":return a.VVType.ROTATION;case "size":return a.VVType.SIZE;default:return g.error(`Cannot interpret unknown vv: ${L}`),null}};x.isDefined=function(L){return null!=L};x.isNumber=function(L){return"number"===typeof L};x.strideToPackingFactor=
f;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/color":function(){define(["exports","./number"],function(x,F){function E(h,a){Array.isArray(a)?(h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3]):(h[0]=a.r,h[1]=a.g,h[2]=a.b,h[3]=a.a);return h}function B(h,a=0,d=!1){const c=h[a+3];h[a+0]*=c;h[a+1]*=c;h[a+2]*=c;d||(h[a+3]*=255);return h}const k=[0,0,0,0];x.copyAndPremultiply=function(h){return B(E([],h))};x.premultiplyAlpha=B;x.premultiplyAlphaRGBA=function(h){if(!h)return 0;
const {r:a,g:d,b:c,a:b}=h;return F.i8888to32(a*b,d*b,c*b,255*b)};x.premultiplyAlphaRGBAArray=function(h){if(!h)return 0;const [a,d,c,b]=h;return F.i8888to32(b/255*a,b/255*d,b/255*c,b)};x.premultiplyAlphaUint32=function(h){B(E(k,h));return F.i8888to32(k[0],k[1],k[2],k[3])};x.white=[255,255,255,1];Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(x){function F(k,h,a){return Math.round(Math.max(Math.min(k,a),h))}const E=new Float32Array(1),
B=new Uint32Array(E.buffer);x.i16=function(k){return F(k,-32768,32767)};x.i1616to32=function(k,h){return 65535&k|h<<16};x.i32=function(k){return F(k,-2147483648,2147483647)};x.i8=function(k){return F(k,-128,127)};x.i8816to32=function(k,h,a){return k&255|(h&255)<<8|a<<16};x.i8888to32=function(k,h,a,d){return k&255|(h&255)<<8|(a&255)<<16|d<<24};x.numTo32=function(k){return k|0};x.toFloat32=function(k){B[0]=k;return E[0]};x.toUint32=function(k){E[0]=k;return B[0]};x.u16=function(k){return F(k,0,65535)};
x.u32=function(k){return F(k,0,4294967295)};x.u32to4Xu8=function(k){return[k&255,(k&65280)>>>8,(k&16711680)>>>16,(k&4278190080)>>>24]};x.u8=function(k){return F(k,0,255)};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["exports","../../../../core/ObjectPool"],function(x,F){let E=function(){function B(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=
0}var k=B.prototype;k.acquire=function(h,a,d,c,b,e,f,r,q){this.color=h;this.haloColor=a;this.haloSize=d;this.size=c;this.angle=b;this.offsetX=e;this.offsetY=f;this.hAnchor=r;this.vAnchor=q};k.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};return B}();E.pool=new F(E);x.TextProperties=E;Object.defineProperty(x,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["exports","./sources/resolver"],function(x,F){F={shaders:{vertexShader:F.resolveIncludes("background/background.vert"),fragmentShader:F.resolveIncludes("background/background.frag")},attributes:new Map([["a_pos",0]])};x.background=F;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define("exports ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../webgl/Program ../../../../../webgl/ProgramCache ../../../../../webgl/Renderbuffer ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ./shaderRepository".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e){const f=new d(function(r){let q=e;r.split("/").forEach(g=>{q&&(q=q[g])});return q});x.resolveIncludes=function(r){return f.resolveIncludes(r)};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\ngl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\nvec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nlowp vec4 color \x3d texture2D(u_tex, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_pos, 0.0, 1.0);\nv_uv \x3d a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\nfloat vIn \x3d rgb2v(Cb);\nvec3 hsvTint \x3d rgb2hsv(Cs);\nvec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\nreturn hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 0.0) ? 0.0 : (Cs \x3d\x3d 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 1.0) ? 1.0 : (Cs \x3d\x3d 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\nreturn (Cs \x3d\x3d 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\nif (Cs \x3c\x3d 0.5) {\nreturn Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n}\nif (Cb \x3c\x3d 0.25) {\nreturn Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n}\nreturn Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\nreturn min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\nreturn max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\nreturn dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\nreturn maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\nfloat lum \x3d lumv3(color);\nfloat mincol \x3d minv3(color);\nfloat maxcol \x3d maxv3(color);\nif (mincol \x3c 0.0) {\ncolor \x3d lum + ((color - lum) * lum) / (lum - mincol);\n}\nif (maxcol \x3e 1.0) {\ncolor \x3d lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n}\nreturn color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\nfloat lbase \x3d lumv3(cbase);\nfloat llum \x3d lumv3(clum);\nfloat ldiff \x3d llum - lbase;\nvec3 color \x3d cbase + vec3(ldiff);\nreturn clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\nfloat minbase \x3d minv3(cbase);\nfloat sbase \x3d satv3(cbase);\nfloat ssat \x3d satv3(csat);\nvec3 color;\nif (sbase \x3e 0.0) {\ncolor \x3d (cbase - minbase) * ssat / sbase;\n} else {\ncolor \x3d vec3(0.0);\n}\nreturn setLum(color, clum);\n}\nvoid main() {\nvec4 src \x3d texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\ngl_FragColor \x3d src *  u_opacity;\n#else\nvec4 dst \x3d texture2D(u_backbufferTexture, v_uv);\nvec3 Cs \x3d src.a \x3d\x3d 0.0 ? src.rgb : vec3(src.rgb / src.a);\nvec3 Cb \x3d dst.a \x3d\x3d 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\nfloat as \x3d u_opacity * src.a;\nfloat ab \x3d dst.a;\n#ifdef DESTINATION_OVER\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n#endif\n#ifdef SOURCE_IN\nvec4 color \x3d vec4(as * Cs * ab, as * ab);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef DESTINATION_IN\nvec4 color \x3d vec4(ab * Cb * as, ab * as);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef SOURCE_OUT\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n#endif\n#ifdef DESTINATION_OUT\ngl_FragColor \x3d vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n#endif\n#ifdef SOURCE_ATOP\ngl_FragColor \x3d vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n#endif\n#ifdef DESTINATION_ATOP\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n#endif\n#ifdef XOR\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\nas * (1.0 - ab) + ab * (1.0 - as));\n#endif\n#ifdef MULTIPLY\ngl_FragColor \x3d vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\nas + ab * (1.0 - as));\n#endif\n#ifdef SCREEN\ngl_FragColor \x3d vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef OVERLAY\nvec3 f \x3d vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DARKEN\ngl_FragColor \x3d vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LIGHTER\ngl_FragColor \x3d vec4(as * Cs + ab * Cb, as + ab);\n#endif\n#ifdef LIGHTEN\ngl_FragColor \x3d vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_DODGE\nvec3 f \x3d vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_BURN\nvec3 f \x3d vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HARD_LIGHT\nvec3 f \x3d vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SOFT_LIGHT\nvec3 f \x3d vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DIFFERENCE\ngl_FragColor \x3d vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef EXCLUSION\nvec3 f \x3d Cs + Cb - 2.0 * Cs * Cb;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef INVERT\ngl_FragColor \x3d vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n#endif\n#ifdef VIVID_LIGHT\nvec3 f \x3d vec3(vividLight(Cb.r, Cs.r),\nvividLight(Cb.g, Cs.g),\nvividLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HUE\nvec3 f \x3d setLumSat(Cs,Cb,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SATURATION\nvec3 f \x3d setLumSat(Cb,Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR\nvec3 f \x3d setLum(Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LUMINOSITY\nvec3 f \x3d setLum(Cb,Cs);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef PLUS\ngl_FragColor \x3d clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n#endif\n#ifdef MINUS\ngl_FragColor \x3d vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n#endif\n#ifdef AVERAGE\nvec3 f \x3d (Cb + Cs) / 2.0;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef REFLECT\nvec3 f \x3d vec3(reflectBlend(Cb.r, Cs.r),\nreflectBlend(Cb.g, Cs.g),\nreflectBlend(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#endif\n}",
"blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_position , 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\nfloat b \x3d 1.0 / 6.0;\nfloat v2 \x3d v * v;\nfloat v3 \x3d v2 * v;\nfloat w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\nfloat w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\nfloat w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\nfloat w3 \x3d b * v3;\nreturn vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\nvec4 w \x3d computeWeights(v);\nfloat g0 \x3d w.x + w.y;\nfloat g1 \x3d w.z + w.w;\nfloat h0 \x3d 1.0 - (w.y / g0) + v;\nfloat h1 \x3d 1.0 + (w.w / g1) - v;\nreturn vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\nvec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\nvec2 texel \x3d coords * texSize - 0.5;\nvec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\nvec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\nvec2 coords10 \x3d coords + hgX.x * eX;\nvec2 coords00 \x3d coords - hgX.y * eX;\nvec2 coords11 \x3d coords10 + hgY.x * eY;\nvec2 coords01 \x3d coords00 + hgY.x * eY;\ncoords10 \x3d coords10 - hgY.y * eY;\ncoords00 \x3d coords00 - hgY.y * eY;\nvec4 color00 \x3d texture2D(sampler, coords00);\nvec4 color10 \x3d texture2D(sampler, coords10);\nvec4 color01 \x3d texture2D(sampler, coords01);\nvec4 color11 \x3d texture2D(sampler, coords11);\ncolor00 \x3d mix(color00, color01, hgY.z);\ncolor10 \x3d mix(color10, color11, hgY.z);\ncolor00 \x3d mix(color00, color10, hgX.z);\nreturn color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 texelStart \x3d floor(coords * texSize);\nvec2 coord0 \x3d texelStart / texSize;\nvec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\nvec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\nvec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\nvec4 color0 \x3d texture2D(sampler, coord0);\nvec4 color1 \x3d texture2D(sampler, coord1);\nvec4 color2 \x3d texture2D(sampler, coord2);\nvec4 color3 \x3d texture2D(sampler, coord3);\nvec2 blend \x3d fract(coords * texSize);\nvec4 color01 \x3d mix(color0, color1, blend.x);\nvec4 color23 \x3d mix(color2, color3, blend.x);\nreturn mix(color01, color23, blend.y);\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\nvec2 invSize \x3d 1.0 / texSize;\nvec2 texel \x3d coords * texSize;\nvec2 texel_i \x3d floor(texel);\nvec2 texel_frac \x3d fract(texel);\nvec4 colorP \x3d texture2D(sampler, texel_i * invSize);\nvec4 colorP1 \x3d vec4(colorP);\nvec4 colorP2 \x3d vec4(colorP);\nvec4 colorP3 \x3d vec4(colorP);\nvec4 colorP4 \x3d vec4(colorP);\nvec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\nvec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\nvec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\nvec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\nif (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\ncolorP1 \x3d colorA;\n}\nif (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\ncolorP2 \x3d colorB;\n}\nif (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\ncolorP3 \x3d colorC;\n}\nif (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\ncolorP4 \x3d colorD;\n}\nvec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\nvec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\nreturn mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\nvec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\nfloat flags \x3d data0.r * 255.0;\nfloat groupMinZoom \x3d data0.g * 255.0;\nfloat isVisible \x3d getFilterBit(flags, 0);\nfloat wouldClip \x3d step(groupMinZoom, u_zoomLevel);\nfloat direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\nfloat dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\nvec4 nextState \x3d vec4(texel + direction * dt);\ngl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\ngl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump float u_sigma;\nuniform sampler2D u_texture;\nmediump float gauss1(mediump vec2 dir) {\nreturn exp(-dot(dir, dir) / (2.0 * u_sigma * u_sigma));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\nreturn u_channelSelector * sample;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\nmediump float w \x3d gauss1(i * u_direction.xy);\ntot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\nweight +\x3d w;\n}\nvoid main(void) {\nmediump float tot \x3d 0.0;\nmediump float weight \x3d 0.0;\naccumGauss1(-5.0, tot, weight);\naccumGauss1(-4.0, tot, weight);\naccumGauss1(-3.0, tot, weight);\naccumGauss1(-2.0, tot, weight);\naccumGauss1(-1.0, tot, weight);\naccumGauss1(0.0, tot, weight);\naccumGauss1(1.0, tot, weight);\naccumGauss1(2.0, tot, weight);\naccumGauss1(3.0, tot, weight);\naccumGauss1(4.0, tot, weight);\naccumGauss1(5.0, tot, weight);\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump float u_sigma;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\nmediump float y \x3d texture2D(u_texture, v_texcoord)[3];\nconst mediump float y0 \x3d 0.5;\nmediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * u_sigma);\nmediump float d \x3d (y - y0) / m0;\nreturn d;\n}\nmediump vec4 shade(mediump float d) {\nmediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\nmappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\nreturn texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\nmediump float d \x3d estimateDistance();\ngl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor \x3d 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\nlowp vec2 uvn \x3d uv * 2.0 - 1.0;\nif (uvn.x \x3d\x3d 0.0 \x26\x26 uvn.y \x3d\x3d 0.0) {\nreturn vec2(0.5, 0.5);\n}\nlowp float theta \x3d atan(uvn.y, uvn.x);\nlowp float r \x3d pow(length(uvn), barrelFactor);\nreturn r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\nlowp vec4 color \x3d texture2D(u_readbackTexture, barrel(v_texCoord));\ncolor \x3d (color + (1.0 - color.a) * u_background);\nlowp float mask \x3d u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\ncolor *\x3d mask;\nlowp vec4 overlayColor \x3d u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\ngl_FragColor \x3d overlayColor + (1.0 - overlayColor.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\nv_texCoord \x3d a_pos;\ngl_Position \x3d vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\nhighp vec4 texel \x3d unpackDisplayIdTexel(id);\nhighp float size \x3d float(u_attributeTextureSize);\nhighp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\nhighp float col \x3d mod(u32, size);\nhighp float row \x3d (u32 - col) / size;\nhighp float u \x3d col / size;\nhighp float v \x3d row / size;\nreturn vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\nvec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\nbool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\nif (isMagic) {\nreturn NAN_MAGIC_NUMBER;\n}\nreturn (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float POSITION_PRECISION \x3d 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION \x3d 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\ngl_FragColor \x3d v_id;\n#elif defined(PATTERN)\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\nvec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\nvec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\nvec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\nvec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\nvec4 isPositive0 \x3d step(0.0, difference0);\nvec4 isPositive1 \x3d step(0.0, difference1);\nfloat weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\nfloat lessThanEqZero \x3d step(weightSum, 0.0);\nfloat greaterThanZero \x3d 1.0 - lessThanEqZero ;\nfloat divisor \x3d (weightSum + lessThanEqZero);\nvec4 weights0 \x3d difference0 * isPositive0 / divisor;\nvec4 weights1 \x3d difference1 * isPositive1 / divisor;\nvec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\nvec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\nfloat diffMax \x3d max(max4(difference0), max4(difference1));\nfloat lessThanZero \x3d step(diffMax, 0.0);\nfloat greaterOrEqZero \x3d 1.0 - lessThanZero;\nvec4 isMax0 \x3d step(diffMax, difference0);\nvec4 isMax1 \x3d step(diffMax, difference1);\nvec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\nvec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\ngl_FragColor \x3d preEffectColor;\n#else\ngl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\ngl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision highp float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\nattribute vec2 a_zoomRange;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\nreturn featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\nvoid main()\n{\nINIT;\nfloat a_bitSet \x3d a_aux3.a;\nv_color     \x3d getColor(a_color, a_bitSet, 0);\nv_opacity   \x3d getOpacity();\nv_id        \x3d norm(a_id);\nv_pos       \x3d u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\nv_flags     \x3d getFilterFlags();\n#ifdef PATTERN\nvec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\nfloat width \x3d u_zoomFactor * a_aux1.x * aux2.x;\nfloat height \x3d u_zoomFactor * a_aux1.y * aux2.y;\nfloat angle \x3d C_256_TO_RAD * a_aux3.z;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nmat3 patternMatrix \x3d mat3(cosA / width, sinA / height, 0,\n-sinA / width, cosA / height, 0,\n0,            0,             1);\nvec2 symbolOffset \x3d (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED) / vec2(width, height);\nv_tileTextureCoord \x3d (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\nv_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\nvec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\nvec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\nfloat size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\nv_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\nv_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\nv_dotTextureCoords \x3d (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\ngl_Position \x3d vec4(clip(v_color, v_pos, v_flags, a_zoomRange), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying highp float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\nvec2 v_size \x3d v_sizeTex.xy;\nvec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nfloat outlineWidth \x3d v_outlineWidth;\n#ifdef HIGHLIGHT\noutlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n#endif\nif (outlineWidth \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\nfloat clampedOutlineSize \x3d min(outlineWidth, size);\noutlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\ngl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n}\nelse {\ngl_FragColor \x3d v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef HIGHLIGHT\ngl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\nfloat r \x3d getSize(baseSize.y) / referenceSize;\nbaseSize.xy *\x3d r;\noffset.xy *\x3d r;\nfloat scaleSymbolProportionally \x3d getBit(bitSet, 3);\noutlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\nreturn baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\nfloat isMapAligned \x3d getBit(a_bitSet, 0);\nvec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\nreturn getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\nINIT;\nvec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec2  a_offset \x3d a_vertexOffset / 16.0;\nfloat a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\nvec2 v_tex      \x3d a_texCoords / u_mosaicSize;\nv_color    \x3d getColor(a_color, a_bitSet, 1);\nv_opacity  \x3d getOpacity();\nv_id       \x3d norm(a_id);\nv_filters  \x3d getFilterFlags();\nv_pos      \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + getOffset(a_offset, a_bitSet);\nv_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\nv_isThin   \x3d getBit(a_bitSet, 2);\n#ifdef VV_COLOR\nv_overridingOutlineColor \x3d v_isThin;\n#else\nv_overridingOutlineColor \x3d 0.0;\n#endif\nv_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\nv_outlineColor \x3d a_outlineColor;\nv_distRatio \x3d a_bitSetAndDistRatio.y / 126.0;\n#endif\ngl_Position \x3d vec4(clip(v_color, v_pos, v_filters, a_zoomRange), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\nfloat glyphAngle \x3d angle * 360.0 / 254.0;\nfloat mapAngle \x3d u_mapRotation * 360.0 / 254.0;\nfloat diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\nfloat z \x3d 0.0;\nz +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_currentZoom)));\nz +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\nz +\x3d 2.0 * (1.0 - step(u_currentZoom, maxZoom));\nreturn z;\n}\nvoid main()\n{\nINIT;\nfloat groupMinZoom    \x3d getMinZoom();\nfloat glyphMinZoom    \x3d a_glyphData.x;\nfloat glyphMaxZoom    \x3d a_glyphData.y;\nfloat glyphAngle      \x3d a_glyphData.z;\nfloat a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\nfloat a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\nvec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\nfloat a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\nfloat fontSize           \x3d a_texAndSize.z;\nfloat haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\nvec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  pos          \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\nfloat fontScale    \x3d fontSize / SDF_FONT_SIZE;\nfloat halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\nfloat animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\nv_color     \x3d animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\nv_opacity   \x3d 1.0;\nv_tex       \x3d a_texCoords / u_mosaicSize;\nv_edgeDistanceOffset \x3d u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\nvec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\nvec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\nvec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\ngl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\nv_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying highp vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nuniform mediump float u_antialiasing;\n#endif\nvoid main()\n{\nmediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nmediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\nlowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\nmediump float lineHalfWidth \x3d v_lineHalfWidth;\nmediump float lineWidthRatio \x3d max(lineHalfWidth - 0.55 * u_antialiasing, 0.25) / sdfPatternHalfWidth;\nmediump float relativeTexX \x3d mod(v_accumulatedDistance * 0.5 / (lineWidthRatio * v_patternSize.x), 1.0);\nmediump float relativeTexY \x3d 0.5 + 0.25 * v_normal.y;\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * lineHalfWidth;\nlowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\ngl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\nmediump float lineHalfWidth \x3d v_lineHalfWidth;\nmediump float adjustedPatternWidth \x3d v_patternSize.x * 2.0 * lineHalfWidth / v_patternSize.y;\nmediump float relativeTexX \x3d mod(v_accumulatedDistance / adjustedPatternWidth, 1.0);\nmediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexY, relativeTexX));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\ngl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\ngl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\ngl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nconst float WIDTH_SCALE \x3d 1.0 / 1024.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\nfloat referenceHalfWidth \x3d a_aux.x * WIDTH_SCALE;\nfloat lineWidth \x3d 2.0 * in_lineHalfWidth;\nreturn 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\nreturn in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\nfloat halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\nhalfWidth \x3d max(halfWidth, 2.0);\n#endif\nreturn halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\nfloat thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nreturn thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\nINIT;\nfloat a_bitSet          \x3d a_segmentDirection.w;\nfloat a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\nfloat a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * WIDTH_SCALE;\nfloat aa                \x3d 0.5 * u_antialiasing;\nvec2  a_offset          \x3d a_offsetAndNormal.xy;\nfloat baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nfloat z         \x3d 2.0 * step(baseWidth, 0.0);\nvec2  dist      \x3d getDist(a_offset, halfWidth);\nvec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\nvec3  pos       \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + offset;\nv_color         \x3d getColor(a_color, a_bitSet, 0);\nv_opacity       \x3d getOpacity();\nv_lineHalfWidth \x3d halfWidth;\nv_id            \x3d norm(a_id);\nv_normal        \x3d a_offsetAndNormal.zw * SCALE;\nv_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\nv_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\nv_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d a_accumulatedDist * u_zoomFactor + dot(SCALE * a_segmentDirection.xy, dist);\n#endif\ngl_Position \x3d vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n}"},
text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\nfloat SDF_CUTOFF \x3d (2.0 / 8.0);\nfloat SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\nedge /\x3d 2.0;\n#endif\nlowp float aa \x3d v_antialiasingWidth;\nlowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\ngl_FragColor \x3d alpha * v_color * v_opacity;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_zoomRange;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\nreturn getSize(baseSize);\n#endif\nreturn baseSize;\n}\nvoid main()\n{\nINIT;\nfloat a_referenceSize \x3d a_aux.z * a_aux.z / 256.0;\nfloat a_bitSet        \x3d a_aux.w;\nfloat a_fontSize      \x3d a_texFontSize.z;\nvec2  a_offset        \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  in_pos        \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat fontSize      \x3d getTextSize(a_fontSize, a_referenceSize);\nfloat scaleFactor   \x3d fontSize / a_fontSize;\nfloat fontScale     \x3d fontSize / SDF_FONT_SIZE;\nvec3  offset        \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\nmat3  extrudeMatrix \x3d getBit(a_bitSet, 0) \x3d\x3d 1.0 ? u_displayViewMat3 : u_displayMat3;\nv_color   \x3d u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 1);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\nv_tex     \x3d a_texCoords / u_mosaicSize;\nv_pos     \x3d u_dvsMat3 * in_pos + extrudeMatrix * offset;\nv_edgeDistanceOffset \x3d u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\ngl_Position \x3d  vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\nreturn floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\nfloat offset \x3d pow(2.0, float(bitIndex));\nreturn mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\nreturn getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\nreturn getBit(bitset, 0);\n}\nhighp vec4 unpackDisplayIdTexel(in highp vec4 bitset) {\nfloat isAggregate \x3d getBit(bitset.a, 7);\nreturn (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\nfloat r \x3d mod(rshift(u32, 0), 255.0);\nfloat g \x3d mod(rshift(u32, 8), 255.0);\nfloat b \x3d mod(rshift(u32, 16), 255.0);\nfloat a \x3d mod(rshift(u32, 24), 255.0);\nreturn vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\nreturn v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\nreturn max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\nreturn (bytes - 127.0) / 127.0;\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nuniform mediump float u_currentZoom;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\ntarget.rgba \x3d getAttributeData2(a_id);\n#else\nvec4 data0 \x3d getAttributeData2(a_id);\nvec4 data1 \x3d getAttributeData3(a_id);\ntarget.r \x3d u88VVToFloat(data0.rg * 255.0);\ntarget.g \x3d u88VVToFloat(data0.ba * 255.0);\ntarget.b \x3d u88VVToFloat(data1.rg * 255.0);\ntarget.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n#define INIT loadVisualVariableData(VV_ADATA)\n#else\n#define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\nfloat isColorLocked   \x3d getBit(a_bitSet, index);\nreturn getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\nreturn a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\nreturn getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\nreturn 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\nreturn getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\nreturn in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\nreturn getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\nreturn mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\nreturn ceil(getAttributeData0(a_id).x * 255.0);\n#else\nreturn getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\nreturn getAttributeData1(a_id);\n}\nfloat getMinZoom() {\nvec4 data0 \x3d getAttributeData0(a_id) * 255.0;\nreturn data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\nreturn isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 clip(inout vec4 color, inout vec3 pos, in float filterFlags, in vec2 minMaxZoom) {\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\npos.z +\x3d 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n#if !defined(HIGHLIGHT_ALL)\npos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n#endif\npos.z +\x3d 2.0 * (step(minMaxZoom.y, u_currentZoom) + (1.0 - step(minMaxZoom.x, u_currentZoom)));\nreturn pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifndef OUTSIDE_LABELS_VISIBLE\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#endif\nreturn pos;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n#define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n#define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\nreturn (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nfloat interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\ninterpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\nreturn u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nif (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\nreturn u_vvSizeFieldStopsSizes[0];\n}\nfor (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\nif (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\nfloat f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\nreturn mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n}\n}\nreturn u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nreturn u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue) {\nif (isNan(opacityValue)) {\nreturn 1.0;\n}\nif (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\nreturn u_vvOpacities[0];\n}\nfor (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\nif (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\nfloat f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\nreturn mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n}\n}\nreturn u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat4(1, 0, 0, 0,\n0, 1, 0, 0,\n0, 0, 1, 0,\n0, 0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat4(cosA, sinA, 0, 0,\n-sinA,  cosA, 0, 0,\n0,     0, 1, 0,\n0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat3(1, 0, 0,\n0, 1, 0,\n0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * -rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat3(cosA, -sinA, 0,\nsinA, cosA, 0,\n0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\nif (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\nreturn fallback;\n}\nif (colorValue \x3c\x3d u_vvColorValues[0]) {\nreturn u_vvColors[0];\n}\nfor (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\nif (u_vvColorValues[i] \x3e\x3d colorValue) {\nfloat f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\nreturn mix(u_vvColors[i-1], u_vvColors[i], f);\n}\n}\nreturn u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\nreturn getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\nreturn u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\nfloat outSize \x3d getVVStopsSize(vvSize, size);\nreturn isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\nreturn getVVUnitValue(vvSize, size);\n#else\nreturn size;\n#endif\n}"},
"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\ngl_FragColor \x3d texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\nfloat mirrorFactor \x3d 1.2 - factor;\nreturn mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\ngl_FragColor \x3d u_bloomStrength * (\nlerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\nlerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\nlerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\nlerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\nlerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n);\n}"},
gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d float(SIGMA);\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\nvec4 texel \x3d texture2D(u_texture, v_uv);\nvec3 luma \x3d vec3(0.299, 0.587, 0.114);\nfloat v \x3d dot(texel.xyz, luma);\nvec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\nfloat alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\ngl_FragColor \x3d mix(outputColor, texel, alpha);\n}"}},
blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d u_sigma;\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist \x3d 1.0;\nconst float sampleStrength \x3d 2.2;\nvoid main(void) {\nfloat samples[10];\nsamples[0] \x3d -0.08;\nsamples[1] \x3d -0.05;\nsamples[2] \x3d -0.03;\nsamples[3] \x3d -0.02;\nsamples[4] \x3d -0.01;\nsamples[5] \x3d  0.01;\nsamples[6] \x3d  0.02;\nsamples[7] \x3d  0.03;\nsamples[8] \x3d  0.05;\nsamples[9] \x3d  0.08;\nvec2 dir \x3d 0.5 - v_uv;\nfloat dist \x3d sqrt(dir.x * dir.x + dir.y * dir.y);\ndir \x3d dir / dist;\nvec4 color \x3d texture2D(u_colorTexture,v_uv);\nvec4 sum \x3d color;\nfor (int i \x3d 0; i \x3c 10; i++) {\nsum +\x3d texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n}\nsum *\x3d 1.0 / 11.0;\nfloat t \x3d dist * sampleStrength;\nt \x3d clamp(t, 0.0, 1.0);\ngl_FragColor \x3d mix(color, sum, t);\n}"}},
dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\nvec4 minColor \x3d texture2D(u_minColor, vec2(0.5));\nvec4 maxColor \x3d texture2D(u_maxColor, vec2(0.5));\nvec4 color \x3d texture2D(u_texture, v_uv);\nvec3 minColorUnpremultiply \x3d minColor.rgb / minColor.a;\nvec3 maxColorUnpremultiply \x3d maxColor.rgb / maxColor.a;\nvec3 colorUnpremultiply \x3d color.rgb / color.a;\nvec3 range \x3d maxColorUnpremultiply - minColorUnpremultiply;\ngl_FragColor \x3d vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}",
"min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\nvec2 srcPixel \x3d floor(gl_FragCoord.xy) * float(CELL_SIZE);\nvec2 onePixel \x3d vec2(1.0) / u_srcResolution;\nvec2 uv \x3d (srcPixel + 0.5) / u_srcResolution;\nvec4 minColor \x3d vec4(1.0);\nvec4 maxColor \x3d vec4(0.0);\nfor (int y \x3d 0; y \x3c CELL_SIZE; ++y) {\nfor (int x \x3d 0; x \x3c CELL_SIZE; ++x) {\nvec2 offset \x3d uv + vec2(x, y) * onePixel;\nminColor \x3d min(minColor, texture2D(u_minTexture, offset));\nmaxColor \x3d max(maxColor, texture2D(u_maxTexture, offset));\n}\n}\ngl_FragData[0] \x3d minColor;\ngl_FragData[1] \x3d maxColor;\n}"}},
"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nvarying vec2 v_uv;\nvoid main() {\nvec4 layerColor \x3d texture2D(u_layerFBOTexture, v_uv);\nvec4 blurColor \x3d texture2D(u_blurTexture, v_uv);\ngl_FragColor \x3d ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"},"drop-shadow.vert":"precision mediump float;\nattribute vec2 a_position;\nuniform highp mat3 u_displayViewMat3;\nuniform highp vec2 u_offset;\nvarying vec2 v_uv;\nvoid main() {\nvec3 offset \x3d u_displayViewMat3 * vec3(u_offset, 0.0);\ngl_Position \x3d vec4(a_position, 0.0, 1.0) + vec4(offset, 0.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"},
"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 \x3d mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 \x3d mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 \x3d mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 \x3d mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 \x3d mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 \x3d mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 \x3d mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 \x3d mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 \x3d mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\nG[0] \x3d g0,\nG[1] \x3d g1,\nG[2] \x3d g2,\nG[3] \x3d g3,\nG[4] \x3d g4,\nG[5] \x3d g5,\nG[6] \x3d g6,\nG[7] \x3d g7,\nG[8] \x3d g8;\nmat3 I;\nfloat cnv[9];\nvec3 sample;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 9; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nfloat M \x3d (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\nfloat S \x3d (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\ngl_FragColor \x3d vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},
sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\ngl_FragColor \x3d vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},
"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\ngl_FragColor \x3d vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},
filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\nvec4 rgbw \x3d u_coefficients * vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\nfloat a \x3d color.a;\ngl_FragColor \x3d vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"}},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\nvec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\nfloat alpha \x3d u_opacity * color.a;\ngl_FragColor \x3d vec4(alpha * color.rgb, alpha);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include \x3craster/common/projection.glsl\x3e\n#endif\n#ifdef BICUBIC\n#include \x3cfiltering/bicubic.glsl\x3e\n#endif\n#ifdef BILINEAR\n#include \x3cfiltering/bilinear.glsl\x3e\n#endif\nvec2 getPixelLocation(vec2 coords) {\nvec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\ntargetLocation \x3d projectPixelLocation(targetLocation);\n#endif\nreturn targetLocation;\n}\nbool isOutside(vec2 coords){\nif (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\nreturn true;\n} else {\nreturn false;\n}\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\nvec4 color \x3d sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\nvec4 color \x3d texture2D(u_image, pixelLocation);\n#endif\nreturn color;\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\nvec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\nfloat maxI \x3d 255.0;\nfloat mid \x3d 128.0;\nfloat c \x3d u_contrastOffset;\nfloat b \x3d u_brightnessOffset;\nvec4 v;\nif (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n} else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n} else if (c \x3d\x3d 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\nv \x3d (sign(v) + 1.0) / 2.0;\n} else if (c \x3d\x3d -100.0) {\nv \x3d vec4(mid, mid, mid, currentPixel.a);\n}\nreturn vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\nvec2 index_image \x3d floor(coords * u_targetImageSize);\nvec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\nif (pos.s \x3c\x3d pos.t) {\nvec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\nreturn 0.0;\n}\nelse {\nreturn e;\n}\n}\nvec3 rgb2hsv(vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\nval \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb \x3d colorize(vec4(val, val, val, 1.0), 255.0);\nvec3 hsv \x3d rgb2hsv(rgb.xyz);\nhsv.z \x3d hillshade;\nreturn vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nif (currentPixel.a \x3d\x3d 0.0) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nvec2 onePixel \x3d 1.0 / u_srcImageSize;\nif (pixelLocation.s \x3c onePixel.s) {\naxy[0] \x3d 1.0;\ndxy[0] \x3d 1.0;\ngxy[0] \x3d 1.0;\n}\nif (pixelLocation.t \x3c onePixel.t) {\naxy[1] \x3d 1.0;\nbxy[1] \x3d 1.0;\ncxy[1] \x3d 1.0;\n}\nif (pixelLocation.s \x3e 1.0 - onePixel.s) {\ncxy[0] \x3d -1.0;\nfxy[0] \x3d -1.0;\nixy[0] \x3d -1.0;\n}\nif (pixelLocation.t \x3e 1.0 - onePixel.t) {\ngxy[1] \x3d -1.0;\nhxy[1] \x3d -1.0;\nixy[1] \x3d -1.0;\n}\nvec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\nvec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\nvec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\nvec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\nvec4 ve \x3d texture2D(u_image, pixelLocation);\nvec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\nvec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\nvec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\nvec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\nfloat dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\nfloat dzd \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\nfloat hillshade \x3d 0.0;\nif (u_hillshadeType \x3d\x3d 0){\nfloat cosDelta \x3d u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\nfloat z \x3d (u_cosZs[0] + cosDelta) / dzd;\nif (z \x3c 0.0)  z \x3d 0.0;\nhillshade \x3d z;\n} else {\nfor (int k \x3d 0; k \x3c 6; k++) {\nfloat cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\nfloat z \x3d (u_cosZs[k] + cosDelta) / dzd;\nif (z \x3c 0.0) z \x3d 0.0;\nhillshade \x3d hillshade + z * u_weights[k];\nif (k \x3d\x3d 5) break;\n}\n}\nfloat alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\ngl_FragColor \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\ngl_FragColor \x3d vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}",
"hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\nfloat clrIndex \x3d clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\nvec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\nvec4 color \x3d texture2D(u_colormap, clrPosition);\nvec4 result \x3d vec4(color.rgb, color.a * currentPixel.a);\nreturn result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nvec4 result \x3d colorize(currentPixel, 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * u_opacity;\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\nif (val \x3e\x3d maxCutOff) {\nreturn maxOutput;\n} else if (val \x3c\x3d minCutOff) {\nreturn minOutput;\n}\nfloat stretchedVal;\nif (useGamma) {\nfloat tempf \x3d 1.0;\nfloat outRange \x3d maxOutput - minOutput;\nfloat relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\nif (gamma \x3e 1.0) {\ntempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal \x3d (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n} else {\nstretchedVal \x3d minOutput + (val - minCutOff) * factor;\n}\nreturn stretchedVal;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\n#ifdef NOOP\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\nreturn;\n#endif\nif (u_bandCount \x3d\x3d 1) {\nfloat grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\nvec4 result \x3d colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\ngl_FragColor \x3d vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n} else {\nfloat redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\nfloat greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor \x3d vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n}\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\ngl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\ngl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},
tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\nlowp vec4 color \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\nmediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\nvec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\nv_tex \x3d a_pos;\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../webgl/Program ../../../../webgl/ProgramCache ../../../../webgl/Renderbuffer ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/programUtils ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g){return function(l){function n(){var t=l.apply(this,arguments)||this;t._color=F.fromValues(1,0,0,1);return t}x._inheritsLoose(n,l);var u=n.prototype;u.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&
(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};u.prepareState=function({context:t}){t.setBlendingEnabled(!0);t.setBlendFunctionSeparate(1,771,1,771);t.setColorMask(!0,!0,!0,!0);t.setStencilWriteMask(0);t.setStencilTestEnabled(!1)};u.draw=function(t,m){({context:t}=t);if(m.isReady){this._loadWGLResources(t);t.bindVAO(this._outlineVertexArrayObject);t.useProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs);
this._outlineProgram.setUniform2f("u_coord_range",m.coordRange[0],m.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);t.drawArrays(3,0,4);t.bindVAO();var w=this._getTexture(t,m);w&&(t.bindVAO(this._tileInfoVertexArrayObject),t.useProgram(this._tileInfoProgram),t.bindTexture(w,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",
m.coordRange[0]/m.size[0],m.coordRange[1]/m.size[1]),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",w.descriptor.width,w.descriptor.height),t.drawArrays(5,0,4),t.bindVAO())}};u._loadWGLResources=function(t){if(!this._outlineProgram||!this._tileInfoProgram){var m=f.createProgram(t,q.background),w=f.createProgram(t,g.tileInfo),v={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},C=new Int8Array([0,0,1,0,1,1,0,
1]);C=E.createVertex(t,35044,C);C=new e(t,q.background.attributes,v,{geometry:C});var A=new Int8Array([0,0,1,0,0,1,1,1]);A=E.createVertex(t,35044,A);t=new e(t,g.tileInfo.attributes,v,{geometry:A});this._outlineProgram=m;this._tileInfoProgram=w;this._outlineVertexArrayObject=C;this._tileInfoVertexArrayObject=t}};u._getTexture=function(t,m){if(m.texture&&m.triangleCountReportedInDebug===m.triangleCount)return m.texture;m.triangleCountReportedInDebug=m.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),
this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const w=m.triangleCount;let v=m.key.id;0<m.triangleCount&&(v+=`, ${w}`);const C=this._canvas,A=C.getContext("2d");A.font="24px sans-serif";A.textAlign="left";A.textBaseline="top";A.clearRect(0,0,300,32);1E5<w?(A.fillStyle="red",A.fillRect(0,0,300,32),A.fillStyle="black"):(A.clearRect(0,0,300,32),A.fillStyle="blue");A.fillText(v,
0,0);m.texture=new b(t,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071},C);return m.texture};return n}(r)})},"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["exports","./sources/resolver"],function(x,F){F={shaders:{vertexShader:F.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:F.resolveIncludes("tileInfo/tileInfo.frag")},attributes:new Map([["a_pos",0]])};x.tileInfo=F;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/vec4f32 ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../webgl/Program ../../../../webgl/ProgramCache ../../../../webgl/Renderbuffer ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/programUtils ./WGLBrush ../shaders/BackgroundPrograms".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q){return function(g){function l(){var u=g.apply(this,arguments)||this;u._color=F.fromValues(1,0,0,1);u._initialized=!1;return u}x._inheritsLoose(l,g);var n=l.prototype;n.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};n.prepareState=function({context:u},t){u.setDepthWriteEnabled(!1);u.setDepthTestEnabled(!1);u.setStencilTestEnabled(!0);
u.setBlendingEnabled(!1);u.setColorMask(!1,!1,!1,!1);u.setStencilOp(7680,7680,7681);u.setStencilWriteMask(255);u.setStencilFunctionSeparate(1032,516,t.stencilRef,255)};n.draw=function(u,t){({context:u}=u);this._initialized||this._initialize(u);u.bindVAO(this._solidVertexArrayObject);u.useProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",t.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",t.coordRange);this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",
this._color);u.drawArrays(5,0,4);u.bindVAO()};n._initialize=function(u){if(this._initialized)return!0;const t=f.createProgram(u,q.background);if(!t)return!1;var m=new Int8Array([0,0,1,0,0,1,1,1]);m=E.createVertex(u,35044,m);u=new e(u,q.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:m});this._solidProgram=t;this._solidVertexArrayObject=u;return this._initialized=!0};return l}(r)})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../chunks/mat3f32 ../../../../../chunks/vec4f32 ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../webgl/Program ../../../../webgl/ProgramCache ../../../../webgl/Renderbuffer ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../definitions ../enums ../number ./WGLBrush".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n,u,t){d=function(m){function w(){var C=m.apply(this,arguments)||this;C._color=h.fromValues(1,0,0,1);C._patternMatrix=k.create();C._programOptions={id:!1,pattern:!1};return C}F._inheritsLoose(w,m);var v=w.prototype;v.dispose=function(){this._vao&&(this._vao.dispose(),this._vao=null)};v.drawMany=function(C,A){const {context:y,painter:p,styleLayerUID:z}=C;this._loadWGLResources(C);const D=C.displayLevel;var G=C.styleLayer,I=G.backgroundMaterial;const K=p.vectorTilesMaterialManager;
var N=G.getPaintValue("background-color",D);const L=G.getPaintValue("background-opacity",D),M=G.getPaintValue("background-pattern",D),O=void 0!==M,H=N[3]*L,J=C.spriteMosaic;let P,Q;const U=(window.devicePixelRatio|1)>l.VTL_HIGH_RES_CUTOFF?2:1;C=C.drawPhase===n.WGLDrawPhase.HITTEST;const aa=this._programOptions;aa.id=C;aa.pattern=O;I=K.getMaterialProgram(y,I,aa);y.bindVAO(this._vao);y.useProgram(I);if(O){N=J.getMosaicItemPosition(M,!0);if(B.isSome(N)){const {tl:ba,br:ia,page:ha}=N;P=ia[0]-ba[0];Q=
ia[1]-ba[1];N=J.getPageSize(ha);B.isSome(N)&&(J.bind(y,9729,ha,l.VTL_TEXTURE_BINDING_UNIT_SPRITES),I.setUniform4f("u_tlbr",ba[0],ba[1],ia[0],ia[1]),I.setUniform2fv("u_mosaicSize",N),I.setUniform1i("u_texture",l.VTL_TEXTURE_BINDING_UNIT_SPRITES))}I.setUniform1f("u_opacity",L)}else this._color[0]=H*N[0],this._color[1]=H*N[1],this._color[2]=H*N[2],this._color[3]=H,I.setUniform4fv("u_color",this._color);I.setUniform1f("u_depth",G.z||0);C&&(G=u.u32to4Xu8(z+1),I.setUniform4fv("u_id",G));for(const ba of A)I.setUniform1f("u_coord_range",
ba.coordRange[0]),I.setUniformMatrix3fv("u_dvsMat3",ba.transforms.dvs),O&&(G=U*ba.size[0]*Math.max(2**(Math.round(D)-ba.key.level),1),A=G/E.nextPowerOfTwo(P),G/=E.nextPowerOfTwo(Q),this._patternMatrix[0]=A,this._patternMatrix[4]=G,I.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),y.setStencilFunction(514,ba.stencilRef,255),y.drawArrays(5,0,4)};v._loadWGLResources=function(C){if(!this._vao){var {context:A,styleLayer:y}=C;C=y.backgroundMaterial;var p=new Int8Array([0,0,1,0,0,1,1,1]);p=
a.createVertex(A,35044,p);this._vao=new g(A,C.getAttributeLocations(),C.getLayoutInfo(),{geometry:p})}};return w}(t);x.WGLBrushVTLBackground=d;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../number ./WGLBrush".split(" "),function(x,F,E,B,k,h){h=function(a){function d(){var b=a.apply(this,arguments)||this;b._programOptions={id:!1};
return b}F._inheritsLoose(d,a);var c=d.prototype;c.dispose=function(){};c.drawMany=function(b,e){const {context:f,displayLevel:r,requiredLevel:q,state:g,drawPhase:l,painter:n,spriteMosaic:u,styleLayerUID:t}=b;if(e.some(p=>{var z,D;return null!=(z=null==(D=p.layerData.get(t))?void 0:D.circleIndexCount)?z:!1})){b=b.styleLayer;var m=b.circleMaterial,w=n.vectorTilesMaterialManager,v=b.getPaintValue("circle-translate",r),C=b.getPaintValue("circle-translate-anchor",r),A=l===B.WGLDrawPhase.HITTEST,y=this._programOptions;
y.id=A;w=w.getMaterialProgram(f,m,y);f.useProgram(w);w.setUniformMatrix3fv("u_displayMat3",1===C?g.displayMat3:g.displayViewMat3);w.setUniform2fv("u_circleTranslation",v);w.setUniform1f("u_depth",b.z);w.setUniform1f("u_antialiasingWidth",1.2);v=-1;A&&(A=k.u32to4Xu8(t+1),w.setUniform4fv("u_id",A));for(const p of e)p.layerData.has(t)&&(p.key.level!==v&&(v=p.key.level,m.setDataUniforms(w,r,b,v,u)),e=p.layerData.get(t),e.circleIndexCount&&(e.prepareForRendering(f),A=e.circleVertexArrayObject,E.isNone(A)||
(f.bindVAO(A),w.setUniformMatrix3fv("u_dvsMat3",p.transforms.dvs),q!==p.key.level?f.setStencilFunction(514,p.stencilRef,255):f.setStencilFunction(516,255,255),f.drawElements(4,e.circleIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*e.circleIndexStart),p.triangleCount+=e.circleIndexCount/3)))}};return d}(h);x.WGLBrushVTLCircle=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../enums ../number ./WGLBrush".split(" "),
function(x,F,E,B,k,h,a){const d=1/65536;a=function(c){function b(){var f=c.apply(this,arguments)||this;f._fillProgramOptions={id:!1,pattern:!1};f._outlineProgramOptions={id:!1};return f}F._inheritsLoose(b,c);var e=b.prototype;e.dispose=function(){};e.drawMany=function(f,r){const {displayLevel:q,drawPhase:g,renderPass:l,spriteMosaic:n,styleLayerUID:u}=f;var t=!1;for(var m of r)if(m.layerData.has(u)){var w=m.layerData.get(u);if(0<w.fillIndexCount||0<w.outlineIndexCount){t=!0;break}}if(t){t=f.styleLayer;
var v=t.getPaintProperty("fill-pattern");w=(m=void 0!==v)&&v.isDataDriven;if(m&&!w){var C=v.getValue(q);C=n.getMosaicItemPosition(C,!0)}v=!m&&t.getPaintValue("fill-antialias",q);var A=!0,y=1;if(!m){var p=t.getPaintProperty("fill-color"),z=t.getPaintProperty("fill-opacity");null!=p&&p.isDataDriven||null!=z&&z.isDataDriven||(y=t.getPaintValue("fill-color",q),y=t.getPaintValue("fill-opacity",q)*y[3],1<=y&&(A=!1))}if(!A||"opaque"!==l){var D;g===k.WGLDrawPhase.HITTEST&&(D=h.u32to4Xu8(u+1));p=t.getPaintValue("fill-translate",
q);z=t.getPaintValue("fill-translate-anchor",q);(A||"translucent"!==l)&&this._drawFill(f,u,t,r,p,z,m,C,w,D);C=!t.hasDataDrivenOutlineColor&&t.outlineUsesFillColor&&1>y;v&&"opaque"!==l&&!C&&this._drawOutline(f,u,t,r,p,z,D)}}};e._drawFill=function(f,r,q,g,l,n,u,t,m,w){if(!u||!E.isNone(t)){var {context:v,displayLevel:C,state:A,drawPhase:y,painter:p,pixelRatio:z,spriteMosaic:D}=f;f=q.fillMaterial;var G=p.vectorTilesMaterialManager,I=z>B.VTL_HIGH_RES_CUTOFF?2:1,K=y===k.WGLDrawPhase.HITTEST,N=this._fillProgramOptions;
N.id=K;N.pattern=u;G=G.getMaterialProgram(v,f,N);v.useProgram(G);E.isSome(t)&&({page:t}=t,N=D.getPageSize(t),E.isSome(N)&&(D.bind(v,9729,t,B.VTL_TEXTURE_BINDING_UNIT_SPRITES),G.setUniform2fv("u_mosaicSize",N),G.setUniform1i("u_texture",B.VTL_TEXTURE_BINDING_UNIT_SPRITES)));G.setUniformMatrix3fv("u_displayMat3",1===n?A.displayMat3:A.displayViewMat3);G.setUniform2fv("u_fillTranslation",l);G.setUniform1f("u_depth",q.z+d);K&&G.setUniform4fv("u_id",w);l=-1;for(const L of g)if(L.layerData.has(r)&&(L.key.level!==
l&&(l=L.key.level,f.setDataUniforms(G,C,q,l,D)),g=L.layerData.get(r),g.fillIndexCount&&(g.prepareForRendering(v),n=g.fillVertexArrayObject,!E.isNone(n)))){v.bindVAO(n);G.setUniformMatrix3fv("u_dvsMat3",L.transforms.dvs);v.setStencilFunction(514,L.stencilRef,255);u&&G.setUniform1f("u_patternFactor",L.coordRange[0]/(I*L.size[0]*Math.max(2**(Math.round(C)-L.key.level),1)));if(m){n=g.patternMap;if(!n)continue;for(const [M,O]of n)n=D.getPageSize(M),E.isSome(n)&&(D.bind(v,9729,M,B.VTL_TEXTURE_BINDING_UNIT_SPRITES),
G.setUniform2fv("u_mosaicSize",n),G.setUniform1i("u_texture",B.VTL_TEXTURE_BINDING_UNIT_SPRITES),v.drawElements(4,O[1],5125,Uint32Array.BYTES_PER_ELEMENT*O[0]))}else v.drawElements(4,g.fillIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*g.fillIndexStart);L.triangleCount+=g.fillIndexCount/3}}};e._drawOutline=function(f,r,q,g,l,n,u){const {context:t,displayLevel:m,state:w,drawPhase:v,painter:C,pixelRatio:A,spriteMosaic:y}=f;f=q.outlineMaterial;var p=C.vectorTilesMaterialManager;const z=.75/A,D=v===k.WGLDrawPhase.HITTEST,
G=this._outlineProgramOptions;G.id=D;p=p.getMaterialProgram(t,f,G);t.useProgram(p);p.setUniformMatrix3fv("u_displayMat3",1===n?w.displayMat3:w.displayViewMat3);p.setUniform2fv("u_fillTranslation",l);p.setUniform1f("u_depth",q.z+d);p.setUniform1f("u_outline_width",z);D&&p.setUniform4fv("u_id",u);l=-1;for(const I of g)I.layerData.has(r)&&(I.key.level!==l&&(l=I.key.level,f.setDataUniforms(p,m,q,l,y)),g=I.layerData.get(r),g.prepareForRendering(t),g.outlineIndexCount&&(n=g.outlineVertexArrayObject,E.isNone(n)||
(t.bindVAO(n),p.setUniformMatrix3fv("u_dvsMat3",I.transforms.dvs),t.setStencilFunction(514,I.stencilRef,255),t.drawElements(4,g.outlineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*g.outlineIndexStart),I.triangleCount+=g.outlineIndexCount/3)))};return b}(a);x.WGLBrushVTLFill=a;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../enums ../number ./WGLBrush".split(" "),
function(x,F,E,B,k,h,a){a=function(d){function c(){var e=d.apply(this,arguments)||this;e._programOptions={id:!1,pattern:!1,sdf:!1};return e}F._inheritsLoose(c,d);var b=c.prototype;b.dispose=function(){};b.drawMany=function(e,f){const {context:r,displayLevel:q,state:g,drawPhase:l,painter:n,pixelRatio:u,spriteMosaic:t,styleLayerUID:m}=e;if(f.some(L=>{var M,O;return null!=(M=null==(O=L.layerData.get(m))?void 0:O.lineIndexCount)?M:!1})){e=e.styleLayer;var w=e.lineMaterial,v=n.vectorTilesMaterialManager,
C=e.getPaintValue("line-translate",q),A=e.getPaintValue("line-translate-anchor",q),y=e.getPaintProperty("line-pattern"),p=void 0!==y,z=p&&y.isDataDriven;if(p&&!z){y=y.getValue(q);var D=t.getMosaicItemPosition(y)}var G;y=!1;if(!p){var I=e.getPaintProperty("line-dasharray");y=(G=void 0!==I)&&I.isDataDriven;G&&!y&&(D=I.getValue(q),D=e.getDashKey(D,e.getLayoutValue("line-cap",q)),D=t.getMosaicItemPosition(D))}I=1/u;var K=l===k.WGLDrawPhase.HITTEST,N=this._programOptions;N.id=K;N.pattern=p;N.sdf=G;G=v.getMaterialProgram(r,
w,N);r.useProgram(G);G.setUniformMatrix3fv("u_displayViewMat3",g.displayViewMat3);G.setUniformMatrix3fv("u_displayMat3",1===A?g.displayMat3:g.displayViewMat3);G.setUniform2fv("u_lineTranslation",C);G.setUniform1f("u_depth",e.z);G.setUniform1f("u_antialiasing",I);K&&(C=h.u32to4Xu8(m+1),G.setUniform4fv("u_id",C));D&&E.isSome(D)&&({page:C}=D,A=t.getPageSize(C),E.isSome(A)&&(t.bind(r,9729,C,B.VTL_TEXTURE_BINDING_UNIT_SPRITES),G.setUniform2fv("u_mosaicSize",A),G.setUniform1i("u_texture",B.VTL_TEXTURE_BINDING_UNIT_SPRITES)));
C=-1;for(const L of f)if(L.layerData.has(m)&&(L.key.level!==C&&(C=L.key.level,w.setDataUniforms(G,q,e,C,t)),G.setUniform1f("u_zoomFactor",2**(q-C)/u),f=L.layerData.get(m),f.lineIndexCount&&(f.prepareForRendering(r),A=f.lineVertexArrayObject,!E.isNone(A)))){r.bindVAO(A);G.setUniformMatrix3fv("u_dvsMat3",L.transforms.dvs);r.setStencilFunction(514,L.stencilRef,255);if(z||y){A=f.patternMap;if(!A)continue;for(const [M,O]of A)A=t.getPageSize(M),E.isSome(A)&&(t.bind(r,9729,M,B.VTL_TEXTURE_BINDING_UNIT_SPRITES),
G.setUniform2fv("u_mosaicSize",A),G.setUniform1i("u_texture",B.VTL_TEXTURE_BINDING_UNIT_SPRITES),r.drawElements(4,O[1],5125,Uint32Array.BYTES_PER_ELEMENT*O[0]))}else r.drawElements(4,f.lineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*f.lineIndexStart);L.triangleCount+=f.lineIndexCount/3}}};return c}(a);x.WGLBrushVTLLine=a;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec2f32 ../../vectorTiles/decluttering/config ../definitions ../enums ../GeometryUtils ../number ./WGLBrush".split(" "),
function(x,F,E,B,k,h,a,d,c,b){const e=1/65536;b=function(f){function r(){var g=f.apply(this,arguments)||this;g._iconProgramOptions={id:!1,sdf:!1};g._sdfProgramOptions={id:!1};g._spritesTextureSize=B.create();return g}F._inheritsLoose(r,f);var q=r.prototype;q.dispose=function(){};q.drawMany=function(g,l){const {drawPhase:n,styleLayerUID:u}=g,t=g.styleLayer;let m;n===a.WGLDrawPhase.HITTEST&&(m=c.u32to4Xu8(u+1));this._drawIcons(g,t,l,m);this._drawText(g,t,l,m)};q._drawIcons=function(g,l,n,u){const {context:t,
displayLevel:m,drawPhase:w,painter:v,spriteMosaic:C,state:A,styleLayerUID:y}=g,p=l.iconMaterial;var z=v.vectorTilesMaterialManager,D=!1;for(var G of n)if(G.layerData.has(y)){var I=G.layerData.get(y);if(0<I.iconPerPageElementsMap.size){D=!0;break}}if(D){D=l.getPaintValue("icon-translate",m);G=l.getPaintValue("icon-translate-anchor",m);var K=l.getLayoutValue("icon-rotation-alignment",m);2===K&&(K=0===l.getLayoutValue("symbol-placement",m)?1:0);var N=0===K;N=l.getLayoutValue("icon-keep-upright",m)&&
N;var L=I.isIconSDF;I=w===a.WGLDrawPhase.HITTEST;var M=this._iconProgramOptions;M.id=I;M.sdf=L;z=z.getMaterialProgram(t,p,M);t.useProgram(z);z.setUniformMatrix3fv("u_displayViewMat3",0===K?A.displayViewMat3:A.displayMat3);z.setUniformMatrix3fv("u_displayMat3",1===G?A.displayMat3:A.displayViewMat3);z.setUniform2fv("u_iconTranslation",D);z.setUniform1f("u_depth",l.z);z.setUniform1f("u_mapRotation",d.degToByte(A.rotation));z.setUniform1f("u_keepUpright",N?1:0);z.setUniform1f("u_level",10*m);z.setUniform1i("u_texture",
h.VTL_TEXTURE_BINDING_UNIT_SPRITES);z.setUniform1f("u_fadeDuration",k.FADE_DURATION/1E3);I&&z.setUniform4fv("u_id",u);u=-1;for(const O of n)if(O.layerData.has(y)&&(O.key.level!==u&&(u=O.key.level,p.setDataUniforms(z,m,l,u,C)),I=O.layerData.get(y),0!==I.iconPerPageElementsMap.size&&(I.prepareForRendering(t),I.updateOpacityInfo(),n=I.iconVertexArrayObject,!E.isNone(n)))){t.bindVAO(n);z.setUniformMatrix3fv("u_dvsMat3",O.transforms.dvs);z.setUniform1f("u_time",(performance.now()-I.lastOpacityUpdate)/
1E3);for(const [H,J]of I.iconPerPageElementsMap)this._renderIconRange(g,z,J,H,O)}}};q._renderIconRange=function(g,l,n,u,t){const {context:m,spriteMosaic:w}=g;this._spritesTextureSize[0]=w.getWidth(u)/4;this._spritesTextureSize[1]=w.getHeight(u)/4;l.setUniform2fv("u_mosaicSize",this._spritesTextureSize);w.bind(m,9729,u,h.VTL_TEXTURE_BINDING_UNIT_SPRITES);m.setStencilTestEnabled(!0);m.setStencilFunction(516,255,255);m.setStencilWriteMask(0);m.drawElements(4,n[1],5125,Uint32Array.BYTES_PER_ELEMENT*n[0]);
t.triangleCount+=n[1]/3};q._drawText=function(g,l,n,u){const {context:t,displayLevel:m,drawPhase:w,glyphMosaic:v,painter:C,pixelRatio:A,spriteMosaic:y,state:p,styleLayerUID:z}=g;g=l.textMaterial;const D=C.vectorTilesMaterialManager;var G=!1;for(var I of n)if(I.layerData.has(z)){var K=I.layerData.get(z);if(0<K.glyphPerPageElementsMap.size){G=!0;break}}if(G&&(K=l.getPaintProperty("text-opacity"),!K||K.isDataDriven||0!==K.getValue(m))){K=l.getPaintProperty("text-color");var N=!K||K.isDataDriven||0<K.getValue(m)[3];
K=l.getPaintProperty("text-halo-width");I=l.getPaintProperty("text-halo-color");var L=(!K||K.isDataDriven||0<K.getValue(m))&&(!I||I.isDataDriven||0<I.getValue(m)[3]);if(N||L){K=l.getLayoutValue("text-rotation-alignment",m);2===K&&(K=0===l.getLayoutValue("symbol-placement",m)?1:0);I=0===K;I=l.getLayoutValue("text-keep-upright",m)&&I;G=w===a.WGLDrawPhase.HITTEST;var M=.8*3/A;this._glyphTextureSize||(this._glyphTextureSize=B.fromValues(v.width/4,v.height/4));var O=l.getPaintValue("text-translate",m),
H=l.getPaintValue("text-translate-anchor",m),J=this._sdfProgramOptions;J.id=G;var P=D.getMaterialProgram(t,g,J);t.useProgram(P);P.setUniformMatrix3fv("u_displayViewMat3",0===K?p.displayViewMat3:p.displayMat3);P.setUniformMatrix3fv("u_displayMat3",1===H?p.displayMat3:p.displayViewMat3);P.setUniform2fv("u_textTranslation",O);P.setUniform1f("u_depth",l.z+e);P.setUniform2fv("u_mosaicSize",this._glyphTextureSize);P.setUniform1f("u_mapRotation",d.degToByte(p.rotation));P.setUniform1f("u_keepUpright",I?
1:0);P.setUniform1f("u_level",10*m);P.setUniform1i("u_texture",h.VTL_TEXTURE_BINDING_UNIT_GLYPHS);P.setUniform1f("u_antialiasingWidth",M);P.setUniform1f("u_fadeDuration",k.FADE_DURATION/1E3);G&&P.setUniform4fv("u_id",u);u=-1;for(const Q of n)Q.layerData.has(z)&&(Q.key.level!==u&&(u=Q.key.level,g.setDataUniforms(P,m,l,u,y)),K=Q.layerData.get(z),0!==K.glyphPerPageElementsMap.size&&(K.prepareForRendering(t),K.updateOpacityInfo(),n=K.textVertexArrayObject,E.isNone(n)||(t.bindVAO(n),P.setUniformMatrix3fv("u_dvsMat3",
Q.transforms.dvs),t.setStencilTestEnabled(!0),t.setStencilFunction(516,255,255),t.setStencilWriteMask(0),n=(performance.now()-K.lastOpacityUpdate)/1E3,P.setUniform1f("u_time",n),K.glyphPerPageElementsMap.forEach((U,aa)=>{this._renderGlyphRange(t,U,aa,v,P,L,N,Q)}))))}}};q._renderGlyphRange=function(g,l,n,u,t,m,w,v){u.bind(g,9729,n,h.VTL_TEXTURE_BINDING_UNIT_GLYPHS);m&&(t.setUniform1f("u_halo",1),g.drawElements(4,l[1],5125,Uint32Array.BYTES_PER_ELEMENT*l[0]),v.triangleCount+=l[1]/3);w&&(t.setUniform1f("u_halo",
0),g.drawElements(4,l[1],5125,Uint32Array.BYTES_PER_ELEMENT*l[0]),v.triangleCount+=l[1]/3)};return r}(b);x.WGLBrushVTLSymbol=b;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/config":function(){define(["exports"],function(x){x.COLLISION_GRID_CELL_SIZE=32;x.DECLUTTER_BUDGET=1.5;x.DECLUTTER_TILES=!0;x.FADE_DURATION=200;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["exports"],function(x){function F(d,
c){d%=c;return 0<=d?d:d+c}const E=Number.POSITIVE_INFINITY,B=Math.PI,k=128/B,h=256/360,a=1/Math.LN2;x.C_256_TO_RAD=B/128;x.C_2PI=2*B;x.C_DEG_TO_256=h;x.C_DEG_TO_RAD=B/180;x.C_INFINITY=E;x.C_PI=B;x.C_PI_BY_2=B/2;x.C_RAD_TO_256=k;x.C_SQRT2=1.414213562;x.C_SQRT2_INV=1/1.414213562;x.between=function(d,c,b){return d>=c&&d<=b||d>=b&&d<=c};x.degToByte=function(d){return F(d*h,256)};x.interpolate=function(d,c,b){return d*(1-b)+c*b};x.log2=function(d){return Math.log(d)*a};x.positiveMod=F;x.radToByte=function(d){return F(d*
k,256)};x.sqr=function(d){return d*d};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/RandomLCG ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../webgl/Program ../../../../webgl/ProgramCache ../../../../webgl/Renderbuffer ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l){return function(n){function u(){var m=n.apply(this,arguments)||this;m._dotTextureSize=0;m._dotTextures=null;m._dotSamplers=new Int32Array([f.TEXTURE_BINDING_RENDERER_0,f.TEXTURE_BINDING_RENDERER_1]);return m}x._inheritsLoose(u,n);var t=u.prototype;t.dispose=function(){this._disposeTextures()};t.getGeometryType=function(){return r.WGLGeometryType.FILL};t.drawGeometry=function(m,w,v,C){const {context:A,painter:y,rendererInfo:p,requiredLevel:z}=m;var D=l.FillMaterialKey.load(v.materialKey);
const {bufferLayouts:G,attributes:I}=q.createProgramDescriptor(D.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},...D.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,type:5121},{location:7,name:"a_zoomRange",count:2,type:5123}],...D.dotDensity?[{location:2,
name:"a_inverseArea",count:1,type:5126}]:[]]});C=y.materialManager.getMaterialProgram(m,D,"materials/fill",I,C);A.useProgram(C);this._setSharedUniforms(C,m,w);D.textureBinding&&(y.textureManager.bindTextures(A,C,D),C.setUniform1f("u_zoomFactor",1/2**(z-w.key.level)/m.pixelRatio));D.vvColor&&(C.setUniform1fv("u_vvColorValues",p.vvColorValues),C.setUniform4fv("u_vvColors",p.vvColors));D.vvOpacity&&(C.setUniform1fv("u_vvOpacityValues",p.vvOpacityValues),C.setUniform1fv("u_vvOpacities",p.vvOpacities));
if(D.dotDensity){D=f.TILE_SIZE/p.ddDotSize;const K=D*window.devicePixelRatio*D*window.devicePixelRatio;w=1/2**(z-w.key.level);const N=1/w*(1/w);m=p.ddDotScale?m.state.scale/p.ddDotScale:1;C.setUniform1f("u_tileZoomFactor",w);C.setUniform1f("u_tileDotsOverArea",K/(f.TILE_SIZE*window.devicePixelRatio*f.TILE_SIZE*window.devicePixelRatio));C.setUniformMatrix4fv("u_dotColors",p.ddColors);C.setUniform4fv("u_isActive",p.ddActiveDots);C.setUniform4fv("u_dotBackgroundColor",p.ddBackgroundColor);C.setUniform1f("u_dotValue",
Math.max(1,p.ddDotValue*m*N));this._bindDotDensityTextures(A,C,p,D)}v.draw(A,G,I)};t._disposeTextures=function(){if(this._dotTextures){for(let m=0;m<this._dotTextures.length;m++)this._dotTextures[m].dispose();this._dotTextures=null}};t._bindDotDensityTextures=function(m,w,v,C){v=this._createDotDensityTextures(m,C,v.ddSeed);w.setUniform1iv("u_dotTextures",this._dotSamplers);for(w=0;w<v.length;w++)m.bindTexture(v[w],this._dotSamplers[w])};t._createDotDensityTextures=function(m,w,v){if(this._dotTextureSize!==
w||this._seed!==v)this._disposeTextures(),this._dotTextureSize=w,this._seed=v;null===this._dotTextures&&(v=new F(v),this._dotTextures=[this._allocDotDensityTexture(m,w,v),this._allocDotDensityTexture(m,w,v)]);return this._dotTextures};t._allocDotDensityTexture=function(m,w,v){const C=new Float32Array(w*w*4);for(let A=0;A<C.length;A++)C[A]=v.getFloat();return new b(m,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:w,height:w},C)};return u}(g)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/maybe","../definitions","./WGLBrush"],function(x,F,E,B){return function(k){function h(){return k.apply(this,arguments)||this}x._inheritsLoose(h,k);var a=h.prototype;a.prepareState=function({context:d},c,b){b=b&&-1!==b.indexOf("id");d.setBlendingEnabled(!b);d.setBlendFunctionSeparate(1,771,1,771);d.setColorMask(!0,!0,!0,!0);d.setStencilWriteMask(0);d.setStencilTestEnabled(!0);d.setStencilFunction(514,c.stencilRef,255)};a.draw=function(d,c,b){var e=this.getGeometryType();c.commit(d);
e=c.getGeometry(e);F.isNone(e)||(d.timeline.begin(this.name),d.attributeView.bindTextures(d.context),e.forEachCommand(f=>this.drawGeometry(d,c,f,b)))};a._setSharedUniforms=function(d,c,b){const {displayLevel:e,pixelRatio:f,state:r}=c;d.setUniform1f("u_pixelRatio",f);d.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);d.setUniformMatrix3fv("u_displayViewMat3",r.displayViewMat3);d.setUniform1f("u_currentZoom",Math.round(e*E.MIN_MAX_ZOOM_PRECISION_FACTOR));d.setUniform1i("u_attributeTextureSize",c.attributeView.size);
d.setUniform1i("u_attributeData0",E.TEXTURE_BINDING_ATTRIBUTE_DATA_0);d.setUniform1i("u_attributeData1",E.TEXTURE_BINDING_ATTRIBUTE_DATA_1);d.setUniform1i("u_attributeData2",E.TEXTURE_BINDING_ATTRIBUTE_DATA_2);d.setUniform1i("u_attributeData3",E.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};return h}(B)})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../enums","../mesh/templates/meshUtils"],function(x,
F,E,B,k){function h(u,t=!1){const m=B.WGLVVFlag.SIZE_FIELD_STOPS|B.WGLVVFlag.SIZE_MINMAX_VALUE|B.WGLVVFlag.SIZE_SCALE_STOPS|B.WGLVVFlag.SIZE_UNIT_VALUE;u=(u&(B.WGLVVTarget.FIELD_TARGETS_OUTLINE|B.WGLVVTarget.MINMAX_TARGETS_OUTLINE|B.WGLVVTarget.SCALE_TARGETS_OUTLINE|B.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return t?m&u:m&~u}function a(u){const t=h(u,!1);return u&(B.WGLVVFlag.COLOR|B.WGLVVFlag.OPACITY|B.WGLVVFlag.ROTATION|t)}let d=function(){function u(m){this._data=0;this._data=m}u.load=function(m){const w=
this.shared;w.data=m;return w};var t=u.prototype;t.setBit=function(m,w){m=1<<m;this._data=w?this._data|m:this._data&~m};t.bit=function(m){return(this._data&1<<m)>>m};t.setBits=function(m,w,v){for(let C=w,A=0;C<v;C++,A++)this.setBit(C,0!==(m&1<<A))};t.bits=function(m,w){let v=0;for(let C=m,A=0;C<w;C++,A++)v|=this.bit(C)<<A;return v};t.hasVV=function(){return!1};t.setVV=function(m,w){};t.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}};t.getVariationHash=
function(){return this._data&~(7&this.textureBinding)};F._createClass(u,[{key:"data",get:function(){return this._data},set:function(m){this._data=m}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(m){this.setBits(m,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(m){this.setBit(20,m)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(m){this.setBit(11,m)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(m){this.setBit(12,
m)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(m){this.setBits(m,0,8)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case B.WGLGeometryType.FILL:return"fill";case B.WGLGeometryType.MARKER:return"marker";case B.WGLGeometryType.LINE:return"line";case B.WGLGeometryType.TEXT:return"text";case B.WGLGeometryType.LABEL:return"label";default:throw new E(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return u}();d.shared=new d(0);const c=
u=>function(t){function m(){return t.apply(this,arguments)||this}F._inheritsLoose(m,t);var w=m.prototype;w.hasVV=function(){return t.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};w.setVV=function(v,C){t.prototype.setVV.call(this,v,C);v&=h(v,C);this.vvSizeMinMaxValue=!!(v&B.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(v&B.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(v&B.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=
!!(v&B.WGLVVFlag.SIZE_SCALE_STOPS)};F._createClass(m,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(v){this.setBit(16,v)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(v){this.setBit(17,v)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(v){this.setBit(18,v)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(v){this.setBit(19,v)}}]);return m}(u),b=u=>function(t){function m(){return t.apply(this,
arguments)||this}F._inheritsLoose(m,t);var w=m.prototype;w.hasVV=function(){return t.prototype.hasVV.call(this)||this.vvRotation};w.setVV=function(v,C){t.prototype.setVV.call(this,v,C);this.vvRotation=!C&&!!(v&B.WGLVVFlag.ROTATION)};F._createClass(m,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(v){this.setBit(15,v)}}]);return m}(u),e=u=>function(t){function m(){return t.apply(this,arguments)||this}F._inheritsLoose(m,t);var w=m.prototype;w.hasVV=function(){return t.prototype.hasVV.call(this)||
this.vvColor};w.setVV=function(v,C){t.prototype.setVV.call(this,v,C);this.vvColor=!C&&!!(v&B.WGLVVFlag.COLOR)};F._createClass(m,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(v){this.setBit(13,v)}}]);return m}(u),f=u=>function(t){function m(){return t.apply(this,arguments)||this}F._inheritsLoose(m,t);var w=m.prototype;w.hasVV=function(){return t.prototype.hasVV.call(this)||this.vvOpacity};w.setVV=function(v,C){t.prototype.setVV.call(this,v,C);this.vvOpacity=!C&&!!(v&B.WGLVVFlag.OPACITY)};
F._createClass(m,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(v){this.setBit(14,v)}}]);return m}(u);let r=function(u){function t(){return u.apply(this,arguments)||this}F._inheritsLoose(t,u);t.load=function(m){const w=this.shared;w.data=m;return w};t.from=function(m,w){const v=this.load(0);v.geometryType=B.WGLGeometryType.FILL;w?v.dotDensity=!0:v.setVV(m,!1);return v.data};t.prototype.getVariation=function(){return{...u.prototype.getVariation.call(this),dotDensity:this.dotDensity,
vvColor:this.vvColor,vvOpacity:this.vvOpacity}};F._createClass(t,[{key:"dotDensity",get:function(){return!!this.bit(15)},set:function(m){this.setBit(15,m)}}]);return t}(e(f(d)));r.shared=new r(0);let q=function(u){function t(){return u.apply(this,arguments)||this}F._inheritsLoose(t,u);t.load=function(m){const w=this.shared;w.data=m;return w};t.from=function(m){const w=this.load(0);w.geometryType=B.WGLGeometryType.MARKER;w.setVV(m,!1);return w.data};t.prototype.getVariation=function(){return{...u.prototype.getVariation.call(this),
vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return t}(e(f(b(c(d)))));q.shared=new q(0);let g=function(u){function t(){return u.apply(this,arguments)||this}F._inheritsLoose(t,u);t.load=function(m){const w=this.shared;w.data=m;return w};t.from=function(m,w){const v=this.load(0);v.geometryType=B.WGLGeometryType.LINE;
v.setVV(m,w);return v.data};t.prototype.getVariation=function(){return{...u.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return t}(e(f(c(d))));g.shared=new g(0);let l=function(u){function t(){return u.apply(this,arguments)||this}F._inheritsLoose(t,u);t.load=function(m){const w=this.shared;w.data=m;return w};
t.from=function(m){const w=this.load(m);w.geometryType=B.WGLGeometryType.TEXT;w.setVV(m,!1);return w.data};t.prototype.getVariation=function(){return{...u.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return t}(e(f(b(c(d)))));l.shared=new l(0);let n=function(u){function t(){return u.apply(this,
arguments)||this}F._inheritsLoose(t,u);t.load=function(m){const w=this.shared;w.data=m;return w};t.from=function(m,w){const v=this.load(0);v.geometryType=B.WGLGeometryType.LABEL;v.setVV(m,!1);v.mapAligned=k.isMapAligned(w);return v.data};t.prototype.getVariation=function(){return{...u.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return t}(c(d));n.shared=
new n(0);x.FillMaterialKey=r;x.LabelMaterialKey=n;x.LineMaterialKey=g;x.MarkerMaterialKey=q;x.MaterialKeyBase=d;x.TextMaterialKey=l;x.createMaterialKey=function(u,t,m,w,v){switch(u){case B.WGLGeometryType.FILL:return r.from(t,w);case B.WGLGeometryType.LINE:return g.from(t,m);case B.WGLGeometryType.MARKER:return q.from(t);case B.WGLGeometryType.TEXT:return l.from(t);case B.WGLGeometryType.LABEL:return n.from(t,v);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${u}`);}};x.getFillVVFlags=
function(u){return u&(B.WGLVVFlag.COLOR|B.WGLVVFlag.OPACITY)};x.getLabelVVFlags=function(u){const t=h(u,!1);return u&t};x.getLineVVFlags=function(u,t){if(t)return t=h(u,!0),u&t;t=h(u,!1);return u&(B.WGLVVFlag.COLOR|B.WGLVVFlag.OPACITY|t)};x.getMarkerVVFlags=a;x.getSizeFlagsMask=h;x.getTextVVFlags=function(u){return a(u)};x.hydrateMaterialKey=function(u){switch(d.load(u).geometryType){case B.WGLGeometryType.MARKER:return new q(u);case B.WGLGeometryType.FILL:return new r(u);case B.WGLGeometryType.LINE:return new g(u);
case B.WGLGeometryType.TEXT:return new l(u);case B.WGLGeometryType.LABEL:return new n(u)}};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/meshUtils":function(){define(["exports"],function(x){x.isMapAligned=function(F){switch(F){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;default:return!1}};Object.defineProperty(x,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","../Utils","./WGLGeometryBrush","../materialKey/MaterialKey"],function(x,F,E,B,k){return function(h){function a(){return h.apply(this,arguments)||this}x._inheritsLoose(a,h);var d=a.prototype;d.dispose=function(){};d.getGeometryType=function(){return F.WGLGeometryType.LABEL};d.drawGeometry=function(c,b,e,f){const {context:r,painter:q,
state:g,rendererInfo:l}=c,n=k.LabelMaterialKey.load(e.materialKey),u=n.mapAligned?1:0;if(u||!(1<=Math.abs(b.key.level-Math.round(100*c.displayLevel)/100))){var {bufferLayouts:t,attributes:m}=E.createProgramDescriptor(n.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,
name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_glyphData",count:4,type:5121},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,name:"a_texCoords",count:2,type:5123}]});f=q.materialManager.getMaterialProgram(c,n,"materials/label",m,f);c.context.setStencilFunction(514,0,255);r.useProgram(f);this._setSharedUniforms(f,c,b);q.textureManager.bindTextures(r,f,n);var w=1===u?g.displayViewMat3:g.displayMat3;n.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",
l.vvSizeMinMaxValue);n.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",l.vvSizeScaleStopsValue);n.vvSizeFieldStops&&(b=l.getSizeVVFieldStops(b.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",b.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",b.sizes));n.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",l.vvSizeUnitValueToPixelsRatio);f.setUniform1f("u_mapRotation",Math.floor(g.rotation/360*254));f.setUniform1f("u_mapAligned",u);f.setUniformMatrix3fv("u_displayMat3",
w);f.setUniform1f("u_opacity",1);f.setUniform2fv("u_screenSize",c.state.size);f.setUniform1f("u_isHalo",1);e.draw(r,t,m);f.setUniform1f("u_isHalo",0);e.draw(r,t,m);r.setStencilTestEnabled(!0);r.setBlendingEnabled(!0)}};return a}(B)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","../Utils","./WGLGeometryBrush","../materialKey/MaterialKey"],function(x,F,E,B,k){return function(h){function a(){return h.apply(this,
arguments)||this}x._inheritsLoose(a,h);var d=a.prototype;d.dispose=function(){};d.getGeometryType=function(){return F.WGLGeometryType.LINE};d.drawGeometry=function(c,b,e,f){const {context:r,painter:q,rendererInfo:g,displayLevel:l}=c,n=k.LineMaterialKey.load(e.materialKey),{bufferLayouts:u,attributes:t}=E.createProgramDescriptor(n.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,
name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123},{location:8,name:"a_zoomRange",count:2,type:5123}]});f=q.materialManager.getMaterialProgram(c,n,"materials/line",t,f);const m=1/c.pixelRatio;r.useProgram(f);this._setSharedUniforms(f,c,b);n.textureBinding&&q.textureManager.bindTextures(r,f,
n);f.setUniform1f("u_zoomFactor",2**(l-b.key.level)/c.pixelRatio);f.setUniform1f("u_blur",0+m);f.setUniform1f("u_antialiasing",m);n.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",g.vvSizeMinMaxValue);n.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",g.vvSizeScaleStopsValue);n.vvSizeFieldStops&&(c=g.getSizeVVFieldStops(b.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",c.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",c.sizes));n.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",
g.vvSizeUnitValueToPixelsRatio);n.vvColor&&(f.setUniform1fv("u_vvColorValues",g.vvColorValues),f.setUniform4fv("u_vvColors",g.vvColors));n.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",g.vvOpacityValues),f.setUniform1fv("u_vvOpacities",g.vvOpacities));r.setFaceCullingEnabled(!1);e.draw(r,u,t)};return a}(B)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","../Utils","./WGLGeometryBrush","../materialKey/MaterialKey"],
function(x,F,E,B,k){return function(h){function a(){return h.apply(this,arguments)||this}x._inheritsLoose(a,h);var d=a.prototype;d.dispose=function(){};d.getGeometryType=function(){return F.WGLGeometryType.MARKER};d.drawGeometry=function(c,b,e,f){const {context:r,painter:q,rendererInfo:g,state:l}=c,n=k.MarkerMaterialKey.load(e.materialKey),{bufferLayouts:u,attributes:t}=E.createProgramDescriptor(n.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,
type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:2,type:5123},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121},{location:8,name:"a_zoomRange",count:2,type:5123}]});f=q.materialManager.getMaterialProgram(c,n,"materials/icon",t,f);r.useProgram(f);n.textureBinding&&
q.textureManager.bindTextures(r,f,n,!0);this._setSharedUniforms(f,c,b);f.setUniformMatrix3fv("u_displayMat3",n.vvRotation?l.displayViewMat3:l.displayMat3);n.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",g.vvSizeMinMaxValue);n.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",g.vvSizeScaleStopsValue);n.vvSizeFieldStops&&(c=g.getSizeVVFieldStops(b.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",c.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",c.sizes));n.vvSizeUnitValue&&
f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",g.vvSizeUnitValueToPixelsRatio);n.vvColor&&(f.setUniform1fv("u_vvColorValues",g.vvColorValues),f.setUniform4fv("u_vvColors",g.vvColors));n.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",g.vvOpacityValues),f.setUniform1fv("u_vvOpacities",g.vvOpacities));n.vvRotation&&f.setUniform1f("u_vvRotationType","geographic"===g.vvMaterialParameters.vvRotationType?0:1);e.draw(r,u,t)};return a}(B)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../enums","../Utils","./WGLGeometryBrush","../materialKey/MaterialKey"],function(x,F,E,B,k){return function(h){function a(){return h.apply(this,arguments)||this}x._inheritsLoose(a,h);var d=a.prototype;d.dispose=function(){};d.getGeometryType=function(){return F.WGLGeometryType.TEXT};d.drawGeometry=function(c,b,e,f){const {context:r,painter:q,rendererInfo:g,state:l}=c,n=k.TextMaterialKey.load(e.materialKey),{bufferLayouts:u,attributes:t}=E.createProgramDescriptor(n.data,{geometry:[{location:0,name:"a_pos",
count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:5121},{location:5,name:"a_aux",count:4,type:5120},{location:6,name:"a_zoomRange",count:2,type:5123},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,name:"a_texCoords",count:2,type:5123}]});f=q.materialManager.getMaterialProgram(c,n,"materials/text",t,f);
r.useProgram(f);this._setSharedUniforms(f,c,b);q.textureManager.bindTextures(r,f,n);f.setUniformMatrix3fv("u_displayMat3",l.displayMat3);f.setUniformMatrix3fv("u_displayViewMat3",l.displayViewMat3);n.vvSizeMinMaxValue&&f.setUniform4fv("u_vvSizeMinMaxValue",g.vvSizeMinMaxValue);n.vvSizeScaleStops&&f.setUniform1f("u_vvSizeScaleStopsValue",g.vvSizeScaleStopsValue);n.vvSizeFieldStops&&(c=g.getSizeVVFieldStops(b.key.level),f.setUniform1fv("u_vvSizeFieldStopsValues",c.values),f.setUniform1fv("u_vvSizeFieldStopsSizes",
c.sizes));n.vvSizeUnitValue&&f.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",g.vvSizeUnitValueToPixelsRatio);n.vvColor&&(f.setUniform1fv("u_vvColorValues",g.vvColorValues),f.setUniform4fv("u_vvColors",g.vvColors));n.vvOpacity&&(f.setUniform1fv("u_vvOpacityValues",g.vvOpacityValues),f.setUniform1fv("u_vvOpacities",g.vvOpacities));n.vvRotation&&f.setUniform1f("u_vvRotationType","geographic"===g.vvMaterialParameters.vvRotationType?0:1);f.setUniform1f("u_isHalo",1);e.draw(r,u,t);f.setUniform1f("u_isHalo",
0);e.draw(r,u,t)};return a}(B)})},"esri/views/2d/engine/webgl/brushes/raster/BrushRasterBitmap":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../VertexStream","../WGLBrush","../../../../../webgl/rasterUtils"],function(x,F,E,B){return function(k){function h(){var d=k.apply(this,arguments)||this;d._desc={lut:{vsPath:"raster/lut",fsPath:"raster/lut",attributes:new Map([["a_position",0],["a_texcoord",1]])},stretch:{vsPath:"raster/stretch",fsPath:"raster/stretch",attributes:new Map([["a_position",
0],["a_texcoord",1]])},hillshade:{vsPath:"raster/hillshade",fsPath:"raster/hillshade",attributes:new Map([["a_position",0],["a_texcoord",1]])}};d._rendererUniformInfos=new Map;return d}x._inheritsLoose(h,k);var a=h.prototype;a.dispose=function(){this._quad&&this._quad.dispose()};a.prepareState=function({context:d},c){d.setBlendingEnabled(!0);d.setBlendFunctionSeparate(1,771,1,771);d.setColorMask(!0,!0,!0,!0);d.setStencilWriteMask(0);d.setStencilTestEnabled(!0);d.setStencilFunction(514,c.stencilRef,
255)};a.draw=function(d,c){var b;if(c.source&&!c.suspended){d.timeline.begin(this.name);var e=!(null!=(b=d.context.capabilities.textureFloat)&&b.textureFloatLinear);c.updateTexture(d);b=this.getShaderVariations(c,e);b=d.painter.materialManager.getProgram(d,this._desc[c.symbolizerParameters.type],b);this.drawWithProgram(d.context,b,c);d.timeline.end(this.name)}};a.drawWithProgram=function(d,c,b,e=1,f=[0,0],r=!1){this._quad||(this._quad=new F(d,[0,0,1,0,0,1,1,1]));const {symbolizerParameters:q,transformGrid:g,
width:l,height:n,opacity:u}=b;var t=q.type;d.useProgram(c);const m=this.getShaderVariations(b);t=this.getUniformInfos(t,d,c,m);const {names:w,textures:v}=b.getTextures();B.setTextures(d,c,w,v);d=B.getBasicGridUniforms(e,f);r=B.getCommonUniforms(g,[l,n],[b.source.width,b.source.height],u,r);B.setUniforms(c,t,{u_coordScale:b.coordScale,u_dvsMat3:b.transforms.dvs,...d,...r});if(q.colormap){const {colormap:C,colormapOffset:A}=q;b=B.getColormapUniforms(C,A);B.setUniforms(c,t,b)}"stretch"===q.type?(b=B.getStretchUniforms(q),
B.setUniforms(c,t,b)):"hillshade"===q.type&&(b=B.getShadedReliefUniforms(q),B.setUniforms(c,t,b));this._quad.draw()};a.getUniformInfos=function(d,c,b,e){d=0<e.length?d+"-"+e.join("-"):d;if(this._rendererUniformInfos.has(d))return this._rendererUniformInfos.get(d);c=B.getUniformLocationInfos(c,b);this._rendererUniformInfos.set(d,c);return c};a.getShaderVariations=function(d,c=!1){const b=[];"cubic"===d.interpolation?b.push("bicubic"):c&&"bilinear"===d.interpolation&&b.push("bilinear");d.isRendereredSource?
b.push("noop"):d.symbolizerParameters.colormap&&b.push("applyColormap");d.transformGrid&&b.push("applyProjection");return b};return h}(E)})},"esri/views/webgl/rasterUtils":function(){define(["exports","./FramebufferObject","./Texture"],function(x,F,E){x.createColormapTexture=function(B,k){return new E(B,{width:k.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1},k)};x.createFrameBuffer=function(B,k,h,a){a=new E(B,{width:k,
height:h,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:9728,dataType:a?5121:5126,wrapMode:33071,flipped:!1});return new F(B,{colorTarget:0,depthStencilTarget:3,width:k,height:h},a)};x.createRasterTexture=function(B,k,h="nearest",a=!1){var d;const c=(a=!(a&&"u8"===k.pixelType))?5126:5121,b=null==k.pixels||0===k.pixels.length?null:a?k.getAsRGBAFloat():k.getAsRGBA(),e=null==(d=B.capabilities.textureFloat)?void 0:d.textureFloatLinear;return new E(B,{width:k.width,height:k.height,target:3553,
pixelFormat:6408,internalFormat:"webgl2"===B.webglVersion&&a?34836:6408,samplingMode:!e||"bilinear"!==h&&"cubic"!==h?9728:9729,dataType:c,wrapMode:33071,flipped:!1},b)};x.createTransformTexture=function(B,k){var h=4*k.size[0],a=k.size[1];const d={width:h,height:a,target:3553,pixelFormat:6408,internalFormat:"webgl2"===B.webglVersion?34836:6408,dataType:5126,samplingMode:9728,wrapMode:33071,flipped:!1};h=new Float32Array(h*a*4);a=0;for(let c=0;c<k.coefficients.length;c++)h[a++]=k.coefficients[c],2===
c%3&&(h[a++]=1);return new E(B,d,h)};x.getBasicGridUniforms=function(B,k){return{u_scale:B,u_offset:k}};x.getColormapUniforms=function(B,k){return{u_colormapOffset:k||0,u_colormapMaxIndex:B?B.length/4-1:null}};x.getCommonUniforms=function(B,k,h,a=1,d=!0,c=!1){return{u_flipY:d,u_isFloatTexture:c,u_applyTransform:B?!0:!1,u_opacity:a,u_transformSpacing:B?B.spacing:null,u_transformGridSize:B?B.size:null,u_targetImageSize:k,u_srcImageSize:h}};x.getShadedReliefUniforms=function(B){return{u_hillshadeType:B.hillshadeType,
u_sinZcosAs:B.sinZcosAs,u_sinZsinAs:B.sinZsinAs,u_cosZs:B.cosZs,u_weights:B.weights,u_factor:B.factor,u_minValue:B.minValue,u_maxValue:B.maxValue}};x.getStretchUniforms=function(B){return{u_bandCount:B.bandCount,u_minOutput:B.outMin,u_maxOutput:B.outMax,u_minCutOff:B.minCutOff,u_maxCutOff:B.maxCutOff,u_factor:B.factor,u_useGamma:B.useGamma,u_gamma:B.gamma,u_gammaCorrection:B.gammaCorrection}};x.getUniformLocationInfos=function(B,k){B=B.gl;k=k.glName;const h=B.getProgramParameter(k,B.ACTIVE_UNIFORMS),
a=new Map;let d;for(let c=0;c<h;c++)(d=B.getActiveUniform(k,c))&&a.set(d.name,{location:B.getUniformLocation(k,d.name),info:d});return a};x.setTextures=function(B,k,h,a){h.length===a.length&&(a.some(d=>null==d)||h.some(d=>null==d)||h.forEach((d,c)=>{k.setUniform1i(d,c);B.bindTexture(a[c],c)}))};x.setUniforms=function(B,k,h){Object.keys(h).forEach(a=>{var d=k.get(a)||k.get(a+"[0]");if(d){var c=h[a];if(null!==d&&null!=c)switch({info:d}=d,d.type){case 5126:1<d.size?B.setUniform1fv(a,c):B.setUniform1f(a,
c);break;case 35664:B.setUniform2fv(a,c);break;case 35665:B.setUniform3fv(a,c);break;case 35666:B.setUniform4fv(a,c);break;case 35675:B.setUniformMatrix3fv(a,c);break;case 35676:B.setUniformMatrix4fv(a,c);break;case 5124:1<d.size?B.setUniform1iv(a,c):B.setUniform1i(a,c);break;case 35670:B.setUniform1i(a,c?1:0);break;case 35667:case 35671:B.setUniform2iv(a,c);break;case 35668:case 35672:B.setUniform3iv(a,c);break;case 35669:case 35673:B.setUniform4iv(a,c)}}})};Object.defineProperty(x,"__esModule",
{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterialManager":function(){define("../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../webgl/Program ../../../../webgl/ProgramCache ../../../../webgl/Renderbuffer ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ./Programs".split(" "),function(x,F,E,B,k,h,a,d,c,b){return function(){function e(){this._programByKey=new Map}var f=e.prototype;
f.dispose=function(){this._programByKey.forEach(r=>r.dispose());this._programByKey.clear()};f.getMaterialProgram=function(r,q,g){const l=q.key<<3|this._getMaterialOptionsValue(q.type,g);if(this._programByKey.has(l))return this._programByKey.get(l);var n=this._getProgramTemplate(q.type);({shaders:n}=n);const {vertexShader:u,fragmentShader:t}=n(g);g=q.getShaderHeader();n=q.getShaderMain();g=u.replace("#pragma header",g).replace("#pragma main",n);r=new E.Program(r,g,t,q.getAttributeLocations());this._programByKey.set(l,
r);return r};f._getMaterialOptionsValue=function(r,q){switch(r){case 0:return(q.pattern?1:0)<<1|(q.id?1:0);case 1:return(q.pattern?1:0)<<1|(q.id?1:0);case 2:return q.id?1:0;case 3:return(q.sdf?1:0)<<2|(q.pattern?1:0)<<1|(q.id?1:0);case 4:return(q.sdf?1:0)<<1|(q.id?1:0);case 5:return q.id?1:0;case 6:return q.id?1:0;default:return 0}};f._getProgramTemplate=function(r){switch(r){case 0:return b.background;case 5:return b.circle;case 1:return b.fill;case 4:return b.icon;case 3:return b.line;case 2:return b.outline;
case 6:return b.text;default:return null}};return e}()})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define("exports ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../webgl/Program ../../../../webgl/ProgramCache ../../../../webgl/Renderbuffer ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/programUtils ./sources/resolver".split(" "),function(x,F,E,B,
k,h,a,d,c,b,e,f){x.background={shaders:r=>({vertexShader:e.glslifyDefineMap({ID:r.id,PATTERN:r.pattern})+f.resolveIncludes("background/background.vert"),fragmentShader:e.glslifyDefineMap({ID:r.id,PATTERN:r.pattern})+f.resolveIncludes("background/background.frag")})};x.circle={shaders:r=>({vertexShader:e.glslifyDefineMap({ID:r.id})+f.resolveIncludes("circle/circle.vert"),fragmentShader:e.glslifyDefineMap({ID:r.id})+f.resolveIncludes("circle/circle.frag")})};x.fill={shaders:r=>({vertexShader:e.glslifyDefineMap({ID:r.id,
PATTERN:r.pattern})+f.resolveIncludes("fill/fill.vert"),fragmentShader:e.glslifyDefineMap({ID:r.id,PATTERN:r.pattern})+f.resolveIncludes("fill/fill.frag")})};x.icon={shaders:r=>({vertexShader:e.glslifyDefineMap({ID:r.id,SDF:r.sdf})+f.resolveIncludes("icon/icon.vert"),fragmentShader:e.glslifyDefineMap({ID:r.id,SDF:r.sdf})+f.resolveIncludes("icon/icon.frag")})};x.line={shaders:r=>({vertexShader:e.glslifyDefineMap({ID:r.id,PATTERN:r.pattern,SDF:r.sdf})+f.resolveIncludes("line/line.vert"),fragmentShader:e.glslifyDefineMap({ID:r.id,
PATTERN:r.pattern,SDF:r.sdf})+f.resolveIncludes("line/line.frag")})};x.outline={shaders:r=>({vertexShader:e.glslifyDefineMap({ID:r.id})+f.resolveIncludes("outline/outline.vert"),fragmentShader:e.glslifyDefineMap({ID:r.id})+f.resolveIncludes("outline/outline.frag")})};x.text={shaders:r=>({vertexShader:e.glslifyDefineMap({ID:r.id})+f.resolveIncludes("text/text.vert"),fragmentShader:e.glslifyDefineMap({ID:r.id})+f.resolveIncludes("text/text.frag")})};Object.defineProperty(x,"__esModule",{value:!0})})},
"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define("exports ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../webgl/Program ../../../../../webgl/ProgramCache ../../../../../webgl/Renderbuffer ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ./shaderRepository".split(" "),function(x,F,E,B,k,h,a,d,c,b,e){const f=new d(function(r){let q=e;r.split("/").forEach(g=>
{q&&(q=q[g])});return q});x.resolveIncludes=function(r){return f.resolveIncludes(r)};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d u_opacity * color;\n#else\ngl_FragColor \x3d u_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\nuniform mediump vec4 u_tlbr;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\n#endif\nvoid main() {\ngl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\nv_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d u_tlbr / u_mosaicSize.xyxy;\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float dist \x3d length(v_offset);\nmediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\nlowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\ngl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_stroke_color \x3d stroke_color * stroke_opacity;\nv_stroke_width \x3d stroke_width;\nv_radius \x3d radius;\nv_blur \x3d max(blur, u_antialiasingWidth / (radius + stroke_width));\nmediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\nv_offset \x3d offset;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d v_color[3] * color;\n#else\ngl_FragColor \x3d v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\n#include \x3cutil/util.glsl\x3e\nuniform mediump vec2 u_mosaicSize;\nuniform mediump float u_patternFactor;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\nfloat patternWidth \x3d nextPOT(tlbr.z - tlbr.x);\nfloat patternHeight \x3d nextPOT(tlbr.w - tlbr.y);\nfloat scaleX \x3d 1.0 / (patternWidth * u_patternFactor);\nfloat scaleY \x3d 1.0 / (patternHeight * u_patternFactor);\nmat3 patterMat \x3d mat3(scaleX, 0.0,    0.0,\n0.0,    -scaleY, 0.0,\n0.0,    0.0,    1.0);\nv_tileTextureCoord \x3d (patterMat * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d tlbr / u_mosaicSize.xyxy;\n#endif\nvec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump flaot v_halo_width;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\nconst float softEdgeRatio \x3d 0.248062016;\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * softEdgeRatio * size;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nif (v_halo_width \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d u_outlineColor;\nconst float outlineLimitRatio \x3d (16.0 / 86.0);\nfloat clampedOutlineSize \x3d softEdgeRatio * min(v_halo_width, outlineLimitRatio * max(v_size.x, v_size.y));\noutlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\ngl_FragColor \x3d v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n}\nelse {\ngl_FragColor \x3d v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump float v_halo_width;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nv_color \x3d color;\nv_opacity \x3d opacity;\n#ifdef SDF\nv_halo_width \x3d halo_width;\n#endif\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_opacity *\x3d interpolatedOpacity;\nmediump float a_angle         \x3d a_levelInfo[1];\nmediump float a_minLevel      \x3d a_levelInfo[2];\nmediump float a_maxLevel      \x3d a_levelInfo[3];\nmediump vec2 a_tex            \x3d a_texAngleRange.xy;\nmediump float delta_z \x3d 0.0;\nmediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_opacity, 0.0);\nvec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\nv_size \x3d abs(offset);\n#ifdef SDF\noffset \x3d (120.0 / 86.0) * offset;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_tex \x3d a_tex.xy / u_mosaicSize;\n}"},
line:{"line.frag":"precision lowp float;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#if defined (PATTERN) || defined(SDF)\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nuniform sampler2D u_texture;\nuniform mediump float u_antialiasing;\n#endif\n#ifdef SDF\n#include \x3cutil/encoding.glsl\x3e\nconst mediump float sdfPatternHalfWidth \x3d 15.5;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\nlowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\nmediump float relativeTexX \x3d mod(v_accumulatedDistance / v_patternSize.x, 1.0);\nmediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\ngl_FragColor \x3d alpha * v_color[3] * color;\n#elif defined(SDF)\nmediump float lineHalfWidth \x3d v_lineHalfWidth - 0.5 * u_antialiasing;\nmediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\nmediump float relativeTexX \x3d mod((v_accumulatedDistance * 0.5) / (lineWidthRatio * v_patternSize.x), 1.0);\nmediump float relativeTexY \x3d  0.5 + 0.25 * v_normal.y;\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * lineHalfWidth;\ngl_FragColor \x3d alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n#else\ngl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_extrude_offset;\nattribute vec4 a_dir_normal;\nattribute vec2 a_accumulatedDistance;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\nconst mediump float tileCoordRatio \x3d 8.0;\n#if defined (PATTERN) || defined(SDF)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_blur \x3d blur + u_antialiasing;\nv_normal \x3d a_dir_normal.zw * scale;\n#if defined (PATTERN) || defined(SDF)\nv_tlbr          \x3d tlbr / u_mosaicSize.xyxy;\nv_patternSize   \x3d vec2(tlbr.z - tlbr.x, tlbr.y - tlbr.w);\n#endif\nv_lineHalfWidth \x3d (width + u_antialiasing) * 0.5;\nmediump vec2 dir \x3d a_dir_normal.xy * scale;\nmediump vec2 offset_ \x3d a_extrude_offset.zw * scale * offset;\nmediump vec2 dist \x3d v_lineHalfWidth * scale * a_extrude_offset.xy;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos + offset_ * tileCoordRatio / u_zoomFactor, 1.0) + u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n#if defined (PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d a_accumulatedDistance.x * u_zoomFactor / tileCoordRatio + dot(dir, dist + offset_);\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d abs(v_normal.y);\nlowp float alpha \x3d smoothstep(1.0, 0.0, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_normal \x3d a_xnormal;\nmediump vec2 dist \x3d u_outline_width * scale * a_offset;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nconst float sdfPixel \x3d 3.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nif (u_halo \x3e 0.5)\n{\nv_color \x3d halo_color * opacity;\nhalo_width *\x3d sdfPixel;\nhalo_blur *\x3d sdfPixel;\n}\nelse\n{\nv_color \x3d color * opacity;\nhalo_width \x3d 0.0;\nhalo_blur \x3d 0.0;\n}\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_color *\x3d interpolatedOpacity;\nmediump float a_angle       \x3d a_levelInfo[1];\nmediump float a_minLevel    \x3d a_levelInfo[2];\nmediump float a_maxLevel    \x3d a_levelInfo[3];\nmediump vec2 a_tex          \x3d a_texAngleRange.xy;\nmediump float a_visMinAngle    \x3d a_texAngleRange.z;\nmediump float a_visMaxAngle    \x3d a_texAngleRange.w;\nmediump float delta_z \x3d 0.0;\nmediump float angle \x3d mod(a_angle + u_mapRotation, 256.0);\nif (a_visMinAngle \x3c a_visMaxAngle)\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n}\nelse\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n}\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_color[3], 0.0);\nv_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_edgeDistance \x3d edgePos - halo_width / size;\nv_edgeWidth \x3d (u_antialiasingWidth + halo_blur) / size;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}","util.glsl":"float nextPOT(in float x) {\nreturn pow(2.0, ceil(log2(abs(x))));\n}"}}})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define("exports ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/ProgramCache ../../../webgl/Renderbuffer ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/programUtils ./shaders/BitBlitPrograms".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f){E=function(){function r(){this._initialized=!1}var q=r.prototype;q.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};q.render=function(g,l,n,u){g&&(this._initialized||this._initialize(g),g.setBlendFunctionSeparate(1,771,1,771),g.bindVAO(this._vertexArrayObject),g.useProgram(this._program),l.setSamplingMode(n),g.bindTexture(l,0),this._program.setUniform1i("u_tex",
0),this._program.setUniform1f("u_opacity",u),g.drawArrays(5,0,4),g.bindTexture(null,0),g.bindVAO())};q._initialize=function(g){if(this._initialized)return!0;const l=f.bitBlit.attributes,n=e.createProgram(g,f.bitBlit);if(!n)return!1;const u=new Int8Array(16);u[0]=-1;u[1]=-1;u[2]=0;u[3]=0;u[4]=1;u[5]=-1;u[6]=1;u[7]=0;u[8]=-1;u[9]=1;u[10]=0;u[11]=1;u[12]=1;u[13]=1;u[14]=1;u[15]=1;g=new b(g,l,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,
offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:F.createVertex(g,35044,u)});this._program=n;this._vertexArrayObject=g;return this._initialized=!0};return r}();x.BitBlitRenderer=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["exports","./sources/resolver"],function(x,F){F={shaders:{vertexShader:F.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:F.resolveIncludes("bitBlit/bitBlit.frag")},attributes:new Map([["a_pos",
0],["a_tex",1]])};x.bitBlit=F;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("../../../../core/maybe ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/ProgramCache ../../../webgl/Renderbuffer ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ../../../webgl/Texture ../../../webgl/VertexArrayObject ./enums ./shaders/MaterialPrograms".split(" "),function(x,F,E,B,k,h,a,d,c,
b,e,f){const r=l=>l===e.WGLDrawPhase.HITTEST||l===e.WGLDrawPhase.LABEL_ALPHA,q=({rendererInfo:l,drawPhase:n},u,t,m)=>{u=u.getVariationHash();m=m.join(".");n=(r(n)?1:0)|(n===e.WGLDrawPhase.HIGHLIGHT?2:0);return`${u}-${m}-${n}-${l.getVariationHash()}-${x.isSome(t)&&t.join(".")}`},g=(l,n,u,t)=>{t=t.reduce((m,w)=>({...m,[w]:l.driverTestResult[w]}),{});n={...n.getVariation(),...l.rendererInfo.getVariation(),highlight:l.drawPhase===e.WGLDrawPhase.HIGHLIGHT,id:r(l.drawPhase),...t};if(x.isSome(u))for(const m of u)n[m]=
!0;return n};return function(){function l(u){this._programByKey=new Map;this._programCache=new k(u)}var n=l.prototype;n.dispose=function(){this._programCache&&this._programCache.dispose()};n.getProgram=function(u,t,m=[],w=[]){const v=t.vsPath+"."+t.fsPath+JSON.stringify(m)+w.join(".");if(this._programByKey.has(v))return this._programByKey.get(v);w=w.reduce((p,z)=>({...p,[z]:u.driverTestResult[z]}),{});m={...m.map(p=>"string"===typeof p?{name:p,value:!0}:p).reduce((p,z)=>({...p,[z.name]:z.value}),
{}),...w};const {vsPath:C,fsPath:A,attributes:y}=t;t=this._programCache.getProgram(f.createProgramTemplate(C,A,y),m);if(!t)throw Error("Unable to get program for key: ${key}");this._programByKey.set(v,t);return t};n.getMaterialProgram=function(u,t,m,w,v,C=["ignoresSamplerPrecision"]){const A=q(u,t,v,C);if(this._programByKey.has(A))return this._programByKey.get(A);u=g(u,t,v,C);m=this._programCache.getProgram(f.createProgramTemplate(m,m,w),u);if(!m)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(A,m);return m};return l}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["exports","./sources/resolver","../../../../webgl/programUtils"],function(x,F,E){const B=k=>{const h={};for(const d in k){{let c=void 0;var a=d;c=""+a[0].toUpperCase();for(let b=1;b<a.length;b++){const e=a[b];e===e.toUpperCase()?(c+="_",c+=e):c+=e.toUpperCase()}a=c}h[a]=k[d]}return E.glslifyDefineMap(h)};x.createProgramTemplate=(k,h,a)=>{const d=k+k.substring(k.lastIndexOf("/")),
c=h+h.substring(h.lastIndexOf("/"));return{attributes:a,shaders:b=>({vertexShader:B(b)+F.resolveIncludes(`${d}.vert`),fragmentShader:B(b)+F.resolveIncludes(`${c}.frag`)})}};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TextureManager":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../config ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../chunks/vec2 ../../../../chunks/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./animatedFormats/apng ./animatedFormats/gif ./util/BidiText ./util/Result ./util/symbolUtils ../../../support/QueueProcessor".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n,u,t,m,w,v,C,A){function y(L){switch(L.type){case "CIMSolidStroke":case "CIMSolidFill":return!0;case "esriSFS":return"esriSFSSolid"===L.style||"esriSFSNull"===L.style;case "esriSLS":return"esriSLSSolid"===L.style||"esriSLSNull"===L.style;default:return!1}}function p(L){switch(L.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!1;default:return!0}}function z(L,M){return D.apply(this,
arguments)}function D(){D=x._asyncToGenerator(function*(L,M){L=L.imageData?`data:${L.contentType};base64,${L.imageData}`:L.url;var O;if(-1!==L.indexOf(";base64,")){M=L.indexOf(";base64,")+8;M=L.substring(M);M=atob(M);L=new Uint8Array(M.length);for(O=0;O<M.length;O++)L[O]=M.charCodeAt(O);O=L.buffer}else try{const {data:H}=yield E(L,{responseType:"array-buffer",...M});O=H}catch(H){if(!a.isAbortError(H))return new B("mapview-invalid-resource",`Could not fetch requested resource at ${L}`)}return O});
return D.apply(this,arguments)}function G(L,M){M=Math.round(d.pt2px(M)*window.devicePixelRatio);return Math.min(L,M*(128<=M?2:4))}const I=b.create(),K=k.getLogger("esri.views.2d.engine.webgl.TextureManager");let N=function(){function L(M,O,H){this.mosaicType=M;this.page=O;this.sdf=H}L.fromMosaic=function(M,O){return new L(M,O.page,O.sdf)};return L}();return function(){function L(O){this._invalidFontsMap=new Map;this._sdfConverter=new n(126);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._rasterizer=
new e;this._ongoingRasterizations=new Map;this._imageRequestQueue=new A.QueueProcessor({concurrency:10,process:function(){var H=x._asyncToGenerator(function*(J,P){a.throwIfAborted(P);try{return yield E(J,{responseType:"image",signal:P})}catch(Q){if(!a.isAbortError(Q))throw new B("mapview-invalid-resource",`Could not fetch requested resource at ${J}`,Q);throw Q;}});return function(J,P){return H.apply(this,arguments)}}()});this._spriteMosaic=new u(O,2048,2048,500);this._glyphSource=new l(`${F.fontsUrl}/{fontstack}/{range}.pbf`);
this._glyphMosaic=new g(1024,1024,this._glyphSource)}var M=L.prototype;M.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._sdfConverter.dispose();this._sdfConverter=this._rasterizer=this._glyphMosaic=this._spriteMosaic=null;this._hashToBindingIndex.clear();this._bindingInfos=this._hashToBindingIndex=null;this._ongoingRasterizations.clear();this._ongoingRasterizations=null;this._imageRequestQueue.clear();this._imageRequestQueue=null};M.rasterizeItem=
function(){var O=x._asyncToGenerator(function*(H,J,P,Q){if(h.isNone(H))return K.error(new B("mapview-null-resource","Unable to rasterize null resource",void 0)),null;switch(H.type){case "CIMTextSymbol":case "esriTS":return H=yield this._rasterizeText(H,P,Q),H.forEach(U=>this._setTextureBinding(r.MosaicType.GLYPH,U)),{glyphMosaicItems:H};default:if(H.type&&-1!==H.type.toLowerCase().indexOf("3d"))return K.error(new B("mapview-invalid-type",`MapView does not support symbol type: ${H.type}`,H)),null;
H=yield this._rasterizeSpriteSymbol(H,J,Q);v.ok(H)&&H&&this._setTextureBinding(r.MosaicType.SPRITE,H);return{spriteMosaicItem:H}}});return function(H,J,P,Q){return O.apply(this,arguments)}}();M.bindTextures=function(O,H,J,P=!1){if(0!==J.textureBinding){var Q=this._bindingInfos[J.textureBinding-1];J=Q.page;P=P?9987:9729;switch(Q.mosaicType){case r.MosaicType.SPRITE:{Q=this.sprites.getWidth(J);const U=this.sprites.getHeight(J);Q=c.set(I,Q,U);this._spriteMosaic.bind(O,P,J,f.TEXTURE_BINDING_SPRITE_ATLAS);
H.setUniform1i("u_texture",f.TEXTURE_BINDING_SPRITE_ATLAS);H.setUniform2fv("u_mosaicSize",Q);break}case r.MosaicType.GLYPH:Q=c.set(I,this.glyphs.width,this.glyphs.height);this._glyphMosaic.bind(O,P,J,f.TEXTURE_BINDING_GLYPH_ATLAS);H.setUniform1i("u_texture",f.TEXTURE_BINDING_GLYPH_ATLAS);H.setUniform2fv("u_mosaicSize",Q);break;default:K.error("mapview-texture-manager",`Cannot handle unknown type ${Q.mosaicType}`)}}};M._hashMosaic=function(O,H){return 1|O<<1|(H.sdf?1:0)<<2|H.page<<3};M._setTextureBinding=
function(O,H){const J=this._hashMosaic(O,H);this._hashToBindingIndex.has(J)||(O=N.fromMosaic(O,H),this._hashToBindingIndex.set(J,this._bindingInfos.length+1),this._bindingInfos.push(O));H.textureBinding=this._hashToBindingIndex.get(J)};M._rasterizeText=function(){var O=x._asyncToGenerator(function*(H,J,P){const Q=q.getFullyQualifiedFontName(H.font),U=this._invalidFontsMap.has(Q);if(J)H=J;else{H=w.bidiText(H.text)[0];J=[];for(let aa=0;aa<H.length;aa++)J.push(H.charCodeAt(aa));H=J}try{return yield this._glyphMosaic.getGlyphItems(U?
"arial-unicode-ms-regular":Q,H,P)}catch(aa){return K.error(new B("mapview-invalid-resource",`Couldn't find font ${Q}. Falling back to Arial Unicode MS Regular`,void 0)),this._invalidFontsMap.set(Q,!0),this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",H,P)}});return function(H,J,P){return O.apply(this,arguments)}}();M._rasterizeSpriteSymbol=function(){var O=x._asyncToGenerator(function*(H,J,P){if(y(H))return null;const Q=C.keyFromSymbol(H);if(this._spriteMosaic.has(Q))return this._spriteMosaic.getSpriteItem(Q);
if("esriSMS"===H.type&&H.path||H.url||H.imageData)return this._handleAsyncResource(Q,H,P);if(J=this._rasterizer.rasterizeJSONResource(H,J)){const {size:U,image:aa,sdf:ba,simplePattern:ia}=J;return this._addItemToMosaic(Q,U,{type:"static",data:aa},p(H),ba,ia)}return new B("TextureManager","unrecognized or null rasterized image")});return function(H,J,P){return O.apply(this,arguments)}}();M._handleAsyncResource=function(){var O=x._asyncToGenerator(function*(H,J,P){if(this._ongoingRasterizations.has(H))return this._ongoingRasterizations.get(H);
J="esriSMS"===J.type&&J.path?this._handleSVG(J,H,P):this._handleImage(J,H,P);this._ongoingRasterizations.set(H,J);try{yield J,this._ongoingRasterizations.delete(H)}catch{this._ongoingRasterizations.delete(H)}return J});return function(H,J,P){return O.apply(this,arguments)}}();M._handleSVG=function(){var O=x._asyncToGenerator(function*(H,J,P){H=yield this._sdfConverter.draw(H.path,P);return this._addItemToMosaic(J,[126,126],{type:"static",data:new Uint32Array(H.buffer)},!1,!0,!0)});return function(H,
J,P){return O.apply(this,arguments)}}();M._handleGIFOrPNG=function(){var O=x._asyncToGenerator(function*(H,J,P){var Q=yield z(H,P);if(v.ok(Q)){var U=m.isGIF(Q);const aa=t.isPNG(Q);if(!U&&!aa)return new B("mapview-invalid-resource","Image data is neither GIF nor PNG!");let ba;try{U&&m.isAnimatedGIF(Q)?ba=yield m["default"].create(Q,P):aa&&t.isAnimatedPNG(Q)&&(ba=yield t["default"].create(Q,P))}catch(ia){if(!a.isAbortError(ia))return new B("mapview-invalid-resource","Could not fetch requested resource!")}if(ba&&
v.ok(ba))return this._addItemToMosaic(J,[ba.width,ba.height],{type:"animated",data:ba},p(H),!1,!1);P=new Blob([Q],{type:U?"image/gif":"image/png"});if((P=yield this._imageFromBlob(P))&&P instanceof HTMLImageElement){Q=P.width;U=P.height;"esriPMS"===H.type&&(Q=Math.round(G(P.width,H.width)),U=Math.round(Q/P.width*P.height));const {size:ia,sdf:ha,image:ca}=this._rasterizer.rasterizeImageResource(Q,U,P,H.colorSubstitutions);return this._addItemToMosaic(J,ia,{type:"static",data:ca},p(H),ha,!1)}}return new B("mapview-invalid-resource",
"Could not handle resource!")});return function(H,J,P){return O.apply(this,arguments)}}();M._handleImage=function(){var O=x._asyncToGenerator(function*(H,J,P){var Q;(Q=H.url&&-1!==H.url.indexOf(".gif")||H.contentType&&"image/gif"===H.contentType||H.imageData&&-1!==H.imageData.indexOf("data:image/gif"))||(Q=H.url&&-1!==H.url.indexOf(".png")||H.contentType&&"image/png"===H.contentType||H.imageData&&-1!==H.imageData.indexOf("data:image/png"));if(Q)return this._handleGIFOrPNG(H,J,P);Q=H.imageData?`data:${H.contentType};base64,${H.imageData}`:
H.url;try{const {data:U}=yield this._imageRequestQueue.push(Q,{...P});-1!==Q.indexOf("data:image/svg+xml")&&(U.width=d.pt2px(H.width),U.height=d.pt2px(H.height));let aa=U.width,ba=U.height;"esriPMS"===H.type&&(aa=Math.round(G(U.width,H.width)),ba=Math.round(aa/U.width*U.height));const {size:ia,sdf:ha,image:ca}=this._rasterizer.rasterizeImageResource(aa,ba,U,H.colorSubstitutions);return this._addItemToMosaic(J,ia,{type:"static",data:ca},p(H),ha,!1)}catch(U){if(!a.isAbortError(U))return new B("mapview-invalid-resource",
`Could not fetch requested resource at ${Q}. ${U.message}`)}});return function(H,J,P){return O.apply(this,arguments)}}();M._imageFromBlob=function(){var O=x._asyncToGenerator(function*(H){H=window.URL.createObjectURL(H);try{const {data:J}=yield this._imageRequestQueue.push(H);window.URL.revokeObjectURL(H);return J}catch(J){window.URL.revokeObjectURL(H);if(!a.isAbortError(J))return new B("mapview-invalid-resource",`Could not fetch requested resource at ${H}`);throw J;}});return function(H){return O.apply(this,
arguments)}}();M._addItemToMosaic=function(O,H,J,P,Q,U){return this._spriteMosaic.addSpriteItem(O,H,J,P,Q,U)};x._createClass(L,[{key:"sprites",get:function(){return this._spriteMosaic}},{key:"glyphs",get:function(){return this._glyphMosaic}}]);return L}()})},"esri/symbols/cim/Rasterizer":function(){define(["./CIMSymbolHelper","./Rect","./SDFHelper","./utils"],function(x,F,E,B){return function(){function k(){}var h=k.prototype;h.dispose=function(){this._rasterizationCanvas=null};h.rasterizeJSONResource=
function(a,d,c){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type){const [n,u,t]=x.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,a.style,d);return{size:[u,t],image:new Uint32Array(n.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===a.type||"esriSLS"===a.type){const [n,u,t]=x.SymbolHelper.rasterizeSimpleLine(a.style,a.cap);return{size:[u,t],image:new Uint32Array(n.buffer),sdf:!0,simplePattern:!0,
anchorX:0,anchorY:0}}let b,e;"simple-marker"===a.type||"esriSMS"===a.type||"line-marker"===a.type?(a=x.CIMSymbolHelper.fromSimpleMarker(a),e=E.getSDFInfo(a)):"CIMHatchFill"===a.type?(a=x.CIMSymbolHelper.fromCIMHatchFill(a),b=new F(a.frame.xmin,-a.frame.ymax,a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin)):a.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===a.markerPlacement.type?(a=x.CIMSymbolHelper.fromCIMInsidePolygon(a),b=new F(a.frame.xmin,-a.frame.ymax,a.frame.xmax-a.frame.xmin,a.frame.ymax-
a.frame.ymin)):e=E.getSDFInfo(a);if(e&&!c){const [n,u,t]=E.buildSDF(e);return n?{size:[u,t],image:new Uint32Array(n.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const [f,r,q,g,l]=x.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a,b,!c);return f?{size:[r,q],image:new Uint32Array(f.buffer),sdf:!1,simplePattern:!1,anchorX:g,anchorY:l}:null};h.rasterizeImageResource=function(a,d,c,b){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=
a;this._rasterizationCanvas.height=d;var e=this._rasterizationCanvas.getContext("2d");c instanceof ImageData?e.putImageData(c,0,0):(c.setAttribute("width",`${a}px`),c.setAttribute("height",`${d}px`),e.drawImage(c,0,0,a,d));c=e.getImageData(0,0,a,d);c=new Uint8Array(c.data);if(b)for(var f of b)if(f&&f.oldColor&&4===f.oldColor.length&&f.newColor&&4===f.newColor.length){const [r,q,g,l]=f.oldColor,[n,u,t,m]=f.newColor;if(r!==n||q!==u||g!==t||l!==m)for(b=0;b<c.length;b+=4)r===c[b]&&q===c[b+1]&&g===c[b+
2]&&l===c[b+3]&&(c[b]=n,c[b+1]=u,c[b+2]=t,c[b+3]=m)}for(b=0;b<c.length;b+=4)f=c[b+3]/255,c[b]*=f,c[b+1]*=f,c[b+2]*=f;e=c;f=a;b=d;if(512<=f||512<=b){e=f/b;1<e?(f=512,b=Math.round(512/e)):(b=512,f=Math.round(512*e));e=new Uint8Array(4*f*b);const r=new Uint8ClampedArray(e.buffer);B.resampleHermite(c,a,d,r,f,b,!1)}return{size:[f,b],image:new Uint32Array(e.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return k}()})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../Color ../../core/Logger ../../core/mathUtils ./CIMPlacements ./CIMSymbolDrawHelper ./packingUtils".split(" "),
function(x,F,E,B,k,h,a){function d(q,g){switch(g.type){case "CIMSymbolReference":q.drawSymbol(g.symbol,{type:"point",x:0,y:0});break;case "CIMPointSymbol":q.drawSymbol(g,{type:"point",x:0,y:0});break;case "CIMVectorMarker":{const l=new k.Placement;q.drawMarker(g,l)}}return q.envelope()}const c=Math.PI,b=c/2,e=E.getLogger("esri.symbols.cim.CIMSymbolHelper");E=function(){function q(){}q.getEnvelope=function(g){const l=new h.EnvDrawHelper;if(Array.isArray(g)){let n;for(const u of g)n?n.union(d(l,u)):
n=d(l,u);return n}return d(l,g)};q.getTextureAnchor=function(g){g=this.getEnvelope(g);if(!g||0>=g.width||0>=g.height)return[0,0,0];const l=96/72,n=g.height*l+2;return[(g.x+.5*g.width)*l/(g.width*l+2),-(g.y+.5*g.height)*l/n,n]};q.rasterize=function(g,l,n,u=!0){var t=n||this.getEnvelope(l);if(!t||0>=t.width||0>=t.height)return[null,0,0,0,0];var m=96/72;const w=(t.x+.5*t.width)*m,v=(t.y+.5*t.height)*m;g.width=t.width*m;g.height=t.height*m;n||(g.width+=2,g.height+=2);n=g.getContext("2d");m=h.Transformation.createScale(m,
-m);m.translate(.5*g.width-w,.5*g.height+v);m=new h.CanvasDrawHelper(n,m);switch(l.type){case "CIMPointSymbol":m.drawSymbol(l,{type:"point",x:0,y:0});break;case "CIMVectorMarker":t=new k.Placement,m.drawMarker(l,t)}l=n.getImageData(0,0,g.width,g.height);l=new Uint8Array(l.data);if(u)for(n=0;n<l.length;n+=4)u=l[n+3]/255,l[n]*=u,l[n+1]*=u,l[n+2]*=u;return[l,g.width,g.height,-w/g.width,-v/g.height]};q.fromSimpleMarker=function(g){var l=g.style;if("circle"===l||"esriSMSCircle"===l){var n=Math.acos(.995);
var u=Math.ceil(c/n/4);0===u&&(u=1);n=b/u;u*=4;l=[];l.push([50,0]);for(let m=1;m<u;m++)l.push([50*Math.cos(m*n),-50*Math.sin(m*n)]);l.push([50,0]);n={rings:[l]};u={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===l||"esriSMSCross"===l)n={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,50],[0,50]]]},u={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===l||"esriSMSDiamond"===l)n={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},u={xmin:-50,ymin:-50,
xmax:50,ymax:50};else if("square"===l||"esriSMSSquare"===l)n={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},u={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===l||"esriSMSX"===l)n={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},u={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===l||"esriSMSTriangle"===l)u=2/3*100,l=u-100,n={rings:[[[-57.735026918962575,l],[0,u],[57.735026918962575,l],[-57.735026918962575,l]]]},u=
{xmin:-57.735026918962575,ymin:l,xmax:57.735026918962575,ymax:u};else if("arrow"===l||"esriSMSArrow"===l)n={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},u={xmin:-50,ymin:-50,xmax:50,ymax:50};if(n&&u){var t=[{type:"CIMSolidFill",enable:!0,color:g.color}];g.outline&&t.push({type:"CIMSolidStroke",enable:!0,width:g.outline.width,color:g.outline.color});t={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:g.angle,size:g.size,offsetX:g.xoffset,offsetY:g.yoffset,
frame:u,markerGraphics:[{type:"CIMMarkerGraphic",geometry:n,symbol:{type:"CIMPolygonSymbol",symbolLayers:t}}]}]}}return t};q.fromCIMHatchFill=function(g){const l=void 0!==g.separation?g.separation:4,n=l/2;for(var u=this._getLineSymbolPeriod(g.lineSymbol)||4;4>u;)u*=2;u/=2;return{type:"CIMVectorMarker",frame:{xmin:-u,xmax:u,ymin:-n,ymax:n},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-u,0],[u,0]]]},symbol:g.lineSymbol}],size:l}};q._getLineSymbolPeriod=function(g){if(g){const l=this._getEffectsRepeat(g.effects);
if(l)return l;if(g.symbolLayers)for(const n of g.symbolLayers)if((g=this._getEffectsRepeat(n.effects))||n&&(g=this._getPlacementRepeat(n.markerPlacement)))return g}return 0};q._getEffectsRepeat=function(g){if(g)for(var l of g)if(l)switch(l.type){case "CIMGeometricEffectDashes":if((g=l.dashTemplate)&&g.length){l=0;for(const n of g)l+=n;g.length&1&&(l*=2);return l}break;case "CIMGeometricEffectWave":return l.period;default:e.error(`unsupported geometric effect type ${l.type}`)}return 0};q._getPlacementRepeat=
function(g){if(g)switch(g.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((g=g.placementTemplate)&&g.length){let l=0;for(const n of g)l+=n;g.length&1&&(l*=2);return l}}return 0};q.fromCIMInsidePolygon=function(g){var l=g.markerPlacement;const n={type:g.type,...g,markerPlacement:null,anchorPoint:null};let u,t;!0===l.shiftOddRows?(g=l.stepX/2,u=l.stepY,t=2*l.stepY,l=[{x:-g,y:0},{x:g,y:0},{x:0,y:u},{x:0,y:-u}].map(m=>
({type:"CIMMarkerGraphic",geometry:m,symbol:{type:"CIMPointSymbol",symbolLayers:[n]}}))):(g=l.stepX/2,u=l.stepY/2,t=l.stepY,l=[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",symbolLayers:[n]}}]);return{type:"CIMVectorMarker",frame:{xmin:-g,xmax:g,ymin:-u,ymax:u},markerGraphics:l,size:t}};q.getFillColor=function(g){if(!g)return null;switch(g.type){case "CIMPolygonSymbol":if(g.symbolLayers)for(const l of g.symbolLayers)if(g=q.getFillColor(l),null!=g)return g;break;case "CIMTextSymbol":return q.getFillColor(g.symbol);
case "CIMSolidFill":return g.color}};q.getStrokeColor=function(g){if(g)switch(g.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(g.symbolLayers)for(const l of g.symbolLayers)if(g=q.getStrokeColor(l),void 0!==g)return g;break;case "CIMTextSymbol":return q.getStrokeColor(g.symbol);case "CIMSolidStroke":return g.color}};q.getStrokeWidth=function(g){if(g)switch(g.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(g.symbolLayers)for(const l of g.symbolLayers)if(g=q.getStrokeWidth(l),void 0!==g)return g;
break;case "CIMTextSymbol":return q.getStrokeWidth(g.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return g.width}};q.getSize=function(g){if(g)switch(g.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":{let l=0;if(g.symbolLayers)for(const n of g.symbolLayers)g=q.getSize(n),g>l&&(l=g);return l}case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return g.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return g.size}};
q.getMarkerScaleRatio=function(g){if(g)switch(g.type){case "CIMVectorMarker":if(!1!==g.scaleSymbolsProportionally&&g.frame)return g.size/(g.frame.ymax-g.frame.ymin)}return 1};return q}();let f=function(){function q(){}q.rasterizeSimpleFill=function(g,l,n){"solid"!==l&&"none"!==l&&"esriSFSSolid"!==l&&"esriSFSNull"!==l||console.error("Unexpected: style does not require rasterization");n=B.nextPowerOfTwo(Math.ceil(n));var u=this._isHorizontalOrVertical(l)?8*n:16*n;const t=2*n;g.width=u;g.height=u;const m=
g.getContext("2d");m.strokeStyle="#FFFFFF";m.lineWidth=n;m.beginPath();if("vertical"===l||"cross"===l||"esriSFSCross"===l||"esriSFSVertical"===l)m.moveTo(u/2,-t),m.lineTo(u/2,u+t);if("horizontal"===l||"cross"===l||"esriSFSCross"===l||"esriSFSHorizontal"===l)m.moveTo(-t,u/2),m.lineTo(u+t,u/2);if("forward-diagonal"===l||"diagonal-cross"===l||"esriSFSDiagonalCross"===l||"esriSFSForwardDiagonal"===l)m.moveTo(-t,-t),m.lineTo(u+t,u+t),m.moveTo(u-t,-t),m.lineTo(u+t,t),m.moveTo(-t,u-t),m.lineTo(t,u+t);if("backward-diagonal"===
l||"diagonal-cross"===l||"esriSFSBackwardDiagonal"===l||"esriSFSDiagonalCross"===l)m.moveTo(u+t,-t),m.lineTo(-t,u+t),m.moveTo(t,-t),m.lineTo(-t,t),m.moveTo(u+t,u-t),m.lineTo(u-t,u+t);m.stroke();l=m.getImageData(0,0,g.width,g.height);l=new Uint8Array(l.data);for(u=0;u<l.length;u+=4)n=l[u+3]/255,l[u]*=n,l[u+1]*=n,l[u+2]*=n;return[l,g.width,g.height]};q.rasterizeSimpleLine=function(g,l){switch(l){case "butt":l="Butt";break;case "square":l="Square";break;default:l="Round"}const n="Butt"===l;switch(g){case "dash":case "esriSLSDash":g=
n?[4,3]:[3,4];break;case "dash-dot":case "esriSLSDashDot":g=n?[4,3,1,3]:[3,4,0,4];break;case "dot":case "esriSLSDot":g=n?[1,3]:[0,4];break;case "long-dash":case "esriSLSLongDash":g=n?[8,3]:[7,4];break;case "long-dash-dot":case "esriSLSLongDashDot":g=n?[8,3,1,3]:[7,4,0,4];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":g=n?[8,3,1,3,1,3]:[7,4,0,4,0,4];break;case "short-dash":case "esriSLSShortDash":g=n?[4,1]:[3,2];break;case "short-dash-dot":case "esriSLSShortDashDot":g=n?[4,1,1,1]:[3,2,0,2];
break;case "short-dash-dot-dot":case "esriSLSShortDashDotDot":g=n?[4,1,1,1,1,1]:[3,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":g=n?[1,1]:[0,2];break;case "solid":case "esriSLSSolid":case "none":e.error("Unexpected: style does not require rasterization");g=[0,0];break;default:e.error(`Tried to rasterize SLS, but found an unexpected style: ${g}!`),g=[0,0]}return this.rasterizeDash(g,l)};q.rasterizeDash=function(g,l){var n="Butt"===l,u="Square"===l;l=!n&&!u;1===g.length%2&&(g=[...g,...g]);
var t=0;for(var m of g)t+=m;m=Math.round(15.5*t);t=new Float32Array(31*m);let w=0,v=0,C=.5,A=!0;for(var y of g){w=v;for(v+=15.5*y;C<=v;){for(g=.5;31>g;){const p=l?(g-15.5)*(g-15.5):Math.abs(g-15.5);t[(g-.5)*m+C-.5]=A?n?Math.max(Math.max(w+7.75-C,p),Math.max(C-v+7.75,p)):p:l?Math.min((C-w)*(C-w)+p,(C-v)*(C-v)+p):u?Math.min(Math.max(C-w,p),Math.max(v-C,p)):Math.min(Math.max(C-w+7.75,p),Math.max(v+7.75-C,p));g++}C++}A=!A}n=t.length;y=new Uint8Array(4*n);for(u=0;u<n;++u)a.packFloatRGBA((l?Math.sqrt(t[u]):
t[u])/15.5,y,4*u);return[y,m,31]};q._isHorizontalOrVertical=function(g){return"vertical"===g||"horizontal"===g||"cross"===g||"esriSFSCross"===g||"esriSFSVertical"===g||"esriSFSHorizontal"===g};return q}(),r=function(){function q(){}q.findApplicableOverrides=function(g,l,n){if(l){if(g.primitiveName){let u=!1;for(const t of n)if(t.primitiveName===g.primitiveName){u=!0;break}if(!u)for(const t of l)t.primitiveName===g.primitiveName&&n.push(t)}switch(g.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(g.effects)for(const u of g.effects)q.findApplicableOverrides(u,
l,n);if(g.symbolLayers)for(const u of g.symbolLayers)q.findApplicableOverrides(u,l,n);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(g.effects)for(const u of g.effects)q.findApplicableOverrides(u,l,n);g.markerPlacement&&q.findApplicableOverrides(g.markerPlacement,l,n);if("CIMVectorMarker"===g.type){if(g.markerGraphics)for(const u of g.markerGraphics)q.findApplicableOverrides(u,
l,n),q.findApplicableOverrides(u.symbol,l,n)}else"CIMCharacterMarker"===g.type?q.findApplicableOverrides(g.symbol,l,n):"CIMHatchFill"===g.type&&q.findApplicableOverrides(g.lineSymbol,l,n)}}};q.applyOverrides=function(g,l,n,u){if(l){if(g.primitiveName)for(const m of l)if(m.primitiveName===g.primitiveName){var t=(t=m.propertyName)?t.charAt(0).toLowerCase()+t.substr(1):t;u&&u.push({cim:g,nocapPropertyName:t,value:g[t]});m.expression&&(m.value=q.toValue(m.propertyName,m.expression));if(n){let w=!1;for(const v of n)v.primitiveName===
g.primitiveName&&(w=!0);w||n.push(m)}g[t]=m.value}switch(g.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(g.effects)for(const m of g.effects)q.applyOverrides(m,l,n,u);if(g.symbolLayers)for(const m of g.symbolLayers)q.applyOverrides(m,l,n,u);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(g.effects)for(const m of g.effects)q.applyOverrides(m,l,n,u);if("CIMVectorMarker"===g.type&&g.markerGraphics)for(const m of g.markerGraphics)q.applyOverrides(m,
l,n,u),q.applyOverrides(m.symbol,l,n,u)}}};q.restoreOverrides=function(g){for(const l of g)l.cim[l.nocapPropertyName]=l.value};q.buildOverrideKey=function(g){let l="";for(const n of g)void 0!==n.value&&(l+=`${n.primitiveName}${n.propertyName}${JSON.stringify(n.value)}`);return l};q.toValue=function(g,l){return"DashTemplate"===g?l.split(" ").map(n=>Number(n)):"Color"===g?(g=(new F(l)).toRgba(),g[3]*=255,g):l};return q}();x.CIMSymbolHelper=E;x.OverrideHelper=r;x.SymbolHelper=f;Object.defineProperty(x,
"__esModule",{value:!0})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],function(x){let F=function(){function B(){this.setIdentity()}var k=B.prototype;k.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,this.rz_c);return this.rz};k.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};k.setTranslate=function(h,a){this.tx=h;this.ty=a};k.setTranslateZ=function(h){this.tz=
h};k.setRotateCS=function(h,a){this.rz=void 0;this.rz_c=h;this.rz_s=a};k.setRotate=function(h){this.rz=h;this.rz_s=this.rz_c=void 0};k.setRotateY=function(h){this.ry=h};k.setScale=function(h){this.s=h};k.setMeasure=function(h){this.m=h};return B}(),E=function(){function B(){}B.prototype.next=function(){return null};return B}();x.EmptyPlacementCursor=E;x.Placement=F;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/Logger ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/jsonUtils ./CIMEffects ./CIMOperators ./CIMPlacements ./Rect".split(" "),
function(x,F,E,B,k,h,a,d,c,b){const e=Math.PI/180,f=E.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let r=function(){function n(t){this._t=t}n.createIdentity=function(){return new n([1,0,0,0,1,0])};var u=n.prototype;u.clone=function(){return new n(this._t.slice())};u.transform=function(t){const m=this._t;return[m[0]*t[0]+m[1]*t[1]+m[2],m[3]*t[0]+m[4]*t[1]+m[5]]};n.createScale=function(t,m){return new n([t,0,0,0,m,0])};u.scale=function(t,m){const w=this._t;w[0]*=t;w[1]*=t;w[2]*=t;w[3]*=m;w[4]*=
m;w[5]*=m;return this};u.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};n.createTranslate=function(t,m){return new n([0,0,t,0,0,m])};u.translate=function(t,m){const w=this._t;w[2]+=t;w[5]+=m;return this};n.createRotate=function(t){const m=Math.cos(t);t=Math.sin(t);return new n([m,-t,0,t,m,0])};u.rotate=function(t){return this.multiply(n.createRotate(t))};u.multiply=function(t){const m=this._t;t=t._t;const w=m[1]*t[0]+m[4]*t[1],v=m[2]*t[0]+m[5]*t[1]+t[2],C=m[0]*
t[3]+m[3]*t[4],A=m[1]*t[3]+m[4]*t[4],y=m[2]*t[3]+m[5]*t[4]+t[5];m[0]=m[0]*t[0]+m[3]*t[1];m[1]=w;m[2]=v;m[3]=C;m[4]=A;m[5]=y;return this};return n}();E=function(){function n(t){this._transfos=[];this._sizeTransfos=[];this._transfos.push(t||r.createIdentity());this._sizeTransfos.push(t?t.scaleRatio():1)}var u=n.prototype;u.transformPt=function(t){return this._transfos[this._transfos.length-1].transform(t)};u.transformSize=function(t){return t*this._sizeTransfos[this._sizeTransfos.length-1]};u.back=
function(){return this._transfos[this._transfos.length-1]};u.push=function(t,m){m=m?t.scaleRatio():1;t.multiply(this.back());this._transfos.push(t);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*m)};u.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};u.drawSymbol=function(t,m){if(t)switch(t.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(t,m)}};u.drawMultiLayerSymbol=function(t,m){if(t){var w=t.symbolLayers;
if(w)if(t=t.effects){if(m=this.executeEffects(t,m))for(t=m.next();t;)this.drawSymbolLayers(w,t),t=m.next()}else this.drawSymbolLayers(w,m)}};u.executeEffects=function(t,m){m=new a.SimpleGeometryCursor(m);for(const w of t)(t=d.getEffectOperator(w))&&(m=t.execute(m,w,1));return m};u.drawSymbolLayers=function(t,m){let w=t.length;for(;w--;){const C=t[w];if(C&&!1!==C.enable){var v=C.effects;if(v){if(v=this.executeEffects(v,m)){let A=v.next();for(;A;)this.drawSymbolLayer(C,A),A=v.next()}}else this.drawSymbolLayer(C,
m)}}};u.drawSymbolLayer=function(t,m){switch(t.type){case "CIMSolidFill":this.drawSolidFill(m,t.color);break;case "CIMHatchFill":this.drawHatchFill(t,m);break;case "CIMSolidStroke":this.drawSolidStroke(m,t.color,t.width,t.capStyle,t.joinStyle,t.miterLimit);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(t,m)}};u.drawHatchFill=function(t,m){const w=this._buildHatchPolyline(t,m,1);w&&(this.pushClipPath(m),this.drawMultiLayerSymbol(t.lineSymbol,w),
this.popClipPath())};u.drawMarkerLayer=function(t,m){var w=t.markerPlacement;if(w){const C=d.getPlacementOperator(w);if(C){var v="CIMMarkerPlacementInsidePolygon"===w.type;v&&this.pushClipPath(m);if(m=C.execute(m,w,1))for(w=m.next();w;)this.drawMarker(t,w),w=m.next();v&&this.popClipPath()}}else v=new c.Placement,v.tx=m.x,v.ty=m.y,this.drawMarker(t,v)};u.drawMarker=function(t,m){switch(t.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(t,m);break;case "CIMVectorMarker":this.drawVectorMarker(t,
m)}};u.drawPictureMarker=function(t,m){if(t){var w=t.size||10,v=r.createIdentity(),C=t.anchorPoint;if(C){let A=C.x;C=C.y;"Absolute"!==t.anchorPointUnits&&(A*=w,C*=w);v.translate(-A,-C)}t.rotation&&v.rotate(t.rotation*e);v.translate(t.offsetX||0,t.offsetY||0);v.translate(m.tx,m.ty);this.push(v,!1);this.drawImage(t.url,w,t.scaleX);this.pop()}};u.drawVectorMarker=function(t,m){if(t){var w=t.markerGraphics;if(w){var v=t.size,C=t.frame,A=C?C.ymax-C.ymin:0;v=v&&A?v/A:1;A=r.createIdentity();C&&A.translate(.5*
-(C.xmax+C.xmin),.5*-(C.ymax+C.ymin));var y=t.anchorPoint;if(y){let p=y.x;y=y.y;"Absolute"!==t.anchorPointUnits?C&&(p*=C.xmax-C.xmin,y*=C.ymax-C.ymin):(p/=v,y/=v);A.translate(-p,-y)}1!==v&&A.scale(v,v);t.rotation&&A.rotate(t.rotation*e);A.translate(t.offsetX||0,t.offsetY||0);A.translate(m.tx,m.ty);this.push(A,t.scaleSymbolsProportionally);for(const p of w)p&&p.symbol&&p.geometry||f.error("Invalid marker graphic",p),this.drawSymbol(p.symbol,p.geometry);this.pop()}}};u._buildHatchPolyline=function(t,
m,w){var v=(void 0!==t.separation?t.separation:4)*w,C=void 0!==t.rotation?t.rotation:0;if(0===v)return null;0>v&&(v=-v);for(var A=0,y=.5*v;A>y;)A-=v;for(;A<-y;)A+=v;A=B.create();k.getBoundsXY(A,m);A[0]-=y;A[1]-=y;A[2]+=y;A[3]+=y;for(var p=[[A[0],A[1]],[A[0],A[3]],[A[2],A[3]],[A[2],A[1]]];180<C;)C-=180;for(;0>C;)C+=180;y=Math.cos(C*e);var z=Math.sin(C*e);C=-v*z;m=v*y;A=(void 0!==t.offsetX?t.offsetX*w:0)*z-(void 0!==t.offsetY?t.offsetY*w:0)*y;let D;var G=t=Number.MAX_VALUE;D=w=-Number.MAX_VALUE;for(var I of p){var K=
I[0];const N=I[1];p=y*K+z*N;K=-z*K+y*N;G=Math.min(G,p);t=Math.min(t,K);D=Math.max(D,p);w=Math.max(w,K)}t=Math.floor(t/v)*v;I=y*G-z*t-C*A/v;G=z*G+y*t-m*A/v;p=y*D-z*t-C*A/v;A=z*D+y*t-m*A/v;v=1+Math.round((w-t)/v);y=[];for(z=0;z<v;z++)I+=C,G+=m,p+=C,A+=m,y.push([[I,G],[p,A]]);return{paths:y}};return n}();let q=function(n){function u(){var m=n.call(this)||this;m.reset();return m}F._inheritsLoose(u,n);var t=u.prototype;t.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=
0};t.envelope=function(){return new b(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};t.drawSolidFill=function(m){!m||0<this._clipCount||(h.isPolygon(m)?this._processPath(m.rings,0):h.isPolyline(m)?this._processPath(m.paths,0):h.isExtent(m)&&(m=l(m))&&this._processPath(m.rings,0))};t.drawSolidStroke=function(m,w,v){!m||0<this._clipCount||(w=.5*this.transformSize(v),h.isPolygon(m)?this._processPath(m.rings,w):h.isPolyline(m)?this._processPath(m.paths,w):h.isExtent(m)&&(m=l(m))&&
this._processPath(m.rings,w))};t.pushClipPath=function(m){this.drawSolidFill(m);++this._clipCount};t.popClipPath=function(){--this._clipCount};t.drawImage=function(m,w,v){m=w/2;this._merge(this.transformPt([0,0]),m)};t._processPath=function(m,w){if(m)for(const v of m)if(m=v?v.length:0,1<m){this._merge(this.transformPt(v[0]),w);for(let C=1;C<m;++C)this._merge(this.transformPt(v[C]),w)}};t._merge=function(m,w){m[0]-w<this._xmin&&(this._xmin=m[0]-w);m[0]+w>this._xmax&&(this._xmax=m[0]+w);m[1]-w<this._ymin&&
(this._ymin=m[1]-w);m[1]+w>this._ymax&&(this._ymax=m[1]+w)};return u}(E),g=function(n){function u(m,w){w=n.call(this,w)||this;w._ctx=m;return w}F._inheritsLoose(u,n);var t=u.prototype;t.drawSolidFill=function(m,w){if(m){if(h.isPolygon(m))this._buildPath(m.rings,!0);else if(h.isPolyline(m))this._buildPath(m.paths,!0);else if(h.isExtent(m))this._buildPath(l(m).rings,!0);else return;m=this._ctx;m.fillStyle="string"===typeof w?w:"rgba("+Math.round(w[0])+","+Math.round(w[1])+","+Math.round(w[2])+","+w[3]/
255+")";m.fill("evenodd")}};t.drawSolidStroke=function(m,w,v,C,A,y){if(m&&w&&0!==v){if(h.isPolygon(m))this._buildPath(m.rings,!0);else if(h.isPolyline(m))this._buildPath(m.paths,!1);else if(h.isExtent(m))this._buildPath(l(m).rings,!0);else return;m=this._ctx;m.strokeStyle="string"===typeof w?w:"rgba("+Math.round(w[0])+","+Math.round(w[1])+","+Math.round(w[2])+","+w[3]/255+")";m.lineWidth=this.transformSize(v)+.5;this._setCapStyle(C);this._setJoinStyle(A);m.miterLimit=y;m.stroke()}};t.pushClipPath=
function(m){this._ctx.save();if(h.isPolygon(m))this._buildPath(m.rings,!0);else if(h.isPolyline(m))this._buildPath(m.paths,!0);else if(h.isExtent(m))this._buildPath(l(m).rings,!0);else return;this._ctx.clip("evenodd")};t.popClipPath=function(){this._ctx.restore()};t.drawImage=function(m,w,v){};t._buildPath=function(m,w){const v=this._ctx;v.beginPath();if(m)for(const C of m)if(m=C?C.length:0,1<m){let A=this.transformPt(C[0]);v.moveTo(A[0],A[1]);for(let y=1;y<m;++y)A=this.transformPt(C[y]),v.lineTo(A[0],
A[1]);w&&v.closePath()}};t._setCapStyle=function(m){switch(m){case "Butt":this._ctx.lineCap="butt";break;case "Round":this._ctx.lineCap="round";break;case "Square":this._ctx.lineCap="square"}};t._setJoinStyle=function(m){switch(m){case "Bevel":this._ctx.lineJoin="bevel";break;case "Round":this._ctx.lineJoin="round";break;case "Miter":this._ctx.lineJoin="miter"}};return u}(E);const l=n=>n?{spatialReference:n.spatialReference,rings:[[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,
n.ymin]]]}:null;x.CIMSymbolDrawHelper=E;x.C_DEG_TO_RAD=e;x.CanvasDrawHelper=g;x.EnvDrawHelper=q;x.Transformation=r;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang"],function(x,F){let E=function(){function B(k){this._geometry=k}B.prototype.next=function(){const k=this._geometry;this._geometry=null;return k};return B}();x.SimpleGeometryCursor=E;x.clone=function(B){return F.clone(B)};Object.defineProperty(x,"__esModule",
{value:!0})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n,u,t,m,w){x.getEffectOperator=function(v){if(!v)return null;switch(v.type){case "CIMGeometricEffectAddControlPoints":return F.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return E.EffectArrow.local();case "CIMGeometricEffectBuffer":return B.EffectBuffer.local();case "CIMGeometricEffectCut":return k.EffectCut.local();case "CIMGeometricEffectDashes":return h.EffectDashes.local();case "CIMGeometricEffectDonut":return a.EffectDonut.local();case "CIMGeometricEffectJog":return d.EffectJog.local();
case "CIMGeometricEffectMove":return c.EffectMove.local();case "CIMGeometricEffectOffset":return b.EffectOffset.local();case "CIMGeometricEffectReverse":return e.EffectReverse.local();case "CIMGeometricEffectRotate":return f.EffectRotate.local();case "CIMGeometricEffectScale":return r.EffectScale.local();case "CIMGeometricEffectWave":return q.EffectWave.local()}return null};x.getPlacementOperator=function(v){if(!v)return null;switch(v.type){case "CIMMarkerPlacementAlongLineSameSize":return g.PlacementAlongLineSameSize.local();
case "CIMMarkerPlacementAtExtremities":return l.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return n.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return u.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return t.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return m.PlacementOnVertices.local();case "CIMMarkerPlacementPolygonCenter":return w.PlacementPolygonCenter.local()}return null};Object.defineProperty(x,"__esModule",
{value:!0})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(x,F,E,B){let k=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(d,c,b){return new h(d,c,b)};return a}();k.instance=null;let h=function(){function a(c,b,e){this._inputGeometries=c;this._angleTolerance=void 0!==b.angleTolerance?b.angleTolerance:
120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var d=a.prototype;d.next=function(){for(var c=this._inputGeometries.next();c;){if(E.isPolygon(c))return this._isClosed=!0,c=F.clone(c),this._processMultipath(c.rings),c;if(E.isPolyline(c))return this._isClosed=!1,c=F.clone(c),this._processMultipath(c.paths),c;if(E.isExtent(c)){if(this._maxCosAngle)return c;this._isClosed=!0;c=[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]];this._processPath(c);
return{rings:[c]}}c=this._inputGeometries.next()}return null};d._processMultipath=function(c){if(c)for(const b of c)this._processPath(b)};d._processPath=function(c){if(c){let b=c.length,e=c[0],f,r,q,g,l,n;this._isClosed&&++b;for(let u=1;u<b;++u){let t;t=this._isClosed&&u===b-1?c[0]:c[u];const m=t[0]-e[0],w=t[1]-e[1],v=Math.sqrt(m*m+w*w);1<u&&0<v&&0<q&&(f*m+r*w)/v/q<=this._maxCosAngle&&B.setId(e,1);1===u&&(g=m,l=w,n=v);0<v&&(e=t,f=m,r=w,q=v)}this._isClosed&&0<q&&0<n&&(f*g+r*l)/n/q<=this._maxCosAngle&&
B.setId(c[0],1)}};return a}();x.EffectAddControlPoints=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(x,F,E,B){function k(q){if(q){var g=q.length;for(--g;0<g;--g)q[g][0]-=q[g-1][0],q[g][1]-=q[g-1][1]}}function h(q){if(q)for(const g of q)k(g)}function a(q){if(q){const g=q.length;for(let l=1;l<g;++l)q[l][0]+=q[l-1][0],q[l][1]+=q[l-1][1]}}function d(q){if(q)for(const g of q)a(g)}
function c(q){q&&(E.isPolygon(q)?d(q.rings):E.isPolyline(q)?d(q.paths):E.isMultipoint(q)&&a(q.points))}function b(q){q&&q.reverse()}function e(q){return{rings:[[[q.xmin,q.ymin],[q.xmin,q.ymax],[q.xmax,q.ymax],[q.xmax,q.ymin],[q.xmin,q.ymin]]]}}let f=function(){function q(g,l,n,u){this.acceptPolygon=l;this.acceptPolyline=n;this.geomUnitsPerPoint=u;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;g&&(E.isPolygon(g)?l&&(this.multiPath=g.rings,this.isClosed=!0):E.isPolyline(g)?n&&(this.multiPath=
g.paths,this.isClosed=!1):E.isExtent(g)&&l&&(this.multiPath=e(g).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new B.Placement}q.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const g=this.processPath(this.multiPath[this.pathIndex]);if(g)return g}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return q}(),r=function(){function q(g,
l,n,u){this.inputGeometries=g;this.acceptPolygon=l;this.acceptPolyline=n;this.geomUnitsPerPoint=u;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}q.prototype.next=function(){for(;;){if(!this.multiPath){for(var g=this.inputGeometries.next();g;)if(E.isPolygon(g)?this.acceptPolygon&&(this.multiPath=g.rings,this.isClosed=!0):E.isPolyline(g)?this.acceptPolyline&&(this.multiPath=g.paths,this.isClosed=!1):E.isExtent(g)&&this.acceptPolygon&&(this.multiPath=e(g).rings,this.isClosed=!0),this.multiPath){this.pathCount=
this.multiPath.length;this.pathIndex=-1;break}else g=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,g=this.processPath(this.multiPath[this.pathIndex]))return g;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return q}();x.PathGeometryCursor=r;x.PathTransformationCursor=f;x.cloneAndDecodeGeometry=function(q){q=F.clone(q);c(q);return q};x.deltaDecodeGeometry=c;x.deltaEncodeGeometry=function(q){q&&
(E.isPolygon(q)?h(q.rings):E.isPolyline(q)?h(q.paths):E.isMultipoint(q)&&k(q.points))};x.getCoord2D=function(q,g,l){return[q[0]+(g[0]-q[0])*l,q[1]+(g[1]-q[1])*l]};x.getId=function(q){return q[4]};x.isClosedPath=function(q){return q&&0!==q.length?q[0][0]===q[q.length-1][0]&&q[0][1]===q[q.length-1][1]:!1};x.reverseMultipath=function(q){if(q)for(const g of q)b(g)};x.reversePath=b;x.setId=function(q,g){q[4]=g};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(x,F,E,B){let k=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(d,c,b){return new h(d,c,b)};return a}();k.instance=null;let h=function(a){function d(b,e,f){b=a.call(this,b,!1,!0)||this;b._curveHelper=new B.CurveHelper;b._width=(void 0!==e.width?e.width:5)*f;b._arrowType=void 0!==e.geometricEffectArrowType?e.geometricEffectArrowType:
"OpenEnded";b._offsetFlattenError=B.PIXEL_TOLERANCE*f;return b}F._inheritsLoose(d,a);var c=d.prototype;c.processPath=function(b){switch(this._arrowType){default:return this._constructSimpleArrow(b,!0);case "Block":return this._constructSimpleArrow(b,!1);case "Crossed":return this._constructCrossedArrow(b)}};c._constructSimpleArrow=function(b,e){var f=this._curveHelper.calculatePathLength(b),r=this._width;f<2*r&&(r=f/2);f=this._curveHelper.getSubCurve(b,0,f-r);if(!f)return null;var q=r/2;if(this._curveHelper.isEmpty(f,
!1))return null;r=this._constructOffset(f,-q);if(!r)return null;f=this._constructOffset(f,q);if(!f)return null;const g=this._constructArrowBasePoint(r,-q/2);if(!g)return null;q=this._constructArrowBasePoint(f,q/2);if(!q)return null;b=b[b.length-1];e||(this._makeControlPoint(f,!0),this._makeControlPoint(r,!0));const l=new B.PathHelper;l.addPath(f,!0);l.lineTo(q);this._makeControlPoint(l.path());l.lineTo(b);this._makeControlPoint(l.path());l.lineTo(g);this._makeControlPoint(l.path());l.addPath(r,!1);
return e?{paths:[l.path()]}:(l.close(),{rings:[l.path()]})};c._constructCrossedArrow=function(b){var e=this._curveHelper.calculatePathLength(b),f=this._width;e<3.732050807568877*f&&(f=e/3.732050807568877);var r=this._curveHelper.getSubCurve(b,0,e-2.732050807568877*f);if(!r)return null;var q=f/2;if(this._curveHelper.isEmpty(r,!1))return null;const g=this._constructOffset(r,q);if(!g)return null;r=this._constructOffset(r,-q);if(!r)return null;e=this._curveHelper.getSubCurve(b,0,e-f);if(!e||this._curveHelper.isEmpty(e,
!1))return null;f=this._constructOffset(e,q);if(!f)return null;var l=this._constructOffset(e,-q);if(!l)return null;e=f[f.length-1];f=this._constructArrowBasePoint(f,q/2);if(!f)return null;const n=l[l.length-1];q=this._constructArrowBasePoint(l,-q/2);if(!q)return null;b=b[b.length-1];this._makeControlPoint(g,!1);this._makeControlPoint(r,!1);l=new B.PathHelper;l.addPath(g,!0);this._makeControlPoint(l.path());l.lineTo(n);l.lineTo(q);this._makeControlPoint(l.path());l.lineTo(b);this._makeControlPoint(l.path());
l.lineTo(f);this._makeControlPoint(l.path());l.lineTo(e);this._makeControlPoint(l.path());l.addPath(r,!1);return{paths:[l.path()]}};c._constructOffset=function(b,e){return this._curveHelper.offset(b,e,"Rounded",4,this._offsetFlattenError)};c._constructArrowBasePoint=function(b,e){if(!b||2>b.length)return null;var f=b[b.length-2];b=b[b.length-1];f=[b[0]-f[0],b[1]-f[1]];this._curveHelper.normalize(f);return[b[0]+f[1]*e,b[1]-f[0]*e]};c._makeControlPoint=function(b,e=!1){e?E.setId(b[0],1):E.setId(b[b.length-
1],1)};return d}(E.PathGeometryCursor);x.EffectArrow=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/CurveHelper":function(){define(["exports"],function(x){let F=function(){function B(){this._path=[]}var k=B.prototype;k.path=function(){return this._path};k.addPath=function(h,a){a||h.reverse();Array.prototype.push.apply(this._path,h);a||h.reverse()};B.mergePath=function(h,a){a&&Array.prototype.push.apply(h,a)};k.startPath=function(h){this._path.push(h)};k.lineTo=function(h){this._path.push(h)};
k.close=function(){const h=this._path;1<h.length&&(h[0][0]!==h[h.length-1][0]||h[0][1]!==h[h.length-1][1])&&h.push([h[0][0],h[0][1]])};return B}(),E=function(){function B(h,a){}var k=B.prototype;k.normalize=function(h){const a=Math.sqrt(h[0]*h[0]+h[1]*h[1]);h[0]/=a;h[1]/=a};k.calculateLength=function(h,a){const d=a[0]-h[0];h=a[1]-h[1];return Math.sqrt(d*d+h*h)};k.calculateSegLength=function(h,a){return this.calculateLength(h[a],h[a+1])};k.calculatePathLength=function(h){let a=0;const d=h?h.length:
0;for(let c=0;c<d-1;++c)a+=this.calculateSegLength(h,c);return a};k.calculatePathArea=function(h){let a=0;const d=h?h.length:0;for(let c=0;c<d-1;++c)a+=(h[c+1][0]-h[c][0])*(h[c+1][1]+h[c][1]);return a/2};k.getCoord2D=function(h,a,d){return[h[0]+(a[0]-h[0])*d,h[1]+(a[1]-h[1])*d]};k.getSegCoord2D=function(h,a,d){return this.getCoord2D(h[a],h[a+1],d)};k.getAngle=function(h,a,d){return Math.atan2(a[1]-h[1],a[0]-h[0])};k.getSegAngle=function(h,a,d){return this.getAngle(h[a],h[a+1],d)};k.getAngleCS=function(h,
a,d){d=a[0]-h[0];h=a[1]-h[1];a=Math.sqrt(d*d+h*h);return 0<a?[d/a,h/a]:[1,0]};k.getSegAngleCS=function(h,a,d){return this.getAngleCS(h[a],h[a+1],d)};k.cut=function(h,a,d,c){d=0>=d?h[a]:this.getSegCoord2D(h,a,d);h=1<=c?h[a+1]:this.getSegCoord2D(h,a,c);return[d,h]};k.addSegment=function(h,a,d){d&&h.push(a[0]);h.push(a[1])};k.getSubCurve=function(h,a,d){const c=[];return this.appendSubCurve(c,h,a,d)?c:null};k.appendSubCurve=function(h,a,d,c){const b=a?a.length-1:0;let e=0,f=!0,r=0;for(;r<b;){const g=
this.calculateSegLength(a,r);if(0!==g){if(f){if(e+g>d){var q=(d-e)/g;let l=1,n=!1;e+g>=c&&(l=(c-e)/g,n=!0);(q=this.cut(a,r,q,l))&&this.addSegment(h,q,f);if(n)break;f=!1}}else{if(e+g>c){(a=this.cut(a,r,0,(c-e)/g))&&this.addSegment(h,a,f);break}this.addSegment(h,[a[r],a[r+1]],f)}e+=g}++r}return!0};k.getCIMPointAlong=function(h,a){const d=h?h.length-1:0;let c=0,b=-1;for(;b<d;){++b;const e=this.calculateSegLength(h,b);if(0!==e){if(c+e>a)return this.getCoord2D(h[b],h[b+1],(a-c)/e);c+=e}}return null};k.isEmpty=
function(h,a){if(!h||1>=h.length)return!0;const d=h?h.length-1:0;let c=-1;for(;c<d;)if(++c,h[c+1][0]!==h[c][0]||h[c+1][1]!==h[c][1]||a&&h[c+1][2]!==h[c][2])return!1;return!0};k.offset=function(h,a,d,c,b){if(!h||2>h.length)return null;b=h.length;const e=h[0][0]===h[b-1][0]&&h[0][1]===h[b-1][1];if(e){if(3>h.length)return null;--b}const f=[];var r=e?h[b-1]:null;let q=h[0];for(let u=0;u<b;u++){const t=u===b-1?e?h[0]:null:h[u+1];if(r)if(t){var g=[t[0]-q[0],t[1]-q[1]];this.normalize(g);r=[q[0]-r[0],q[1]-
r[1]];this.normalize(r);var l=r[0]*g[1]-r[1]*g[0],n=r[0]*g[0]+r[1]*g[1];if(0<=l===0>=a)g=[g[0]-r[0],g[1]-r[1]],this.normalize(g),r=-Math.abs(a)/Math.sqrt((1+n)/2),f.push([q[0]-g[0]*r,q[1]-g[1]*r]);else switch(d){case "Mitered":if(n=Math.sqrt((1+n)/2),0<n&&1/n<c){g=[g[0]-r[0],g[1]-r[1]];this.normalize(g);r=Math.abs(a)/n;f.push([q[0]-g[0]*r,q[1]-g[1]*r]);break}case "Bevelled":f.push([q[0]+r[1]*a,q[1]-r[0]*a]);f.push([q[0]+g[1]*a,q[1]-g[0]*a]);break;case "Rounded":f.push([q[0]+r[1]*a,q[1]-r[0]*a]);n=
.2;for(l=1;5>l;l++,n+=.2){const m=[r[1]*(1-n)+g[1]*n,-r[0]*(1-n)-g[0]*n];this.normalize(m);f.push([q[0]+m[0]*a,q[1]+m[1]*a])}f.push([q[0]+g[1]*a,q[1]-g[0]*a]);break;default:0>l?(f.push([q[0]+(r[1]+r[0])*a,q[1]+(r[1]-r[0])*a]),f.push([q[0]+(g[1]-g[0])*a,q[1]-(g[0]+g[1])*a])):(n=Math.sqrt((1+Math.abs(n))/2),g=[g[0]-r[0],g[1]-r[1]],this.normalize(g),r=a/n,f.push([q[0]-g[0]*r,q[1]-g[1]*r]))}}else g=[q[0]-r[0],q[1]-r[1]],this.normalize(g),f.push([q[0]+g[1]*a,q[1]-g[0]*a]);else g=[t[0]-q[0],t[1]-q[1]],
this.normalize(g),f.push([q[0]+g[1]*a,q[1]-g[0]*a]);r=q;q=t}e&&f.push([f[0][0],f[0][1]]);return f};return B}();x.CurveHelper=E;x.PIXEL_TOLERANCE=.03;x.PathHelper=F;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(x,F,E){let B=function(){function h(){}h.local=function(){null===h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(a,d,c){return new k(a,
d,c)};return h}();B.instance=null;let k=function(){function h(a,d,c){this._inputGeometries=a;this._curveHelper=new E.CurveHelper;this._size=(void 0!==d.size?d.size:1)*c;this._offsetFlattenError=E.PIXEL_TOLERANCE*c}h.prototype.next=function(){let a=this._inputGeometries.next();for(;a;){if(F.isExtent(a))if(0<this._size){var d=this._curveHelper.offset([[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]],this._size,"Rounded",4,this._offsetFlattenError);if(d)return{rings:[d]}}else if(0>
this._size){if(0<Math.min(a.xmax-a.xmin,a.ymax-a.ymin)+2*this._size)return{xmin:a.xmin-this._size,xmax:a.xmax+this._size,ymin:a.ymin-this._size,ymax:a.ymax+this._size}}else return a;if(F.isPolygon(a)){if(0===this._size)return a;d=[];for(const b of a.rings){var c=this._curveHelper.offset(b,this._size,"Rounded",4,this._offsetFlattenError);c&&d.push(c)}if(d.length)return{rings:d}}if(F.isPolyline(a)&&0<this._size){d=[];for(const b of a.paths)if(b&&1<b.length){c=this._curveHelper.offset(b,this._size,"Rounded",
4,this._offsetFlattenError);const e=this._curveHelper.offset(b,-this._size,"Rounded",4,this._offsetFlattenError);if(c&&e){for(let f=e.length-1;0<=f;f--)c.push(e[f]);c.push([c[0][0],c[0][1]]);d.push(c)}}if(d.length)return{rings:d}}F.isPoint(a);a=this._inputGeometries.next()}return null};return h}();x.EffectBuffer=B;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],
function(x,F,E,B){let k=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(d,c,b){return new h(d,c,b)};return a}();k.instance=null;let h=function(a){function d(c,b,e){c=a.call(this,c,!0,!0)||this;c._curveHelper=new B.CurveHelper;c._beginCut=(void 0!==b.beginCut?b.beginCut:1)*e;c._endCut=(void 0!==b.endCut?b.endCut:1)*e;c._middleCut=(void 0!==b.middleCut?b.middleCut:0)*e;c._invert=void 0!==b.invert?b.invert:!1;0>c._beginCut&&
(c._beginCut=0);0>c._endCut&&(c._endCut=0);0>c._middleCut&&(c._middleCut=0);return c}F._inheritsLoose(d,a);d.prototype.processPath=function(c){var b=this._beginCut;const e=this._endCut,f=this._middleCut,r=this._curveHelper.calculatePathLength(c),q=[];if(!this._invert)0===b&&0===e&&0===f?q.push(c):b+e+f>=r||(0===f?(c=this._curveHelper.getSubCurve(c,b,r-e))&&q.push(c):((b=this._curveHelper.getSubCurve(c,b,.5*(r-f)))&&q.push(b),(b=this._curveHelper.getSubCurve(c,.5*(r+f),r-e))&&q.push(b)));else if(0!==
b||0!==e||0!==f)b+e+f>=r?q.push(c):((b=this._curveHelper.getSubCurve(c,0,b))&&q.push(b),(b=this._curveHelper.getSubCurve(c,.5*(r-f),.5*(r+f)))&&q.push(b),(b=this._curveHelper.getSubCurve(c,r-e,e))&&q.push(b));return 0===q.length?null:{paths:q}};return d}(E.PathGeometryCursor);x.EffectCut=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDashes":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../GeometryWalker"],
function(x,F,E,B,k){let h=function(){function d(){}d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(c,b,e){return new a(c,b,e)};return d}();h.instance=null;let a=function(d){function c(b,e,f){b=d.call(this,b,!0,!0)||this;b._walker=new k.GeometryWalker;b._walker.updateTolerance(f);b._endings=e.lineDashEnding;b._customDashPos=void 0!==e.offsetAlongLine?e.offsetAlongLine*f:0;b._offsetAtEnd=void 0!==e.customEndingOffset?e.customEndingOffset*f:0;
b._pattern=new k.DashPattern;b._pattern.init(e.dashTemplate,!0);b._pattern.scale(f);return b}F._inheritsLoose(c,d);c.prototype.processPath=function(b){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[b]};if(!this.iteratePath){var e=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case "FullPattern":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case "FullGap":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case "NoConstraint":this.isClosed||
(e=!1);break;case "Custom":this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var f=this._walker.calculatePathLength(b);if(this._pattern.isEmpty()||f<.1*this._pattern.length()||!this._walker.init(b,this._pattern,e))return{paths:[b]}}if(this.iteratePath)b=this._pattern.nextValue();else{switch(this._endings){default:e=.5*this._pattern.firstValue();break;case "HalfGap":e=.5*-this._pattern.lastValue();break;case "FullGap":e=-this._pattern.lastValue();break;case "FullPattern":e=0;break;case "NoConstraint":case "Custom":e=
-this._customDashPos}b=e/this._pattern.length();b-=Math.floor(b);e=b*this._pattern.length();this._pattern.reset();b=this._pattern.nextValue();for(f=!1;e>=b;)e-=b,b=this._pattern.nextValue(),f=!f;b-=e;f?(this._walker.nextPosition(b),b=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(b),b=this._pattern.nextValue(),this._walker.nextPosition(b),b=this._pattern.nextValue())}(e=this._walker.nextCurve(b))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,
1),B.PathHelper.mergePath(e,this._firstCurve),this._firstCurve=null)):(b=this._pattern.nextValue(),!this._walker.nextPosition(b)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(e=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,e=this._firstCurve,this._firstCurve=null);return{paths:[e]}};return c}(E.PathGeometryCursor);x.EffectDashes=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(x,F,E,B){let k=function(){function d(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var c=d.prototype;c.isEmpty=function(){return 0===this._values.length};c.size=function(){return this._values.length};c.init=function(b,e,f=!0){this._setEmpty();if(!b||0===b.length)return!1;for(let r=0;r<b.length;r++){let q=Math.abs(b[r]);f&&1E-7>q&&(q=1E-7);this._values.push(q);this._length+=q}e&&b.length&
1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};c.scale=function(b){const e=this._values?this._values.length:0;for(let f=0;f<e;++f)this._values[f]*=b;this._length*=b;this.extPtGap*=b;this.ctrlPtGap*=b};c.addValue=function(b){this._length+=b;this._values.push(b)};c.firstValue=function(){return this._values[0]};c.lastValue=function(){return this._values[this._values.length-1]};c.nextValue=function(){this._currentValue++;this._currentValue===
this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};c.reset=function(){this._currentValue=-1};c.length=function(){return this._length};c._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return d}(),h=function(){function d(){this.reset()}var c=d.prototype;c.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};c.isValid=function(){return-1!==this.segment};c.copyTo=
function(b){b.segment=this.segment;b.segmentLength=this.segmentLength;b.abscissa=this.abscissa;b.isPathEnd=this.isPathEnd;b.isPartEnd=this.isPartEnd};return d}(),a=function(d){function c(e=0,f=!1){e=d.call(this,e,f)||this;e._tolerance=B.PIXEL_TOLERANCE;e._currentPosition=new h;return e}F._inheritsLoose(c,d);var b=c.prototype;b.updateTolerance=function(e){this._tolerance=B.PIXEL_TOLERANCE*e};b.init=function(e,f,r=!0){r?(this._patternLength=f.length(),this._partExtPtGap=f.extPtGap,this._partCtrlPtGap=
f.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=e;this._seg=-1;return this.setPosAtNextPart()};b.curPositionIsValid=function(){return this._currentPosition.isValid()};b.nextPosition=function(e,f=0){const r=new h;if(!this._nextPosition(e,r,null,f))return!1;r.copyTo(this._currentPosition);return!0};b.curPointAndAngle=function(e){e.pt=this._getPoint(this._currentPosition);const [f,r]=this._getAngle(this._currentPosition);
e.ca=f;e.sa=r};b.nextPointAndAngle=function(e,f,r=0){const q=new h;if(!this._nextPosition(e,q,null,r))return!1;q.copyTo(this._currentPosition);f.pt=this._getPoint(q);const [g,l]=this._getAngle(q);f.ca=g;f.sa=l;return!0};b.nextCurve=function(e){if(0===e)return null;const f=[],r=new h;if(!this._nextPosition(e,r,f,1))return null;r.copyTo(this._currentPosition);return f};b.isPathEnd=function(){return this._currentPosition.isPathEnd};b.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");
return this._path[this._currentPosition.segment+1]};b._nextPosition=function(e,f,r,q){if(this._currentPosition.isPathEnd)return!1;var g=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(g/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(f);f.abscissa+e*this._partLengthRatio>f.segmentLength+this._tolerance;)if(r&&(0===r.length&&(0===g?(g=this._path[f.segment],r.push([g[0],g[1]])):r.push(this.getSegCoord2D(this._path,f.segment,g))),g=this._path[f.segment+1],
r.push([g[0],g[1]])),g=0,e-=(f.segmentLength-f.abscissa)/this._partLengthRatio,this._partSegCount)f.segment=this.nextSegment(),f.segmentLength=this.calculateSegLength(this._path,f.segment),f.abscissa=0,this._partSegCount--;else{if(!this.setPosAtNextPart()){if(0===q)return!1;f.segmentLength=this.calculateSegLength(this._path,f.segment);f.isPartEnd=!0;1===q?(f.abscissa=f.segmentLength,f.isPathEnd=!0):f.abscissa=f.segmentLength+e;return!0}this._currentPosition.copyTo(f)}f.abscissa+=e*this._partLengthRatio;
r&&(0===r.length&&(0===g?(e=this._path[f.segment],r.push([e[0],e[1]])):r.push(this.getSegCoord2D(this._path,f.segment,g))),e=f.abscissa/f.segmentLength,1===e?(e=this._path[f.segment+1],r.push([e[0],e[1]])):r.push(this.getSegCoord2D(this._path,f.segment,e)));!this._partSegCount&&Math.abs(f.abscissa-f.segmentLength)<this._tolerance&&(f.isPathEnd=this._partIsLast,f.isPartEnd=!0);return!0};b._getPoint=function(e){if(-1===e.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,e.segment,
0>=e.segmentLength?0:e.abscissa/e.segmentLength)};b._getAngle=function(e){if(-1===e.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,e.segment,0>=e.segmentLength?0:e.abscissa/e.segmentLength)};b.setPosAtNextPart=function(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,
this.nextSegment()),this._partSegCount++,1===E.getId(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}for(var e=this._partSegCount;e;)this.previousSegment(),--e;this._currentPosition.segment=this.nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;e=this.getStartPointIndex();this._ctrlPtBegin=
1===E.getId(this._path[e]);e=e+this._partSegCount+1;e>=this._path.length&&(e=0);this._ctrlPtEnd=1===E.getId(this._path[e]);if(0<this._patternLength){e=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const f=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let r=Math.round((this._partLength-(e+f))/this._patternLength);0>=r&&(r=0<e+f?0:1);this._partLengthRatio=this._partLength/(e+f+r*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=
1;return!0};b.hasNextSegment=function(){return this._seg<this._path.length-2};b.previousSegment=function(){return--this._seg};b.nextSegment=function(){return++this._seg};b.getStartPointIndex=function(){return this._seg};b.getEndPointIndex=function(){return this._seg+1};return c}(B.CurveHelper);x.DashPattern=k;x.GeometryWalker=a;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDonut":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],
function(x,F,E){let B=function(){function h(){}h.local=function(){null===h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(a,d,c){return new k(a,d,c)};return h}();B.instance=null;let k=function(){function h(a,d,c){this._inputGeometries=a;this._curveHelper=new E.CurveHelper;this._width=(void 0!==d.width?d.width:2)*c;switch(d.method){default:this._method="Mitered";break;case "Bevelled":this._method="Bevelled";break;case "Rounded":case "TrueBuffer":this._method="Rounded";
break;case "Square":this._method="Square"}this._option=d.option;this._offsetFlattenError=E.PIXEL_TOLERANCE*c}h.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(F.isExtent(a)&&0<this._width){if(0>Math.min(a.xmax-a.xmin,a.ymax-a.ymin)-2*this._width)return a;var d=[];d.push([[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]);d.push([[a.xmin+this._width,a.ymin+this._width],[a.xmax-this._width,a.ymin+this._width],[a.xmax-this._width,a.ymax-this._width],
[a.xmin+this._width,a.ymax-this._width],[a.xmin+this._width,a.ymin+this._width]]);return{rings:d}}if(F.isPolygon(a)&&0<this._width){d=[];for(const c of a.rings){a=this._curveHelper.calculatePathLength(c);const b=this._curveHelper.offset(c,this._width,this._method,4,this._offsetFlattenError);b&&(0>a&&b.reverse(),d.push(b))}if(d.length)return{rings:d}}a=this._inputGeometries.next()}return null};return h}();x.EffectDonut=B;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(x,F,E,B){let k=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(d,c,b){return new h(d,c,b)};return a}();k.instance=null;let h=function(a){function d(c,b,e){c=a.call(this,c,!1,!0)||this;c._curveHelper=new B.CurveHelper;c._length=(void 0!==b.length?b.length:20)*e;c._angle=void 0!==b.angle?b.angle:225;c._position=void 0!==b.position?b.position:
50;0>c._length&&(c._length=-c._length);20>c._position&&(c._position=20);80<c._position&&(c._position=80);c._mirror=!1;return c}F._inheritsLoose(d,a);d.prototype.processPath=function(c){if(this._curveHelper.isEmpty(c,!1))return null;const b=c[0];c=c[c.length-1];this._curveHelper.normalize([c[0]-b[0],c[1]-b[1]]);const e=[b[0]+(c[0]-b[0])*this._position/100,b[1]+(c[1]-b[1])*this._position/100],f=Math.cos((90-this._angle)/180*Math.PI);let r=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(r=-r);
this._mirror=!this._mirror;return{paths:[[b,[e[0]-this._length/2*f,e[1]-this._length/2*r],[e[0]+this._length/2*f,e[1]+this._length/2*r],c]]}};return d}(E.PathGeometryCursor);x.EffectJog=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(x,F,E){let B=function(){function h(){}h.local=function(){null===h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=
function(a,d,c){return new k(a,d,c)};return h}();B.instance=null;let k=function(){function h(d,c,b){this._inputGeometries=d;this._offsetX=void 0!==c.offsetX?c.offsetX*b:0;this._offsetY=void 0!==c.offsetY?-c.offsetY*b:0}var a=h.prototype;a.next=function(){for(var d=this._inputGeometries.next();d;){if(E.isExtent(d))return{xmin:d.xmin+this._offsetX,xmax:d.xmax+this._offsetX,ymin:d.ymin+this._offsetY,ymax:d.ymax+this._offsetY};if(E.isPolygon(d))return d=F.clone(d),this._moveMultipath(d.rings,this._offsetX,
this._offsetY),d;if(E.isPolyline(d))return d=F.clone(d),this._moveMultipath(d.paths,this._offsetX,this._offsetY),d;if(E.isMultipoint(d))return d=F.clone(d),this._movePath(d.points,this._offsetX,this._offsetY),d;if(E.isPoint(d))return{x:d.x+this._offsetX,y:d.y+this._offsetY};d=this._inputGeometries.next()}return null};a._moveMultipath=function(d,c,b){if(d)for(const e of d)this._movePath(e,c,b)};a._movePath=function(d,c,b){if(d)for(const e of d)e[0]+=c,e[1]+=b};return h}();x.EffectMove=B;Object.defineProperty(x,
"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectOffset":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(x,F,E){let B=function(){function h(){}h.local=function(){null===h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(a,d,c){return new k(a,d,c)};return h}();B.instance=null;let k=function(){function h(a,d,c){this._inputGeometries=a;this._curveHelper=new E.CurveHelper;this._offset=(void 0!==d.offset?d.offset:1)*c;
this._method=d.method;this._option=d.option;this._offsetFlattenError=E.PIXEL_TOLERANCE*c}h.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._offset)return a;if(F.isExtent(a)){if("Rounded"===this._method&&0<this._offset){var d=this._curveHelper.offset([[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]],this._offset,this._method,4,this._offsetFlattenError);return d?{rings:[d]}:null}if(0<Math.min(a.xmax-a.xmin,a.ymax-a.ymin)+2*this._offset)return{xmin:a.xmin-
this._offset,xmax:a.xmax+this._offset,ymin:a.ymin-this._offset,ymax:a.ymax+this._offset}}if(F.isPolygon(a)){var c=[];for(d of a.rings){const b=this._curveHelper.offset(d,this._offset,this._method,4,this._offsetFlattenError);b&&c.push(b)}if(c.length)return{rings:c}}if(F.isPolyline(a)){c=[];for(const b of a.paths)(a=this._curveHelper.offset(b,this._offset,this._method,4,this._offsetFlattenError))&&c.push(a);if(c.length)return{paths:c}}a=this._inputGeometries.next()}return null};return h}();x.EffectOffset=
B;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(x,F,E,B){let k=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(d,c,b){return new h(d,c,b)};return a}();k.instance=null;let h=function(){function a(d,c,b){this._inputGeometries=d;this._reverse=void 0!==c.reverse?
c.reverse:!0}a.prototype.next=function(){for(var d=this._inputGeometries.next();d;){if(!this._reverse)return d;if(E.isPolyline(d))return d=F.clone(d),B.reverseMultipath(d.paths),d;d=this._inputGeometries.next()}return null};return a}();x.EffectReverse=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],
function(x,F,E,B,k){let h=function(){function d(){}d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(c,b,e){return new a(c,b,e)};return d}();h.instance=null;let a=function(){function d(b,e,f){this._inputGeometries=b;this._rotateAngle=void 0!==e.angle?-e.angle*Math.PI/180:0}var c=d.prototype;c.next=function(){for(var b=this._inputGeometries.next();b;){if(0===this._rotateAngle)return b;var e=E.create();B.getBoundsXY(e,b);const f=(e[2]+e[0])/2;e=
(e[3]+e[1])/2;if(k.isExtent(b))return b={rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]},this._rotateMultipath(b.rings,f,e),b;if(k.isPolygon(b))return b=F.clone(b),this._rotateMultipath(b.rings,f,e),b;if(k.isPolyline(b))return b=F.clone(b),this._rotateMultipath(b.paths,f,e),b;if(k.isMultipoint(b))return b=F.clone(b),this._rotatePath(b.points,f,e),b;if(k.isPoint(b))return b;b=this._inputGeometries.next()}return null};c._rotateMultipath=function(b,e,f){if(b)for(const r of b)this._rotatePath(r,
e,f)};c._rotatePath=function(b,e,f){if(b){const r=Math.cos(this._rotateAngle),q=Math.sin(this._rotateAngle);for(const g of b){b=g[0]-e;const l=g[1]-f;g[0]=e+b*r-l*q;g[1]=f+b*q+l*r}}};return d}();x.EffectRotate=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(x,F,E,B,k){let h=
function(){function d(){}d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(c,b,e){return new a(c,b,e)};return d}();h.instance=null;let a=function(){function d(b,e,f){this._inputGeometries=b;this._xFactor=void 0!==e.xScaleFactor?e.xScaleFactor:1.15;this._yFactor=void 0!==e.yScaleFactor?e.yScaleFactor:1.15}var c=d.prototype;c.next=function(){for(var b=this._inputGeometries.next();b;){if(1===this._xFactor&&1===this._yFactor)return b;var e=E.create();
B.getBoundsXY(e,b);const f=(e[2]+e[0])/2;e=(e[3]+e[1])/2;if(k.isExtent(b))return b={rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]},this._scaleMultipath(b.rings,f,e),b;if(k.isPolygon(b))return b=F.clone(b),this._scaleMultipath(b.rings,f,e),b;if(k.isPolyline(b))return b=F.clone(b),this._scaleMultipath(b.paths,f,e),b;if(k.isMultipoint(b))return b=F.clone(b),this._scalePath(b.points,f,e),b;if(k.isPoint(b))return b;b=this._inputGeometries.next()}return null};
c._scaleMultipath=function(b,e,f){if(b)for(const r of b)this._scalePath(r,e,f)};c._scalePath=function(b,e,f){if(b)for(const r of b)b=(r[1]-f)*this._yFactor,r[0]=e+(r[0]-e)*this._xFactor,r[1]=f+b};return d}();x.EffectScale=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../GeometryWalker"],function(x,F,E,B){let k=function(){function a(){}a.local=function(){null===a.instance&&
(a.instance=new a);return a.instance};a.prototype.execute=function(d,c,b){return new h(d,c,b)};return a}();k.instance=null;let h=function(){function a(c,b,e){this._inputGeometries=c;this._height=(void 0!==b.amplitude?b.amplitude:2)*e;this._period=(void 0!==b.period?b.period:3)*e;this._style=b.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new B.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);
this._walker=new B.GeometryWalker;this._walker.updateTolerance(e)}var d=a.prototype;d.next=function(){for(var c=this._inputGeometries.next();c;){if(0===this._height||0===this._period)return c;if(F.isPolyline(c)){const b=this._processGeom(c.paths);if(b.length)return{paths:b}}if(F.isPolygon(c)&&(c=this._processGeom(c.rings),c.length))return{rings:c};c=this._inputGeometries.next()}return null};d._processGeom=function(c){const b=[];for(const e of c)if(this._walker.init(e,this._pattern))switch(this._style){default:b.push(this._constructCurve(e,
!1));break;case "Square":b.push(this._constructSquare(e));break;case "Triangle":b.push(this._constructTriangle(e));break;case "Random":b.push(this._constructCurve(e,!0))}else b.push(e);return b};d._constructCurve=function(c,b){const e=new E.PathHelper;var f=this._walker.calculatePathLength(c),r=Math.round(f/this._period);0===r&&(r=1);const q=this._period/16,g=1/(16*r+1);f=2*Math.PI*f/(f/r);r=2*Math.PI*Math.random();const l=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),u=.75-Math.random()/2,t=
.75-Math.random()/2,m={};this._walker.curPointAndAngle(m);e.startPath(m.pt);let w=0;for(;;)if(this._walker.nextPointAndAngle(q,m)){const v=w;w+=g;let C;if(b){const A=this._height/2*(1+.3*Math.sin(u*f*v+r));C=A*Math.sin(f*v+l);C+=A*Math.sin(t*f*v+n);C/=2}else C=.5*this._height*Math.sin(.5*f*v);e.lineTo([m.pt[0]-C*m.sa,m.pt[1]+C*m.ca])}else{e.lineTo(c[c.length-1]);break}return e.path()};d._constructSquare=function(c){const b=new E.PathHelper;c=this._walker.calculatePathLength(c);Math.round(c/this._period);
for(c=!0;;){let e=!1;if(this._walker.curPositionIsValid()){const f={};this._walker.curPointAndAngle(f);const r={};if(this._walker.nextPointAndAngle(this._period,r)){const q={};this._walker.nextPointAndAngle(this._period,q)&&(c?(b.startPath(f.pt),c=!1):b.lineTo(f.pt),b.lineTo([f.pt[0]-this._height/2*f.sa,f.pt[1]+this._height/2*f.ca]),b.lineTo([r.pt[0]-this._height/2*r.sa,r.pt[1]+this._height/2*r.ca]),b.lineTo([r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca]),b.lineTo([q.pt[0]+this._height/
2*q.sa,q.pt[1]-this._height/2*q.ca]),e=!0)}}if(!e){b.lineTo(this._walker.getPathEnd());break}}return b.path()};d._constructTriangle=function(c){const b=new E.PathHelper;c=this._walker.calculatePathLength(c);Math.round(c/this._period);for(c=!0;;){let e=!1;if(this._walker.curPositionIsValid()){const f={};this._walker.curPointAndAngle(f);const r={};if(this._walker.nextPointAndAngle(this._period/2,r)){const q={};this._walker.nextPointAndAngle(this._period,q)&&(this._walker.nextPosition(this._period/2)&&
(c?(b.startPath(f.pt),c=!1):b.lineTo(f.pt),b.lineTo([r.pt[0]-this._height/2*r.sa,r.pt[1]+this._height/2*r.ca]),b.lineTo([q.pt[0]+this._height/2*q.sa,q.pt[1]-this._height/2*q.ca])),e=!0)}}if(!e){b.lineTo(this._walker.getPathEnd());break}}return b.path()};return a}();x.EffectWave=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../enums","../GeometryWalker"],
function(x,F,E,B,k){let h=function(){function d(){}d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(c,b,e){return new a(c,b,e)};return d}();h.instance=null;let a=function(d){function c(e,f,r){e=d.call(this,e,!0,!0)||this;e._grometryWalker=new k.GeometryWalker;e._grometryWalker.updateTolerance(r);e._angleToLine=void 0!==f.angleToLine?f.angleToLine:!0;e._offset=void 0!==f.offset?f.offset*r:0;e._originalEndings=f.endings;e._offsetAtEnd=void 0!==
f.customEndingOffset?f.customEndingOffset*r:0;e._position=void 0!==f.offsetAlongLine?f.offsetAlongLine*r:0;e._pattern=new k.DashPattern;e._pattern.init(f.placementTemplate,!1);e._pattern.scale(r);e._endings=e._originalEndings;return e}F._inheritsLoose(c,d);var b=c.prototype;b.processPath=function(e){if(this._pattern.isEmpty())return null;if(this.iteratePath)var f=this._pattern.nextValue();else{this._endings=this._originalEndings===B.PlacementEndings.WithFullGap&&this.isClosed?B.PlacementEndings.WithMarkers:
this._originalEndings;this._pattern.extPtGap=0;let r=!0;switch(this._endings){case B.PlacementEndings.NoConstraint:f=-this._position;f=this._adjustPosition(f);r=!1;break;default:f=-this._pattern.lastValue()/2;break;case B.PlacementEndings.WithFullGap:f=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case B.PlacementEndings.WithMarkers:f=0;break;case B.PlacementEndings.Custom:f=-this._position,f=this._adjustPosition(f),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._grometryWalker.init(e,
this._pattern,r))return null;this._pattern.reset();for(e=0;f>e;)f-=e,e=this._pattern.nextValue();f=e-=f;this.iteratePath=!0}e={};if(!this._grometryWalker.nextPointAndAngle(f,e)||this._endings===B.PlacementEndings.WithFullGap&&this._grometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===B.PlacementEndings.WithMarkers&&this._grometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(e.pt[0]+this._offset*e.sa,e.pt[1]-this._offset*
e.ca);this._angleToLine&&this.internalPlacement.setRotateCS(e.ca,e.sa);return this.internalPlacement};b._adjustPosition=function(e){e/=this._pattern.length();e-=Math.floor(e);return e*this._pattern.length()};return c}(E.PathTransformationCursor);x.PlacementAlongLineSameSize=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/enums":function(){define(["exports"],function(x){x.PlacementEndings=void 0;var F=x.PlacementEndings||(x.PlacementEndings={});F.NoConstraint="NoConstraint";
F.WithMarkers="WithMarkers";F.WithFullGap="WithFullGap";F.WithHalfGap="WithHalfGap";F.Custom="Custom";Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(x,F,E,B){let k=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(d,c,b){return new h(d,c,b)};return a}();
k.instance=null;let h=function(a){function d(b,e,f){b=a.call(this,b,!1,!0)||this;b._curveHelper=new B.CurveHelper;b._angleToLine=void 0!==e.angleToLine?e.angleToLine:!0;b._offset=void 0!==e.offset?e.offset*f:0;b._type=e.extremityPlacement;b._position=void 0!==e.offsetAlongLine?e.offsetAlongLine*f:0;b._beginProcessed=!1;return b}F._inheritsLoose(d,a);var c=d.prototype;c.processPath=function(b){let e;switch(this._type){default:this._beginProcessed?(e=this._atExtremities(b,this._position,!1),this.iteratePath=
this._beginProcessed=!1):(e=this._atExtremities(b,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case "JustBegin":e=this._atExtremities(b,this._position,!0);break;case "JustEnd":e=this._atExtremities(b,this._position,!1);case "None":}return e};c._atExtremities=function(b,e,f){var r=b.length;if(2>r)return null;var q=f?1:r-2;const g=f?r:-1,l=f?1:-1;let n=0;f=f?b[0]:b[r-1];for(r=q;r!==g;r+=l){q=f;f=b[r];const u=this._curveHelper.calculateLength(q,f);if(n+u>e){b=(e-n)/u;const [t,m]=
this._curveHelper.getAngleCS(q,f,b);b=E.getCoord2D(q,f,b);this.internalPlacement.setTranslate(b[0]-this._offset*m,b[1]+this._offset*t);this._angleToLine&&this.internalPlacement.setRotateCS(-t,-m);return this.internalPlacement}n+=u}return null};return d}(E.PathTransformationCursor);x.PlacementAtExtremities=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor",
"../GeometryWalker"],function(x,F,E,B){let k=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(d,c,b){return new h(d,c,b)};return a}();k.instance=null;let h=function(a){function d(c,b,e){c=a.call(this,c,!0,!0)||this;c._walker=new B.GeometryWalker;c._walker.updateTolerance(e);c._angleToLine=void 0!==b.angleToLine?b.angleToLine:!0;c._offset=void 0!==b.offset?b.offset*e:0;c._beginGap=void 0!==b.beginPosition?b.beginPosition*
e:0;c._endGap=void 0!==b.endPosition?b.endPosition*e:0;c._flipFirst=void 0!==b.flipFirst?b.flipFirst:!0;c._pattern=new B.DashPattern;c._pattern.init(b.positionArray,!1,!1);c._subPathLen=0;c._posCount=c._pattern.size();c._isFirst=!0;c._prevPos=0;return c}F._inheritsLoose(d,a);d.prototype.processPath=function(c){if(this._pattern.isEmpty())return null;if(this.iteratePath){c=this._pattern.nextValue()*this._subPathLen;var b=this._beginGap+c;c=b-this._prevPos;this._prevPos=b}else{this._posCount=this._pattern.size();
this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(c)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(c,this._pattern,!1))return null;this._pattern.reset();c=this._pattern.nextValue()*this._subPathLen;b=this._beginGap+c;c=b-this._prevPos;this._prevPos=b;this.iteratePath=!0}b={};if(!this._walker.nextPointAndAngle(c,b,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(b.pt[0]+this._offset*b.sa,
b.pt[1]-this._offset*b.ca);c=this._isFirst&&this._flipFirst;let e;this._angleToLine?(e=b.ca,b=b.sa):(e=1,b=0);c&&(e=-e,b=-b);this.internalPlacement.setRotateCS(e,b);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return d}(E.PathTransformationCursor);x.PlacementAtRatioPositions=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../CIMPlacements"],function(x,
F){let E=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(h,a,d){return new B(h,a,d)};return k}();E.instance=null;let B=function(){function k(a,d,c){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=(void 0!==d.stepX?Math.abs(d.stepX):16)*c;this._stepY=(void 0!==d.stepY?Math.abs(d.stepY):16)*c;if(0!==this._stepX&&0!==this._stepY&&a&&void 0!==a.rings&&a.rings){this._gridType=void 0!==
d.gridType?d.gridType:"Fixed";if("Random"===this._gridType)this._randomness=void 0!==d.randomness?d.randomness/100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0;else{this._randomness=0;this._gridAngle=void 0!==d.gridAngle?d.gridAngle:0;this._shiftOddRows=void 0!==d.shiftOddRows?d.shiftOddRows:!1;this._offsetX=void 0!==d.offsetX?d.offsetX*c:0;this._offsetY=void 0!==d.offsetY?d.offsetY*c:0;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);
this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=new F.Placement;this._calculateMinMax(a);this._geometry=
a}}var h=k.prototype;h.next=function(){return this._geometry?this._nextInside():null};h._calculateMinMax=function(a){this._yMax=this._yMin=this._xMax=this._xMin=0;let d,c,b,e,f;c=b=Number.MAX_VALUE;e=f=-Number.MAX_VALUE;for(const q of a.rings){const g=q?q.length:0;for(let l=0;l<g;++l){var r=q[l][0]-this._graphicOriginX-this._offsetX;d=q[l][1]-this._graphicOriginY-this._offsetY;a=this._cosAngle*r-this._sinAngle*d;r=this._sinAngle*r+this._cosAngle*d;c=Math.min(c,a);e=Math.max(e,a);b=Math.min(b,r);f=
Math.max(f,r)}}c+=this._graphicOriginX;e+=this._graphicOriginX;b+=this._graphicOriginY;f+=this._graphicOriginY;this._xMin=Math.round(c/this._stepX);this._xMax=Math.round(e/this._stepX);this._yMin=Math.round(b/this._stepY);this._yMax=Math.round(f/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};h._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&
this._currentX--}var a=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(a+=.5*this._stepX);const d=this._currentY*this._stepY+this._offsetY;this._currentX++;let c;"Random"===this._gridType?(c=this._graphicOriginX+a+this._stepX*this._randomness*(.5-Math.random())*2/3,a=this._graphicOriginY+d+this._stepY*this._randomness*(.5-Math.random())*2/3):(c=this._graphicOriginX+this._cosAngle*a+this._sinAngle*d,a=this._graphicOriginY-this._sinAngle*a+this._cosAngle*d);this._internalPlacement.setTranslate(c,
a);return this._internalPlacement}};return k}();x.PlacementInsidePolygon=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(x,F,E,B){let k=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(d,c,b){return new h(d,c,b)};return a}();k.instance=null;let h=function(a){function d(b,
e,f){b=a.call(this,b,!0,!0)||this;b._curveHelper=new B.CurveHelper;b._angleToLine=void 0!==e.angleToLine?e.angleToLine:!0;b._offset=void 0!==e.offset?e.offset*f:0;b._relativeTo=e.relativeTo;b._position=void 0!==e.startPointOffset?e.startPointOffset*f:0;b._epsilon=.001*f;return b}F._inheritsLoose(d,a);var c=d.prototype;c.processPath=function(b){var e=this._position;if("SegmentMidpoint"===this._relativeTo){this.iteratePath||(this._segmentCount=b.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<
this._segmentCount;){var f=this._curSegment;this._curSegment++;e=b[f-1];f=b[f];const r=this._curveHelper.calculateLength(e,f);if(r<this._epsilon)continue;b=.5+this._position/r;const [q,g]=this._curveHelper.getAngleCS(e,f,b);b=E.getCoord2D(e,f,b);this.internalPlacement.setTranslate(b[0]-this._offset*g,b[1]+this._offset*q);this._angleToLine&&this.internalPlacement.setRotateCS(q,g);return this.internalPlacement}this.iteratePath=!1;return null}"LineEnd"===this._relativeTo&&E.reversePath(b);e=this.onLine(b,
e);"LineEnd"===this._relativeTo&&E.reversePath(b);return e};c.onLine=function(b,e){let f,r=!1;switch(this._relativeTo){default:f=this._curveHelper.calculatePathLength(b)/2+e;break;case "LineBeginning":f=e;break;case "LineEnd":f=e,r=!0}const q=b.length;let g=0,l=b[0];for(let n=1;n<q;++n){e=l;l=b[n];const u=this._curveHelper.calculateLength(e,l);if(g+u>f){b=(f-g)/u;const [t,m]=this._curveHelper.getAngleCS(e,l,b);b=E.getCoord2D(e,l,b);e=r?this._offset:-this._offset;this.internalPlacement.setTranslate(b[0]-
e*m,b[1]+e*t);this._angleToLine&&(r?this.internalPlacement.setRotateCS(-t,-m):this.internalPlacement.setRotateCS(t,m));return this.internalPlacement}g+=u}return null};return d}(E.PathTransformationCursor);x.PlacementOnLine=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(x,F,E,B){function k(d,c){const b=Math.PI;for(;Math.abs(c-d)>
b+2E-15;)c=c-d>b?c-2*b:c+2*b;return(d+c)/2}let h=function(){function d(){}d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(c,b,e){return new a(c,b,e)};return d}();h.instance=null;let a=function(d){function c(e,f,r){e=d.call(this,e,!0,!0)||this;e._curveHelper=new B.CurveHelper;e._angleToLine=void 0!==f.angleToLine?f.angleToLine:!0;e._offset=void 0!==f.offset?f.offset*r:0;e._endPoints=void 0!==f.placeOnEndPoints?f.placeOnEndPoints:!0;e._controlPoints=
void 0!==f.placeOnControlPoints?f.placeOnControlPoints:!0;e._regularVertices=void 0!==f.placeOnRegularVertices?f.placeOnRegularVertices:!0;e._tags=[];e._tagIterator=0;return e}F._inheritsLoose(c,d);var b=c.prototype;b.processPath=function(e){this.iteratePath||(this._preparePath(e),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;e=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(e[2]);
let f=e[0],r=e[1];if(0!==this._offset){const q=Math.cos(e[2]);f-=this._offset*Math.sin(e[2]);r+=this._offset*q}this.internalPlacement.setTranslate(f,r);this._tagIterator++;return this.internalPlacement};b._preparePath=function(e){this._tagIterator=this._tags.length=0;const f=E.isClosedPath(e),r=e.length-1;let q=0,g=0,l=0,n=0,u=0,t,m;for(;q<r;){q++;t=e[q-1];m=e[q];const w=E.getId(t),v=E.getId(m);if(this._angleToLine||0!==this._offset)n=this._curveHelper.getAngle(t,m,0);1===q?f?(g=n,l=w):this._endPoints&&
this._tags.push([t[0],t[1],n]):1===w?this._controlPoints&&this._tags.push([t[0],t[1],k(u,n)]):this._regularVertices&&this._tags.push([t[0],t[1],k(u,n)]);if(this._angleToLine||0!==this._offset)u=this._curveHelper.getAngle(t,m,1);q===r&&(f?1===v||1===l?this._controlPoints&&this._tags.push([m[0],m[1],k(u,g)]):this._regularVertices&&this._tags.push([m[0],m[1],k(u,g)]):this._endPoints&&this._tags.push([m[0],m[1],u]))}this._tagIterator=0};return c}(E.PathTransformationCursor);x.PlacementOnVertices=h;Object.defineProperty(x,
"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../CIMPlacements"],function(x,F,E,B){let k=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(d,c,b){return new h(d,c,b)};return a}();k.instance=null;let h=function(){function a(c,b,e){this._geometry=c;this._offsetX=void 0!==b.offsetX?
b.offsetX*e:0;this._offsetY=void 0!==b.offsetY?b.offsetY*e:0;this._method=void 0!==b.method?b.method:"OnPolygon";this._internalPlacement=new B.Placement}var d=a.prototype;d.next=function(){const c=this._geometry;this._geometry=null;return c&&void 0!==c.rings?this._polygonCenter(c):null};d._polygonCenter=function(c){switch(this._method){default:case "CenterOfMass":case "BoundingBoxCenter":{const b=F.create();E.getBoundsXY(b,c);this._internalPlacement.setTranslate((b[2]+b[0])/2+this._offsetX,(b[3]+
b[1])/2-this._offsetY)}}return this._internalPlacement};return a}();x.PlacementPolygonCenter=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(x){return function(){function F(E=0,B=0,k=0,h=0){this.x=E;this.y=B;this.width=k;this.height=h}F.prototype.union=function(E){this.x=Math.min(this.x,E.x);this.y=Math.min(this.y,E.y);this.width=Math.max(this.width,E.width);this.height=Math.max(this.height,E.height)};
x._createClass(F,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return F}()})},"esri/symbols/cim/packingUtils":function(){define(["exports"],function(x){function F(a,d=0){let c=0;for(let b=0;4>b;b++)c+=a[d+b]*k[b];return c}function E(a){return a-Math.floor(a)}const B=[1,256,65536,16777216],k=[1/256,1/65536,1/16777216,1/4294967296],h=F(new Uint8ClampedArray([255,255,255,255]));x.packFloatRGBA=function(a,d,c=0){a=0>a?0:a>h?h:a;for(let b=0;4>b;b++)d[c+b]=Math.floor(256*E(a*B[b]))};
x.unpackFloatRGBA=F;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/SDFHelper":function(){define(["exports","../../geometry/support/jsonUtils","./packingUtils","./Rect"],function(x,F,E,B){function k(a){if(!a)return null;switch(a.type){case "CIMPointSymbol":a=a.symbolLayers;if(!a||1!==a.length)break;return k(a[0]);case "CIMVectorMarker":a=a.markerGraphics;if(!a||1!==a.length)break;var d=a[0];if(!d)break;a=d.geometry;if(!a)break;d=d.symbol;if(!d||"CIMPolygonSymbol"!==d.type&&"CIMLineSymbol"!==
d.type)break;return{geom:a,asFill:"CIMPolygonSymbol"===d.type};case "sdf":return{geom:a.geom,asFill:a.asFill}}return null}function h(a){let d=Infinity,c=-Infinity,b=Infinity,e=-Infinity;for(const f of a)for(const r of f)r[0]<d&&(d=r[0]),r[0]>c&&(c=r[0]),r[1]<b&&(b=r[1]),r[1]>e&&(e=r[1]);return[d,b,c,e]}x.buildSDF=function(a){var d=a.geom;var c=d?d.rings?d.rings:d.paths?d.paths:void 0!==d.xmin&&void 0!==d.ymin&&void 0!==d.xmax&&void 0!==d.ymax?[[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,
d.ymin],[d.xmin,d.ymin]]]:null:null;d=Infinity;var b=-Infinity;var e=Infinity,f=-Infinity;for(var r of c)for(var q of r)q[0]<d&&(d=q[0]),q[0]>b&&(b=q[0]),q[1]<e&&(e=q[1]),q[1]>f&&(f=q[1]);b=new B(d,e,b-d,f-e);e=64/Math.max(b.width,b.height);r=Math.round(b.width*e)+62;q=Math.round(b.height*e)+62;d=[];for(var g of c)if(g&&1<g.length){c=[];for(var l of g){let [p,z]=l;p-=b.x;z-=b.y;p*=e;z*=e;p+=30.5;z+=30.5;c.push([p,z])}a.asFill&&(f=c.length-1,c[0][0]===c[f][0]&&c[0][1]===c[f][1]||c.push(c[0]));d.push(c)}var n;
g=r*q;l=Array(g);for(c=0;c<g;++c)l[c]=962;for(n of d)for(c=n.length,b=1;b<c;++b){e=n[b-1];f=n[b];var u=void 0,t=void 0;e[0]<f[0]?(u=e[0],t=f[0]):(u=f[0],t=e[0]);var m=void 0,w=void 0;e[1]<f[1]?(m=e[1],w=f[1]):(m=f[1],w=e[1]);var v=Math.floor(u)-31;t=Math.floor(t)+31;m=Math.floor(m)-31;w=Math.floor(w)+31;0>v&&(v=0);t>r&&(t=r);0>m&&(m=0);w>q&&(w=q);u=f[0]-e[0];const p=f[1]-e[1],z=u*u+p*p;for(;v<t;v++)for(let D=m;D<w;D++){var C=(v-e[0])*u+(D-e[1])*p,A=void 0;0>C?(A=e[0],C=e[1]):C>z?(A=f[0],C=f[1]):(C/=
z,A=e[0]+C*u,C=e[1]+C*p);A=(v-A)*(v-A)+(D-C)*(D-C);C=(q-D-1)*r+v;A<l[C]&&(l[C]=A)}}for(n=0;n<g;++n)l[n]=Math.sqrt(l[n]);n=l;if(a.asFill)for(var y of d)for(a=y.length,d=1;d<a;++d)for(g=y[d-1],l=y[d],g[0]<l[0]?(c=g[0],b=l[0]):(c=l[0],b=g[0]),g[1]<l[1]?(f=g[1],e=l[1]):(f=l[1],e=g[1]),c=Math.floor(c),b=Math.floor(b)+1,f=Math.floor(f),e=Math.floor(e)+1,31>c&&(c=31),b>r-31&&(b=r-31),31>f&&(f=31),e>q-31&&(e=q-31);f<e;++f)if(g[1]>f!==l[1]>f){t=(q-f-1)*r;for(m=c;m<b;++m)m<(l[0]-g[0])*(f-g[1])/(l[1]-g[1])+
g[0]&&(n[t+m]=-n[t+m]);for(m=31;m<c;++m)n[t+m]=-n[t+m]}y=n.length;a=new Uint8Array(4*y);for(d=0;d<y;++d)E.packFloatRGBA(.5-n[d]/62,a,4*d);y=a;return[y,r,q]};x.getExtent=function(a){return a?a.rings?h(a.rings):a.paths?h(a.paths):F.isExtent(a)?[a.xmin,a.ymin,a.xmax,a.ymax]:null:null};x.getSDFInfo=k;x.getSDFMetrics=function(a,d,c,b,e){const [f,r,q,g]=a;if(q<f||g<r)return[0,0,0];var l=q-f,n=g-r;a=64/Math.max(l,n);l=Math.round(l*a);n=Math.round(n*a)+62;let u=1;d&&(u=n/a/(d.ymax-d.ymin));let t=0,m=0;b&&
(e?d&&c&&0<d.ymax-d.ymin&&(t=b.x/((d.xmax-d.xmin)/(d.ymax-d.ymin)*c),m=b.y/c):(t=b.x,m=b.y));t=.5*(d.xmax+d.xmin)+t*(d.xmax-d.xmin);m=.5*(d.ymax+d.ymin)+m*(d.ymax-d.ymin);t=(t-f)*a+31;m=(m-r)*a+31;return[u,t/(l+62)-.5,-(m/n-.5)]};x.getSDFSymbol=function(a){a=a.markerGraphics;if(!a||1!==a.length)return null;a=a[0];if(!a)return null;a=a.symbol;return!a||"CIMPolygonSymbol"!==a.type&&"CIMLineSymbol"!==a.type?null:a};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["exports"],
function(x){function F(E){E=E.toLowerCase().split(" ").join("-");switch(E){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return E}}x.getFontDecorationTop=function(E){switch(E){case "underline":return-26;case "line-through":return-18}return NaN};x.getFullyQualifiedFontName=function(E){a:{if(E.weight)switch(E.weight.toLowerCase()){case "bold":case "bolder":var B=
"-bold";break a}B=""}a:{if(E.style)switch(E.style.toLowerCase()){case "italic":case "oblic":var k="-italic";break a}k=""}B+=k;return F(E.family)+(0<B.length?B:"-regular")};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/promiseUtils ./Rect ./RectangleBinPack ../../../webgl/Texture".split(" "),function(x,F,E,B,k,h){function a(c){const b=new Set;for(const e of c)b.add(Math.floor(e/
256));return b}function d(c,b,e){c.has(b)||c.set(b,e().then(()=>{c.delete(b)}).catch(f=>{c.delete(b);E.throwIfNotAbortError(f)}));return c.get(b)}return function(){function c(e,f,r){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=e;this.height=f;this._glyphSource=r;this._binPack=new k(e-4,f-4);this._glyphData.push(new Uint8Array(e*f));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}
var b=c.prototype;b.dispose=function(){this._binPack=null;for(const e of this._textures)e&&e.dispose();this._textures.length=0;this._glyphData.length=0};b._initDecorationGlyph=function(){var e=[117,149,181,207,207,181,149,117];const f=[];for(let r=0;r<e.length;r++){const q=e[r];for(let g=0;11>g;g++)f.push(q)}e={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(f)};this._recordGlyph(e)};b.getGlyphItems=function(){var e=x._asyncToGenerator(function*(f,r,q){const g=this._getGlyphCache(f);
yield this._fetchRanges(f,r,q);return r.map(l=>this._getMosaicItem(g,f,l))});return function(f,r,q){return e.apply(this,arguments)}}();b.bind=function(e,f,r,q){const g=this._getTexture(e,r);g.setSamplingMode(f);this._dirties[r]&&(g.setData(this._glyphData[r]),this._dirties[r]=!1);e.bindTexture(g,q)};b._getGlyphCache=function(e){this._glyphCache[e]||(this._glyphCache[e]={});return this._glyphCache[e]};b._getTexture=function(e,f){this._textures[f]||(this._textures[f]=new h(e,{pixelFormat:6406,dataType:5121,
width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[f]};b._invalidate=function(){this._dirties[this._currentPage]=!0};b._fetchRanges=function(){var e=x._asyncToGenerator(function*(f,r,q){const g=[];a(r).forEach(l=>{g.push(this._fetchRange(f,l,q))});yield Promise.all(g)});return function(f,r,q){return e.apply(this,arguments)}}();b._fetchRange=function(){var e=x._asyncToGenerator(function*(f,r,q){return 256<r?null:d(this._rangePromises,f+r,()=>this._glyphSource.getRange(f,
r,q))});return function(f,r,q){return e.apply(this,arguments)}}();b._getMosaicItem=function(e,f,r){if(!e[r]){f=this._glyphSource.getGlyph(f,r);if(!f||!f.metrics)return{rect:new B(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:r,sdf:!0};const q=this._recordGlyph(f);e[r]={rect:q,page:this._currentPage,metrics:f.metrics,code:r,sdf:!0};this._invalidate()}return e[r]};b._recordGlyph=function(e){var f=e.metrics;if(0===f.width)f=new B(0,0,0,0);else{const r=f.width+6,q=f.height+6;
f=this._binPack.allocate(r,q);f.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new k(this.width-4,this.height-4),f=this._binPack.allocate(r,q));const g=this._glyphData[this._currentPage];e=e.bitmap;let l,n;if(e)for(let u=0;u<q;u++){l=r*u;n=this.width*(f.y+u)+f.x;for(let t=
0;t<r;t++)g[n+t]=e[l+t]}F("esri-glyph-debug")&&this._showDebugPage(g)}return f};b._showDebugPage=function(e){const f=document.createElement("canvas"),r=f.getContext("2d"),q=new ImageData(this.width,this.height),g=q.data;f.width=this.width;f.height=this.height;f.style.border="1px solid black";for(let l=0;l<e.length;++l)g[4*l]=e[l],g[4*l+1]=0,g[4*l+2]=0,g[4*l+3]=255;r.putImageData(q,0,0);document.body.appendChild(f)};return c}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],
function(x){return function(){function F(E=0,B=0,k=0,h=0){this.x=E;this.y=B;this.width=k;this.height=h}F.prototype.union=function(E){this.x=Math.min(this.x,E.x);this.y=Math.min(this.y,E.y);this.width=Math.max(this.width,E.width);this.height=Math.max(this.height,E.height)};x._createClass(F,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return F}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./Rect"],function(x,
F){return function(){function E(k,h){this._height=this._width=0;this._free=[];this._width=k;this._height=h;this._free.push(new F(0,0,k,h))}var B=E.prototype;B.allocate=function(k,h){if(k>this._width||h>this._height)return new F;let a=null,d=-1;for(let c=0;c<this._free.length;++c){const b=this._free[c];k<=b.width&&h<=b.height&&(null===a||b.y<=a.y&&b.x<=a.x)&&(a=b,d=c)}if(null===a)return new F;this._free.splice(d,1);a.width<a.height?(a.width>k&&this._free.push(new F(a.x+k,a.y,a.width-k,h)),a.height>
h&&this._free.push(new F(a.x,a.y+h,a.width,a.height-h))):(a.width>k&&this._free.push(new F(a.x+k,a.y,a.width-k,a.height)),a.height>h&&this._free.push(new F(a.x,a.y+h,k,a.height-h)));return new F(a.x,a.y,k,h)};B.release=function(k){for(let h=0;h<this._free.length;++h){const a=this._free[h];if(a.y===k.y&&a.height===k.height&&a.x+a.width===k.x)a.width+=k.width;else if(a.x===k.x&&a.width===k.width&&a.y+a.height===k.y)a.height+=k.height;else if(k.y===a.y&&k.height===a.height&&k.x+k.width===a.x)a.x=k.x,
a.width+=k.width;else if(k.x===a.x&&k.width===a.width&&k.y+k.height===a.y)a.y=k.y,a.height+=k.height;else continue;this._free.splice(h,1);this.release(k)}this._free.push(k)};x._createClass(E,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return E}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define(["../../../../request","../../../../core/pbf"],function(x,F){let E=function(){function k(a){this._metrics=[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:{const d=
a.getMessage();for(;d.next();)switch(d.tag()){case 3:{const c=d.getMessage();let b,e,f,r,q,g,l;for(;c.next();)switch(c.tag()){case 1:b=c.getUInt32();break;case 2:e=c.getBytes();break;case 3:f=c.getUInt32();break;case 4:r=c.getUInt32();break;case 5:q=c.getSInt32();break;case 6:g=c.getSInt32();break;case 7:l=c.getUInt32();break;default:c.skip()}c.release();b&&(this._metrics[b]={width:f,height:r,left:q,top:g,advance:l},this._bitmaps[b]=e);break}default:d.skip()}d.release();break}default:a.skip()}}var h=
k.prototype;h.getMetrics=function(a){return this._metrics[a]};h.getBitmap=function(a){return this._bitmaps[a]};return k}(),B=function(){function k(){this._ranges=[]}var h=k.prototype;h.getRange=function(a){return this._ranges[a]};h.addRange=function(a,d){this._ranges[a]=d};return k}();return function(){function k(a){this._glyphInfo={};this._baseURL=a}var h=k.prototype;h.getRange=function(a,d,c){const b=this._getFontStack(a);if(b.getRange(d))return Promise.resolve();const e=256*d,f=e+255;a=this._baseURL.replace("{fontstack}",
a).replace("{range}",e+"-"+f);return x(a,{responseType:"array-buffer",...c}).then(r=>{b.addRange(d,new E(new F(new Uint8Array(r.data),new DataView(r.data))))})};h.getGlyph=function(a,d){if(a=this._getFontStack(a)){var c=Math.floor(d/256);if(!(256<c)&&(a=a.getRange(c)))return{metrics:a.getMetrics(d),bitmap:a.getBitmap(d)}}};h._getFontStack=function(a){let d=this._glyphInfo[a];d||(d=this._glyphInfo[a]=new B);return d};return k}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["../../../../core/promiseUtils",
"./packingUtils"],function(x,F){return function(){function E(k){this.size=k;const h=document.createElement("canvas");h.width=h.height=k;this._context=h.getContext("2d");this._gridOuter=new Float64Array(k*k);this._gridInner=new Float64Array(k*k);this._f=new Float64Array(k);this._d=new Float64Array(k);this._z=new Float64Array(k+1);this._v=new Int16Array(k)}var B=E.prototype;B.dispose=function(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=this._v=null;this._svg&&(document.body.removeChild(this._svg),
this._svg=null)};B.draw=function(k,h,a=31){this._initSVG();const d=this._createSVGString(k);return new Promise((c,b)=>{const e=new Image;e.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(d);e.onload=()=>{e.onload=null;this._context.clearRect(0,0,this.size,this.size);this._context.drawImage(e,0,0,this.size,this.size);var r=this._context.getImageData(0,0,this.size,this.size);const q=new Uint8Array(this.size*this.size*4);for(let g=0;g<this.size*this.size;g++){const l=r.data[4*g+3]/255;
this._gridOuter[g]=1===l?0:0===l?1E20:Math.max(0,.5-l)**2;this._gridInner[g]=1===l?1E20:0===l?0:Math.max(0,l-.5)**2}this._edt(this._gridOuter,this.size,this.size);this._edt(this._gridInner,this.size,this.size);for(r=0;r<this.size*this.size;r++)F.packFloatRGBA(.5-(this._gridOuter[r]-this._gridInner[r])/(2*a),q,4*r);c(q)};const f=h&&h.signal;if(f)x.onAbort(f,()=>b(x.createAbortError()))})};B._initSVG=function(){if(!this._svg){const k=document.createElementNS("http://www.w3.org/2000/svg","svg");k.setAttribute("style",
"position: absolute;");k.setAttribute("width","0");k.setAttribute("height","0");k.setAttribute("aria-hidden","true");k.setAttribute("role","presentation");document.body.appendChild(k);this._svg=k}};B._createSVGString=function(k){const h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttribute("d",k);this._svg.appendChild(h);k=h.getBBox();var a=k.width/k.height;const d=this.size/2;let c,b,e;1<a?(b=c=d/k.width,e=this.size/4,a=d-1/a*d/2):(c=b=d/k.height,e=d-d*a/2,a=this.size/4);h.setAttribute("style",
`transform: matrix(${c}, 0, 0, ${b}, ${-k.x*c+e}, ${-k.y*b+a})`);k=`<svg style="fill:red;" height="${this.size}" width="${this.size}" xmlns="http://www.w3.org/2000/svg">${this._svg.innerHTML}</svg>`;this._svg.removeChild(h);return k};B._edt=function(k,h,a){const d=this._f,c=this._d,b=this._v,e=this._z;for(var f=0;f<h;f++){for(var r=0;r<a;r++)d[r]=k[r*h+f];this._edt1d(d,c,b,e,a);for(r=0;r<a;r++)k[r*h+f]=c[r]}for(f=0;f<a;f++){for(r=0;r<h;r++)d[r]=k[f*h+r];this._edt1d(d,c,b,e,h);for(r=0;r<h;r++)k[f*
h+r]=Math.sqrt(c[r])}};B._edt1d=function(k,h,a,d,c){a[0]=0;d[0]=-1E20;d[1]=1E20;for(let b=1,e=0;b<c;b++){let f=(k[b]+b*b-(k[a[e]]+a[e]*a[e]))/(2*b-2*a[e]);for(;f<=d[e];)e--,f=(k[b]+b*b-(k[a[e]]+a[e]*a[e]))/(2*b-2*a[e]);e++;a[e]=b;d[e]=f;d[e+1]=1E20}for(let b=0,e=0;b<c;b++){for(;d[e+1]<b;)e++;h[b]=(b-a[e])*(b-a[e])+k[a[e]]}};return E}()})},"esri/views/2d/engine/webgl/packingUtils":function(){define(["exports"],function(x){function F(h){return h-Math.floor(h)}const E=[1,256,65536,16777216],B=[1/256,
1/65536,1/16777216,1/4294967296],k=function(h,a=0){let d=0;for(let c=0;4>c;c++)d+=h[a+c]*B[c];return d}(new Uint8ClampedArray([255,255,255,255]));x.packFloatRGBA=function(h,a,d=0){h=0>h?0:h>k?k:h;for(let c=0;4>c;c++)a[d+c]=Math.floor(256*F(h*E[c]))};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/maybe ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/ProgramCache ../../../webgl/Renderbuffer ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ../../../webgl/Texture ../../../webgl/VertexArrayObject ./definitions ./GeometryUtils ./Rect ./RectangleBinPack".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l){function n(u){return u&&"static"===u.type}return function(){function u(m,w,v,C=0){this._mosaicPages=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=w||0>=v)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=w;this._pageHeight=v;this._requestRender=m;0<C&&(this._maxItemSize=C);this.pixelRatio=window.devicePixelRatio||
1;this._binPack=new l(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}var t=u.prototype;t.getWidth=function(m){return m>=this._mosaicPages.length?-1:this._mosaicPages[m].size[0]};t.getHeight=function(m){return m>=this._mosaicPages.length?-1:this._mosaicPages[m].size[1]};t.getPageTexture=function(m){return m<this._mosaicPages.length?
this._mosaicPages[m].texture:null};t.has=function(m){return this._mosaicRects.has(m)};t.getSpriteItem=function(m){return this._mosaicRects.get(m)};t.addSpriteItem=function(m,w,v,C,A,y){if(this._mosaicRects.has(m))return this._mosaicRects.get(m);let p,z,D;n(v)?[p,z,D]=this._allocateImage(w[0],w[1]):(p=new g(0,0,w[0],w[1]),z=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:v,size:w,dirty:!0,texture:void 0}));if(0>=p.width||0>=p.height)return null;y={rect:p,width:w[0],height:w[1],sdf:A,simplePattern:y,
pixelRatio:1,page:z};this._mosaicRects.set(m,y);n(v)&&this._copy({rect:p,spriteSize:w,spriteData:v.data,page:z,pageSize:D,repeat:C,sdf:A});return y};t.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};t.processNextItem=function(){const m=this._spriteCopyQueue.pop();m&&this._copy(m)};t.getSpriteItems=function(m){const w={};for(const v of m)w[v]=this.getSpriteItem(v);return w};t.getMosaicItemPosition=function(m){const w=(m=this.getSpriteItem(m))&&m.rect;if(!w)return null;w.width=
m.width;w.height=m.height;const v=r.SPRITE_PADDING,C=this._mosaicPages[m.page];return{size:[m.width,m.height],tl:[(w.x+v)/C[0],(w.y+v)/C[1]],br:[(w.x+v+m.width)/C[0],(w.y+v+m.height)/C[1]],page:m.page}};t.bind=function(m,w,v=0,C=0){v=this._mosaicPages[v];var A=v.mosaicsData,y=v.texture;y||(y=v.size,y=n(A)?new e(m,{pixelFormat:6408,dataType:5121,width:y[0],height:y[1]},new Uint8Array(A.data.buffer)):new e(m,{pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:y[0],height:y[1]},null),
v.texture=y);y.setSamplingMode(w);n(A)?(m.bindTexture(y,C),v.dirty&&(y.setData(new Uint8Array(A.data.buffer)),y.generateMipmap())):(w=A.data,A=w.bindFrame(m,y,C),E.isSome(this._requestRender)&&A&&0<w.frameCount&&this._requestRender.requestRender(),w.bindFrame(m,y,C));v.dirty=!1};u._copyBits=function(m,w,v,C,A,y,p,z,D,G,I){let K=C*w+v;p=z*y+p;if(I)for(p-=y,I=-1;I<=G;I++,K=((I+G)%G+C)*w+v,p+=y)for(z=-1;z<=D;z++)A[p+z]=m[K+(z+D)%D];else for(v=0;v<G;v++){for(C=0;C<D;C++)A[p+C]=m[K+C];K+=w;p+=y}};t._copy=
function(m){if(!(m.page>=this._mosaicPages.length)){var w=this._mosaicPages[m.page],v=w.mosaicsData;if(!n(w.mosaicsData))throw new F("mapview-invalid-resource","unsuitable data type!");var C=m.spriteData;(v=v.data)&&C||console.error("Source or target images are uninitialized!");u._copyBits(C,m.spriteSize[0],0,0,v,m.pageSize[0],m.rect.x+r.SPRITE_PADDING,m.rect.y+r.SPRITE_PADDING,m.spriteSize[0],m.spriteSize[1],m.repeat);w.dirty=!0}};t._allocateImage=function(m,w){m+=2*r.SPRITE_PADDING;w+=2*r.SPRITE_PADDING;
var v=Math.max(m,w);if(this._maxItemSize&&this._maxItemSize<v){v=2**Math.ceil(q.log2(m));const C=2**Math.ceil(q.log2(w));m=new g(0,0,m,w);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(v*C)},size:[v,C],dirty:!0,texture:void 0});return[m,this._mosaicPages.length-1,[v,C]]}v=this._binPack.allocate(m,w);return 0>=v.width?(v=this._mosaicPages[this._currentPage],!v.dirty&&n(v.mosaicsData)&&(v.mosaicsData.data=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",
data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new l(this._pageWidth,this._pageHeight),this._allocateImage(m,w)):[v,this._currentPage,[this._pageWidth,this._pageHeight]]};t.dispose=function(){this._binPack=null;for(const w of this._mosaicPages){var m=w.texture;m&&m.dispose();m=w.mosaicsData;n(m)||m.data.pause()}this._mosaicPages=null;this._mosaicRects.clear()};x._createClass(u,[{key:"itemCount",get:function(){return this._mosaicRects.size}}]);
return u}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../../../../../core/promiseUtils"],function(x,F,E,B){function k(t,m=0,w=t.length-m){let v=-1;for(let C=m,A=m+w;C<A;C++)v=v>>>8^r[(v^t[C])&255];return v^-1}function h(t){const m=t.constructor===Uint8Array?t:new Uint8Array(t);return n.some((w,v)=>w!==m[v])?!1:!0}function a(t,m){const w=new Uint8Array(m);if(n.some((I,K)=>I!==w[K]))return g;
let v=!1;d(w,I=>!(v="acTL"===I));if(!v)return l;const C=[],A=[];let y=null,p=null,z=0;d(w,(I,K,N,L)=>{const M=new DataView(K.buffer);switch(I){case "IHDR":y=K.subarray(N+8,N+8+L);t.width=M.getUint32(N+8);t.height=M.getUint32(N+12);break;case "acTL":t.numPlays=M.getUint32(N+8+4);break;case "fcTL":p&&(t.frames.push(p),z++);p=new u;p.width=M.getUint32(N+8+4);p.height=M.getUint32(N+8+8);p.left=M.getUint32(N+8+12);p.top=M.getUint32(N+8+16);I=M.getUint16(N+8+20);K=M.getUint16(N+8+22);0===K&&(K=100);p.delay=
1E3*I/K;10>=p.delay&&(p.delay=100);t.playTime+=p.delay;p.disposeOp=M.getUint8(N+8+24);p.blendOp=M.getUint8(N+8+25);p.dataParts=[];0===z&&2===p.disposeOp&&(p.disposeOp=1);break;case "fdAT":p&&p.dataParts.push(K.subarray(N+8+4,N+8+L));break;case "IDAT":p&&p.dataParts.push(K.subarray(N+8,N+8+L));break;case "IEND":A.push(b(K,N,12+L));break;default:C.push(b(K,N,12+L))}});if(0===t.frames.length)return l;t.frameCount=t.frames.length;const D=new Blob(C),G=new Blob(A);t.frames.forEach(I=>{let K=[];K.push(n);
y.set(f(I.width),0);y.set(f(I.height),4);K.push(e("IHDR",y));K.push(D);I.dataParts.forEach(N=>K.push(e("IDAT",N)));K.push(G);I.data=new Blob(K,{type:"image/png"});delete I.dataParts;K=null});return t}function d(t,m){const w=new DataView(t.buffer);let v=8;let C,A;do{C=w.getUint32(v);var y=v+4;y=Array.prototype.slice.call(t.subarray(y,y+4));y=String.fromCharCode.apply(String,y);A=m(y,t,v,C);v+=12+C}while(!1!==A&&"IEND"!==y&&v<t.length)}function c(t){const m=new Uint8Array(t.length);for(let w=0;w<t.length;w++)m[w]=
t.charCodeAt(w);return m}function b(t,m,w){const v=new Uint8Array(w);v.set(t.subarray(m,m+w));return v}function e(t,m){const w=t.length+m.length,v=new Uint8Array(w+8),C=new DataView(v.buffer);C.setUint32(0,m.length);v.set(c(t),4);v.set(m,8);t=k(v,4,w);C.setUint32(w+4,t);return v}function f(t){return new Uint8Array([t>>>24&255,t>>>16&255,t>>>8&255,t&255])}const r=new Uint32Array(256);for(var q=0;256>q;q++){let t=q;for(let m=0;8>m;m++)t=0!==(t&1)?3988292384^t>>>1:t>>>1;r[q]=t}const g=new E("Not a PNG"),
l=new E("Not an animated PNG"),n=new Uint8Array([137,80,78,71,13,10,26,10]);q=function(){function t(){this.playTime=this.numPlays=this.height=this.width=0;this.frames=[];this.playing=this.paused=!1;this.playSpeed=1;this.currentFrameNumber=0;this._lastUsedFrame=-1}t.create=function(){var w=F._asyncToGenerator(function*(v,C){const A=new t;try{yield A._load(v,C)}catch(y){if(!B.isAbortError(y))return new E("invalid-resource",`Could not load PNG: ${y.message}`)}return A});return function(v,C){return w.apply(this,
arguments)}}();var m=t.prototype;m.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};m.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};m.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};m.bindFrame=function(w,v,C){w.bindTexture(v,C);w=this.frameChanged();if(!w)return!1;C=this.currentFrame;const A=C.frameData,y=v.descriptor;(C.left||C.top||C.width!==y.width||C.height!==y.height)&&v.setData(null);v.updateData(0,C.left,
C.top,C.width,C.height,A);this.updateUsedFrame();return w};m.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};m.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};m._load=function(){var w=F._asyncToGenerator(function*(v,C){try{const A=a(this,v);if(A!==this)return A;this._resizeCanvas=document.createElement("canvas");this._resizeCanvas.width=this.width;this._resizeCanvas.height=this.height;yield Promise.all(this.frames.map(y=>y.createImage(this._resizeCanvas)))}catch(A){if(!B.isAbortError(A))return new E("invalid-resource",
"Could not parse PNG")}this.play()});return function(v,C){return w.apply(this,arguments)}}();m._play=function(){if(0===this.playSpeed)this.pause();else{if(0>this.playSpeed){--this.currentFrameNumber;0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1);var w=this.currentFrameNumber;--w;0>w&&(w=this.frames.length-1);w=-this.frames[w].delay/this.playSpeed}else this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,w=1*this.frames[this.currentFrameNumber].delay/this.playSpeed;
var v=this.frames[this.currentFrameNumber];this.currentFrame={frameData:v.imageData,top:v.top,left:v.left,width:v.width,height:v.height};this.timerID=window.setTimeout(()=>this._play(),w)}};return t}();let u=function(){function t(){this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageData=this.data=null}t.prototype.createImage=function(){var m=F._asyncToGenerator(function*(w){if(null===this.imageData)return new Promise((v,C)=>{const A=URL.createObjectURL(this.data),
y=document.createElement("img");y.onload=()=>{URL.revokeObjectURL(A);{w.width=y.width;w.height=y.height;var p=w.getContext("2d");p.drawImage(y,0,0,y.width,y.height);p=p.getImageData(0,0,y.width,y.height);p=new Uint8Array(p.data);let z;for(let D=0;D<p.length;D+=4)z=p[D+3]/255,p[D]*=z,p[D+1]*=z,p[D+2]*=z;p=new ImageData(new Uint8ClampedArray(p.buffer),y.width,y.height)}this.imageData=p;v()};y.onerror=()=>{URL.revokeObjectURL(A);this.imageData=null;C(Error("Image creation error"))};y.src=A})});return function(w){return m.apply(this,
arguments)}}();return t}();x.default=q;x.getPNGSize=function(t){t=new Uint8Array(t);let m,w;d(t,(v,C,A)=>{C=new DataView(C.buffer);"IHDR"===v&&(m=C.getUint32(A+8),w=C.getUint32(A+12))});return[m,w]};x.isAnimatedPNG=function(t){t=new Uint8Array(t);if(!h(t))return!1;let m=!1;d(t,w=>!(m="acTL"===w));return m};x.isPNG=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error",
"../../../../../core/promiseUtils"],function(x,F,E,B){function k(d){if(!d||0===d.byteLength)return!1;d=d.constructor===Uint8Array?d:new Uint8Array(d);return 71===d[0]&&73===d[1]&&70===d[2]&&56===d[3]}let h=function(){function d(){this.playing=this.paused=!1;this.waitTillDone=!0;this.firstFrameOnly=this.loading=!1;this.frames=[];this.comment="";this.frameCount=this.currentFrameNumber=this.length=0;this.playSpeed=1;this.lastFrame=null;this.playOnLoad=!0;this.complete=!1;this.interlaceOffsets=[0,4,2,
1];this.interlaceSteps=[8,8,4,2];this._lastUsedFrame=-1}d.create=function(){var b=F._asyncToGenerator(function*(e,f){const r=new d;try{yield r._load(e,f)}catch(q){if(!B.isAbortError(q))return new E("invalid-resource",`Could not load PNG: ${q.message}`)}return r});return function(e,f){return b.apply(this,arguments)}}();var c=d.prototype;c.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};c.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};c.togglePlay=
function(){this.paused||!this.playing?this.play():this.pause()};c.bindFrame=function(b,e,f){b.bindTexture(e,f);if(b=this.frameChanged())f=this.currentFrame,e.updateData(0,0,0,f.width,f.height,f.frameData),this.updateUsedFrame();return b};c.seekFrame=function(b){clearTimeout(this.timerID);this.currentFrameNumber=b%this.frames.length;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};c.seek=function(b){clearTimeout(this.timerID);0>b&&(b=0);b=1E3*b%this.length;let e=0;for(;b>this.frames[e].time+
this.frames[e].delay&&e<this.frames.length;)e+=1;this.currentFrameNumber=e;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};c.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};c.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};c._load=function(){var b=F._asyncToGenerator(function*(e,f){try{this.loading=!0,yield this._parse(e,f),this.loading=!1,this.play()}catch(r){if(!B.isAbortError(r))return new E("invalid-resource","Could not parse gif!")}});
return function(e,f){return b.apply(this,arguments)}}();c._parse=function(b,e){const f=new a(b);f.pos+=6;this.width=f.data[f.pos++]+(f.data[f.pos++]<<8);this.height=f.data[f.pos++]+(f.data[f.pos++]<<8);b=f.data[f.pos++];this.globalColourCount=1<<(b&7)+1;f.pos++;f.pos++;b&128&&(this.globalColourTable=this._parseColourTable(this.globalColourCount,f));return new Promise((r,q)=>{setTimeout(()=>this._parseBlock(f,r,q,e),0)})};c._parseBlock=function(){var b=F._asyncToGenerator(function*(e,f,r,q){if(q&&
q.signal&&B.isAborted(q.signal))r(B.createAbortError());else{var g=e.data[e.pos++];if(44===g){if(this._parseImg(e),this.firstFrameOnly){this._finishedLoading();f();return}}else{if(59===g){this._finishedLoading();f();return}this._parseExt(e)}if("function"===typeof this.onprogress)this.onprogress({bytesRead:e.pos,totalBytes:e.data.length,frame:this.frames.length});setTimeout(()=>this._parseBlock(e,f,r,q),0)}});return function(e,f,r,q){return b.apply(this,arguments)}}();c._parseColourTable=function(b,
e){const f=[];for(let r=0;r<b;r++)f.push([e.data[e.pos++],e.data[e.pos++],e.data[e.pos++]]);return f};c._parseImg=function(b){const e=q=>{const g=this.pixelBufSize/q;this.interlacedBufSize!==this.pixelBufSize&&(this.deinterlaceBuf=new Uint8Array(this.pixelBufSize),this.interlacedBufSize=this.pixelBufSize);let l=0;for(let n=0;4>n;n++)for(let u=this.interlaceOffsets[n];u<g;u+=this.interlaceSteps[n])this.deinterlaceBuf.set(this.pixelBuf.subarray(l,l+q),u*q),l+=q},f={};this.frames.push(f);f.disposalMethod=
this.disposalMethod;f.time=this.length;f.delay=10*this.delayTime;this.length+=f.delay;f.transparencyIndex=this.transparencyGiven?this.transparencyIndex:void 0;f.leftPos=b.data[b.pos++]+(b.data[b.pos++]<<8);f.topPos=b.data[b.pos++]+(b.data[b.pos++]<<8);f.width=b.data[b.pos++]+(b.data[b.pos++]<<8);f.height=b.data[b.pos++]+(b.data[b.pos++]<<8);const r=b.data[b.pos++];f.localColourTableFlag=r&128?!0:!1;f.localColourTableFlag&&(f.localColourTable=this._parseColourTable(1<<(r&7)+1,b));this.pixelBufSize!==
f.width*f.height&&(this.pixelBuf=new Uint8Array(f.width*f.height),this.pixelBufSize=f.width*f.height);this._lzwDecode(b.data[b.pos++],b.readSubBlocksB());r&64?(f.interlaced=!0,e(f.width)):f.interlaced=!1;this._processFrame(f)};c._lzwDecode=function(b,e){let f,r,q,g,l;let n,u;q=r=0;let t=[];const m=1<<b,w=m+1;g=b+1;for(u=!1;!u;){var v=l;for(f=l=0;f<g;f++)e[q>>3]&1<<(q&7)&&(l|=1<<f),q++;if(l===m){t=[];g=b+1;for(f=0;f<m;f++)t[f]=[f];t[m]=[];t[w]=null}else{if(l===w){u=!0;break}l>=t.length?t.push(t[v].concat(t[v][0])):
v!==m&&t.push(t[v].concat(t[l][0]));v=t[l];n=v.length;for(f=0;f<n;f++)this.pixelBuf[r++]=v[f];t.length===1<<g&&12>g&&g++}}};c._processFrame=function(b){b.image=document.createElement("canvas");b.image.width=this.width;b.image.height=this.height;b.ctx=b.image.getContext("2d");const e=b.localColourTableFlag?b.localColourTable:this.globalColourTable;null===this.lastFrame&&(this.lastFrame=b);const f=2===this.lastFrame.disposalMethod||3===this.lastFrame.disposalMethod?!0:!1;f||b.ctx.drawImage(this.lastFrame.image,
0,0,this.width,this.height);const r=b.ctx.getImageData(b.leftPos,b.topPos,b.width,b.height),q=b.transparencyIndex,g=r.data,l=b.interlaced?this.deinterlaceBuf:this.pixelBuf,n=l.length;let u=0,t,m;for(let w=0;w<n;w++)t=l[w],m=e[t],q!==t?(g[u++]=m[0],g[u++]=m[1],g[u++]=m[2],g[u++]=255):(f&&(g[u+3]=0),u+=4);b.ctx.putImageData(r,b.leftPos,b.topPos);this.lastFrame=b};c._parseExt=function(b){const e=b.data[b.pos++];249===e?this._parseGCExt(b):254===e?this.comment+=b.readSubBlocks():255===e?this._parseAppExt(b):
(1===e&&(b.pos+=13),b.readSubBlocks())};c._parseAppExt=function(b){b.pos+=1;"NETSCAPE"===b.getString(8)?b.pos+=8:(b.pos+=3,b.readSubBlocks())};c._parseGCExt=function(b){b.pos++;const e=b.data[b.pos++];this.disposalMethod=(e&28)>>2;this.transparencyGiven=e&1?!0:!1;this.delayTime=b.data[b.pos++]+(b.data[b.pos++]<<8);this.transparencyIndex=b.data[b.pos++];b.pos++};c._finishedLoading=function(){this.loading=!1;this.frameCount=this.frames.length;this.lastFrame=null;this.complete=!0;this.deinterlaceBuf=
this.pixelBufSize=this.deinterlaceBuf=this.pixelBuf=this.waitTillDone=this.transparencyIndex=this.delayTime=this.transparencyGiven=this.disposalMethod=void 0;this.currentFrameNumber=0;0<this.frames.length&&this._setCurrentFrame(0);this.playOnLoad&&this.play()};c._play=function(){if(0===this.playSpeed)this.pause();else{if(0>this.playSpeed){--this.currentFrameNumber;0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1);var b=this.currentFrameNumber;--b;0>b&&(b=this.frames.length-
1);b=-this.frames[b].delay/this.playSpeed}else this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,b=1*this.frames[this.currentFrameNumber].delay/this.playSpeed;this._setCurrentFrame(this.currentFrameNumber);this.timerID=window.setTimeout(()=>this._play(),b)}};c._setCurrentFrame=function(b){this.currentFrame={frameData:this.frames[b].image,top:0,left:0,width:this.width,height:this.height}};return d}(),a=function(){function d(b){this.pos=0;this.data=new Uint8ClampedArray(b);this.len=
this.data.length}var c=d.prototype;c.getString=function(b){let e="";for(;b--;)e+=String.fromCharCode(this.data[this.pos++]);return e};c.readSubBlocks=function(){let b,e,f="";do for(e=b=this.data[this.pos++];e--;)f+=String.fromCharCode(this.data[this.pos++]);while(0!==b&&this.pos<this.len);return f};c.readSubBlocksB=function(){let b,e;const f=[];do for(e=b=this.data[this.pos++];e--;)f.push(this.data[this.pos++]);while(0!==b&&this.pos<this.len);return f};return d}();x.default=h;x.getGIFSize=function(d){var c=
new Uint8ClampedArray(d);let b=6;d=c[b++]+(c[b++]<<8);c=c[b++]+(c[b++]<<8);return[d,c]};x.isAnimatedGIF=function(d){if(!d||0===d.byteLength)return!1;d=new Uint8Array(d);if(!k(d))return!1;let c=0;for(let b=0,e=d.length-9;b<e&&(0!==d[b]||33!==d[b+1]||249!==d[b+2]||4!==d[b+3]||0!==d[b+8]||44!==d[b+9]&&33!==d[b+9]||(c++,!(1<c)));++b);return 1<c};x.isGIF=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/BidiText":function(){define(["exports","../../../../../core/BidiEngine"],
function(x,F){const E=new F;x.bidiText=function(B){if(!E.hasBidiChar(B))return[B,!1];let k;k="rtl"===E.checkContextual(B)?"IDNNN":"ICNNN";return[E.bidiTransform(B,k,"VLYSN"),!0]};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/core/BidiEngine":function(){define(["./bidiEngineTables"],function(x){function F(v,C,A,y,p){var z=v;void 0===C&&(C=p.defInFormat);void 0===A&&(A=p.defOutFormat);void 0===y&&(y=p.defSwap);if(C!==A){var D=C.substring(0,1),G=A.substring(0,1);var I=C.substring(1,4);var K=
A.substring(1,4);"C"===I.charAt(0)&&(I=E(z),I="ltr"===I||"rtl"===I?I.toUpperCase():"L"===C.charAt(2)?"LTR":"RTL",C=D+I);"C"===K.charAt(0)&&(I=E(z),"rtl"===I?K="RTL":"ltr"===I?(z=z.split(""),z.reverse(),I=E(z.join("")),K=I.toUpperCase()):K="L"===A.charAt(2)?"LTR":"RTL",A=G+K)}if(C===A)return v;G=C.substring(0,1);z=C.substring(1,4);D=A.substring(0,1);K=A.substring(1,4);p.inFormat=C;p.outFormat=A;p.swap=y;if("L"===G&&"VLTR"===A){if("LTR"===z)return p.dir=0,B(v,p);if("RTL"===z)return p.dir=1,B(v,p)}if("V"===
G&&"V"===D)return p.dir="RTL"===z?1:0,h(v,p);if("L"===G&&"VRTL"===A)return p.dir="LTR"===z?0:1,v=B(v,p),h(v);if("VLTR"===C&&"LLTR"===A)return p.dir=0,B(v,p);if("V"===G&&"L"===D&&z!==K)return v=h(v),"RTL"===z?F(v,"LLTR","VLTR",y,p):F(v,"LRTL","VRTL",y,p);if("VRTL"===C&&"LRTL"===A)return F(v,"LRTL","VRTL",y,p);"L"===G&&"L"===D&&(C=p.swap,p.swap=C.substr(0,1)+"N","RTL"===z?(p.dir=1,v=B(v,p),p.swap="N"+C.substr(1,2),p.dir=0,v=B(v,p)):(p.dir=0,v=B(v,p),p.swap="N"+C.substr(1,2),v=F(v,"VLTR","LRTL",p.swap,
p)));return v}function E(v){return(v=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(v))?"z">=v[0]?"ltr":"rtl":""}function B(v,C){v=v.split("");const A=[];k(v,A,C);if(0!==C.hiLevel&&C.swap.substr(0,1)!==C.swap.substr(1,2))for(let z=0;z<v.length;z++)if(1===A[z]){var y=z;b:{let D=void 0;var p=v[z];let G=0,I=x.SwapTable.length-1;for(;G<=I;)if(D=Math.floor((G+I)/2),p<x.SwapTable[D][0])I=D-1;else if(p>x.SwapTable[D][0])G=D+1;else{p=x.SwapTable[D][1];break b}}v[y]=p}c(2,
v,A,C);c(1,v,A,C);u=A;return v.join("")}function k(v,C,A){const y=v.length;var p=A.dir?x.impTabRtl:x.impTabLtr,z=0,D=-1;const G=[],I=[];A.hiLevel=A.dir;A.lastArabic=!1;A.hasUbatAl=!1;A.hasUbatB=!1;A.hasUbatS=!1;for(var K=0;K<y;K++){var N=K;{var L=v[K].charCodeAt(0);const M=x.PrimaryTable[L>>8];L=M<x.TBBASE?M:x.UnicodeTable[M-x.TBBASE][L&255]}G[N]=L}for(N=0;N<y;N++){K=b(v,G,I,N,A);I[N]=K;z=p[z][K];L=z&240;z&=15;K=p[z][5];C[N]=K;if(0<L){if(16===L)for(;D<N;D++)C[D]=1;D=-1}if(p[z][6])-1===D&&(D=N);else if(-1<
D){for(;D<N;D++)C[D]=K;D=-1}G[N]===x.UBAT_B&&(C[N]=0);A.hiLevel|=K}if(A.hasUbatS)for(v=0;v<y;v++)if(G[v]===x.UBAT_S)for(C[v]=A.dir,p=v-1;0<=p;p--)if(G[p]===x.UBAT_WS)C[p]=A.dir;else break}function h(v,C){v=v.split("");if(C){const A=[];k(v,A,C);u=A}v.reverse();l.reverse();return v.join("")}function a(v){for(let C=0;C<x.ArabicAlefBetIntervalsBegine.length;C++)if(v>=x.ArabicAlefBetIntervalsBegine[C]&&v<=x.ArabicAlefBetIntervalsEnd[C])return!0;return!1}function d(v,C,A,y){for(;C*A<y&&f(v[C]);)C+=A;return C*
A<y&&a(v[C])?!0:!1}function c(v,C,A,y){if(!(y.hiLevel<v))if(1!==v||1!==y.dir||y.hasUbatB){y=C.length;for(var p=0,z,D,G;p<y;){if(A[p]>=v){for(z=p+1;z<y&&A[z]>=v;)z++;for(D=z-1;p<D;p++,D--)G=C[p],C[p]=C[D],C[D]=G,G=l[p],l[p]=l[D],l[D]=G;p=z}p++}}else C.reverse(),l.reverse()}function b(v,C,A,y,p){return{UBAT_L:()=>{p.lastArabic=!1;return x.UBAT_L},UBAT_R:()=>{p.lastArabic=!1;return x.UBAT_R},UBAT_ON:()=>x.UBAT_ON,UBAT_AN:()=>x.UBAT_AN,UBAT_EN:()=>p.lastArabic?x.UBAT_AN:x.UBAT_EN,UBAT_AL:()=>{p.lastArabic=
!0;p.hasUbatAl=!0;return x.UBAT_R},UBAT_WS:()=>x.UBAT_ON,UBAT_CS:()=>{let z,D;if(1>y||y+1>=C.length||(z=A[y-1])!==x.UBAT_EN&&z!==x.UBAT_AN||(D=C[y+1])!==x.UBAT_EN&&D!==x.UBAT_AN)return x.UBAT_ON;p.lastArabic&&(D=x.UBAT_AN);return D===z?D:x.UBAT_ON},UBAT_ES:()=>(0<y?A[y-1]:x.UBAT_B)===x.UBAT_EN&&y+1<C.length&&C[y+1]===x.UBAT_EN?x.UBAT_EN:x.UBAT_ON,UBAT_ET:()=>{if(0<y&&A[y-1]===x.UBAT_EN)return x.UBAT_EN;if(p.lastArabic)return x.UBAT_ON;let z=y+1;const D=C.length;for(;z<D&&C[z]===x.UBAT_ET;)z++;return z<
D&&C[z]===x.UBAT_EN?x.UBAT_EN:x.UBAT_ON},UBAT_NSM:()=>{if("VLTR"===p.inFormat){for(var z=C.length,D=y+1;D<z&&C[D]===x.UBAT_NSM;)D++;if(D<z&&(z=v[y].charCodeAt[0],D=C[D],(1425<=z&&2303>=z||64286===z)&&(D===x.UBAT_R||D===x.UBAT_AL)))return x.UBAT_R}return 1>y||C[y-1]===x.UBAT_B?x.UBAT_ON:A[y-1]},UBAT_B:()=>{p.lastArabic=!0;p.hasUbatB=!0;return p.dir},UBAT_S:()=>{p.hasUbatS=!0;return x.UBAT_ON},UBAT_LRE:()=>{p.lastArabic=!1;return x.UBAT_ON},UBAT_RLE:()=>{p.lastArabic=!1;return x.UBAT_ON},UBAT_LRO:()=>
{p.lastArabic=!1;return x.UBAT_ON},UBAT_RLO:()=>{p.lastArabic=!1;return x.UBAT_ON},UBAT_PDF:()=>{p.lastArabic=!1;return x.UBAT_ON},UBAT_BN:()=>x.UBAT_ON}[x.TYPES_NAMES[C[y]]]()}function e(v,C){for(let A=0;A<x.BaseForm.length;A++)if(v===x.BaseForm[A])return C[A];return v}function f(v){return"\u064b"<=v&&"\u0655">=v?!0:!1}function r(v){return"L"===v?"LTR":"R"===v?"RTL":"C"===v?"CLR":"D"===v?"CRL":""}function q(v,C){for(let A=0;A<x.AlefTable.length;A++)if(v===x.AlefTable[A])return C[A];return v}function g(v,
C,A,y){for(let p=0;p<v.length;p++)if(v[p]>C||!A&&v[p]===C)v[p]+=y}let l=[],n=[],u=[];const t={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},m=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,w=/[\u0591-\u06ff\ufb1d-\ufefc]/;return function(){function v(){this.inputFormat="ILYNN";this.outputFormat="VLNNN";this.sourceToTarget=[];this.targetToSource=[];this.levels=[]}var C=
v.prototype;C.bidiTransform=function(A,y,p){this.sourceToTarget=[];this.targetToSource=[];if(!A)return"";var z=this.sourceToTarget,D=this.targetToSource,G=A.length;l=[];u=[];for(var I=0;I<G;I++)z[I]=I,D[I]=I,l[I]=I;if(!this.checkParameters(y,p))return A;y=this.inputFormat;p=this.outputFormat;z=A;G=r(y.charAt(1));z=r(p.charAt(1));I="I"===y.charAt(0)?"L":y.charAt(0);D="I"===p.charAt(0)?"L":p.charAt(0);G=I+G;z=D+z;D=y.charAt(2)+p.charAt(2);t.defInFormat=G;t.defOutFormat=z;t.defSwap=D;A=F(A,G,z,D,t);
z=!1;if("R"===p.charAt(1))z=!0;else if("C"===p.charAt(1)||"D"===p.charAt(1))z="rtl"===this.checkContextual(A);D=this.sourceToTarget=l;G=Array(D.length);for(I=0;I<D.length;I++)G[D[I]]=I;n=this.targetToSource=D=G;if(y.charAt(3)===p.charAt(3))z=A;else if("S"===p.charAt(3))if(y=z,p=!0,0===A.length)z="";else{void 0===y&&(y=!0);void 0===p&&(p=!0);A=String(A);A=A.split("");G=0;z=1;D=A.length;y||(G=A.length-1,z=-1,D=1);var K=G;G=p;var N=0;I=[];for(var L=0;K*z<D;K+=z)if(a(A[K])||f(A[K])){var M;if(M="\u0644"===
A[K])b:{for(var O=A,H=K+z,J=z,P=D;H*J<P&&f(O[H]);)H+=J;M=" ";if(H*J<P)for(M=O[H],O=0;O<x.AlefTable.length;O++)if(x.AlefTable[O]===M){M=!0;break b}M=!1}if(M){A[K]=0===N?q(A[K+z],x.LamAlefInialTableFE):q(A[K+z],x.LamAlefMedialTableFE);K+=z;N=A;M=K;O=z;for(H=D;M*O<H&&f(N[M]);)M+=O;M*O<H&&(N[M]=" ");G&&(I[L]=K,L++);N=0}else{M=A[K];if(1===N){O=K;if(d(A,K+z,z,D))b:for(H=A[K],J=0;J<x.BaseForm.length;J++){if(H===x.BaseForm[J]){H=x.MedialForm[J];break b}}else H=e(A[K],x.FinalForm);A[O]=H}else!0===d(A,K+z,
z,D)?A[K]=e(A[K],x.InitialForm):A[K]=e(A[K],x.IsolatedForm);f(M)||(N=1);b:{for(O=0;O<x.StandAlonForm.length;O++)if(x.StandAlonForm[O]===M){M=!0;break b}M=!1}!0===M&&(N=0)}}else N=0;z=I;D="";for(G=0;G<A.length;G++){if(I=p){b:{for(I=0;I<z.length;I++)if(z[I]===G)break b;I=-1}I=-1<I}I?(g(n,G,!y,-1),l.splice(G,1)):D+=A[G]}z=D}else if(y=A,p=z,A=!0,0===y.length)z="";else for(void 0===A&&(A=!0),void 0===p&&(p=!0),y=String(y),z="",D=y.split(""),G=0;G<y.length;G++)I=!1,"\ufe70"<=D[G]&&"\ufeff">D[G]?(L=y.charCodeAt(G),
"\ufef5"<=D[G]&&"\ufefc">=D[G]?(p?(0<G&&A&&" "===D[G-1]?z=z.substring(0,z.length-1)+"\u0644":(z+="\u0644",I=!0),z+=x.AlefTable[(L-65269)/2]):(z+=x.AlefTable[(L-65269)/2],z+="\u0644",G+1<y.length&&A&&" "===D[G+1]?G++:I=!0),I&&(g(n,G,!0,1),l.splice(G,0,l[G]))):z+=x.FETo06Table[L-65136]):z+=D[G];this.sourceToTarget=l;this.targetToSource=n;this.levels=u;return z};C._inputFormatSetter=function(A){if(!m.test(A))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=A};
C._outputFormatSetter=function(A){if(!m.test(A))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=A};C.checkParameters=function(A,y){A?this._inputFormatSetter(A):A=this.inputFormat;y?this._outputFormatSetter(y):y=this.outputFormat;return A===y?!1:!0};C.checkContextual=function(A){A=E(A);if("ltr"!==A&&"rtl"!==A){try{A=document.dir.toLowerCase()}catch(y){}"ltr"!==A&&"rtl"!==A&&(A="ltr")}return A};C.hasBidiChar=function(A){return w.test(A)};return v}()})},"esri/core/bidiEngineTables":function(){define(["exports"],
function(x){x.AlefTable=["\u0622","\u0623","\u0625","\u0627"];x.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];x.ArabicAlefBetIntervalsEnd=["\u063a","\u064a"];x.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");x.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
x.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");x.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");
x.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");x.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];x.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];x.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");
x.PrimaryTable=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107];x.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");x.SwapTable=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59",
"\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];x.TBBASE=100;x.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");x.UBAT_AL=7;x.UBAT_AN=3;x.UBAT_B=5;x.UBAT_BN=18;x.UBAT_CS=9;x.UBAT_EN=2;x.UBAT_ES=10;x.UBAT_ET=11;x.UBAT_L=0;x.UBAT_LRE=13;x.UBAT_LRO=16;x.UBAT_NSM=12;x.UBAT_ON=
4;x.UBAT_PDF=15;x.UBAT_R=1;x.UBAT_RLE=14;x.UBAT_RLO=17;x.UBAT_S=6;x.UBAT_WS=8;x.UnicodeTable=[[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,
4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,12,1,12,12,1,12,12,1,12,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,11,11,7,9,7,4,4,12,12,12,12,12,12,12,12,12,12,12,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,3,3,3,3,3,3,3,3,3,3,11,3,3,7,7,7,12,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,3,4,12,12,12,12,12,12,7,7,12,12,4,12,12,12,12,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,12,12,12,12,12,12,12,12,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,18,18,18,18,18,4,4,4,4,4,18,18,18,18,18,18,2,0,4,4,2,2,2,2,2,2,10,10,4,4,4,0,2,2,2,2,2,2,2,2,2,2,10,10,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,
4,4,0,0,0,0,0,4,4,4,4,4,1,12,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,11,4,4,10,10,4,4,4,4,4,11,11,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,4,4,18],[4,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,11,11,4,4,4,11,11,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];x.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];x.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(x,F){x.ok=function(E,B){return E&&"name"in E?(B&&B.error(new F(E.name,E.message,E.details)),!1):!0};Object.defineProperty(x,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["exports"],function(x){x.keyFromSymbol=function(F){switch(F.type){case "esriSMS":return`${F.style}.${F.path}`;case "esriSLS":return`${F.style}.${F.cap}`;case "esriSFS":return`${F.style}`;case "esriPFS":case "esriPMS":return F.imageData?`${F.imageData}${F.width}${F.height}`:`${F.url}${F.width}${F.height}`;default:return F.mosaicHash?F.mosaicHash:JSON.stringify(F)}};Object.defineProperty(x,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(x,F,E,B,k,h){h=function(a){function d(){var b=a.apply(this,arguments)||this;b.defines=[];b._desc={vsPath:"fx/integrate",fsPath:"fx/integrate",attributes:new Map([["a_position",0]])};return b}F._inheritsLoose(d,a);var c=d.prototype;c.dispose=function(){this._quad&&this._quad.dispose()};
c.bind=function(){};c.unbind=function(){};c.draw=function(b,e){if(e.size){var {context:f,renderingOptions:r}=b;this._quad||(this._quad=new k(f,[0,0,1,0,0,1,1,1]));var q=f.getBoundFramebufferObject(),{x:g,y:l,width:n,height:u}=f.getViewport();e.bindTextures(f);var t=e.getBlock(B.ATTRIBUTE_DATA_ANIMATION);if(!E.isNone(t)){var m=t.getFBO(f);t=t.getFBO(f,1);f.setViewport(0,0,e.size,e.size);this._computeDelta(b,t,r.labelsAnimationTime);this._updateAnimationState(b,t,m);f.bindFramebuffer(q);f.setViewport(g,
l,n,u)}}};c._computeDelta=function(b,e,f){const {context:r,painter:q,displayLevel:g}=b,l=q.materialManager.getProgram(b,this._desc,["delta"]);r.bindFramebuffer(e);r.setClearColor(0,0,0,0);r.clear(r.gl.COLOR_BUFFER_BIT);r.useProgram(l);l.setUniform1i("u_maskTexture",B.TEXTURE_BINDING_ATTRIBUTE_DATA_0);l.setUniform1i("u_sourceTexture",B.TEXTURE_BINDING_ATTRIBUTE_DATA_1);l.setUniform1f("u_timeDelta",b.deltaTime);l.setUniform1f("u_animationTime",f);l.setUniform1f("u_zoomLevel",Math.round(10*g));this._quad.draw()};
c._updateAnimationState=function(b,e,f){const {context:r,painter:q}=b;b=q.materialManager.getProgram(b,this._desc,["update"]);r.bindTexture(e.colorTexture,1);r.useProgram(b);b.setUniform1i("u_sourceTexture",1);r.bindFramebuffer(f);r.setClearColor(0,0,0,0);r.clear(r.gl.COLOR_BUFFER_BIT);this._quad.draw()};return d}(h.Effect);x.AnimationEffect=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["exports"],function(x){x.Effect=function(){this.name=
this.constructor.name};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/BlendEffect":function(){define("exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../webgl/Program ../../../../webgl/ProgramCache ../../../../webgl/Renderbuffer ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../enums ../VertexStream ../shaders/BlendPrograms".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l){const n=E.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");E=function(){function u(){this._size=[0,0]}var t=u.prototype;t.dispose=function(m){this._backBufferTexture&&(this._backBufferTexture.dispose(),this._backBufferTexture=null);this._programCache&&(this._programCache.dispose(),this._programCache=null);this._quad&&(this._quad.dispose(),this._quad=null)};t.draw=function(m,w,v,C,A){const {context:y,drawPhase:p}=m;this._setupShader(y);
C&&"normal"!==C&&p!==q.WGLDrawPhase.LABEL?this._drawBlended(m,w,v,C,A):(m=this._programCache.getProgram(l.blend,"normal"))?(y.useProgram(m),w.setSamplingMode(v),y.bindTexture(w,0),m.setUniform1i("u_layerTexture",0),m.setUniform1f("u_opacity",A),y.setBlendingEnabled(!0),y.setBlendFunction(1,771),w=this._quad,w.draw(),w.unbind()):n.error(new F("mapview-BlendEffect",'Error creating shader program for blend mode "normal"'))};t._drawBlended=function(m,w,v,C,A){const {context:y,state:p,pixelRatio:z,inFadeTransition:D}=
m;var {size:G}=p,I=y.getBoundFramebufferObject();let K;B.isSome(I)?(G=I.descriptor,K=G.width,G=G.height):(K=Math.round(z*G[0]),G=Math.round(z*G[1]));this._createOrResizeTexture(m,K,G);m=this._backBufferTexture;I.copyToTexture(0,0,K,G,0,0,m);y.setStencilTestEnabled(!1);y.setStencilWriteMask(0);y.setBlendingEnabled(!0);y.setDepthTestEnabled(!1);y.setDepthWriteEnabled(!1);(I=this._programCache.getProgram(l.blend,C))?(y.useProgram(I),m.setSamplingMode(v),y.bindTexture(m,0),I.setUniform1i("u_backbufferTexture",
0),w.setSamplingMode(v),y.bindTexture(w,1),I.setUniform1i("u_layerTexture",1),I.setUniform1f("u_opacity",A),I.setUniform1f("u_inFadeOpacity",D?1:0),y.setBlendFunction(1,0),w=this._quad,w.draw(),w.unbind(),y.setBlendFunction(1,771)):n.error(new F("mapview-BlendEffect",`Error creating shader program for blend mode ${C}`))};t._setupShader=function(m){this._programCache||(this._programCache=new d(m),this._quad||(this._quad=new g(m,[-1,-1,1,-1,-1,1,1,1])))};t._createOrResizeTexture=function(m,w,v){({context:m}=
m);if(null===this._backBufferTexture||w!==this._size[0]||v!==this._size[1])this._backBufferTexture?this._backBufferTexture.resize(w,v):this._backBufferTexture=new f(m,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:w,height:v}),this._size[0]=w,this._size[1]=v};return u}();x.BlendEffect=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BlendPrograms":function(){define(["exports","./sources/resolver"],
function(x,F){const E={attributes:new Map([["a_pos",0],["a_tex",1]]),shaders:B=>({vertexShader:`#define ${B.replace("-","_").toUpperCase()}\n`+F.resolveIncludes("blend/blend.vert"),fragmentShader:`#define ${B.replace("-","_").toUpperCase()}\n`+F.resolveIncludes("blend/blend.frag")})};x.blend=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/FeatureEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./Effect"],function(x,F,
E){E=function(B){function k(a){var d=B.call(this)||this;d.name=d.constructor.name;d.defines=[a];return d}F._inheritsLoose(k,B);var h=k.prototype;h.dispose=function(){};h.bind=function({context:a,painter:d}){this._prev=a.getBoundFramebufferObject();const {width:c,height:b}=a.getViewport();d=d.getFbos(c,b).effect0;a.bindFramebuffer(d);a.setColorMask(!0,!0,!0,!0);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT)};h.unbind=function(){};h.draw=function(a,d){const {context:c,painter:b,state:e,deltaTime:f}=
a,r=b.getPostProcessingEffects(d.effects),q=c.getBoundFramebufferObject();r.length&&d.transitionStep(f,e.scale);for(const {postProcessingEffect:g,effect:l}of r)g.draw(a,q,l);c.bindFramebuffer(this._prev);c.setStencilTestEnabled(!1);b.blitTexture(c,q.colorTexture,9728);c.setStencilTestEnabled(!0)};return k}(E.Effect);x.FeatureEffect=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),
function(x,F,E,B,k,h,a){return function(d){function c(){var e=d.apply(this,arguments)||this;e.defines=["highlight"];e._hlRenderer=new h;e._hlGradient=new k;e._width=void 0;e._height=void 0;e._hlSurfaces=new a;e._adjustedWidth=void 0;e._adjustedHeight=void 0;e._blitRenderer=new E.BitBlitRenderer;return e}x._inheritsLoose(c,d);var b=c.prototype;b.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();
this._boundFBO=null};b.bind=function(e){const {context:f,painter:r}=e,{width:q,height:g}=f.getViewport(),l=r.getFbos(q,g).effect0;this.setup(e,q,g);f.bindFramebuffer(l);f.setColorMask(!0,!0,!0,!0);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT)};b.unbind=function(){};b.setup=function({context:e},f,r){this._width=f;this._height=r;const q=f%4,g=r%4;f+=2>q?-q:4-q;r+=2>g?-g:4-g;this._adjustedWidth=f;this._adjustedHeight=r;this._boundFBO=e.getBoundFramebufferObject();f=Math.round(1*f);r=Math.round(1*
r);this._hlRenderer.setup(e,f,r);this._hlSurfaces.setup(e,f,r)};b.draw=function({context:e}){const f=e.getBoundFramebufferObject();e.setViewport(0,0,1*this._adjustedWidth,1*this._adjustedHeight);e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);e.setStencilTestEnabled(!1);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(e,f.colorTexture,9728,1);e.setStencilTestEnabled(!1);e.setBlendingEnabled(!1);e.setColorMask(!1,!1,!1,!0);e.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);
e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(e,this._hlSurfaces.sharedBlur1Tex);e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(e,this._hlSurfaces.sharedBlur2Tex);e.bindFramebuffer(this._boundFBO);e.setBlendingEnabled(!0);e.setColorMask(!0,!0,!0,!0);e.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(e,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);
this._boundFBO=null};b.setHighlightOptions=function(e){this._hlGradient.setHighlightOptions(e)};return c}(B.Effect)})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("../../../../../../core/Logger ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../webgl/Program ../../../../../webgl/ProgramCache ../../../../../webgl/Renderbuffer ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../definitions ./parameters".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f){function r(l,n){n.fillColor[0]=l.color.r/255;n.fillColor[1]=l.color.g/255;n.fillColor[2]=l.color.b/255;n.fillColor[3]=l.color.a;l.haloColor?(n.outlineColor[0]=l.haloColor.r/255,n.outlineColor[1]=l.haloColor.g/255,n.outlineColor[2]=l.haloColor.b/255,n.outlineColor[3]=l.haloColor.a):(n.outlineColor[0]=n.fillColor[0],n.outlineColor[1]=n.fillColor[1],n.outlineColor[2]=n.fillColor[2],n.outlineColor[3]=n.fillColor[3]);n.fillColor[3]*=l.fillOpacity;n.outlineColor[3]*=l.haloOpacity;
n.fillColor[0]*=n.fillColor[3];n.fillColor[1]*=n.fillColor[3];n.fillColor[2]*=n.fillColor[3];n.outlineColor[0]*=n.outlineColor[3];n.outlineColor[1]*=n.outlineColor[3];n.outlineColor[2]*=n.outlineColor[3];n.outlineWidth=f.HIGHLIGHT_SIZING.outlineWidth;n.outerHaloWidth=f.HIGHLIGHT_SIZING.outerHaloWidth;n.innerHaloWidth=f.HIGHLIGHT_SIZING.innerHaloWidth;n.outlinePosition=f.HIGHLIGHT_SIZING.outlinePosition}const q=x.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),g=[0,0,0,
0];return function(){function l(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:f.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:f.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:f.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:f.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*f.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}var n=l.prototype;n.setHighlightOptions=function(u){function t(z,D,G){p[0]=
(1-G)*z[0]+G*D[0];p[1]=(1-G)*z[1]+G*D[1];p[2]=(1-G)*z[2]+G*D[2];p[3]=(1-G)*z[3]+G*D[3]}const m=this._convertedHighlightOptions;r(u,m);u=m.outlinePosition-m.outlineWidth/2-m.outerHaloWidth;const w=m.outlinePosition-m.outlineWidth/2,v=m.outlinePosition+m.outlineWidth/2,C=m.outlinePosition+m.outlineWidth/2+m.innerHaloWidth;var A=Math.sqrt(Math.PI/2)*f.SIGMA,y=Math.abs(u)>A?Math.round(10*(Math.abs(u)-A))/10:0;A=Math.abs(C)>A?Math.round(10*(Math.abs(C)-A))/10:0;y&&!A?q.error("The outer rim of the highlight is "+
y+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!y&&A?q.error("The inner rim of the highlight is "+A+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):y&&A&&q.error("The highlight is "+Math.max(y,A)+"px away from the edge of the feature; consider reducing some width values.");const p=[void 0,void 0,void 0,
void 0];({texelData:A}=this);for(let z=0;z<f.SHADE_TEXTURE_SIZE;++z)y=u+z/(f.SHADE_TEXTURE_SIZE-1)*(C-u),y<u?(p[4*z]=0,p[4*z+1]=0,p[4*z+2]=0,p[4*z+3]=0):y<w?t(g,m.outlineColor,(y-u)/(w-u)):y<v?[p[0],p[1],p[2],p[3]]=m.outlineColor:y<C?t(m.outlineColor,m.fillColor,(y-v)/(C-v)):[p[4*z],p[4*z+1],p[4*z+2],p[4*z+3]]=m.fillColor,A[4*z]=255*p[0],A[4*z+1]=255*p[1],A[4*z+2]=255*p[2],A[4*z+3]=255*p[3];this.minMaxDistance[0]=u;this.minMaxDistance[1]=C;this.shadeTexChanged=!0};n.applyHighlightOptions=function(u,
t){this.shadeTex||(this.shadeTex=new c(u,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:f.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,f.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);u.bindTexture(this.shadeTex,e.TEXTURE_BINDING_HIGHLIGHT_1);t.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};n.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return l}()})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["exports"],
function(x){x.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];x.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0};x.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];x.SHADE_TEXTURE_SIZE=256;x.SIGMA=1;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../webgl/Program ../../../../../webgl/ProgramCache ../../../../../webgl/Renderbuffer ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../../../../webgl/programUtils ../../definitions ./parameters ../../shaders/HighlightPrograms".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r){return function(){function q(){this._height=this._width=void 0;this._resources=null}var g=q.prototype;g.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};g.preBlur=function(l,n){l.bindTexture(n,e.TEXTURE_BINDING_HIGHLIGHT_0);l.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",
[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",f.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);l.bindVAO(this._resources.quadVAO);l.drawArrays(5,0,4);l.bindVAO()};g.finalBlur=function(l,n){l.bindTexture(n,e.TEXTURE_BINDING_HIGHLIGHT_0);l.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",f.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
l.bindVAO(this._resources.quadVAO);l.drawArrays(5,0,4);l.bindVAO()};g.renderHighlight=function(l,n,u){l.bindTexture(n,e.TEXTURE_BINDING_HIGHLIGHT_0);l.useProgram(this._resources.highlightProgram);u.applyHighlightOptions(l,this._resources.highlightProgram);l.bindVAO(this._resources.quadVAO);l.setBlendingEnabled(!0);l.setBlendFunction(1,771);l.drawArrays(5,0,4);l.bindVAO()};g._initialize=function(l,n,u){this._width=n;this._height=u;n=x.createVertex(l,35044,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,
1,1,1,1,1])).buffer);u=new c(l,new Map([["a_position",0],["a_texcoord",1]]),{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:n});const t=b.createProgram(l,r.highlight);l=b.createProgram(l,r.blur);t.setUniform1i("u_texture",e.TEXTURE_BINDING_HIGHLIGHT_0);t.setUniform1i("u_shade",e.TEXTURE_BINDING_HIGHLIGHT_1);t.setUniform1f("u_sigma",f.SIGMA);l.setUniform1i("u_texture",e.TEXTURE_BINDING_HIGHLIGHT_0);
l.setUniform1f("u_sigma",f.SIGMA);this._resources={quadGeometry:n,quadVAO:u,highlightProgram:t,blurProgram:l}};g.setup=function(l,n,u){this._resources?(this._width=n,this._height=u):this._initialize(l,n,u)};return q}()})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["exports","./sources/resolver"],function(x,F){const E={shaders:{vertexShader:F.resolveIncludes("highlight/textured.vert"),fragmentShader:F.resolveIncludes("highlight/highlight.frag")},attributes:new Map([["a_position",
0],["a_texcoord",1]])};F={shaders:{vertexShader:F.resolveIncludes("highlight/textured.vert"),fragmentShader:F.resolveIncludes("highlight/blur.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};x.blur=F;x.highlight=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../webgl/BufferObject ../../../../../webgl/FramebufferObject ../../../../../webgl/Program ../../../../../webgl/ProgramCache ../../../../../webgl/Renderbuffer ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject".split(" "),
function(x,F,E,B,k,h,a,d,c,b){function e(f,r,q){r=new c(f,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:r,height:q,samplingMode:9729});f=new E(f,{colorTarget:0,depthStencilTarget:2},r);return[r,f]}return function(){function f(){this._height=this._width=void 0;this._resources=null}var r=f.prototype;r.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),
this._resources=null)};r._initialize=function(q,g,l){this._width=g;this._height=l;const [n,u]=e(q,g,l),[t,m]=e(q,g,l);this._resources={sharedBlur1Tex:n,sharedBlur1Fbo:u,sharedBlur2Tex:t,sharedBlur2Fbo:m}};r.setup=function(q,g,l){!this._resources||this._width===g&&this._height===l||this.dispose();this._resources||this._initialize(q,g,l)};x._createClass(f,[{key:"sharedBlur1Tex",get:function(){return this._resources.sharedBlur1Tex}},{key:"sharedBlur1Fbo",get:function(){return this._resources.sharedBlur1Fbo}},
{key:"sharedBlur2Tex",get:function(){return this._resources.sharedBlur2Tex}},{key:"sharedBlur2Fbo",get:function(){return this._resources.sharedBlur2Fbo}}]);return f}()})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions","./Effect"],function(x,F,E,B,k){k=function(h){function a(){var c=h.apply(this,arguments)||this;c.name=c.constructor.name;c.defines=["id"];c._lastSize=0;return c}
F._inheritsLoose(a,h);var d=a.prototype;d.dispose=function(){E.isSome(this._fbo)&&this._fbo.dispose()};d.bind=function({context:c,painter:b}){const {width:e,height:f}=c.getViewport();b=b.getFbos(e,f).effect0;c.bindFramebuffer(b);c.setColorMask(!0,!0,!0,!0);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT)};d.unbind=function(){};d.draw=function({context:c,state:b,pixelRatio:e},f,r=B.HITTEST_SEARCH_SIZE){const q=c.getBoundFramebufferObject(),g=b.size[1]*e,l=Math.round(r*e),n=l/2,u=l/2;this._ensureBuffer(l);
f.forEach((t,m)=>{var w=new Map;q.readPixels(Math.floor(m[0]*e-l/2),Math.floor(g-m[1]*e-l/2),l,l,6408,5121,this._buf);for(let A=0;A<this._buf32.length;A++){const y=this._buf32[A];if(4294967295!==y&&0!==y){var v=A%l,C=l-Math.floor(A/l);v=(n-v)*(n-v)+(u-C)*(u-C);C=w.has(y)?w.get(y):4294967295;w.set(y,Math.min(v,C))}}w=Array.from(w).sort((A,y)=>A[1]-y[1]).map(A=>A[0]);t.resolve(w);f.delete(m)})};d._ensureBuffer=function(c){this._lastSize!==c&&(this._lastSize=c,this._buf=new Uint8Array(4*c*c),this._buf32=
new Uint32Array(this._buf.buffer))};return a}(k.Effect);x.HittestEffect=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/EffectManager":function(){define(["require","exports","../../../../../../chunks/_rollupPluginBabelHelpers"],function(x,F,E){const B={colorize:function(){var h=E._asyncToGenerator(function*(){return new (yield new Promise(function(a,d){x(["./Colorize"],a,d)})).Colorize});return function(){return h.apply(this,arguments)}}(),
blur:function(){var h=E._asyncToGenerator(function*(){return new (yield new Promise(function(a,d){x(["./Blur"],a,d)})).Blur});return function(){return h.apply(this,arguments)}}(),bloom:function(){var h=E._asyncToGenerator(function*(){return new (yield new Promise(function(a,d){x(["./Bloom"],a,d)})).Bloom});return function(){return h.apply(this,arguments)}}(),opacity:function(){var h=E._asyncToGenerator(function*(){return new (yield new Promise(function(a,d){x(["./Opacity"],a,d)})).Opacity});return function(){return h.apply(this,
arguments)}}(),"drop-shadow":function(){var h=E._asyncToGenerator(function*(){return new (yield new Promise(function(a,d){x(["./DropShadow"],a,d)})).DropShadow});return function(){return h.apply(this,arguments)}}()};let k=function(){function h(d){this._requestRender=d;this._effectMap=new Map;this._effectPromiseMap=new Map}var a=h.prototype;a.dispose=function(){this._requestRender&&(this._requestRender=null);this._effectMap.forEach(d=>d.dispose());this._effectMap.clear();this._effectPromiseMap.clear()};
a.getPostProcessingEffects=function(d){if(!d||0===d.length)return[];const c=[];for(const b of d){a:switch(d=b.type,d){case "bloom":case "blur":case "opacity":case "drop-shadow":break a;default:d="colorize"}const e=this._effectMap.get(d);e?c.push({postProcessingEffect:e,effect:b}):this._enablePostProcessingEffect(d)}return c};a._enablePostProcessingEffect=function(){var d=E._asyncToGenerator(function*(c){const b=yield this._loadPostProcessingEffect(c);this._requestRender&&(this._effectMap.set(c,b),
this._requestRender.requestRender())});return function(c){return d.apply(this,arguments)}}();a._loadPostProcessingEffect=function(){var d=E._asyncToGenerator(function*(c){this._effectPromiseMap.has(c)||this._effectPromiseMap.set(c,B[c]());return this._effectPromiseMap.get(c)});return function(c){return d.apply(this,arguments)}}();return h}();F.EffectManager=k;Object.defineProperty(F,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define(["../../../../../core/arrayUtils",
"../../../../../core/maybe","../enums"],function(x,F,E){return function(){function B(h,a){var d;this.brushes=h;this.name=a.name;this.drawPhase=a.drawPhase||E.WGLDrawPhase.MAP;this._targetFn=a.target;this.effects=a.effects||[];this.enableDefaultDraw=null!=(d=a.enableDefaultDraw)?d:()=>!0}var k=B.prototype;k.render=function(h){const {context:a,profiler:d}=h,c=this._targetFn();var b=this.drawPhase&h.drawPhase;d.recordPassStart(this.name);if(b){this.enableDefaultDraw()&&this._doRender(h,c);d.recordPassEnd();
for(const e of this.effects){if(!e.enable())continue;b=e.apply;d.recordPassStart(this.name+"."+b.name);d.recordBrushStart(b.name);const f=e.args&&e.args(),{x:r,y:q,width:g,height:l}=a.getViewport(),n=a.getBoundFramebufferObject();b.bind(h,f);this._doRender(h,c,b.defines);b.draw(h,f);b.unbind(h,f);a.bindFramebuffer(n);a.setViewport(r,q,g,l);d.recordBrushEnd();d.recordPassEnd()}}};k._doRender=function(h,a,d){if(!F.isNone(a))if(x.isArrayLike(a))for(const c of a){if(c.visible)for(const b of this.brushes)h.profiler.recordBrushStart(b.name),
b.prepareState(h,c,d),b.draw(h,c,d),h.profiler.recordBrushEnd()}else for(const c of this.brushes)h.profiler.recordBrushStart(c.name),c.prepareState(h,a,d),c.draw(h,a,d),h.profiler.recordBrushEnd()};return B}()})},"esri/views/2d/engine/webgl/Profiler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),function(x,F,E,B,k,
h,a){const d=k("esri-2d-profiler");k=function(){function c(e,f){this._events=new B;this._entries=new Map;this._timings=new E(10);if(d){this._ext=a.createDisjointTimerQuery(e.gl,{});this._debugOutput=f;var r=e.gl;if(this.enableCommandLogging)for(const q in r)if("function"===typeof r[q]){const g=r[q],l=-1!==q.indexOf("draw");r[q]=(...n)=>{this._events.emit("command",{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:q,args:n,isDrawCommand:l});this._currentSummary&&
(this._currentSummary.commands++,l&&this._currentSummary.drawCommands++);return g.apply(r,n)}}}}var b=c.prototype;b.recordContainerStart=function(e){d&&(this._currentContainer=e)};b.recordContainerEnd=function(){d&&(this._currentContainer=null)};b.recordPassStart=function(e){d&&(this._currentPass=e,this._initSummary())};b.recordPassEnd=function(){d&&(this._currentPass=null,this._emitSummary())};b.recordBrushStart=function(e){d&&(this._currentBrush=e)};b.recordBrushEnd=function(){d&&(this._currentBrush=
null)};b.recordStart=function(e){if(d&&h.isSome(this._ext)){if(this._entries.has(e)){const l=this._entries.get(e);var f=this._ext.resultAvailable(l.query),r=this._ext.disjoint();if(f&&!r){f=this._ext.getResult(l.query)/1E6;r=0;if(h.isSome(this._timings.enqueue(f))){r=this._timings.entries;const n=r.length;let u=0;for(var q of r)u+=q;r=u/n}q=f.toFixed(2);f=r?r.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed(`Frame report for ${e}, ${q} ms (${f} last 10 avg)
${l.commandsLen} Commands (${l.drawCommands} draw)`),console.log("RenderPass breakdown: "),console.table(l.summaries),console.log("Commands: ",l.commands),console.groupEnd()):console.log(`Frame report for ${e}, ${q} ms (${f} last 10 avg)`);this._debugOutput.innerHTML=`${q} (${f})`}for(const n of l.handles)n.remove();this._entries.delete(e)}const g={name:e,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(g.handles.push(this._events.on("command",
l=>{g.commandsLen++;g.commands.push(l);l.isDrawCommand&&g.drawCommands++})),g.handles.push(this._events.on("summary",l=>{g.summaries.push(l)})));this._ext.beginTimeElapsed(g.query);this._entries.set(e,g)}};b.recordEnd=function(e){d&&h.isSome(this._ext)&&this._entries.has(e)&&this._ext.endTimeElapsed()};b._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};b._emitSummary=function(){this.enableCommandLogging&&
this._events.emit("summary",this._currentSummary)};F._createClass(c,[{key:"enableCommandLogging",get:function(){return!("object"===typeof d&&d.disableCommands)}}]);return c}();x.Profiler=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(x,F){return function(){function E(k=Number.POSITIVE_INFINITY){this._start=this.size=0;this.maxSize=k;this._buffer=isFinite(k)?Array(k):[]}var B=E.prototype;B.enqueue=
function(k){if(this.size===this.maxSize){const h=this._buffer[this._start];this._buffer[this._start]=k;this._start=(this._start+1)%this.maxSize;return h}isFinite(this.maxSize)?this._buffer[(this._start+this.size++)%this.maxSize]=k:this._buffer[this._start+this.size++]=k;return null};B.dequeue=function(){if(0===this.size)return null;const k=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return k};B.peek=function(){return 0===this.size?
null:this._buffer[this._start]};B.find=function(k){if(0===this.size)return null;for(const h of this._buffer)if(F.isSome(h)&&k(h))return h;return null};B.clear=function(k){let h=this.dequeue();for(;F.isSome(h);)k&&k(h),h=this.dequeue()};x._createClass(E,[{key:"entries",get:function(){return this._buffer}}]);return E}()})},"esri/views/2d/engine/webgl/WebGLDriverTest":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Logger ../../../../core/maybe ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/ProgramCache ../../../webgl/Renderbuffer ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ../../../webgl/Texture ../../../webgl/VertexArrayObject ./VertexStream ../../../webgl/testSVGPremultipliedAlpha".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g){const l=E.getLogger("esri.views.2d.engine.webgl.WebGLDriverTest");let n=function(){function t(m){this.svgAlwaysPremultipliesAlpha=!1;this._ignoresSamplerPrecision=null;this._context=m;g.testSVGPremultipliedAlpha(m).then(w=>{this.svgAlwaysPremultipliesAlpha=!w})}F._createClass(t,[{key:"ignoresSamplerPrecision",get:function(){B.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=u(this._context));return this._ignoresSamplerPrecision}}]);return t}();
const u=t=>{var m=new h(t,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1});const w=new Uint8Array(4),v=new q(t,[0,0,1,0,0,1,1,1]),C=new a.Program(t,"\nprecision highp float;\n\nattribute vec2 a_pos;\n\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\n\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",new Map([["a_pos",0]]));var A=new f(t,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));C.setUniform1i("u_texture",0);t.bindTexture(A,0);A=t.getBoundFramebufferObject();t.bindFramebuffer(m);t.useProgram(C);const {x:y,y:p,width:z,height:D}=t.getViewport();t.setViewport(0,0,1,1);v.draw();t.setViewport(y,p,z,D);m.readPixels(0,
0,1,1,6408,5121,w);C.dispose();v.dispose();m.dispose();(m=255!==w[0]||255!==w[1]||255!==w[2]||255!==w[3])&&l.warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${w[0]}.${w[1]}.${w[2]}.${w[3]}]`);t.bindFramebuffer(A);return m};x.testSamplerPrecision=
u;x.testWebGLDriver=t=>new n(t);Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/webgl/testSVGPremultipliedAlpha":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ./BufferObject ./FramebufferObject ./Program ./Texture ./VertexArrayObject".split(" "),function(x,F,E,B,k,h,a){function d(){d=F._asyncToGenerator(function*(c){const b=new Image;b.src="data:image/svg+xml,%3C%3Fxml version\x3d'1.0' encoding\x3d'UTF-8'%3F%3E%3Csvg width\x3d'5' height\x3d'5' version\x3d'1.1' viewBox\x3d'0 0 5 5' xmlns\x3d'http://www.w3.org/2000/svg'%3E%3Crect width\x3d'5' height\x3d'5' fill\x3d'%23f00' fill-opacity\x3d'.5'/%3E%3C/svg%3E%0A";
b.width=5;b.height=5;yield b.decode();if(!c.gl)return!0;const e=new B(c,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),f=E.createVertex(c,35044,new Uint16Array([0,0,1,0,0,1,1,1])),r=new a(c,new Map([["a_pos",0]]),{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:f}),q=new k.Program(c,"\n  precision highp float;\n\n  attribute vec2 a_pos;\n  varying vec2 v_uv;\n\n  void main() {\n    v_uv \x3d a_pos;\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ",
"\n  precision highp float;\n\n  varying vec2 v_uv;\n  uniform sampler2D u_texture;\n\n  void main() {\n    gl_FragColor \x3d texture2D(u_texture, v_uv);\n  }\n  ",new Map([["a_pos",0]]));c.useProgram(q);const g=new h(c,{dataType:5121,pixelFormat:6408,preMultiplyAlpha:!1,wrapMode:33071,samplingMode:9729},b);c.bindTexture(g,0);q.setUniform1i("u_texture",0);const l=c.getBoundFramebufferObject(),{x:n,y:u,width:t,height:m}=c.getViewport();c.bindFramebuffer(e);c.setViewport(0,0,1,1);c.bindVAO(r);c.drawArrays(5,
0,4);const w=new Uint8Array(4);e.readPixels(0,0,1,1,6408,5121,w);q.dispose();r.dispose(!1);f.dispose();e.dispose();g.dispose();c.setViewport(n,u,t,m);c.bindFramebuffer(l);b.src="";return 255===w[0]});return d.apply(this,arguments)}x.testSVGPremultipliedAlpha=function(c){return d.apply(this,arguments)};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/cpuMapped/BufferDataPool":function(){define("exports ../../../../../core/CircularArray ../../../../../core/has ../../../../../core/maybe ./BufferData ./DisplayRecordReader".split(" "),
function(x,F,E,B,k,h){F=function(){function a(){this._pools=new Map}var d=a.prototype;d.acquire=function(c,b,e=0){var f=h.DisplayRecordReader.from(c.records,e);e=f.size();f.next();const r=f.vertexCount;f=f.indexCount;const q=this._tryAcquire(c.stride,b,r,f);return k.BufferData.createPooled(q,c,b,r,f,e,this)};d.release=function(c){c.isReleased||c.destroy()};d.destroy=function(){this._pools.forEach(c=>{B.isSome(c)&&c.clear(b=>b.destroy())})};d._tryAcquire=function(c,b,e,f){c=this._pools.get(c<<3|b);
if(B.isNone(c))return null;c=c.dequeue();return B.isSome(c)&&c.vertexBufferSize>=e&&c.indexBufferSize>=f?c:null};return a}();x.BufferDataPool=F;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/cpuMapped/BufferData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/maybe ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../webgl/Program ../../../../webgl/ProgramCache ../../../../webgl/Renderbuffer ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../definitions ../FeatureDisplayList ./Buffer ./DisplayRecordReader ../mesh/heuristics".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n,u){E=function(){function t(w,v,C,A,y){this._vaoInvalidated=!0;const p=u.getMeshHeuristic(v),z=Math.max(p.verticesPerRecord*p.multiplier*C,A+1);A=w/Uint32Array.BYTES_PER_ELEMENT;C=new l.Buffer("index",Math.max(p.indicesPerRecord*p.multiplier*C,y+1),1);y={geometry:new l.Buffer("vertex",z,A)};this.stride=w;this.strideInt=A;this.geometryType=v;this._buffers={index:C,vertex:y}}t.createPooled=function(w,v,C,A,y,p,z){const D=Math.max(q.BUFFER_DATA_MINIMUM_SIZE,
Math.round(1.5*p));w=B.unwrapOr(w,()=>new t(v.stride,C,D,A,y));w._buffers.index.clear();w._buffers.vertex.geometry.clear();w._records=null;w._displayList=null;w._vaoInvalidated=!0;w._pool=z;w._released=!1;return w};var m=t.prototype;m.release=function(){this.isReleased||(this._pool.release(this),this._released=!0)};m.destroy=function(){this._buffers.index.destroy();this._buffers.vertex.geometry.destroy();B.andThen(this._vao,w=>w.dispose(!1))};m.draw=function(w,v,C,A,y){this.upload(w);v=this._getVAO(w,
v,C);A*=Uint32Array.BYTES_PER_ELEMENT;w.bindVAO(v);w.drawElements(4,y,5125,A);w.bindVAO(null)};m.insert=function(w){if(!w.done){var {vertexData:v,offset:C}=w,{records:A,indices:y,vertices:p}=v,z=this._getInsertionInfo(n.DisplayRecordReader.from(A,C)),{vertFrom:D,vertCount:G,indexFrom:I,indexCount:K,recordCount:N,done:L}=z;w.done=L;w.offset=N+C;if(0!==N){var {index:M,vertex:O}=this._buffers;w=O.geometry.insert(p,D,G,0);z=M.insert(y,I,K,w);this._addRecords(n.DisplayRecordReader.from(A,C,N),z,w)}}};
m.free=function(w){for(w=n.DisplayRecordReader.from(w.records).getCursor();w.next();)this._freeId(w.id)};m.freeIds=function(w){for(const v of w)this._freeId(v)};m.upload=function(w){const {index:v,vertex:C}=this._buffers;v.upload(w);C.geometry.upload(w)};m.has=function(w){if(!this._records)return!1;const v=this._records.getCursor();for(;v.next();)if(v.id===w)return!0;return!1};m.getViewOf=function(w){if(!this._records)return null;const v=this._records.getCursor();for(;v.next();)if(v.id===w)return v;
return null};m._getInsertionInfo=function(w){w=w.getCursor();const {index:v,vertex:C}=this._buffers,A=v.maxAvailableSpace(),y=C.geometry.maxAvailableSpace();let p=0,z=null,D=0,G=null,I=0,K=!0;for(;w.next();){null===G&&(G=w.vertexFrom,z=w.indexFrom);const N=I+w.vertexCount,L=D+w.indexCount;if(N>=y||L>=A){K=!1;break}p+=1;D=L;I=N}return{done:K,vertFrom:G,vertCount:I,indexFrom:z,indexCount:D,recordCount:p}};m._addRecords=function(w,v,C){const A=w.getCursor();for(;A.next();)A.indexFrom+=v,A.vertexFrom+=
C;this._records?(this._records.link(w),this._displayList=null):this._records=w};m._freeId=function(w){const v=this._records.getCursor(),C=this._buffers.index,A=this._buffers.vertex.geometry;if(v.lookup(w)){for(var y=v.indexFrom,p=v.indexCount,z=v.vertexFrom,D=v.vertexCount;v.next()&&v.id===w;)p+=v.indexCount,D+=v.vertexCount;C.free(y,p);A.free(z,D,!0);this._records.delete(w)}};m._getVAO=function(w,v,C){if(this._vaoInvalidated){const A=JSON.stringify(v)+JSON.stringify([...C]);A!==this._vaoHash&&(B.andThen(this._vao,
y=>{y.dispose(!1)}),this._vao=null,this._vaoHash=A);this._vaoInvalidated=!1}if(B.isNone(this._vao)){const {index:A,vertex:y}=this._buffers;if(B.isNone(y.geometry.gpu)||B.isNone(A.gpu))throw Error("bad news");this._vao=new r(w,C,v,{geometry:y.geometry.gpu},A.gpu)}return this._vao};F._createClass(t,[{key:"isReleased",get:function(){return this._released}},{key:"indexBufferSize",get:function(){return this._buffers.index.bufferSize}},{key:"vertexBufferSize",get:function(){return this._buffers.vertex.geometry.bufferSize}},
{key:"displayList",get:function(){B.isNone(this._displayList)&&(this._displayList=g.FeatureDisplayList.from(this,this._records.getCursor()));return this._displayList}}]);return t}();x.BufferData=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/FeatureDisplayList":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(x,F){let E=function(){function k(a,d,c,b,e){this.target=a;this.geometryType=d;this.materialKey=c;this.indexFrom=b;this.indexCount=
e}var h=k.prototype;h.extend=function(a){this.indexCount+=a};h.draw=function(a,d,c){this.target.draw(a,d,c,this.indexFrom,this.indexCount)};F._createClass(k,[{key:"indexEnd",get:function(){return this.indexFrom+this.indexCount}}]);return k}(),B=function(){function k(a){this._infos=[];this._target=a}k.from=function(a,d){for(a=new k(a);d.next();)a.add(d);return a};var h=k.prototype;h.add=function(a){const {materialKey:d,indexFrom:c,indexCount:b}=a;this._infos.length&&a.materialKey===this._last.materialKey&&
a.indexFrom===this._last.indexEnd?this._last.extend(b):(a=new E(this._target,this.geometryType,d,c,b),this._infos.push(a))};h.forEach=function(a){for(const d of this._infos)a(d)};F._createClass(k,[{key:"_last",get:function(){return this._infos[this._infos.length-1]}}]);return k}();x.FeatureDisplayList=B;x.FeatureDisplayListInfo=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/cpuMapped/Buffer":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../webgl/Program ../../../../webgl/ProgramCache ../../../../webgl/Renderbuffer ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ./FreeList".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r){k=function(){function q(l,n,u){n=new Uint32Array(n*u);this.strideInt=u;this.bufferType=l;this.dirty={start:Infinity,end:0};this.cpu=n;this.gpu=null;this.clear()}var g=q.prototype;g.destroy=function(){E.andThen(this.gpu,l=>l.dispose())};g.clear=function(){this.dirty.start=Infinity;this.dirty.end=0;this.freeList=new r.FreeList({start:0,end:this.cpu.length/this.strideInt});this.fillPointer=0};g.maxAvailableSpace=function(){return this.freeList.maxAvailableSpace()};
g.insert=function(l,n,u,t){var m=u*this.strideInt;l=new Uint32Array(l,n*this.strideInt*Uint32Array.BYTES_PER_ELEMENT,m);var w=E.unwrapOrThrow(this.freeList.firstFit(u),"First fit region must be defined");u=w*this.strideInt;m*=this.strideInt;n=w-n;if(0!==t)for(w=0;w<l.length;w++)l[w]+=t;this.cpu.set(l,u);this.dirty.start=Math.min(this.dirty.start,u);this.dirty.end=Math.max(this.dirty.end,u+m);this.fillPointer=Math.max(this.fillPointer,u+m);return n};g.free=function(l,n,u){const t=l*this.strideInt,
m=(l+n)*this.strideInt;if(!0===u)for(u=l;u!==l+n;u++)this.cpu[u*this.strideInt]=2147450879;this.dirty.start=Math.min(this.dirty.start,t);this.dirty.end=Math.max(this.dirty.end,m);this.freeList.free(l,n)};g.upload=function(l){this.dirty.end&&(E.isNone(this.gpu)?this.gpu=this._createBuffer(l):this.gpu.setSubData(this.cpu,this.dirty.start,this.dirty.start,this.dirty.end),this.dirty.start=Infinity,this.dirty.end=0)};g._createBuffer=function(l){return"index"===this.bufferType?B.createIndex(l,35048,this.cpu):
B.createVertex(l,35048,this.cpu)};F._createClass(q,[{key:"bufferSize",get:function(){return this.cpu.length/this.strideInt}}]);return q}();x.Buffer=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/cpuMapped/FreeList":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe"],function(x,F,E){let B=function(){function h(d){if(Array.isArray(d)){this.data=d[0];var c=this;for(let b=1;b<d.length;b++)c.next=new h([d[b]]),c=
c.next}else this.data=d}var a=h.prototype;a.find=function(d){var c;return d(this.data)?this:null==(c=this.next)?void 0:c.find(d)};a.max=function(d,c=this){c=d(this.data)>d(c.data)?this:c;return this.next?this.next.max(d,c):c};a.remove=function(d,c=null){return this===d?c?(c.next=this.next,c):this.next:this.next.remove(d,this)};F._createClass(h,[{key:"last",get:function(){return this.next?this.next.last:this}}]);return h}(),k=function(){function h(d){this._head=null;E.isNone(d)||(this._head=new B(d))}
var a=h.prototype;a.maxAvailableSpace=function(){if(E.isNone(this._head))return 0;const d=this._head.max(c=>c.end-c.start);return d.data.end-d.data.start};a.firstFit=function(d){if(E.isNone(this._head))return null;var c=null;let b=this._head;for(;b;){const e=b.data.end-b.data.start;if(e===d)return c?c.next=b.next:this._head=b.next,b.data.start;if(e>d)return c=b.data.start,b.data.start+=d,c;c=b;b=b.next}return null};a.free=function(d,c){const b=d+c;if(E.isNone(this._head))this._head=new B({start:d,
end:b});else if(b<=this._head.data.start)if(b===this._head.data.start)this._head.data.start-=c;else{var e=new B({start:d,end:b});e.next=this._head;this._head=e}else{e=this._head;for(var f=e.next;f;){if(f.data.start>=b){if(e.data.end===d){e.data.end+=c;return}if(f.data.start===b){f.data.start-=c;return}d=new B({start:d,end:b});d.next=e.next;e.next=d;return}e=f;f=f.next}d===e.data.end?e.data.end+=c:(d=new B({start:d,end:b}),e.next=d)}};F._createClass(h,[{key:"head",get:function(){return this._head}}]);
return h}();x.FreeList=k;x.List=B;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/cpuMapped/DisplayRecordReader":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions"],function(x,F,E,B){let k=function(){function a(c){this._cursor=this._head=c}a.from=function(c,b=0,e=c.byteLength/h.BYTES_PER_RECORD-b){c=new h(new Int32Array(c,b*h.BYTES_PER_RECORD,e*h.ELEMENTS_PER_RECORD));return new a(c)};var d=a.prototype;
d.size=function(){var c,b;return null!=(c=null==(b=this._cursor)?void 0:b.size())?c:0};d.link=function(c){if(this._head){for(var b=this._head;b._link;)b=b._link;b._link=c._head}else this._head=c._head};d.getCursor=function(){return this.copy()};d.lookup=function(c){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(c);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor};d.copy=function(){var c;const b=new a(null==(c=this._head)?void 0:c.copy());if(!b._head)return b;
c=b._head;let e=b._head._link;for(;e;)c._link=e.copy(),c=e,e=c._link;return b};d.next=function(){if(!this._cursor)return!1;if(!this._cursor.next()){if(!this._cursor._link)return!1;this._cursor=this._cursor._link;return this.next()}return!0};d.peekId=function(){var c;return null!=(c=this._cursor.peekId())?c:this._cursor._link.peekId()};d.delete=function(c){let b=this._head,e=null;for(;b;){if(b.delete(c))return b.isEmpty()&&(E.isSome(e)&&(e._link=b._link),b===this._head&&(this._head=b._link),b===this._cursor&&
(this._cursor=b._link)),!0;e=b;b=b._link}return!1};F._createClass(a,[{key:"id",get:function(){return this._cursor.id},set:function(c){this._cursor.id=c}},{key:"materialKey",get:function(){return this._cursor.materialKey},set:function(c){this._cursor.materialKey=c}},{key:"insertAfter",get:function(){return this._cursor.insertAfter}},{key:"indexFrom",get:function(){return this._cursor.indexFrom},set:function(c){this._cursor.indexFrom=c}},{key:"indexCount",get:function(){return this._cursor.indexCount},
set:function(c){this._cursor.indexCount=c}},{key:"vertexFrom",get:function(){return this._cursor.vertexFrom},set:function(c){this._cursor.vertexFrom=c}},{key:"vertexCount",get:function(){return this._cursor.vertexCount},set:function(c){this._cursor.vertexCount=c}},{key:"index",get:function(){return this._cursor._index}}]);return a}();k.ELEMENTS_PER_RECORD=B.DISPLAY_RECORD_INT_PER_ELEMENT;k.BYTES_PER_RECORD=k.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;let h=function(){function a(c){this._link=
null;this._index=-1;this._deletedCount=0;this._offsets={instance:null};this._packedRecords=c}a.from=function(c,b=0,e=c.byteLength/this.BYTES_PER_RECORD-b){return new a(new Int32Array(c,b*this.BYTES_PER_RECORD,e*this.ELEMENTS_PER_RECORD))};var d=a.prototype;d.delete=function(c){const b=this._index,e=this.lookup(c);if(e)for(this.id=2147483647,++this._deletedCount;this.next()&&this.id===c;)this.id=2147483647,++this._deletedCount;this._index=b;return e};d.isEmpty=function(){return this._deletedCount===
this.size()};d.link=function(c){this._link?this._link.link(c):this._link=c};d.lookup=function(c){if(E.isNone(this._offsets.instance)){this._offsets.instance=new Map;var b=this.copy();b._index=-1;let e=0;for(;b.next();)b.id!==e&&(this._offsets.instance.set(b.id,b._index),e=b.id)}if(!this._offsets.instance.has(c))return!1;b=this._index;this._index=this._offsets.instance.get(c);return 2147483647===this.id?(this._index=b,!1):!0};d.size=function(){return this._packedRecords.length/a.ELEMENTS_PER_RECORD};
d.next=function(){for(;++this._index<this.size()&&2147483647===this.id;);return this._index<this.size()};d.peekId=function(){const c=(this._index+1)*a.ELEMENTS_PER_RECORD;return c>=this._packedRecords.length?0:this._packedRecords[c]};d.getCursor=function(){return this.copy()};d.copy=function(){const c=new a(this._packedRecords);c._link=this._link;c._index=this._index;c._offsets=this._offsets;c._deletedCount=this._deletedCount;return c};F._createClass(a,[{key:"id",get:function(){return this._packedRecords[this._index*
a.ELEMENTS_PER_RECORD]},set:function(c){this._packedRecords[this._index*a.ELEMENTS_PER_RECORD]=c}},{key:"materialKey",get:function(){return this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+1]},set:function(c){this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+1]=c}},{key:"insertAfter",get:function(){return this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+2]}},{key:"indexFrom",get:function(){return this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+3]},set:function(c){this._packedRecords[this._index*
a.ELEMENTS_PER_RECORD+3]=c}},{key:"indexCount",get:function(){return this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+4]},set:function(c){this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+4]=c}},{key:"vertexFrom",get:function(){return this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+5]},set:function(c){this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+5]=c}},{key:"vertexCount",get:function(){return this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+6]},set:function(c){this._packedRecords[this._index*
a.ELEMENTS_PER_RECORD+6]=c}},{key:"index",get:function(){return this._index}}]);return a}();h.ELEMENTS_PER_RECORD=B.DISPLAY_RECORD_INT_PER_ELEMENT;h.BYTES_PER_RECORD=h.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;x.DisplayRecordReader=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],function(x,F,E){const B=new Map;B.set(E.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});
B.set(E.WGLGeometryType.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});B.set(E.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});B.set(E.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});B.set(E.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});x.getMeshHeuristic=function(k){return B.get(k)};x.getMeshSizeHint=function(k,h,a){const {indicesPerRecord:d,multiplier:c,verticesPerRecord:b}=B.get(k);return{recordBytes:a*
F.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:c*d*a*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:c*b*a*h}};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["exports","./sources/resolver"],function(x,F){F={shaders:{vertexShader:F.resolveIncludes("stencil/stencil.vert"),fragmentShader:F.resolveIncludes("stencil/stencil.frag")},attributes:new Map([["a_pos",0]])};x.stencil=F;Object.defineProperty(x,"__esModule",
{value:!0})})},"esri/views/2d/LabelManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Error ../../core/HandleOwner ../../core/Logger ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ./engine/webgl/collisions/CollisionEngine".split(" "),function(x,F,E,B,k,h,a,d,c,b,e,f,r){const q=h.getLogger("esri.views.2d.layers.labels.LabelManager");
E=function(g){function l(u){u=g.call(this,u)||this;u._applyVisibilityPassThrottled=a.throttle(u._applyVisibilityPass,32,x._assertThisInitialized(u));u.lastUpdateId=-1;u.updateRequested=!1;u.view=null;return u}x._inheritsLoose(l,g);var n=l.prototype;n.initialize=function(){this.collisionEngine=new r.CollisionEngine};n.destroy=function(){this.collisionEngine=null;this._applyVisibilityPassThrottled.remove();this._applyVisibilityPassThrottled=null};n.update=function(u){this._applyVisibilityPassThrottled(u)};
n.viewChange=function(){this.requestUpdate()};n.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};n.processUpdate=function(u){this._set("updateParameters",u);this.updateRequested&&(this.updateRequested=!1,this.update(u))};n._applyVisibilityPass=function(u){try{const t=this.view.featuresTilingScheme.getClosestInfoForScale(u.state.scale).level;this.collisionEngine.run(this.view.allLayerViews.items,u,t)}catch(t){q.error(new B("mapview-labeling","Encountered an error during label decluttering",
t))}};x._createClass(l,[{key:"updating",get:function(){return this.updateRequested}}]);return l}(k.HandleOwnerMixin(E));F.__decorate([d.property()],E.prototype,"updateRequested",void 0);F.__decorate([d.property({readOnly:!0})],E.prototype,"updateParameters",void 0);F.__decorate([d.property()],E.prototype,"updating",null);F.__decorate([d.property()],E.prototype,"view",void 0);return E=F.__decorate([f.subclass("esri.views.2d.layers.labels.LabelManager")],E)})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("exports ../../../../../core/maybe ../../../../../core/screenUtils ../definitions ./CollisionGrid ./visualVariableSimpleUtils".split(" "),
function(x,F,E,B,k,h){function a(e,f){const r=[];e.forEachTile(q=>r.push(q));r.sort((q,g)=>q.instanceId-g.instanceId);r.forEach(q=>{F.isSome(q.labelMetrics)&&q.isReady&&f(q,q.labelMetrics.getCursor())})}function d(e){return f=>E.pt2px(h.getSizeForValueSimple(f,e))}function c(e){for(const f of e)if(e=f.labelingInfo||[],f.labelsVisible&&e.length&&e.some(r=>"none"===r.deconflictionStrategy))return!0;return!1}let b=function(){function e(){}var f=e.prototype;f.run=function(r,q,g){const l=[];for(const t of r)a:{r=
l;var n=t;if("feature"!==n.layer.type&&"csv"!==n.layer.type&&"geojson"!==n.layer.type&&"ogc-feature"!==n.layer.type&&"stream"!==n.layer.type&&"subtype-group"!==n.layer.type&&"wfs"!==n.layer.type)break a;const m=n.layer.geometryType,w=!c("subtype-group"===n.layer.type?n.layer.sublayers.items:[n.layer]),v={};if("subtype-group"!==n.layer.type){if("heatmap"===n.layer.renderer.type)break a;b:{var u=n.layer.renderer;if(u="visualVariables"in u&&u.visualVariables)for(const C of u)if("size"===C.type){u=d(C);
break b}u=null}v[0]=u}n=n.tileRenderer;F.isNone(n)||r.push({tileRenderer:n,vvEvaluators:v,deconflictionEnabled:w,geometryType:m})}this._transformMetrics(l,q);this._runCollision(l,q,g)};f._runCollision=function(r,q,g){const [l,n]=q.state.size;q=new k.CollisionBitsetGrid(l,n);for(const {tileRenderer:u,deconflictionEnabled:t}of r){const m=u.featuresView.attributeView;if(!t){a(u,(w,v)=>{for(;v.nextId();)m.setLabelMinZoom(v.id,0)});break}this._prepare(u);this._collideVisible(q,u,g);this._collideInvisible(q,
u)}};f._isFiltered=function(r,q,g){r=q.getFilterFlags(r);q=!g.effect||g.effect.excludedLabelsVisible||!!(r&B.EFFECT_FLAG_0);return!((!g.hasFilter||r&B.FILTER_FLAG_0)&&q)};f._prepare=function(r){const q=r.featuresView.attributeView,g=new Set;a(r,(l,n)=>{for(;n.nextId();)g.has(n.id)||(g.add(n.id),this._isFiltered(n.id,q,r.layerView)?q.setLabelMinZoom(n.id,254):0!==q.getLabelMinZoom(n.id)?q.setLabelMinZoom(n.id,255):q.setLabelMinZoom(n.id,0))})};f._collideVisible=function(r,q,g){const l=q.featuresView.attributeView,
n=new Set;a(q,(u,t)=>{for(;t.nextId();)if(!n.has(t.id))if(u.key.level!==g)l.setLabelMinZoom(t.id,254);else if(0===l.getLabelMinZoom(t.id))switch(r.insertMetrics(t)){case k.HAS_COLLISION:l.setLabelMinZoom(t.id,254);n.add(t.id);break;case k.NONE:l.setLabelMinZoom(t.id,0),n.add(t.id)}})};f._collideInvisible=function(r,q){const g=q.featuresView.attributeView,l=new Set;a(q,(n,u)=>{for(;u.nextId();)if(!l.has(u.id)&&255===g.getLabelMinZoom(u.id))switch(r.insertMetrics(u)){case k.HAS_COLLISION:g.setLabelMinZoom(u.id,
255);l.add(u.id);break;case k.NONE:g.setLabelMinZoom(u.id,0),l.add(u.id)}})};f._transformMetrics=function(r,q){for(const {tileRenderer:g,geometryType:l,vvEvaluators:n}of r)a(g,(u,t)=>{const m=g.featuresView.attributeView;u=u.transforms.labelMat2d;u[4]=Math.round(u[4]);u[5]=Math.round(u[5]);const w=u[4],v=u[5],C="polyline"===l;for(;t.next();){const G=t.boundsCount,I=t.anchorX,K=t.anchorY;var A=0,y=0,p=n[0];F.isSome(p)&&(A=m.getVVSize(t.id),A=p(A),y=isNaN(A)||null==A||Infinity===A?t.size:A,A=y/2*t.directionX,
y=y/2*t.directionY);for(p=0;p<G;p++){var z=I,D=t.anchorY;C?(z=z+t.boundsCenterX(p)+A,D=D+t.boundsCenterY(p)+y,q.state.rotation?(z=u[0]*z+u[2]*D+u[4],D=u[1]*z+u[3]*D+u[5]):(z+=w,D+=v),t.setBoundsComputedAnchorX(p,Math.floor(z)),t.setBoundsComputedAnchorY(p,Math.floor(D))):(q.state.rotation?(z=u[0]*I+u[2]*K+u[4],D=u[1]*I+u[3]*K+u[5]):(z+=w,D+=v),z=z+t.boundsCenterX(p)+A,D=D+t.boundsCenterY(p)+y,t.setBoundsComputedAnchorX(p,z),t.setBoundsComputedAnchorY(p,D))}}})};return e}();x.CollisionEngine=b;Object.defineProperty(x,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["exports","../../../../../core/mathUtils","../definitions","../../../layers/features/support/StaticBitSet"],function(x,F,E,B){let k=function(){function a(c,b){this.width=c;this.height=b;c=Math.ceil(c/1);b=Math.ceil(b/1);this._cols=c;this._rows=b;this._cells=B.StaticBitSet.create(c*b)}var d=a.prototype;d.insertMetrics=function(c){const b=this._hasCollision(c);0===b&&this._markMetrics(c);return b};d.getCellId=
function(c,b){return c+b*this._cols};d.has=function(c){return this._cells.has(c)};d.hasRange=function(c,b){return this._cells.hasRange(c,b)};d.set=function(c){this._cells.set(c)};d.setRange=function(c,b){this._cells.setRange(c,b)};d._hasCollision=function(c){const b=c.id;let e=0,f=0;c.save();do{const r=c.boundsCount;e+=r;for(let q=0;q<r;q++){const g=c.boundsComputedAnchorX(q),l=c.boundsComputedAnchorY(q),n=c.boundsWidth(q)+2,u=c.boundsHeight(q)+2;switch(this._collide(g,l,n,u)){case 2:return 2;case 1:f++}}}while(c.peekId()===
b&&c.next());c.restore();return e===f?1:0};d._collide=function(c,b,e,f){var r=c-e/2;c+=e/2;e=b-f/2;b+=f/2;if(0>c||0>b||r>this.width||e>this.height)return 1;r=F.clamp(Math.floor(r/1),0,this._cols);f=F.clamp(Math.floor(e/1),0,this._rows);c=F.clamp(Math.ceil(c/1),0,this._cols);for(b=F.clamp(Math.ceil(b/1),0,this._rows);f<=b;f++)for(e=r;e<=c;e++){const q=this.getCellId(e,f);if(this.has(q))return 2}return 0};d._mark=function(c,b,e,f){var r=c+e/2,q=b-f/2;b+=f/2;c=F.clamp(Math.floor(c-e/2),0,this._cols);
e=F.clamp(Math.floor(q/1),0,this._rows);r=F.clamp(Math.ceil(r/1),0,this._cols);q=F.clamp(Math.ceil(b/1),0,this._rows);for(b=e;b<=q;b++)for(e=c;e<=r;e++)f=this.getCellId(e,b),this.set(f);return!1};d._markMetrics=function(c){const b=c.id;do{const e=c.boundsCount;for(let f=0;f<e;f++){const r=c.boundsComputedAnchorX(f),q=c.boundsComputedAnchorY(f),g=c.boundsWidth(f)+2,l=c.boundsHeight(f)+2;this._mark(r,q,g,l)}}while(c.peekId()===b&&c.next())};return a}(),h=function(){function a(c,b=2){this._bucketSize=
c;this._rowsLength=E.TILE_SIZE/c;this._colsLength=E.TILE_SIZE/c;this._elementsPerBucket=b;this._grid=this._initGrid()}var d=a.prototype;d.checkOverlap=function(c,b){c=Math.floor(c/this._bucketSize);b=Math.floor(b/this._bucketSize);return 0>c||c>=this._rowsLength||0>b||b>=this._colsLength?!0:this._grid[b*this._colsLength+c]>=this._elementsPerBucket};d.markUsed=function(c,b){this._grid[Math.floor(b/this._bucketSize)*this._colsLength+Math.floor(c/this._bucketSize)]+=1};d.reset=function(){this._grid=
this._initGrid()};d._initGrid=function(){return new Uint8Array(this._rowsLength*this._colsLength)};return a}();x.CollisionBitsetGrid=k;x.CollisionGrid=h;x.HAS_COLLISION=2;x.NONE=0;x.OUTSIDE_EXTENT=1;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(x){let F=function(){function E(k,h){this._mask=0;this._buf=k;this._mask=h}E.fromBuffer=function(k,h){return new E(k,h)};E.create=function(k,h=4294967295){k=new Uint32Array(Math.ceil(k/
32));return new E(k,h)};var B=E.prototype;B._getIndex=function(k){return Math.floor(k/32)};B.has=function(k){k&=this._mask;return!!(this._buf[this._getIndex(k)]&1<<k%32)};B.hasRange=function(k,h){for(;k%32&&k!==h;){if(this.has(k))return!0;k++}for(;h%32&&k!==h;){if(this.has(k))return!0;h--}if(k===h)return!1;for(k/=32;k!==h/32;k++)if(this._buf[k])return!0;return!1};B.set=function(k){k&=this._mask;const h=this._getIndex(k);this._buf[h]|=1<<k%32};B.setRange=function(k,h){for(;k%32&&k!==h;)this.set(k++);
for(;h%32&&k!==h;)this.set(h--);if(k!==h)for(k/=32;k!==h/32;k++)this._buf[k]=4294967295};B.unset=function(k){k&=this._mask;const h=this._getIndex(k);this._buf[h]&=4294967295^1<<k%32};B.resize=function(k){const h=this._buf;k=new Uint32Array(Math.ceil(k/32));k.set(h);this._buf=k};B.or=function(k){for(let h=0;h<this._buf.length;h++)this._buf[h]|=k._buf[h];return this};B.and=function(k){for(let h=0;h<this._buf.length;h++)this._buf[h]&=k._buf[h];return this};B.xor=function(k){for(let h=0;h<this._buf.length;h++)this._buf[h]^=
k._buf[h];return this};B.ior=function(k){for(let h=0;h<this._buf.length;h++)this._buf[h]|=~k._buf[h];return this};B.iand=function(k){for(let h=0;h<this._buf.length;h++)this._buf[h]&=~k._buf[h];return this};B.ixor=function(k){for(let h=0;h<this._buf.length;h++)this._buf[h]^=~k._buf[h];return this};B.any=function(){for(let k=0;k<this._buf.length;k++)if(this._buf[k])return!0;return!1};B.copy=function(k){for(let h=0;h<this._buf.length;h++)this._buf[h]=k._buf[h];return this};B.clone=function(){return new E(this._buf.slice(),
this._mask)};B.clear=function(){for(let k=0;k<this._buf.length;k++)this._buf[k]=0};B.forEachSet=function(k){for(let h=0;h<this._buf.length;h++){let a=this._buf[h],d=32*h;if(a)for(;a;)a&1&&k(d),a>>>=1,d++}};B.countSet=function(){let k=0;this.forEachSet(h=>{k++});return k};return E}();x.StaticBitSet=F;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["exports","../../../../../core/mathUtils","../../../../../renderers/support/lengthUtils"],
function(x,F,E){function B(d,c){switch(c.transformationType){case "additive":var b=k(c.minSize,d);return d+=b||c.minDataValue;case "constant":return b=(b=c.stops)&&b.length&&b[0].size,null==b&&(b=c.minSize),d=k(b,d);case "clamped-linear":b=(d-c.minDataValue)/(c.maxDataValue-c.minDataValue);var e=k(c.minSize,d),f=k(c.maxSize,d);d=d<=c.minDataValue?e:d>=c.maxDataValue?f:e+b*(f-e);return d;case "proportional":return b=d/c.minDataValue,e=k(c.minSize,d),d=k(c.maxSize,d),d=F.clamp(b*e,e,d);case "stops":{const [r,
q,g]=h(d,c.cache.ipData);r===q?d=k(c.stops[r].size,d):(b=k(c.stops[r].size,d),d=k(c.stops[q].size,d),d=b+(d-b)*g)}return d;case "real-world-size":{b=E.meterIn[c.valueUnit];e=k(c.minSize,d);f=k(c.maxSize,d);({valueRepresentation:c}=c);let r=null;r="area"===c?2*Math.sqrt(d/a)/b:"radius"===c||"distance"===c?2*d/b:d/b;d=F.clamp(r,e,f)}return d;case "identity":return d;case "unknown":return null}}function k(d,c){return"number"===typeof d?d:B(c,d)}function h(d,c){if(c){var b=0,e=c.length-1;c.some((f,r)=>
{if(d<f)return e=r,!0;b=r;return!1});return[b,e,(d-c[b])/(c[e]-c[b])]}}const a=Math.PI;x.getSizeForValueSimple=B;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicsView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/HandleOwner ../../../../core/has ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/Logger ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Polygon ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/coordsUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtilsSync ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/data/projectionSupport ../../../../symbols/cim/cimSymbolUtils ../../../../symbols/support/defaults ../../engine/webgl/definitions ../../engine/webgl/GraphicTile ../../engine/webgl/TileData ../../engine/webgl/WGLDisplayObject ../../engine/webgl/mesh/MeshData ../../engine/webgl/mesh/factories/WGLMeshFactory ../../engine/webgl/mesh/templates/WGLTemplateStore ../../engine/webgl/util/BidiText ../../engine/webgl/util/Matcher ../features/schemaUtils ../features/support/AttributeStore ../features/support/ComputedAttributeStorage ../features/support/GraphicsReader ../features/support/TileStore ./GraphicStore ./graphicsUtils ../../../layers/GraphicsView ../../../webgl/capabilities".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n,u,t,m,w,v,C,A,y,p,z,D,G,I,K,N,L,M,O,H,J,P,Q,U,aa){function ba(ia,ha,ca){if(ca.has(ia))return ca.get(ia);ha={tile:ha,addedOrModified:[],removed:[]};ca.set(ia,ha);return ha}E=function(ia){function ha(S){S=ia.call(this,S)||this;S._storage=new O.ComputedAttributeStorage;S._displayIds=new Map;S._controller=new AbortController;S._tiles=new Map;S._graphicStoreUpdate=!1;S._graphicsSet=new Set;S._matcher=Promise.resolve(null);S._tileUpdateSet=new Set;S._tilesToUpdate=
new Map;S._graphicIdToAbortController=new Map;S._attached=!1;S._highlightIds=new Map;S._updatingGraphicsTimer=null;S._hashToExpandedSymbol=new Map;S._hashTpExpandedSymbolPromise=new Map;S._processing=!1;S._needsProcessing=!1;S._pendingUpdate={added:new Set,updated:new Set,removed:new Set};S.lastUpdateId=-1;S.updateRequested=!1;S.graphicUpdateHandler=S.graphicUpdateHandler.bind(x._assertThisInitialized(S));return S}x._inheritsLoose(ha,ia);var ca=ha.prototype;ca._createMatcher=function(S,R){S&&(S=L.createMatcherSchema({indexCount:0,
fields:{}},"feature",S),this._matcher=N.createMatcher(S,R,null))};ca._createDisplayId=function(S){this._displayIds.has(S)||this._displayIds.set(S,this._storage.createDisplayId());return this._displayIds.get(S)};ca.initialize=function(){this._tileStore=new J(this.view.featuresTilingScheme);this._attributeStore=new M["default"]({type:"local",initialize:R=>Promise.resolve(this.container.attributeView.initialize(R)),update:R=>this.container.attributeView.requestUpdate(R),render:()=>this.container.requestRender()},
aa());this._graphicStore=new P(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,R=>{this._createDisplayId(R.uid);this._setFilterState(R.uid,R.visible)},R=>{const Y=this._displayIds.get(R.uid);this._displayIds.delete(R.uid);this._storage.releaseDisplayId(Y)});const S=new I.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),this.view.featuresTilingScheme.tileInfo);this._createMatcher(this.renderer,S);this._meshFactory=new G.WGLMeshFactory(null,this.uid,
S);this._templateStore=S;this.watch("renderer",R=>{this._createMatcher(R,S);for(const Y of this.graphics)this._pendingUpdate.updated.add(Y);this.requestUpdate()});this._tileStore.on("update",this._onTileUpdate.bind(this));this.container.on("attach",()=>{0<this.graphics.items.length&&this._graphicsChangeHandler({target:this.graphics,added:this.graphics.items,removed:[],moved:[]});this.handles.add(this.graphics.on("change",R=>this._graphicsChangeHandler(R)),"graphics");this._attached=!0;this.notifyChange("updating")})};
ca.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating"));this._controller.abort();this.container.destroy();this._set("graphics",null);this._graphicStore.clear();this._tileStore.destroy();this._attributeStore=null;this._hashToExpandedSymbol.clear();this.renderer=this.view=null};ca.hitTest=function(S,R){if(!this.view||!this.view.position)return Promise.resolve(null);S=this.view.toMap(d.createScreenPoint(S,
R));return this.searchFeatures(S).then(Y=>Y&&Y.length?Y[0]:null)};ca.searchFeatures=function(){var S=x._asyncToGenerator(function*(R,Y=2){return this._graphicStore.hitTest(R.x,R.y,Y,this.view.state.resolution,this.view.state.rotation)});return function(R){return S.apply(this,arguments)}}();ca.update=function(S){a.throwIfAborted(this._controller.signal);S=S.state;const R=this.view.featuresTilingScheme.getClosestInfoForScale(S.scale).level;this._graphicStore.updateLevel(R);this._tileStore.setViewState(S);
this._graphicStoreUpdate=!0;this.updateRequested=!1;0<this._pendingUpdate.updated.size&&(this._processing?this._needsProcessing=!0:this._updateGraphics())};ca.viewChange=function(){this.requestUpdate()};ca.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())};ca.processUpdate=function(S){this.updateRequested&&(this.updateRequested=!1,this.update(S))};ca.graphicUpdateHandler=function(S){const {graphic:R,property:Y,newValue:ea}=S;switch(Y){case "geometry":case "symbol":this._pendingUpdate.updated.add(R);
this.requestUpdate();break;case "visible":this._setFilterState(R.uid,ea),this._attributeStore.sendUpdates()}};ca.addHighlight=function(S){for(const R of S)this._highlightIds.has(R)?(S=this._highlightIds.get(R),this._highlightIds.set(R,S+1)):this._highlightIds.set(R,1);this._updateHighlight()};ca.removeHighlight=function(S){for(const R of S)this._highlightIds.has(R)&&(S=this._highlightIds.get(R)-1,0===S?this._highlightIds.delete(R):this._highlightIds.set(R,S));this._updateHighlight()};ca._updateHighlight=
function(){const S=Array.from(this._highlightIds.keys()),R=S.map(Y=>this._displayIds.get(Y));this._attributeStore.setHighlight(S,R)};ca._getIntersectingTiles=function(S){S=this._graphicStore.getBounds(S);if(!S||0===l.width(S)||0===l.height(S))return[];const R=Q.intersectingInternationalDateline(S,this.view.spatialReference);return h.isSome(R)?[...this._tileStore.boundsIntersections(R[0]),...this._tileStore.boundsIntersections(R[1])]:this._tileStore.boundsIntersections(S)};ca._updateTile=function(){var S=
x._asyncToGenerator(function*(R){a.throwIfAborted(this._controller.signal);const Y=R.tile;var ea=this._getGraphicsData(this._templateStore,Y,R.addedOrModified);ea=yield this._processGraphics(Y,ea);a.throwIfAborted(this._controller.signal);this._patchTile(Y.key,{type:"update",addOrUpdate:ea,remove:R.removed,end:!0,clear:!1});return ea});return function(R){return S.apply(this,arguments)}}();ca._patchTile=function(S,R){this._tiles.has(S)&&(S=this._tiles.get(S),this.container.onTileData(S,R),this.container.requestRender())};
ca._graphicsChangeHandler=function(S){const R=this._pendingUpdate;for(const Y of S.added)R.added.add(Y);for(const Y of S.moved)R.updated.add(Y);for(const Y of S.removed)this._pendingUpdate.added.has(Y)?R.added.delete(Y):R.removed.add(Y);this._processing?this._needsProcessing=!0:this._updateGraphics()};ca._getGraphicsToUpdate=function(){const S={added:[],removed:[],updated:[]};if(!this.graphics)return S;const R=this._pendingUpdate;for(const Y of this.graphics.items)R.added.has(Y)?S.added.push(Y):R.updated.has(Y)&&
S.updated.push(Y);for(const Y of R.removed)this._graphicStore.has(Y)&&S.removed.push(Y);R.added.clear();R.removed.clear();R.updated.clear();return S};ca._updateGraphics=function(){var S=x._asyncToGenerator(function*(){this._processing=!0;const {added:R,removed:Y,updated:ea}=this._getGraphicsToUpdate(),T=this._tilesToUpdate;try{if(!this._graphicStoreUpdate){var W=this.view.state,X=this.view.featuresTilingScheme.getClosestInfoForScale(W.scale).level;this._graphicStore.updateLevel(X);this._tileStore.setViewState(W)}W=
[];const na=Array(R.length+Y.length);for(X=0;X<ea.length;X++){var fa=ea[X];const pa=this._getIntersectingTiles(fa);for(const ra of pa){var ja=ra.id;ba(ja,ra,T).removed.push(this._displayIds.get(fa.uid))}W.push(this._updateGraphic(fa,null));na[X]=fa}var ka=ea.length;for(fa=0;fa<R.length;fa++){const pa=R[fa];na[ka+fa]=pa;this._graphicsSet.add(pa);W.push(this._addGraphic(pa))}for(const pa of Y){this._abortProcessingGraphic(pa.uid);const ra=this._getIntersectingTiles(pa);for(const ua of ra)ja=ua.id,ba(ja,
ua,T).removed.push(this._displayIds.get(pa.uid));this._graphicsSet.delete(pa);this._graphicStore.remove(pa)}this._flipUpdatingGraphics();yield Promise.all(W);let qa;for(ka=0;ka<na.length;ka++){qa=na[ka];const pa=this._getIntersectingTiles(qa);for(const ra of pa)ja=ra.id,ba(ja,ra,T).addedOrModified.push(qa)}this._graphicStore.updateZ();ja=[];for(const [,pa]of T)ja.push(this._updateTile(pa));yield Promise.all(ja)}catch(na){a.isAbortError(na)}for(const na of Y)try{const qa=yield this._getSymbolForGraphic(na,
{});qa&&this._hashToExpandedSymbol.delete(qa.hash())}catch(qa){a.isAbortError(qa)}T.clear();this.notifyChange("updating");this._processing=!1;this._needsProcessing&&(this._needsProcessing=!1,this._updateGraphics())});return function(){return S.apply(this,arguments)}}();ca._getArcadeInfo=function(S){const R=(S.attributes?Object.keys(S.attributes):[]).map(Y=>({name:Y,alias:Y,type:"string"===typeof S.attributes[Y]?"esriFieldTypeString":"esriFieldTypeDouble"}));return h.isNone(S.geometry)?null:{geometryType:u.getJsonType(S.geometry),
spatialReference:g.fromJSON(S.geometry.spatialReference),fields:R}};ca._getSymbolForGraphic=function(){var S=x._asyncToGenerator(function*(R,Y){a.throwIfAborted(this._controller.signal);return h.isSome(R.symbol)?R.symbol:h.isSome(this.renderer)?this.renderer.getSymbolAsync(R,{scale:this.view.scale,abortOptions:Y}):this._getNullSymbol(R)});return function(R,Y){return S.apply(this,arguments)}}();ca._getSymbolResources=function(){var S=x._asyncToGenerator(function*(R,Y){a.throwIfAborted(this._controller.signal);
if(!this.container.stage)return null;var ea=yield this._getSymbolForGraphic(R,Y),T=ea.hash();let W=this._hashToExpandedSymbol.get(T);if(!W){let X=this._hashTpExpandedSymbolPromise.get(T);if(X)W=yield X,a.throwIfAborted(this._controller.signal);else{R=this._getArcadeInfo(R);ea=L.createSymbolSchema(ea);X=v.expandSymbol(ea,R,Y);this._hashTpExpandedSymbolPromise.set(T,X);try{W=yield X,this._hashTpExpandedSymbolPromise.delete(T),this._hashToExpandedSymbol.set(T,W)}catch(fa){this._hashTpExpandedSymbolPromise.delete(T),
a.throwIfAborted(fa)}}}if("esriTS"===W.type){Y=[];[T]=K.bidiText(W.text);for(ea=0;ea<T.length;ea++)Y.push(T.charCodeAt(ea));[{mosaicItem:Y}]=yield this.container.getMaterialItems([{symbol:W,id:0,glyphIds:Y}]);return{symbol:W,mosaicItem:Y}}return{symbol:W,mosaicItem:null}});return function(R,Y){return S.apply(this,arguments)}}();ca._projectAndNormalizeGeometry=function(){var S=x._asyncToGenerator(function*(R,Y){a.throwIfAborted(this._controller.signal);if(h.isNone(R.geometry)||"mesh"===R.geometry.type)return null;
var ea=R.geometry;u.isPolygon(ea)?ea.rings=ea.rings:u.isPolyline(ea)?ea.paths=ea.paths:u.isExtent(ea)&&(R=yield this._getSymbolForGraphic(R,Y),a.throwIfAborted(this._controller.signal),ea=Q.isMarkerSymbol(R.type)||Q.isTextSymbol(R.type)?ea.center:q.fromExtent(ea));yield w.checkProjectionSupport(ea.spatialReference,this.view.spatialReference);R=t.normalizeCentralMeridianSync(ea);ea=w.project(R,ea.spatialReference,this.view.spatialReference);n.closeRingsAndFixWinding(ea);return ea});return function(R,
Y){return S.apply(this,arguments)}}();ca._onTileUpdate=function(S){const R=m.getInfo(this.view.spatialReference);if(S.added&&0<S.added.length)for(const Y of S.added)this._addNewTile(Y,R);if(S.removed&&0<S.removed.length)for(const Y of S.removed)this._removeTile(Y.key)};ca._addGraphic=function(){var S=x._asyncToGenerator(function*(R){this._abortProcessingGraphic(R.uid);a.throwIfAborted(this._controller.signal);var Y=a.createAbortController();this._graphicIdToAbortController.set(R.uid,Y);Y={signal:Y.signal};
try{yield this._addOrUpdateGraphic(R,Y),a.throwIfAborted(this._controller.signal),this._graphicIdToAbortController.delete(R.uid)}catch(ea){if(this._graphicIdToAbortController.delete(R.uid),!a.isAbortError(ea))throw ea;}});return function(R){return S.apply(this,arguments)}}();ca._updateGraphic=function(){var S=x._asyncToGenerator(function*(R,Y){a.throwIfAborted(this._controller.signal);const ea=this._projectAndNormalizeGeometry(R,Y);Y=this._getSymbolResources(R,Y);const [T,W]=yield Promise.all([ea,
Y]);a.throwIfAborted(this._controller.signal);this._graphicStore.addOrModify(R,W,T)});return function(R,Y){return S.apply(this,arguments)}}();ca._addOrUpdateGraphic=function(){var S=x._asyncToGenerator(function*(R,Y){a.throwIfAborted(this._controller.signal);const ea=this._projectAndNormalizeGeometry(R,Y);Y=this._getSymbolResources(R,Y);try{const [T,W]=yield Promise.all([ea,Y]);a.throwIfAborted(this._controller.signal);this._addProjectedGraphic(R,W,T)}catch(T){if(!a.isAbortError(T))throw T;}});return function(R,
Y){return S.apply(this,arguments)}}();ca._addProjectedGraphic=function(S,R,Y){this._graphicsSet.has(S)&&this._graphicStore.addOrModify(S,R,Y)};ca._addTile=function(S){var R=this.view.featuresTilingScheme.getTileBounds(l.create(),S);R=new y.GraphicTile(S,R);this._tiles.set(S,R);this.container.addChild(R);return R};ca._addNewTile=function(S,R){const Y=this._addTile(S.key),ea=this._graphicStore.queryTileData(this._templateStore,S);if(R){R=Math.round((R.valid[1]-R.valid[0])/S.resolution);for(const W of ea)W.geometry&&
(u.isPoint(W.geometry)||u.isMultipoint(W.geometry))&&this._wrapPoints(W,R)}const T=S.key;this._tileUpdateSet.add(S.key);this.notifyChange("updating");this._processGraphics(S,ea).then(W=>{Y.patch({type:"update",clear:!1,addOrUpdate:W,remove:[],end:!0});this._tileUpdateSet.delete(T);this.notifyChange("updating")}).catch(W=>{this._tileUpdateSet.delete(T);this.notifyChange("updating");if(!a.isAbortError(W))throw W;})};ca._removeTile=function(S){if(this._tiles.has(S)){var R=this._tiles.get(S);this.container.removeChild(R);
R.destroy();this._tiles.delete(S)}};ca._setFilterState=function(S,R){const Y=this._displayIds.get(S);S=this._attributeStore.getHighlightFlag(S);this._attributeStore.setData(Y,0,0,S|(R?A.FILTER_FLAG_0:0))};ca._getGraphicsData=function(S,R,Y){const ea=m.getInfo(this.view.spatialReference);S=this._graphicStore.getGraphicsData(S,R,Y);if(ea){R=Math.round((ea.valid[1]-ea.valid[0])/R.resolution);for(const T of S)T.geometry&&(u.isPoint(T.geometry)||u.isMultipoint(T.geometry))&&this._wrapPoints(T,R)}return S};
ca._wrapPoints=function(S,R){const Y=S.geometry;u.isMultipoint(Y)?this._wrapMultipoint(Y,R):this._wrapPoint(S,R)};ca._wrapMultipoint=function(S,R){var Y=S.points;const ea=[];let T=0,W=0;for(const [X,fa]of Y)ea.push([X+T,fa]),T=0,R===Q.TILE_SIZE?(Y=5*Q.PIXEL_BUFFER,X+W<Y?(ea.push([R,0]),T=-R):X+W>Q.TILE_SIZE-Y&&(ea.push([-R,0]),T=R)):X+W<-Q.PIXEL_BUFFER?(ea.push([R,0]),T=-R):X+W>Q.TILE_SIZE+Q.PIXEL_BUFFER&&(ea.push([-R,0]),T=R),W+=X;S.points=ea};ca._wrapPoint=function(S,R){const Y=S.geometry;if(R===
Q.TILE_SIZE){const ea=5*Q.PIXEL_BUFFER;Y.x<ea?S.geometry={points:[[Y.x,Y.y],[R,0]]}:Y.x>Q.TILE_SIZE-ea&&(S.geometry={points:[[Y.x,Y.y],[-R,0]]})}else Y.x<-Q.PIXEL_BUFFER?S.geometry={points:[[Y.x,Y.y],[R,0]]}:Y.x>Q.TILE_SIZE+Q.PIXEL_BUFFER&&(S.geometry={points:[[Y.x,Y.y],[-R,0]]})};ca._processGraphics=function(){var S=x._asyncToGenerator(function*(R,Y,ea){if(!Y||!Y.length||!this._meshFactory)return null;Y=H.GraphicsReader.from(Y);const T=this._meshFactory,W=yield this._matcher;yield T.analyzeGraphics(Y,
W,null,null,ea);this._attributeStore.sendUpdates();return this._processAnalyzedGraphics(R,Y)});return function(R,Y,ea){return S.apply(this,arguments)}}();ca._processAnalyzedGraphics=function(S,R){const Y=this._meshFactory;var ea=R.getSize();R=R.getCursor();const T=new D.MeshData(S.key.id,{features:ea,records:ea,metrics:0},!1,!1,!1);for(ea=[];R.next();){const W=R.readGraphic();W.insertAfter=-1===W.insertAfter?-1:this._displayIds.get(W.insertAfter);W.displayId=this._displayIds.get(W.attributes[this.uid]);
const X=new z(W.displayId);X.insertAfter=W.insertAfter;ea.push(X);Y.writeGraphic(T,R,S.level)}S=T.serialize(S.tileInfoView.tileInfo.isWrappable);return 1!==S.length?new p.TileData:p.TileData.fromVertexData(S[0].message,ea)};ca._abortProcessingGraphic=function(S){this._graphicIdToAbortController.has(S)&&this._graphicIdToAbortController.get(S).abort()};ca._getNullSymbol=function(S){S=S.geometry;return u.isPolyline(S)?C.errorPolylineSymbol2D:u.isPolygon(S)||u.isExtent(S)?C.errorPolygonSymbol2D:C.errorPointSymbol2D};
ca._flipUpdatingGraphics=function(){this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer);this._updatingGraphicsTimer=setTimeout(()=>{this._updatingGraphicsTimer=null;this.notifyChange("updating")},160);this.notifyChange("updating")};x._createClass(ha,[{key:"updating",get:function(){return!this._attached||null!==this._updatingGraphicsTimer||0<this._tileUpdateSet.size||0<this._tilesToUpdate.size}}]);return ha}(U.GraphicsView(B.HandleOwnerMixin(E)));F.__decorate([c.property({constructOnly:!0})],
E.prototype,"requestUpdateCallback",void 0);F.__decorate([c.property()],E.prototype,"container",void 0);F.__decorate([c.property({constructOnly:!0})],E.prototype,"graphics",void 0);F.__decorate([c.property()],E.prototype,"updating",null);F.__decorate([c.property()],E.prototype,"view",void 0);F.__decorate([c.property()],E.prototype,"updateRequested",void 0);return E=F.__decorate([r.subclass("esri.views.2d.layers.support.GraphicsView2D")],E)})},"esri/geometry/support/normalizeUtilsSync":function(){define("exports ./aaBoundingRect ./boundsUtils ./intersectsBase ./jsonUtils ./normalizeUtilsCommon ./spatialReferenceUtils".split(" "),
function(x,F,E,B,k,h,a){function d(n,u){const t=h.getGeometryParts(n);for(const m of t)for(const w of m)w[0]+=u;return n}function c(n,u){if(!u)return n;const t=e(n,u).map(m=>m.extent);return 2>t.length?t[0]||n:2<t.length?(n.xmin=u.valid[0],n.xmax=u.valid[1],n):{rings:t.map(m=>[[m.xmin,m.ymin],[m.xmin,m.ymax],[m.xmax,m.ymax],[m.xmax,m.ymin],[m.xmin,m.ymin]])}}function b(n,u,t){if(Array.isArray(n)){var m=n[0];m>u?(t=h.offsetMagnitude(m,u),n[0]=m+-2*t*u):m<t&&(u=h.offsetMagnitude(m,t),n[0]=m+-2*u*t)}else m=
n.x,m>u?(t=h.offsetMagnitude(m,u),n.x+=-2*t*u):m<t&&(u=h.offsetMagnitude(m,t),n.x+=-2*u*t);return n}function e(n,u){const t=[],{ymin:m,ymax:w}=n;var v=n.xmax-n.xmin,C=n.xmin,A=n.xmax;const [y,p]=u.valid;var z=f(n.xmin,u);var D=z.x;const G=z.frameId;z=f(n.xmax,u);n=z.x;z=z.frameId;u=D===n&&0<v;if(v>2*p){v={xmin:C<A?D:n,ymin:m,xmax:p,ymax:w};C={xmin:y,ymin:m,xmax:C<A?n:D,ymax:w};A={xmin:0,ymin:m,xmax:p,ymax:w};D={xmin:y,ymin:m,xmax:0,ymax:w};n=[];u=[];r(v,A)&&n.push(G);r(v,D)&&u.push(G);r(C,A)&&n.push(z);
r(C,D)&&u.push(z);for(let I=G+1;I<z;I++)n.push(I),u.push(I);t.push({extent:v,frameIds:[G]},{extent:C,frameIds:[z]},{extent:A,frameIds:n},{extent:D,frameIds:u})}else D>n||u?t.push({extent:{xmin:D,ymin:m,xmax:p,ymax:w},frameIds:[G]},{extent:{xmin:y,ymin:m,xmax:n,ymax:w},frameIds:[z]}):t.push({extent:{xmin:D,ymin:m,xmax:n,ymax:w},frameIds:[G]});return t}function f(n,u){const [t,m]=u.valid;u=2*m;var w=0;n>m?(w=Math.ceil(Math.abs(n-m)/u),n-=w*u):n<t&&(w=Math.ceil(Math.abs(n-t)/u),n+=w*u,w=-w);return{x:n,
frameId:w}}function r(n,u){const {xmin:t,ymin:m,xmax:w,ymax:v}=u;return q(n,t,m)&&q(n,t,v)&&q(n,w,v)&&q(n,w,m)}function q(n,u,t){return u>=n.xmin&&u<=n.xmax&&t>=n.ymin&&t<=n.ymax?!0:!1}let g=function(){function n(){}n.prototype.cut=function(u,t){let m;if(u.rings)this.closed=!0,m=u.rings,this.minPts=4;else if(u.paths)this.closed=!1,m=u.paths,this.minPts=2;else return null;const w=m.length;t*=-2;for(let v=0;v<w;v++){const C=m[v];if(C&&C.length>=this.minPts){const A=[];for(const y of C)A.push([y[0]+
t,y[1]]);m.push(A)}}this.closed?u.rings=m:u.paths=m;return u};return n}();const l=F.create();x.normalizeCentralMeridianSync=function(n){if(!n)return null;if("mesh"===n.type)return n.toJSON();let u=null;var t=n.spatialReference,m=a.getInfo(t);if(!m)return n.toJSON();var w=t.isWebMercator?102100:4326;const v=h.cutParams[w].maxX,C=h.cutParams[w].minX;t=h.cutParams[w].plus180Line;w=h.cutParams[w].minus180Line;let A;var y=n.toJSON();k.isPoint(y)?A=b(y,v,C):k.isMultipoint(y)?(y.points=y.points.map(p=>b(p,
v,C)),A=y):k.isExtent(y)?A=c(y,m):k.isPolygon(y)||k.isPolyline(y)?(E.getBoundsXY(l,y),n={xmin:l[0],ymin:l[1],xmax:l[2],ymax:l[3]},m=2*h.offsetMagnitude(n.xmin,C)*v,y=0===m?y:d(y,m),n.xmin+=m,n.xmax+=m,B.extentIntersectsPolyline(n,t)&&n.xmax!==v?u=y:B.extentIntersectsPolyline(n,w)&&n.xmin!==C?u=y:A=y):A=n.toJSON();return null!==u?(new g).cut(u,v):A};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(x,F,E,B,k,h){function a(g,l){if(!l)return null;if("x"in l){var n={x:0,y:0};[n.x,n.y]=g(l.x,l.y,e);null!=l.z&&(n.z=l.z);null!=l.m&&(n.m=l.m);return n}if("xmin"in l)return n={xmin:0,ymin:0,xmax:0,ymax:0},[n.xmin,n.ymin]=g(l.xmin,l.ymin,e),[n.xmax,n.ymax]=g(l.xmax,l.ymax,e),l.hasZ&&(n.zmin=l.zmin,n.zmax=l.zmax,n.hasZ=!0),l.hasM&&(n.mmin=l.mmin,n.mmax=l.mmax,n.hasM=!0),n;if("rings"in l)return{rings:d(l.rings,g),hasM:l.hasM,hasZ:l.hasZ};if("paths"in l)return{paths:d(l.paths,g),hasM:l.hasM,hasZ:l.hasZ};
if("points"in l)return{points:c(l.points,g),hasM:l.hasM,hasZ:l.hasZ}}function d(g,l){const n=[];for(const u of g)n.push(c(u,l));return n}function c(g,l){const n=[];for(const u of g)g=l(u[0],u[1],[0,0]),n.push(g),2<u.length&&g.push(u[2]),3<u.length&&g.push(u[3]);return n}function b(){b=F._asyncToGenerator(function*(g,l){l&&(g=Array.isArray(g)?g.map(n=>{var u;return null==(u=n.geometry)?void 0:u.spatialReference}):[g],yield E.initializeProjection(g.map(n=>({source:n,dest:l}))))});return b.apply(this,
arguments)}const e=[0,0],f=a.bind(null,h.lngLatToXY),r=a.bind(null,h.xyToLngLat),q=new (function(){function g(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var l=g.prototype;l.push=function(){var n=F._asyncToGenerator(function*(u,t,m){if(!(u&&u.length&&t&&m)||k.equals(t,m))return u;const w={geometries:u,inSpatialReference:t,outSpatialReference:m,resolve:null};this._jobs.push(w);return new Promise(v=>{w.resolve=v;null===this._timer&&(this._timer=setTimeout(this._process,10))})});
return function(u,t,m){return n.apply(this,arguments)}}();l._process=function(){this._timer=null;const n=this._jobs.shift();if(n){var {geometries:u,inSpatialReference:t,outSpatialReference:m,resolve:w}=n;h.canProject(t,m)?k.isWebMercator(m)?w(u.map(f)):w(u.map(r)):w(E.projectMany(B.jsonAdapter,u,t,m,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return g}());x.checkProjectionSupport=function(g,l){return b.apply(this,arguments)};x.project=function(g,l,n){if(!g)return g;n||
(n=l,l=g.spatialReference);return k.isValid(l)&&k.isValid(n)&&!k.equals(l,n)?h.canProject(l,n)?k.isWebMercator(n)?f(g):r(g):E.projectMany(B.jsonAdapter,[g],l,n,null)[0]:g};x.projectMany=function(g,l,n){return q.push(g,l,n)};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(x){let F=function(a,d,c){this.x=a;this.y=d;this.spatialReference=c;this.m=this.z=void 0},E=function(a,d,c,b){this.rings=a;this.spatialReference=d;this.hasM=
this.hasZ=void 0;c&&(this.hasZ=c);b&&(this.hasM=b)},B=function(a,d,c,b){this.paths=a;this.spatialReference=d;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);b&&(this.hasM=b)},k=function(a,d,c,b){this.points=a;this.spatialReference=d;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);b&&(this.hasM=b)},h=function(a,d,c,b,e){this.xmin=a;this.ymin=d;this.xmax=c;this.ymax=b;this.spatialReference=e;this.mmax=this.mmin=this.zmax=this.zmin=void 0};x.jsonAdapter={convertToGEGeometry:function(a,d){return null==d?null:
a.convertJSONToGeometry(d)},exportPoint:function(a,d,c){c=new F(a.getPointX(d),a.getPointY(d),c);const b=a.hasZ(d),e=a.hasM(d);b&&(c.z=a.getPointZ(d));e&&(c.m=a.getPointM(d));return c},exportPolygon:function(a,d,c){return new E(a.exportPaths(d),c,a.hasZ(d),a.hasM(d))},exportPolyline:function(a,d,c){return new B(a.exportPaths(d),c,a.hasZ(d),a.hasM(d))},exportMultipoint:function(a,d,c){return new k(a.exportPoints(d),c,a.hasZ(d),a.hasM(d))},exportExtent:function(a,d,c){var b=a.hasZ(d);const e=a.hasM(d);
c=new h(a.getXMin(d),a.getYMin(d),a.getXMax(d),a.getYMax(d),c);b&&(b=a.getZExtent(d),c.zmin=b.vmin,c.zmax=b.vmax);e&&(a=a.getMExtent(d),c.mmin=a.vmin,c.mmax=a.vmax);return c}};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/cimSymbolUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../symbols ./cimAnalyzer ./ExpandedCIM ../WebStyleSymbol".split(" "),function(x,F,E,B,k,h){E=function(){var c=F._asyncToGenerator(function*(b,e,f){return Promise.all(b.map(r=>
d(r,e,f)))});return function(b,e,f){return c.apply(this,arguments)}}();const a=function(){var c=F._asyncToGenerator(function*(b,e){return new k.ExpandedCIM(yield B.analyzeCIMSymbol(b.data,e),b.data,b.rendererKey,b.maxVVSize)});return function(b,e){return c.apply(this,arguments)}}(),d=function(){var c=F._asyncToGenerator(function*(b,e,f){return b?"cim"===b.type?a(b,e):"web-style"===b.type?(b={type:"cim",data:(yield h.fromJSON(b).fetchCIMSymbol(f)).data,rendererKey:b.rendererKey,maxVVSize:b.maxVVSize},
a(b,e)):b:null});return function(b,e,f){return c.apply(this,arguments)}}();x.expandSymbol=d;x.expandSymbols=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/Logger ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./SDFHelper ./utils ../../views/2d/arcade/callExpressionWithFeature".split(" "),function(x,F,E,B,k,h,a,d,c,b,e){function f(J){switch(J){case "Butt":return 0;
case "Square":return 2;default:return 1}}function r(J){switch(J){case "Bevel":return 0;case "Miter":return 2;default:return 1}}function q(J){switch(J){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function g(J){switch(J){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function l(J){let P="normal",Q="normal";J&&(J=J.toLowerCase(),-1!==J.indexOf("italic")?P="italic":-1!==J.indexOf("oblique")&&
(P="oblique"),-1!==J.indexOf("bold")?Q="bold":-1!==J.indexOf("light")&&(Q="lighter"));return{style:P,weight:Q}}function n(J,P,Q,U){let aa;J[P]?aa=J[P]:(aa={},J[P]=aa);aa[Q]=U}function u(J){return(J=J.markerPlacement)&&J.angleToLine?1:0}function t(){t=F._asyncToGenerator(function*(J,P,Q,U){Q=null!=Q?Q:[];if(!J)return Q;let aa;const ba={};if("CIMSymbolReference"===J.type){if(aa=J.symbol,J=J.primitiveOverrides){const ha=[];for(const ca of J){var ia=ca.valueExpressionInfo;ia&&P?(ia=a.createRendererExpression(ia.expression,
P.spatialReference,P.fields).then(S=>{S&&n(ba,ca.primitiveName,ca.propertyName,S)}),ha.push(ia)):null!=ca.value&&n(ba,ca.primitiveName,ca.propertyName,ca.value)}yield Promise.all(ha)}}else return H.error("Expect cim type to be 'CIMSymbolReference'"),Q;switch(aa.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":m(aa,J,ba,P,Q,U)}return Q});return t.apply(this,arguments)}function m(J,P,Q,U,aa,ba){if(J){var ia=J.symbolLayers;if(ia){var ha,ca=d.CIMSymbolHelper.getSize(J);"CIMPointSymbol"===
J.type&&"Map"===J.angleAlignment&&(ha=1);for(var S=ia.length;S--;){var R=ia[S];if(R&&!1!==R.enable){var Y=[];d.OverrideHelper.findApplicableOverrides(R,P,Y);switch(R.type){case "CIMSolidFill":w(R,Q,Y,U,aa);break;case "CIMPictureFill":v(R,Q,Y,U,aa);break;case "CIMHatchFill":C(R,Q,Y,U,aa);break;case "CIMGradientFill":{var ea=Q,T=U,W=aa;const [pa,ra]=O(Y,R.primitiveName);var X=h.numericHash(JSON.stringify(R)+ra).toString();W.push({type:"fill",templateHash:X,materialHash:pa?M(X,ea,Y,T):X,cim:R,materialOverrides:null,
colorLocked:R.colorLocked,effects:R.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}break;case "CIMSolidStroke":A(R,Q,Y,U,aa,"CIMPolygonSymbol"===J.type,ca);break;case "CIMPictureStroke":y(R,Q,Y,U,aa,"CIMPolygonSymbol"===J.type,ca);break;case "CIMGradientStroke":{ea=Q;T=U;W=aa;X="CIMPolygonSymbol"===J.type;var fa=ca,ja=R.primitiveName,ka=void 0!==R.width?R.width:4,na=f(R.capStyle),qa=r(R.joinStyle);const pa=R.miterLimit,[ra,ua]=O(Y,ja),va=h.numericHash(JSON.stringify(R)+
ua).toString();W.push({type:"line",templateHash:va,materialHash:ra?M(va,ea,Y,T):va,cim:R,materialOverrides:null,isOutline:X,colorLocked:R.colorLocked,effects:R.effects,color:{r:128,g:128,b:128,a:1},width:L(ja,ea,"Width",T,ka),cap:L(ja,ea,"CapStyle",T,na),join:L(ja,ea,"JoinStyle",T,qa),miterLimit:L(ja,ea,"MiterLimit",T,pa),referenceWidth:fa,zOrder:K(R.name),isDashed:!1})}break;case "CIMCharacterMarker":p(R,Q,Y,U,aa);break;case "CIMPictureMarker":if(p(R,Q,Y,U,aa))break;"CIMLineSymbol"===J.type&&(ha=
u(R));z(R,Q,Y,U,aa,ha,ca);break;case "CIMVectorMarker":if(p(R,Q,Y,U,aa))break;"CIMLineSymbol"===J.type&&(ha=u(R));ea=Q;T=U;W=aa;X=ha;fa=ca;ja=ba;if(na=R.markerGraphics){ka=0;R.scaleSymbolsProportionally&&(qa=R.frame)&&(ka=qa.ymax-qa.ymin);for(const pa of na)if(pa&&(na=pa.symbol))switch(na.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":G(R,pa,Y,ea,T,W,X,fa,ka,ja);break;case "CIMTextSymbol":D(R,pa,ea,Y,T,W,X,fa,ka)}}break;default:H.error("Cannot analyze CIM layer",R.type)}}}}}}
function w(J,P,Q,U,aa){const ba=J.primitiveName,ia=b.fromCIMColor(J.color),[ha,ca]=O(Q,ba),S=h.numericHash(JSON.stringify(J)+ca).toString();aa.push({type:"fill",templateHash:S,materialHash:ha?()=>S:S,cim:J,materialOverrides:null,colorLocked:J.colorLocked,color:L(ba,P,"Color",U,ia,N),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:J.effects})}function v(J,P,Q,U,aa){const ba=J.primitiveName,ia=J.tintColor?b.fromCIMColor(J.tintColor):{r:255,g:255,b:255,a:1},[ha,ca]=O(Q,ba);Q=h.numericHash(JSON.stringify(J)+
ca).toString();const S=h.numericHash(`${J.url}${JSON.stringify(J.colorSubstitutions)}`).toString();aa.push({type:"fill",templateHash:Q,materialHash:ha?()=>S:S,cim:J,materialOverrides:null,colorLocked:J.colorLocked,effects:J.effects,color:L(ba,P,"TintColor",U,ia,N),height:L(ba,P,"Height",U,J.height),scaleX:L(ba,P,"ScaleX",U,J.scaleX),angle:L(ba,P,"Rotation",U,J.rotation),offsetX:L(ba,P,"OffsetX",U,J.offsetX),offsetY:L(ba,P,"OffsetY",U,J.offsetY)})}function C(J,P,Q,U,aa){const ba=["Rotation","OffsetX",
"OffsetY"],ia=Q.filter(Y=>Y.primitiveName!==J.primitiveName&&-1===ba.indexOf(Y.propertyName)),ha=J.primitiveName,[ca,S]=O(Q,ha);Q=h.numericHash(JSON.stringify(J)+S).toString();const R=h.numericHash(`${J.separation}${JSON.stringify(J.lineSymbol)}`).toString();aa.push({type:"fill",templateHash:Q,materialHash:ca?M(R,P,ia,U):R,cim:J,materialOverrides:ia,colorLocked:J.colorLocked,effects:J.effects,color:{r:255,g:255,b:255,a:1},height:L(ha,P,"Separation",U,J.separation),scaleX:1,angle:L(ha,P,"Rotation",
U,J.rotation),offsetX:L(ha,P,"OffsetX",U,J.offsetX),offsetY:L(ha,P,"OffsetY",U,J.offsetY)})}function A(J,P,Q,U,aa,ba,ia){const ha=J.primitiveName,ca=b.fromCIMColor(J.color),S=void 0!==J.width?J.width:4,R=f(J.capStyle),Y=r(J.joinStyle),ea=J.miterLimit,[T,W]=O(Q,ha),X=h.numericHash(JSON.stringify(J)+W).toString();aa.push({type:"line",templateHash:X,materialHash:T?()=>X:X,cim:J,materialOverrides:null,isOutline:ba,colorLocked:J.colorLocked,effects:J.effects,color:L(ha,P,"Color",U,ca,N),width:L(ha,P,"Width",
U,S),cap:L(ha,P,"CapStyle",U,R),join:L(ha,P,"JoinStyle",U,Y),miterLimit:L(ha,P,"MiterLimit",U,ea),referenceWidth:ia,zOrder:K(J.name),isDashed:!1})}function y(J,P,Q,U,aa,ba,ia){const ha=h.numericHash(`${J.url}${JSON.stringify(J.colorSubstitutions)}`).toString(),ca=J.primitiveName,S=b.fromCIMColor(J.tintColor),R=void 0!==J.width?J.width:4,Y=f(J.capStyle),ea=r(J.joinStyle),T=J.miterLimit,[W,X]=O(Q,ca);Q=h.numericHash(JSON.stringify(J)+X).toString();aa.push({type:"line",templateHash:Q,materialHash:W?
()=>ha:ha,cim:J,materialOverrides:null,isOutline:ba,colorLocked:J.colorLocked,effects:J.effects,color:L(ca,P,"TintColor",U,S,N),width:L(ca,P,"Width",U,R),cap:L(ca,P,"CapStyle",U,Y),join:L(ca,P,"JoinStyle",U,ea),miterLimit:L(ca,P,"MiterLimit",U,T),referenceWidth:ia,zOrder:K(J.name),isDashed:!1})}function p(J,P,Q,U,aa){const ba=J.markerPlacement;if(!ba||"CIMMarkerPlacementInsidePolygon"!==ba.type)return!1;const ia=["Rotation","OffsetX","OffsetY"],ha=Q.filter(R=>R.primitiveName!==J.primitiveName&&-1===
ia.indexOf(R.propertyName)),[ca,S]=O(Q,ba.primitiveName);Q=h.numericHash(JSON.stringify(J)+S).toString();aa.push({type:"fill",templateHash:Q,materialHash:ca?M(Q,P,ha,U):Q,cim:J,materialOverrides:ha,colorLocked:J.colorLocked,effects:J.effects,color:{r:255,g:255,b:255,a:1},height:L(ba.primitiveName,P,"StepY",U,ba.stepY),scaleX:1,angle:L(ba.primitiveName,P,"GridAngle",U,ba.gridAngle),offsetX:L(ba.primitiveName,P,"OffsetX",U,ba.offsetX),offsetY:L(ba.primitiveName,P,"OffsetY",U,ba.offsetY)});return!0}
function z(J,P,Q,U,aa,ba,ia){const ha=J.primitiveName,ca=J.size,S=J.scaleX,R=J.rotation,Y=J.offsetX,ea=J.offsetY,T=b.fromCIMColor(J.tintColor),W=h.numericHash(`${J.url}${JSON.stringify(J.colorSubstitutions)}`).toString(),[X,fa]=O(Q,ha);Q=h.numericHash(JSON.stringify(J)+fa).toString();aa.push({type:"marker",templateHash:Q,materialHash:X?()=>W:W,cim:J,materialOverrides:null,colorLocked:J.colorLocked,effects:J.effects,scaleSymbolsProportionally:!1,alignment:ba,size:L(ha,P,"Size",U,ca),scaleX:L(ha,P,
"ScaleX",U,S),rotation:L(ha,P,"Rotation",U,R),offsetX:L(ha,P,"OffsetX",U,Y),offsetY:L(ha,P,"OffsetY",U,ea),color:L(ha,P,"TintColor",U,T,N),anchorPoint:J.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==J.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:J.rotateClockwise,referenceSize:ia,sizeRatio:1,markerPlacement:J.markerPlacement})}function D(J,P,Q,U,aa,ba,ia,ha,ca){d.OverrideHelper.findApplicableOverrides(P,U,[]);var S=P.geometry;if("x"in S&&"y"in S){var R=
P.symbol;var Y=R.underline?"underline":R.strikethrough?"line-through":"none";var ea=l(R.fontStyleName);R.font={family:R.fontFamilyName,decoration:Y,...ea};var T=J.frame,W=J.size/ca;ca=J.primitiveName;Y=(R.height||0)*W;ea=R.angle||0;var X=((R.offsetX||0)+(S.x-.5*(T.xmin+T.xmax)))*W;S=((R.offsetY||0)+(S.y-.5*(T.ymin+T.ymax)))*W;T=b.fromCIMColor(d.CIMSymbolHelper.getFillColor(R));var fa=b.fromCIMColor(d.CIMSymbolHelper.getStrokeColor(R)),ja=d.CIMSymbolHelper.getStrokeWidth(R);ja||(fa=b.fromCIMColor(d.CIMSymbolHelper.getFillColor(R.haloSymbol)),
ja=R.haloSize*W);W="";for(const ka of U)ka.primitiveName===ca&&void 0!==ka.value&&(W+=`-${ka.primitiveName}-${ka.propertyName}-${JSON.stringify(ka.value)}`);U=JSON.stringify(J.effects)+Number(J.colorLocked)+JSON.stringify(J.anchorPoint)+J.anchorPointUnits+JSON.stringify(J.markerPlacement);U=h.numericHash(JSON.stringify(P)+U+W).toString();ba.push({type:"text",templateHash:U,materialHash:()=>h.numericHash(JSON.stringify(R.font)).toString(),cim:R,materialOverrides:null,colorLocked:J.colorLocked,effects:J.effects,
alignment:ia,anchorPoint:{x:J.anchorPoint?J.anchorPoint.x:0,y:J.anchorPoint?J.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==J.anchorPointUnits,fontName:R.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:L(ca,Q,"Size",aa,Y),angle:L(ca,Q,"Rotation",aa,ea),offsetX:L(ca,Q,"OffsetX",aa,X),offsetY:L(ca,Q,"OffsetY",aa,S),horizontalAlignment:q(R.horizontalAlignment),verticalAlignment:g(R.verticalAlignment),text:L(P.primitiveName,Q,"TextString",aa,P.textString,b._adjustTextCase,R.textCase),
color:T,outlineColor:fa,outlineSize:ja,referenceSize:ha,sizeRatio:1,markerPlacement:J.markerPlacement})}}function G(J,P,Q,U,aa,ba,ia,ha,ca,S){const R=P.geometry;if(R){var Y=P.symbol.symbolLayers;if(Y)if(S)I(J,P,U,Q,aa,ba,ia,ha,ca);else for(S=Y.length;S--;){var ea=Y[S];if(ea&&!1!==ea.enable)switch(ea.type){case "CIMSolidFill":case "CIMSolidStroke":{var T=c.getExtent(R);if(!T)continue;const [fa,ja,ka]=c.getSDFMetrics(T,J.frame,J.size,J.anchorPoint,"Relative"!==J.anchorPointUnits);var W="CIMSolidFill"===
ea.type;T={type:"sdf",geom:R,asFill:W};var X=J.primitiveName;const na=J.size,qa=J.rotation||0,pa=J.offsetX,ra=J.offsetY,ua=ea.primitiveName,va=W?b.fromCIMColor(d.CIMSymbolHelper.getFillColor(ea)):b.fromCIMColor(d.CIMSymbolHelper.getStrokeColor(ea)),xa=W?{r:0,g:0,b:0,a:0}:b.fromCIMColor(d.CIMSymbolHelper.getStrokeColor(ea)),wa=d.CIMSymbolHelper.getStrokeWidth(ea);if(!W&&!wa)break;W=!1;let Ga="";for(const Aa of Q)if(Aa.primitiveName===ua||Aa.primitiveName===X)void 0!==Aa.value?Ga+=`-${Aa.primitiveName}-${Aa.propertyName}-${JSON.stringify(Aa.value)}`:
Aa.valueExpressionInfo&&(W=!0);X=JSON.stringify({...J,markerGraphics:null});const Fa=h.numericHash(JSON.stringify(T)).toString();ea={type:"marker",templateHash:h.numericHash(JSON.stringify(P)+JSON.stringify(ea)+X+Ga).toString(),materialHash:W?()=>Fa:Fa,cim:T,materialOverrides:null,colorLocked:J.colorLocked,effects:J.effects,scaleSymbolsProportionally:J.scaleSymbolsProportionally,alignment:ia,anchorPoint:{x:ja,y:ka},isAbsoluteAnchorPoint:!1,size:L(J.primitiveName,U,"Size",aa,na),rotation:L(J.primitiveName,
U,"Rotation",aa,qa),offsetX:L(J.primitiveName,U,"OffsetX",aa,pa),offsetY:L(J.primitiveName,U,"OffsetY",aa,ra),scaleX:1,frameHeight:ca,rotateClockwise:J.rotateClockwise,referenceSize:ha,sizeRatio:fa,color:L(ua,U,"Color",aa,va,N),outlineColor:L(ua,U,"Color",aa,xa,N),outlineWidth:L(ua,U,"Width",aa,wa),markerPlacement:J.markerPlacement};ba.push(ea);break}default:I(J,P,U,Q,aa,ba,ia,ha,ca)}}}}function I(J,P,Q,U,aa,ba,ia,ha,ca){P={type:J.type,enable:!0,name:J.name,colorLocked:J.colorLocked,primitiveName:J.primitiveName,
anchorPoint:J.anchorPoint,anchorPointUnits:J.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:J.rotateClockwise,rotation:0,size:J.size,billboardMode3D:J.billboardMode3D,depth3D:J.depth3D,frame:J.frame,markerGraphics:[P],scaleSymbolsProportionally:J.scaleSymbolsProportionally,respectFrame:J.respectFrame,clippingPath:J.clippingPath,effects:J.effects};let S=[];const R=["Rotation","OffsetX","OffsetY"];S=U.filter(ka=>ka.primitiveName!==J.primitiveName||-1===R.indexOf(ka.propertyName));var Y="";for(var ea of U)void 0!==
ea.value&&(Y+=`-${ea.primitiveName}-${ea.propertyName}-${JSON.stringify(ea.value)}`);const [T,W,X]=d.CIMSymbolHelper.getTextureAnchor(P);U=J.primitiveName;ea=J.rotation||0;const fa=J.offsetX||0,ja=J.offsetY||0;Y=h.numericHash(JSON.stringify(P)+Y).toString();Q={type:"marker",templateHash:Y,materialHash:0===S.length?Y:M(Y,Q,S,aa),cim:P,materialOverrides:S,colorLocked:J.colorLocked,effects:J.effects,scaleSymbolsProportionally:J.scaleSymbolsProportionally,alignment:ia,anchorPoint:{x:T,y:W},isAbsoluteAnchorPoint:!1,
size:J.size,rotation:L(U,Q,"Rotation",aa,ea),offsetX:L(U,Q,"OffsetX",aa,fa),offsetY:L(U,Q,"OffsetY",aa,ja),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:ca,rotateClockwise:J.rotateClockwise,referenceSize:ha,sizeRatio:X/k.pt2px(J.size),markerPlacement:J.markerPlacement};ba.push(Q)}function K(J){return J&&0===J.indexOf("Level_")?parseInt(J.substr(6),10):0}function N(J){if(!J||0===J.length)return null;J=(new E(J)).toRgba();return{r:J[0],g:J[1],b:J[2],a:J[3]}}
function L(J,P,Q,U,aa,ba,ia){if(J=P[J]){const ha=J[Q];if("string"===typeof ha||"number"===typeof ha||ha instanceof Array)return ba?ba.call(null,ha,ia):ha;if(null!=ha&&ha instanceof a.ArcadeExpression)return(ca,S,R)=>{ca=e(ha,ca,{$view:R},U.geometryType,S);null!==ca&&ba&&(ca=ba.call(null,ca,ia));return null!==ca?ca:aa}}return aa}function M(J,P,Q,U){for(const aa of Q)if(aa.valueExpressionInfo){const ba=P[aa.primitiveName]&&P[aa.primitiveName][aa.propertyName];ba instanceof a.ArcadeExpression&&(aa.fn=
(ia,ha,ca)=>e(ba,ia,{$view:ca},U.geometryType,ha))}return(aa,ba,ia)=>{for(const ha of Q)ha.fn&&(ha.value=ha.fn(aa,ba,ia));return h.numericHash(J+d.OverrideHelper.buildOverrideKey(Q)).toString()}}function O(J,P){let Q=!1,U="";for(const aa of J)aa.primitiveName===P&&(void 0!==aa.value?U+=`-${aa.primitiveName}-${aa.propertyName}-${JSON.stringify(aa.value)}`:aa.valueExpressionInfo&&(Q=!0));return[Q,U]}const H=B.getLogger("esri.symbols.cim.cimAnalyzer");x.analyzeCIMResource=function(J,P){if(!P||0===P.length)return J;
J=JSON.parse(JSON.stringify(J));d.OverrideHelper.applyOverrides(J,P);return J};x.analyzeCIMSymbol=function(J,P,Q,U){return t.apply(this,arguments)};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../geometry/support/quantizationUtils"],function(x,F,E){function B(h){const a={};switch(h){case "esriGeometryPoint":return(d,c,b,e)=>E.unquantizePoint(c,a,d,b,e);case "esriGeometryPolygon":return(d,
c,b,e)=>E.unquantizePolygon(c,a,d,b,e);case "esriGeometryPolyline":return(d,c,b,e)=>E.unquantizePolyline(c,a,d,b,e);case "esriGeometryMultipoint":return(d,c,b,e)=>E.unquantizeMultipoint(c,a,d,b,e);default:return F.getLogger("esri.views.2d.support.arcadeOnDemand").error(new x("mapview-arcade",`Unable to handle geometryType: ${h}`)),d=>d}}const k=new Map;return function(h,a,d,c,b){if(h.referencesGeometry()&&b){{const {transform:e,hasZ:f,hasM:r}=b;k.has(c)||k.set(c,B(c));c=k.get(c)(a.geometry,e,f,r);
a={...a,geometry:c}}}a=h.repurposeFeature(a);try{return h.evaluate({...d,$feature:a})}catch(e){return F.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(x,F){function E({scale:p,translate:z},D){return Math.round((D-z[0])/p[0])}function B({scale:p,translate:z},D){return Math.round((z[1]-D)/p[1])}function k(p,z,D){const G=[];let I,K,N,L;for(let M=0;M<
D.length;M++){const O=D[M];if(0<M){if(N=E(p,O[0]),L=B(p,O[1]),N!==I||L!==K)G.push(z(O,N-I,L-K)),I=N,K=L}else I=E(p,O[0]),K=B(p,O[1]),G.push(z(O,I,K))}return 0<G.length?G:null}function h(p,z,D,G){return k(p,D?G?y:A:G?A:C,z)}function a(p,z,D,G){const I=[];D=D?G?y:A:G?A:C;for(G=0;G<z.length;G++){const K=k(p,D,z[G]);K&&3<=K.length&&I.push(K)}return I.length?I:null}function d(p,z,D,G){const I=[];D=D?G?y:A:G?A:C;for(G=0;G<z.length;G++){const K=k(p,D,z[G]);K&&2<=K.length&&I.push(K)}return I.length?I:null}
function c({scale:p,translate:z},D){return D*p[0]+z[0]}function b({scale:p,translate:z},D){return z[1]-D*p[1]}function e(p,z,D){const G=Array(D.length);if(!D.length)return G;const [I,K]=p.scale;let N=c(p,D[0][0]);p=b(p,D[0][1]);G[0]=z(D[0],N,p);for(let L=1;L<D.length;L++){const M=D[L];N+=M[0]*I;p-=M[1]*K;G[L]=z(M,N,p)}return G}function f(p,z,D){const G=Array(D.length);for(let I=0;I<D.length;I++)G[I]=e(p,z,D[I]);return G}function r(p,z,D,G){return e(p,D?G?y:A:G?A:C,z)}function q(p,z,D,G){return f(p,
D?G?y:A:G?A:C,z)}function g(p,z,D,G){return f(p,D?G?y:A:G?A:C,z)}function l(p,z,D){let [G,I]=D[0],K=Math.min(G,z[0]),N=Math.min(I,z[1]),L=Math.max(G,z[2]);z=Math.max(I,z[3]);for(let M=1;M<D.length;M++){const [O,H]=D[M];G+=O;I+=H;0>O&&(K=Math.min(K,G));0<O&&(L=Math.max(L,G));0>H?N=Math.min(N,I):0<H&&(z=Math.max(z,I))}p[0]=K;p[1]=N;p[2]=L;p[3]=z;return p}function n(p,z){if(!z.length)return null;p[0]=p[1]=Number.POSITIVE_INFINITY;p[2]=p[3]=Number.NEGATIVE_INFINITY;for(let D=0;D<z.length;D++)l(p,p,z[D]);
return p}function u(p,z,D,G,I){z.xmin=E(p,D.xmin);z.ymin=B(p,D.ymin);z.xmax=E(p,D.xmax);z.ymax=B(p,D.ymax);z!==D&&(G&&(z.zmin=D.zmin,z.zmax=D.zmax),I&&(z.mmin=D.mmin,z.mmax=D.mmax));return z}function t(p,z,D,G,I){z.points=h(p,D.points,G,I);return z}function m(p,z,D,G,I){z.x=E(p,D.x);z.y=B(p,D.y);z!==D&&(G&&(z.z=D.z),I&&(z.m=D.m));return z}function w(p,z,D,G,I){p=a(p,D.rings,G,I);if(!p)return null;z.rings=p;return z}function v(p,z,D,G,I){p=d(p,D.paths,G,I);if(!p)return null;z.paths=p;return z}const C=
(p,z,D)=>[z,D],A=(p,z,D)=>[z,D,p[2]],y=(p,z,D)=>[z,D,p[2],p[3]];x.equals=function(p,z){if(p===z||null==p&&null==z)return!0;if(null==p||null==z)return!1;let D,G,I,K;p&&"upperLeft"===p.originPosition?(D=p.translate[0],G=p.translate[1],p=p.scale[0]):(D=p.extent.xmin,G=p.extent.ymax,p=p.tolerance);z&&"upperLeft"===z.originPosition?(I=z.translate[0],K=z.translate[1],z=z.scale[0]):(I=z.extent.xmin,K=z.extent.ymax,z=z.tolerance);return D===I&&G===K&&p===z};x.getQuantizedBoundsCoordsArray=l;x.getQuantizedBoundsCoordsArrayArray=
n;x.getQuantizedBoundsPaths=function(p){return n([0,0,0,0],p)};x.getQuantizedBoundsPoints=function(p){const z=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return l(z,z,p)};x.getQuantizedBoundsRings=function(p){return n([0,0,0,0],p)};x.quantizeBounds=function(p,z,D){z[0]=E(p,D[0]);z[3]=B(p,D[1]);z[2]=E(p,D[2]);z[1]=B(p,D[3]);return z};x.quantizeExtent=u;x.quantizeGeometry=function(p,z){return p&&z?F.isPoint(z)?m(p,{},z,!1,!1):F.isPolyline(z)?
v(p,{},z,!1,!1):F.isPolygon(z)?w(p,{},z,!1,!1):F.isMultipoint(z)?t(p,{},z,!1,!1):F.isExtent(z)?u(p,{},z,!1,!1):null:null};x.quantizeMultipoint=t;x.quantizePaths=d;x.quantizePoint=m;x.quantizePoints=h;x.quantizePolygon=w;x.quantizePolyline=v;x.quantizeRings=a;x.quantizeX=E;x.quantizeY=B;x.toQuantizationTransform=function(p){return p?{originPosition:"upper-left"===p.originPosition?"upperLeft":"lower-left"===p.originPosition?"lowerLeft":p.originPosition,scale:p.tolerance?[p.tolerance,p.tolerance]:[1,
1],translate:p.extent?[p.extent.xmin,p.extent.ymax]:[0,0]}:null};x.unquantizeBounds=function(p,z,D){return D?(z[0]=c(p,D[0]),z[1]=b(p,D[3]),z[2]=c(p,D[2]),z[3]=b(p,D[1]),z):[c(p,z[0]),b(p,z[3]),c(p,z[2]),b(p,z[1])]};x.unquantizeCoordsArray=e;x.unquantizeCoordsArrayArray=f;x.unquantizeExtent=function(p,z,D,G,I){z.xmin=c(p,D.xmin);z.ymin=b(p,D.ymin);z.xmax=c(p,D.xmax);z.ymax=b(p,D.ymax);z!==D&&(G&&(z.zmin=D.zmin,z.zmax=D.zmax),I&&(z.mmin=D.mmin,z.mmax=D.mmax));return z};x.unquantizeMultipoint=function(p,
z,D,G,I){z.points=r(p,D.points,G,I);return z};x.unquantizePaths=q;x.unquantizePoint=function(p,z,D,G,I){z.x=c(p,D.x);z.y=b(p,D.y);z!==D&&(G&&(z.z=D.z),I&&(z.m=D.m));return z};x.unquantizePoints=r;x.unquantizePolygon=function(p,z,D,G,I){z.rings=g(p,D.rings,G,I);return z};x.unquantizePolyline=function(p,z,D,G,I){z.paths=q(p,D.paths,G,I);return z};x.unquantizeRings=g;x.unquantizeX=c;x.unquantizeY=b;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(x,F,E,B){const k={marker:E.WGLGeometryType.MARKER,fill:E.WGLGeometryType.FILL,line:E.WGLGeometryType.LINE,text:E.WGLGeometryType.TEXT};E=function(){function h(a,d,c,b){const e={minScale:null==d?void 0:d.minScale,maxScale:null==d?void 0:d.maxScale};var f=e.minScale||e.maxScale?e.minScale+"-"+e.maxScale:"";this.layers=a;this.data=d;this.hash=this._createHash()+
f;this.rendererKey=c;for(const r of a)r.materialKey=B.createMaterialKey(k[r.type],this.rendererKey,!1,!1),r.maxVVSize=b,r.scaleInfo=e,r.templateHash+=f}h.prototype._createHash=function(){let a="";for(const d of this.layers)a+=d.templateHash;return a};F._createClass(h,[{key:"type",get:function(){return"expanded-cim"}}]);return h}();x.ExpandedCIM=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GraphicTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ./DirtyMap ./DisplayRecordStore ./WGLBuffers ./WGLTile".split(" "),
function(x,F,E,B,k,h){h=function(a){function d(){var b=a.apply(this,arguments)||this;b._data=null;b._displayList=null;b._lastCommitTime=0;b._hasData=!1;b._invalidated=!1;b._wglBuffers=null;b._dirtyMap=new E;return b}F._inheritsLoose(d,a);var c=d.prototype;c.destroy=function(){a.prototype.destroy.call(this);this.clear()};c.getGeometry=function(b){return this._wglBuffers&&this._wglBuffers.has(b)?this._wglBuffers.get(b):null};c.getDisplayList=function(){return this._displayList};c.patch=function(b){if(!0===
b.clear)this.clear(),this._hasData=!1;else{var e=b.addOrUpdate,f=b.remove;!this._data&&e&&e.tileDisplayData.displayObjects.length?(e.tileDisplayData.computeDisplayList(),this._dirtyMap=new E,this._dispRecStore=B.fromTileData(e,this._dirtyMap),this._data=e,this._dirtyMap.markAllDirty(),this._hasData=!0,b.end&&this.ready()):this._data?e&&e.tileDisplayData.displayObjects.length||f.length?this._doPatchData(b):b.end&&this.ready():b.end&&this.ready();b.end&&!this._data&&this.clear();this.requestRender();
this.emit("change")}};c.commit=function(b){if(!b.time||b.time!==this._lastCommitTime)if(this._lastCommitTime=b.time,this.visible&&this._data&&(this._wglBuffers||(this._wglBuffers=new k(b.context)),this._dirtyMap.hasDirty()||this._invalidated))this._invalidated=!1,this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._dirtyMap.markAllClean()};c.clear=
function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};c._doPatchData=function(b){this._invalidated=!0;this._patchData(b)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=B.fromTileData(this._data,this._dirtyMap));this.requestRender()};c._patchData=function(b){let e=!0;var f=b.addOrUpdate&&b.addOrUpdate.tileDisplayData&&b.addOrUpdate.tileDisplayData.displayObjects||[],r=(b.remove||[]).slice();for(var q of f)null!=
q.insertAfter&&r.push(q.id);for(var g of r)if(r=this._data.tileDisplayData.displayObjectRegistry.get(g)){this._data.tileDisplayData.displayList.removeFromList(r.displayRecords);for(var l of r.displayRecords)this._dispRecStore.delete(l);this._data.tileDisplayData.displayObjectRegistry.delete(g);r=this._data.tileDisplayData.displayObjects.indexOf(r);this._data.tileDisplayData.displayObjects.splice(r,1)}for(const m of f){f=this._data.tileDisplayData.displayObjectRegistry.get(m.id);let w;if(f){g=f.displayRecords;
f.set(m);f.displayRecords=g;g=f.displayRecords.length;for(l=0;l<g;++l)if(r=f.displayRecords[l],q=m.displayRecords[l],l>=m.displayRecords.length||r.geometryType!==q.geometryType||r.symbolLevel!==q.symbolLevel||r.zOrder!==q.zOrder||r.materialKey!==q.materialKey)this._dispRecStore.delete(f.displayRecords[l]),l<m.displayRecords.length&&(f.displayRecords[l]=void 0);f.displayRecords.length=m.displayRecords.length}else if(f=m.copy(),f.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(m.id,
f),g=this._data.tileDisplayData.displayObjects,null!=f.insertAfter?(w={},0<=f.insertAfter?(l=this._data.tileDisplayData.displayObjectRegistry.get(f.insertAfter))?(q=g.indexOf(l)+1,q<g.length?g.splice(q,0,f):(g.push(f),q=g.length)):(g.push(f),q=g.length):(g.unshift(f),q=0)):(g.push(f),q=g.length),w)for(l=0<m.displayRecords.length?1:0,r=0,--q;0<=q&&r<l;--q)for(var n=g[q].displayRecords.length-1;0<=n&&r<l;--n){var u=g[q].displayRecords[n],t=this._data.tileDisplayData.displayList.getDPInfoType();w[t]||
(w[t]=u,++r)}g=m.displayRecords.length;for(l=0;l<g;++l){r=m.displayRecords[l];(q=f.displayRecords[l])?(q.meshData=r.meshData,q.materialKey=r.materialKey):(q=r.copy(),q.vertexFrom=void 0,q.indexFrom=void 0,f.displayRecords[l]=q);u=r.geometryType;n=this._data.tileDisplayData.displayList.getDPInfoType();t=b.addOrUpdate.tileBufferData.geometries[u];u=t.vertexBuffer;t=t.indexBuffer;let v=void 0;w&&(v=w[n]?this._data.tileDisplayData.displayList.splitAfter(w[n]):-1);e=this._dispRecStore.setMeshData(q,r,
u,t,v)&&e;w&&null!=q.indexFrom&&null!=q.indexFrom&&(w[n]=q)}}return e};F._createClass(d,[{key:"hasData",get:function(){return!!this._hasData}},{key:"displayObjects",get:function(){var b;return null!=(b=this._displayObjects)?b:[]}}]);return d}(h.WGLTile);x.GraphicTile=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(["./Utils"],function(x){function F(E,B,k){if(!E.allDirty)if(null!=E.from&&null!=E.count){const h=Math.min(E.from,B);B=Math.max(E.from+
E.count,B+k)-h;E.from=h;E.count=B}else E.from=B,E.count=k}return function(){function E(){this._dirties=x.createGeometryData(()=>({indices:{from:null,count:null,allDirty:!1}}),()=>({vertices:{from:null,count:null,allDirty:!1}}))}var B=E.prototype;B.hasDirty=function(){for(const k of this._dirties)if(null!==k.data.indices.count||k.data.indices.allDirty)return!0;return!1};B.markAllClean=function(){for(const k of this._dirties){k.data.indices.from=null;k.data.indices.count=null;k.data.indices.allDirty=
!1;for(const h in k.buffers)k.buffers[h].data.vertices.from=null,k.buffers[h].data.vertices.count=null,k.buffers[h].data.vertices.allDirty=!1}};B.markAllDirty=function(){for(const k of this._dirties){k.data.indices.allDirty=!0;for(const h in k.buffers)k.buffers[h].data.vertices.allDirty=!0}};B.forEach=function(k){for(let d=0;d<this._dirties.length;++d){var h=this._dirties[d],a={};for(const c in h.buffers){const b=h.buffers[c].data.vertices;if(b.allDirty||null!=b.from&&null!=b.count&&0<b.count)a[c]=
b}h=h.data.indices;a=h.allDirty||null!=h.from&&null!=h.count&&0<h.count?{indices:h,vertices:a}:{indices:null,vertices:a};(a.indices||0<Object.keys(a).length)&&k(a,d)}};B.markDirtyIndices=function(k,h,a){F(this._dirties[k].data.indices,h,a)};B.markDirtyVertices=function(k,h,a,d){F(this._dirties[k].buffers[h].data.vertices,a,d)};return E}()})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["../../../../core/has","./FreeList","./Utils"],function(x,F,E){const B=["FILL","LINE","MARKER",
"TEXT","LABEL"];return function(){function k(a,d,c,b){this._strides=a;this._displayList=d;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=c;for(const e in a){this._freeListsAndStorage[e]={vtxFreeList:b?new F.FreeList(b):null,idxFreeList:b?new F.FreeList(b):null,vertexBuffers:{},indexBuffer:b?new Uint32Array(b):null};for(const f in a[e])this._freeListsAndStorage[e].vertexBuffers[f]={data:b?E.allocateTypedArrayBuffer(b,a[e][f]):null,stride:a[e][f]}}}k.fromTileData=function(a,d){var c,
b=a.getStrides(),e={};for(c=0;c<b.length;c++)e[B[c]]=b[c];c=e;b=[0,0,0,0,0];e=[0,0,0,0,0];var f=a.tileDisplayData.displayObjects;for(var r of f)for(var q of r.displayRecords)b[q.geometryType]=Math.max(b[q.geometryType],q.vertexFrom+q.vertexCount),e[q.geometryType]=Math.max(e[q.geometryType],q.indexFrom+q.indexCount);d=new k(c,a.tileDisplayData.displayList,d,null);for(r=0;r<a.tileBufferData.geometries.length;++r){q=b[r];f=e[r];var g=a.tileBufferData.geometries[r];c=d._storageFor(B[r]);const l=a.tileBufferData.geometries[r].indexBuffer;
c.indexBuffer=l;c.idxFreeList=new F.FreeList(l.length);c.idxFreeList.allocate(f);let n;for(const u in g.vertexBuffer)f=a.tileBufferData.geometries[r].vertexBuffer[u],c.vertexBuffers[u].data=f.data,c.vertexBuffers[u].stride=f.stride,g=E.strideToPackingFactor(f.stride),f=f.data.length*g/f.stride,n||(n=f);c.vtxFreeList=new F.FreeList(n);c.vtxFreeList.allocate(q)}return d};var h=k.prototype;h.delete=function(a){const d=B[a.geometryType];this._freeVertices(d,a.vertexFrom,a.vertexCount);this._freeIndices(d,
a.indexFrom,a.indexCount);this._displayList.removeFromList(a);a.vertexFrom=void 0;a.indexFrom=void 0};h.setMeshData=function(a,d,c,b,e){const f=B[a.geometryType];a.meshData=null;let r=void 0,q=void 0;void 0===a.vertexFrom?(q=d.vertexCount,r=this._allocateVertices(f,q)):d.vertexCount>a.vertexCount?(this._freeVertices(f,a.vertexFrom,a.vertexCount),q=d.vertexCount,r=this._allocateVertices(f,q)):d.vertexCount===a.vertexCount?(r=a.vertexFrom,q=a.vertexCount):(this._freeVertices(f,a.vertexFrom+d.vertexCount,
a.vertexCount-d.vertexCount),r=a.vertexFrom,q=d.vertexCount);let g=!0,l=void 0,n=void 0,u=void 0;void 0===a.indexFrom?(l=e,u=d.indexCount,n=this._allocateIndices(f,u)):d.indexCount>a.indexCount?(l=this._displayList.removeFromList(a),this._freeIndices(f,a.indexFrom,a.indexCount),u=d.indexCount,n=this._allocateIndices(f,u)):d.indexCount===a.indexCount?(g=!1,n=a.indexFrom,u=a.indexCount):(l=this._displayList.removeFromList(a),this._freeIndices(f,a.indexFrom+d.indexCount,a.indexCount-d.indexCount),n=
a.indexFrom,u=d.indexCount);if(-1!==r&&-1!==n){e=this._storageFor(f);E.copyMeshData(r,n,e.vertexBuffers,e.indexBuffer,d,c,b);a.vertexFrom=r;a.indexFrom=n;a.vertexCount=d.vertexCount;a.indexCount=d.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(a.geometryType,a.indexFrom,a.indexCount);for(const t in c)this._dirtyMap.markDirtyVertices(a.geometryType,t,a.vertexFrom,a.vertexCount)}g&&this._displayList.addToList(a,l);return!0}-1!==r&&this._freeVertices(f,r,q);-1!==n&&this._freeIndices(f,
n,u);a.setMeshDataFromBuffers(d,c,b);a.vertexFrom=void 0;a.vertexCount=0;a.indexFrom=void 0;a.indexCount=0;return!1};h.tryAddMeshData=function(a,d){const c=d.vertexBuffer;d=d.indexBuffer;var b=B[a.geometryType];const e=this._allocateVertices(b,a.vertexCount);if(-1===e)return this._freeVertices(b,e,a.vertexCount),!1;const f=this._allocateIndices(b,a.indexCount);if(-1===f)return this._freeVertices(b,e,a.vertexCount),this._freeIndices(b,f,a.indexCount),!1;b=this._storageFor(b);E.copyMeshData(e,f,b.vertexBuffers,
b.indexBuffer,a,c,d);a.vertexFrom=e;a.indexFrom=f;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(a.geometryType,a.indexFrom,a.indexCount);for(const r in c)this._dirtyMap.markDirtyVertices(a.geometryType,r,e,a.vertexCount)}this._displayList.addToList(a);return!0};h._allocateVertices=function(a,d){a=this._storageFor(a);d=a.vtxFreeList.allocate(d);return-1===d||.5<a.vtxFreeList.fragmentation?-1:d};h._freeVertices=function(a,d,c){this._storageFor(a).vtxFreeList.free(d,c)};h._freeIndices=function(a,
d,c){this._storageFor(a).idxFreeList.free(d,c)};h._allocateIndices=function(a,d){a=this._storageFor(a);d=a.idxFreeList.allocate(d);return-1===d||.5<a.idxFreeList.fragmentation?-1:d};h._storageFor=function(a){return this._freeListsAndStorage[a]};h._stridesFor=function(a,d){return this._strides[a][d]};return k}()})},"esri/views/2d/engine/webgl/FreeList":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(x,F){let E=function(){function k(a){this._largestRange=null;this._parent=
a;this._updateLargestRange()}var h=k.prototype;h.rangeCreated=function(a){if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};h.rangeResized=function(a,d){if(a===this._largestRange)a.count<d&&this._updateLargestRange();else if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};h.findBestRange=function(a){let d=this._parent._freeHead,c=null;for(;null!==d;)d.count>=a&&(!c||d.count-a<c.count-a)&&(c=d),d=d.next;return c};h.findAdjacentRanges=function(a,
d){let c=!0,b=!1,e=null,f=this._parent._freeHead;for(;c&&!b;){const r=null!==f?f.from:this._parent._size;a>=(null!==e?e.from+e.count:0)&&a+d<=r?(c=!1,b=!0):null!==f?(e=f,f=f.next):c=!1}return[e,f]};h._updateLargestRange=function(){let a=null,d=this._parent._freeHead;for(;null!==d;){if(!a||d.count>a.count)a=d;d=d.next}this._largestRange=a};F._createClass(k,[{key:"largestRange",get:function(){return this._largestRange}}]);return k}(),B=function(){function k(a,d){this._allocated=0;this._size=a;this._freeHead=
0<a?{from:0,count:a,prev:null,next:null}:null;this._bookKeeper=d||new E(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}var h=k.prototype;h.allocate=function(a){const d=this._bookKeeper.findBestRange(a);if(null===d)return-1;const c=d.from,b=d.count;d.from+=a;d.count-=a;this._bookKeeper.rangeResized(d,c,b);this._allocated+=a;0===d.count&&(a=null!==d.prev?this._freeHead:d.next,k._removeRange(d),this._freeHead=a);return c};h.free=function(a,d){const [c,b]=this._bookKeeper.findAdjacentRanges(a,
d);a={from:a,count:d,prev:c,next:b};null!==c&&(c.next=a);null!==b&&(b.prev=a);this._bookKeeper.rangeCreated(a);this._allocated-=d;if(null!==b&&a.from+a.count===b.from){d=a.from;var e=a.count;k._fuse(a,b);k._removeRange(b);this._bookKeeper.rangeResized(a,d,e);this._bookKeeper.rangeResized(b,void 0,0)}null!==c&&c.from+c.count===a.from&&(d=c.from,e=c.count,k._fuse(c,a),k._removeRange(a),this._bookKeeper.rangeResized(c,d,e),this._bookKeeper.rangeResized(a,void 0,0));this._freeHead=null!==a.prev?this._freeHead:
a};k._removeRange=function(a){null!==a.prev?null!==a.next?(a.prev.next=a.next,a.next.prev=a.prev):a.prev.next=null:null!==a.next&&(a.next.prev=null)};k._fuse=function(a,d){a.count+=d.count;a.next=d.next;d.from+=d.count;d.count=0;null!==d.next&&(d.next.prev=a)};F._createClass(k,[{key:"fragmentation",get:function(){const a=this._size-this._allocated;return 0===a?0:1-this._bookKeeper.largestRange.count/a}}]);return k}();x.FreeList=B;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define("../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/ProgramCache ../../../webgl/Renderbuffer ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ../../../webgl/Texture ../../../webgl/VertexArrayObject ./Utils".split(" "),
function(x,F,E,B,k,h,a,d,c,b){return function(){function e(r){this.geometryMap=b.createGeometryData(()=>({indexBuffer:x.createIndex(r,35044),vao:null}),(q,g)=>({vertexBuffer:x.createVertex(r,b.C_VBO_INFO[g])}))}var f=e.prototype;f.dispose=function(){for(let r=0;5>r;r++){const q=this.geometryMap[r];if(q){q.data.vao&&q.data.vao.dispose(!1);q.data.indexBuffer&&q.data.indexBuffer.dispose();for(const g in q.buffers)q.buffers[g]&&q.buffers[g].data.vertexBuffer.dispose()}}};f.get=function(r){const q=this.geometryMap[r];
return{draw(g,l,n,u,t){if(!q.data.vao){const m={};for(const w in q.buffers)m[w]=q.buffers[w].data.vertexBuffer;q.data.vao=new c(g,n,l,m,q.data.indexBuffer)}g.bindVAO(q.data.vao);g.drawElements(4,t,5125,Uint32Array.BYTES_PER_ELEMENT*u);g.bindVAO(null)}}};f.has=function(r){return null!=this.geometryMap[r]};f.upload=function(r,q){q.forEach((g,l)=>{this._upload(g,l,r)})};f._upload=function(r,q,g){r.indices&&(r.indices.allDirty?this._uploadIndices(g,q):null!=r.indices.from&&null!=r.indices.count&&this._uploadIndices(g,
q,r.indices.from,r.indices.count));if(r.vertices){r=r.vertices;for(const l in r){const n=r[l];n.allDirty?this._uploadVertices(g,q,l):null!=n.from&&null!=n.count&&this._uploadVertices(g,q,l,n.from,n.count)}}};f._uploadVertices=function(r,q,g,l,n){const u=this.geometryMap[q];u&&(q=r.geometries[q].vertexBuffer[g])&&(r=q.stride,q=q.data.buffer,u.buffers[g]&&0<q.byteLength&&(null!=l&&null!=n?u.buffers[g].data.vertexBuffer.setSubData(q,l*r,l*r,(l+n)*r):u.buffers[g].data.vertexBuffer.setData(q)))};f._uploadIndices=
function(r,q,g,l){const n=this.geometryMap[q];n&&(r=r.geometries[q].indexBuffer.buffer,n.data.indexBuffer&&0<r.byteLength&&(null!=g&&null!=l?n.data.indexBuffer.setSubData(r,4*g,4*g,4*(g+l)):n.data.indexBuffer.setData(r)))};return e}()})},"esri/views/2d/engine/webgl/WGLTile":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./definitions","./TiledDisplayObject"],function(x,F,E,B){B=function(k){function h(a,d){return k.call(this,a,d,[E.TILE_SIZE,E.TILE_SIZE])||this}F._inheritsLoose(h,
k);return h}(B.TiledDisplayObject);x.WGLTile=B;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../DisplayObject ../../tiling/TileKey".split(" "),function(x,F,E,B,k,h,a){E=function(d){function c(e,f,r,q=r){var g=d.call(this)||this;g.triangleCountReportedInDebug=0;g.transforms={dvs:k.create(),tileMat3:k.create()};
g.triangleCount=0;g.key=new a(e);g.bounds=f;g.size=r;g.coordRange=q;return g}F._inheritsLoose(c,d);var b=c.prototype;b.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)};b.setTransform=function(e,f){f/=e.resolution*e.pixelRatio;const r=this.transforms.tileMat3,[q,g]=e.toScreenNoRotation([0,0],this.coords);B.set(r,this.size[0]/this.coordRange[0]*f,0,0,0,this.size[1]/this.coordRange[1]*f,0,q,g,1);B.multiply(this.transforms.dvs,e.displayViewMat3,r)};F._createClass(c,[{key:"coords",
get:function(){return this._coords}},{key:"bounds",get:function(){return this._bounds},set:function(e){this._coords=[e[0],e[3]];this._bounds=e}}]);return c}(h.DisplayObject);x.TiledDisplayObject=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileData":function(){define("exports ../../../../core/maybe ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./WGLDisplayRecord ./cpuMapped/DisplayRecordReader ./mesh/VertexBuffer ./mesh/VertexVector ./util/Writer".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e){const f=new E,r=new E;E=function(){function q(){this.tileBufferData=this.tileDisplayData=null}var g=q.prototype;g.reshuffle=function(){f.reset();const l=k.groupRecordsByGeometryType(this.tileDisplayData.displayObjects);for(var n of l)for(var u of n)u&&f.needMore(u.geometryType,u.meshData?u.meshData.vertexCount:u.vertexCount,u.meshData?u.meshData.indexData.length:u.indexCount);n=l.length;u=new B;for(var t=0;t<n;++t){u.geometries[t].indexBuffer=new Uint32Array(Math.round(1.5*
f.indicesFor(t)));var m=[];for(var w in this.tileBufferData.geometries[t].vertexBuffer)m.push(this.tileBufferData.geometries[t].vertexBuffer[w].stride);m=q._computeVertexAlignment(m);var v=Math.round(1.5*f.verticesFor(t));m=q._align(v,m);for(var C in this.tileBufferData.geometries[t].vertexBuffer)v=this.tileBufferData.geometries[t].vertexBuffer[C].stride,u.geometries[t].vertexBuffer[C]={stride:v,data:h.allocateTypedArrayBuffer(m,v)}}r.reset();this.tileDisplayData.displayList.clear();for(w=0;w<n;++w){C=
l[w];for(const A of C){if(A.meshData)A.writeMeshDataToBuffers(r.verticesFor(w),u.geometries[w].vertexBuffer,r.indicesFor(w),u.geometries[w].indexBuffer),A.meshData=null;else{C=this.tileBufferData.geometries[w].vertexBuffer;t=this.tileBufferData.geometries[w].indexBuffer;m=u.geometries[w].vertexBuffer;v=u.geometries[w].indexBuffer;const y=r.verticesFor(w),p=r.indicesFor(w);h.copyMeshData(y,p,m,v,A,C,t);A.vertexFrom=y;A.indexFrom=p}r.needMore(w,A.vertexCount,A.indexCount)}}for(const A of this.tileDisplayData.displayObjects)this.tileDisplayData.displayList.addToList(A.displayRecords);
this.tileBufferData=u};g.getStrides=function(){const l=[];for(let n=0;n<this.tileBufferData.geometries.length;++n){const u=this.tileBufferData.geometries[n];l[n]={};for(const t in u.vertexBuffer)l[n][t]=u.vertexBuffer[t].stride}return l};g.clone=function(){const l=new q;l.tileBufferData=this.tileBufferData.clone();l.tileDisplayData=this.tileDisplayData.clone();return l};g._guessSize=function(){const {displayObjects:l}=this.tileDisplayData,n=Math.min(l.length,4);let u=0;for(let t=0;t<n;t++)u=Math.max(u,
l[t].displayRecords.length);return 2*(12*l.length+l.length*u*40)};g.serialize=function(){const l=this.tileBufferData.serialize(),n=this.tileBufferData.getBuffers(),u=this.tileDisplayData.serialize(new e(Int32Array,this._guessSize())).buffer();n.push(u);return{result:{displayData:u,bufferData:l},transferList:n}};q.fromVertexData=function(l,n){const u={},t=new Map;for(const m of n)t.set(m.id,m);h.forEachGeometryType(m=>{const w=l.data[m];if(F.isSome(w)){const C=d.DisplayRecordReader.from(w.records).getCursor();
for(;C.next();){var v=C.id;const A=C.materialKey,y=C.indexFrom,p=C.indexCount,z=C.vertexFrom,D=C.vertexCount,G=t.get(v);v=new a(v,m,A);v.indexFrom=y;v.indexCount=p;v.vertexFrom=z;v.vertexCount=D;G.displayRecords.push(v)}u[m]=c.VertexBuffers.fromVertexData(w,m)}else u[m]=(new b.VertexVectors(m,0)).intoBuffers()});return q.fromMeshData({displayObjects:n,vertexBuffersMap:u})};q.fromMeshData=function(l){const n=new q,u=new k["default"],t=new B;u.displayObjects=l.displayObjects;for(const m in l.vertexBuffersMap){const w=
l.vertexBuffersMap[m];t.geometries[m].indexBuffer=w.indexBuffer;t.geometries[m].vertexBuffer=w.namedBuffers}n.tileDisplayData=u;n.tileBufferData=t;return n};q.bind=function(l,n){const u=new q;u.tileDisplayData=l;u.tileBufferData=n;return u};q.create=function(l,n){const u=new q;u.tileDisplayData=new k["default"];u.tileDisplayData.displayObjects=l;const t=[0,0,0,0,0],m=[0,0,0,0,0],w=[[],[],[],[],[]];for(var v of l)for(var C of v.displayRecords)w[C.geometryType].push(C),t[C.geometryType]+=C.meshData.vertexCount,
m[C.geometryType]+=C.meshData.indexData.length;l=new B;n=[n.fill||{},n.line||{},n.icon||{},n.text||{},n.label||{}];for(v=0;5>v;v++){C=new Uint32Array(m[v]);{var A=n[v];var y=t[v];const p={};for(const z in A){const D={data:h.allocateTypedArrayBuffer(y,A[z]),stride:A[z]};p[z]=D}A=p}a.writeAllMeshDataToBuffers(w[v],A,C);l.geometries[v]={indexBuffer:C,vertexBuffer:A}}u.tileBufferData=l;return u};q._align=function(l,n){const u=l%n;return 0===u?l:l+(n-u)};q._computeVertexAlignment=function(l){let n=!1,
u=!1;for(const t of l)2===t%4?n=!0:0!==t%4&&(u=!0);return u?4:n?2:1};return q}();x.TileData=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(x){return function(){function F(){this._byGeometryType=null}var E=F.prototype;E.reset=function(){this._byGeometryType=null};E.verticesFor=function(B){return this._byGeometryType?this._byGeometryType[B].vertices:0};E.indicesFor=function(B){return this._byGeometryType?
this._byGeometryType[B].indices:0};E.needMore=function(B,k,h){if(k||h)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),B=this._byGeometryType[B],B.vertices+=k,B.indices+=h};x._createClass(F,[{key:"satisfied",get:function(){return!this._byGeometryType}}]);return F}()})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["./Utils"],function(x){return function(){function F(){this.geometries=
[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}var E=F.prototype;E.clone=function(){const B=new F;for(let k=0;k<this.geometries.length;k++){const h=this.geometries[k],a=B.geometries[k];a.indexBuffer=h.indexBuffer.slice();a.vertexBuffer={};for(const d in h.vertexBuffer){const {data:c,stride:b}=h.vertexBuffer[d];a.vertexBuffer[d]={data:c.slice(),stride:b}}}return B};
F.deserialize=function(B){const k=new F;for(let h=0;5>h;++h){k.geometries[h].indexBuffer=new Uint32Array(B.geometries[h].indexBuffer);k.geometries[h].vertexBuffer={};for(const a in B.geometries[h].vertexBuffer)k.geometries[h].vertexBuffer[a]={data:x.allocateTypedArrayBufferwithData(B.geometries[h].vertexBuffer[a].data,B.geometries[h].vertexBuffer[a].stride),stride:B.geometries[h].vertexBuffer[a].stride}}return k};E.serialize=function(){const B={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,
vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]};for(let k=0;5>k;++k)for(const h in this.geometries[k].vertexBuffer)B.geometries[k].vertexBuffer[h]={data:this.geometries[k].vertexBuffer[h].data.buffer,stride:this.geometries[k].vertexBuffer[h].stride};return B};
E.getBuffers=function(){const B=[];for(let k=0;5>k;++k){B.push(this.geometries[k].indexBuffer.buffer);for(const h in this.geometries[k].vertexBuffer)B.push(this.geometries[k].vertexBuffer[h].data.buffer)}return B};return F}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./GraphicDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(x,F,E,B,k){let h=function(){function a(){}var d=a.prototype;d.computeDisplayList=
function(){this._displayList=new E;for(const c of this.displayObjects)for(const b of c.displayRecords)this._displayList.addToList(b)};d.clone=function(){const c=new a;this.displayObjects&&(c.displayObjects=this.displayObjects.map(b=>b.clone()));return c};d.serialize=function(c){k.serializeList(c,this.displayObjects);return c};d._deserializeObjects=function(c){var b=c.readInt32();b=Array(b);const e=new Map;for(let f=0;f<b.length;++f){const r=B.deserialize(c);b[f]=r;e.set(r.id,r)}this.displayObjects=
b;this._displayList=null;this._displayObjectRegistry=e};a.deserialize=function(c){const b=new a;b._deserializeObjects(c);return b};F._createClass(a,[{key:"displayObjectRegistry",get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(const c of this.displayObjects)this._displayObjectRegistry.set(c.id,c)}return this._displayObjectRegistry}},{key:"displayList",get:function(){return this._displayList}}]);return a}();x.default=h;x.groupRecordsByGeometryType=function(a){const d=
[[],[],[],[],[]];for(const c of a)for(const b of c.displayRecords)d[b.geometryType].push(b);return d};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GraphicDisplayList":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./enums"],function(x,F){function E(c,b,e,...f){b<c.length?c.splice(b,e,...f):c.push(...f)}const B=new Map;B.set(F.WGLDrawPhase.MAP,[F.WGLGeometryType.FILL,F.WGLGeometryType.LINE,F.WGLGeometryType.MARKER,F.WGLGeometryType.TEXT]);B.set(F.WGLDrawPhase.LABEL,
[F.WGLGeometryType.LABEL]);B.set(F.WGLDrawPhase.LABEL_ALPHA,[F.WGLGeometryType.LABEL]);F=function(){function c(){this.symbolLevels=[]}var b=c.prototype;b.replay=function(e,f,r){for(const g of this.symbolLevels)for(const l of g.zLevels){var q=l.geometryDPInfo.unified;if(q)for(const n of q){q=e.painter.getGeometryBrush(n.geometryType);const u=f.getGeometry(n.geometryType),t={geometryType:n.geometryType,materialKey:n.materialKey,indexFrom:n.indexFrom,indexCount:n.indexCount,draw:(m,w,v)=>{u.draw(m,w,
v,n.indexFrom,n.indexCount)}};q.prepareState(e,f);q.drawGeometry(e,f,t,r)}}};b.clear=function(){this.symbolLevels.length=0};b.addToList=function(e,f){if(Array.isArray(e))for(const r of e)this._addToList(r,f);else this._addToList(e,f)};b.removeFromList=function(e){Array.isArray(e)||(e=[e]);let f=null;for(const r of e)f=this._removeFromList(r);return f};b.clone=function(){const e=new c;for(const f of this.symbolLevels)e.symbolLevels.push(f.clone());return e};b.splitAfter=function(e){const f=this._getDisplayList(e.symbolLevel,
e.zOrder),r=f.length,q=e.indexFrom+e.indexCount;for(let g=0;g<r;++g){const l=f[g];if(l.geometryType===e.geometryType&&q>l.indexFrom&&q<=l.indexFrom+l.indexCount)return q<l.indexFrom+l.indexCount&&(e=new k,e.geometryType=l.geometryType,e.materialKey=l.materialKey,e.indexFrom=q,e.indexCount=l.indexFrom+l.indexCount-q,f.splice(g+1,0,e),l.indexCount=q-l.indexFrom),g}};b._addToList=function(e,f){const r=this._getDisplayList(e.symbolLevel,e.zOrder);f=null!=f?f:r.length-1;var q=0<=f&&f<r.length?r[f]:null;
null!==q&&q.materialKey===e.materialKey&&q.indexFrom+q.indexCount===e.indexFrom&&q.geometryType===e.geometryType?q.indexCount+=e.indexCount:(q=new k,q.indexFrom=e.indexFrom,q.indexCount=e.indexCount,q.materialKey=e.materialKey,q.geometryType=e.geometryType,E(r,f+1,0,q))};b._removeFromList=function(e){const f=this._getDisplayList(e.symbolLevel,e.zOrder);var r=f.length;let q=void 0;for(var g=0;g<r;++g){var l=f[g];if(e.indexFrom+e.indexCount>l.indexFrom&&e.indexFrom<l.indexFrom+l.indexCount&&l.geometryType===
e.geometryType){q=g;break}}if(void 0!==q){r=f[q];if(e.indexFrom===r.indexFrom)return r.indexCount-=e.indexCount,r.indexFrom+=e.indexCount,0===r.indexCount&&E(f,q,1),q-1;if(e.indexFrom+e.indexCount===r.indexFrom+r.indexCount)return r.indexCount-=e.indexCount,0===r.indexCount?(E(f,q,1),q-1):q;{g=r.indexFrom;l=e.indexFrom-r.indexFrom;const n=e.indexCount;e=r.indexFrom+r.indexCount-(e.indexFrom+e.indexCount);r.indexCount=l;const u=new k;u.geometryType=r.geometryType;u.materialKey=r.materialKey;u.indexFrom=
g+l+n;u.indexCount=e;E(f,q+1,0,u);return q}}return null};b._getDisplayList=function(e,f){let r;var q=this.symbolLevels.length;for(let l=0;l<q;l++)if(this.symbolLevels[l].symbolLevel===e){r=this.symbolLevels[l];break}r||(r=new d,r.symbolLevel=e,this.symbolLevels.push(r));let g;e=r.zLevels.length;for(q=0;q<e;q++)if(r.zLevels[q].zLevel===f){g=r.zLevels[q];break}g||(g=new a,g.geometryDPInfo=new h,g.zLevel=f,r.zLevels.push(g));g.geometryDPInfo.unified||(g.geometryDPInfo.unified=[]);return g.geometryDPInfo.unified};
b.getDPInfoType=function(){return"unified"};x._createClass(c,[{key:"empty",get:function(){return!this.symbolLevels||0===this.symbolLevels.length}}]);return c}();let k=function(){function c(){this.materialKey=null;this.indexCount=this.indexFrom=0}c.prototype.clone=function(){const b=new c;b.geometryType=this.geometryType;b.materialKey=this.materialKey;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;return b};return c}(),h=function(){function c(){this.unified=this.label=this.text=this.marker=
this.line=this.fill=null}c.prototype.clone=function(){const b=new c;b.fill=this.fill&&this.fill.map(e=>e.clone());b.line=this.line&&this.line.map(e=>e.clone());b.marker=this.marker&&this.marker.map(e=>e.clone());b.text=this.text&&this.text.map(e=>e.clone());b.label=this.label&&this.label.map(e=>e.clone());b.unified=this.unified&&this.unified.map(e=>e.clone());return b};return c}(),a=function(){function c(){this.geometryDPInfo=new h}c.prototype.clone=function(){const b=new c;b.zLevel=this.zLevel;b.geometryDPInfo=
this.geometryDPInfo.clone();return b};return c}(),d=function(){function c(){this.zLevels=[]}c.prototype.clone=function(){const b=new c;b.symbolLevel=this.symbolLevel;for(const e of this.zLevels)b.zLevels.push(e.clone());return b};return c}();return F})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["./WGLDisplayRecord","./util/serializationUtils"],function(x,F){return function(){function E(k){this.insertAfter=null;this.id=k;this.displayRecords=[]}var B=E.prototype;B.copy=function(){const k=
new E(this.id);k.set(this);return k};B.clone=function(){const k=new E(this.id);k.displayRecords=this.displayRecords.map(h=>h.clone());k.insertAfter=this.insertAfter;return k};B.set=function(k){this.id=k.id;this.displayRecords=k.displayRecords;this.insertAfter=k.insertAfter};B.serialize=function(k){k.push(this.id);F.serializeList(k,this.displayRecords);return k};E.deserialize=function(k){const h=k.readInt32(),a=new E(h);a.displayRecords=F.deserializeList(k,x,{id:h});return a};return E}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./MeshData","./Utils"],function(x,F,E){return function(){function B(h,a,d,c=0,b=0){this.id=h;this.geometryType=a;this.materialKey=d;this.minZoom=c;this.maxZoom=b;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}var k=B.prototype;k.clone=function(){return this.copy()};k.copy=function(){const h=new B(this.id,this.geometryType,this.materialKey);h.vertexFrom=this.vertexFrom;h.vertexCount=this.vertexCount;h.indexFrom=this.indexFrom;h.indexCount=
this.indexCount;h.zOrder=this.zOrder;h.symbolLevel=this.symbolLevel;h.meshData=this.meshData;h.minZoom=this.minZoom;h.maxZoom=this.maxZoom;return h};k.setMeshDataFromBuffers=function(h,a,d){const c=new F;for(const b in a){const e=a[b].stride,f=a[b].data,r=[],q=E.strideToPackingFactor(e);for(let g=0;g<e*h.vertexCount/q;++g)r[g]=f[g+e*h.vertexFrom/q];c.vertexData.set(b,r)}c.indexData.length=0;for(a=0;a<h.indexCount;++a)c.indexData[a]=d[a+h.indexFrom]-h.vertexFrom;c.vertexCount=h.vertexCount;this.meshData=
c};k.readMeshDataFromBuffers=function(h,a){this.meshData?this.meshData.clear():this.meshData=new F;for(const d in h){const c=h[d].stride,b=h[d].data,e=[],f=E.strideToPackingFactor(c);for(let r=0;r<c*this.vertexCount/f;++r)e[r]=b[r+c*this.vertexFrom/f];this.meshData.vertexData.set(d,e)}this.meshData.indexData.length=0;for(h=0;h<this.indexCount;++h)this.meshData.indexData[h]=a[h+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};k.writeMeshDataToBuffers=function(h,a,d,c){for(const b in a){const e=
a[b].stride,f=this.meshData.vertexData.get(b),r=a[b].data,q=E.strideToPackingFactor(e);for(let g=0;g<e*this.meshData.vertexCount/q;++g)r[g+e*h/q]=f[g]}for(a=0;a<this.meshData.indexData.length;++a)c[a+d]=this.meshData.indexData[a]+h;this.vertexFrom=h;this.vertexCount=this.meshData.vertexCount;this.indexFrom=d;this.indexCount=this.meshData.indexData.length};B.writeAllMeshDataToBuffers=function(h,a,d){let c=0,b=0;for(const e of h)e.writeMeshDataToBuffers(c,a,b,d),c+=e.vertexCount,b+=e.indexCount};k._computeSortKey=
function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};k.serialize=function(h){h.push(this.geometryType);h.push(this.materialKey);h.push(this.vertexFrom);h.push(this.vertexCount);h.push(this.indexFrom);h.push(this.indexCount);h.push(this.minZoom);h.push(this.maxZoom);return h};B.deserialize=function(h,a){const d=h.readInt32(),c=h.readInt32();a=new B(a.id,d,c);a.vertexFrom=h.readInt32();a.vertexCount=h.readInt32();a.indexFrom=h.readInt32();a.indexCount=h.readInt32();
a.minZoom=h.readInt32();a.maxZoom=h.readInt32();return a};x._createClass(B,[{key:"sortKey",get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey}}]);return B}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(function(){return function(){function x(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}var F=x.prototype;F.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};F.update=function(E,B,k){for(const h in E)this.vertexData.set(h,
E[h]);for(const h in this.vertexData)null===E[h]&&this.vertexData.delete(h);this.vertexCount=B;this.indexData=k};return x}()})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["exports"],function(x){x.deserializeList=function(F,E,B){var k=F.readInt32();k=Array(k);for(let h=0;h<k.length;h++)k[h]=E.deserialize(F,B);return k};x.serializeList=function(F,E){if(null===E)F.push(0);else{F.push(E.length);for(const B of E)B.serialize(F);return F}};Object.defineProperty(x,"__esModule",
{value:!0})})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["exports","../Utils"],function(x,F){let E=function(){function k(h,a){this.data=h;this.stride=a}k.decode=function(h){const a=F.allocateTypedArrayBufferwithData(h.data,h.stride);return new k(a,h.stride)};k.fromVertexVector=function(h){const a=F.allocateTypedArrayBufferwithData(h.data.buffer(),h.stride);return new k(a,h.stride)};return k}(),B=function(){function k(h,a,d){this.geometryType=h;this.indexBuffer=new Uint32Array(a);
this.namedBuffers=d}k.decode=function(h){const a=h.geometryType,d=h.indexBuffer,c={};for(const b in h.namedBuffers)c[b]=E.decode(h.namedBuffers[b]);return new k(a,d,c)};k.fromVertexData=function(h,a){const d=h.indices,c=F.allocateTypedArrayBufferwithData(h.vertices,h.stride);h={geometry:new E(c,h.stride)};return new k(a,d,h)};k.fromVertexVectors=function(h){const a=h.geometryType,d=h.indexVector.buffer(),c={};for(const b in h.namedVectors)c[b]=E.fromVertexVector(h.namedVectors[b]);return new k(a,
d,c)};return k}();x.VertexBuffers=B;x.default=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../Utils","./VertexBuffer","../util/Writer"],function(x,F,E,B,k){let h=function(){function d(c,b){this.data=c;this.stride=b}d.prototype.transfer=function(c,b){const e=this.data.buffer();c.vertexCount=this.vertexCount;c.data=e;c.stride=this.stride;b.push(e)};F._createClass(d,
[{key:"vertexCount",get:function(){const c=this.data.length/(this.stride/4);c!==(c|0)&&console.debug("Corrupted stride");return c}}]);return d}(),a=function(){function d(b,e,f=!1){this.geometryType=b;this.indexVector=new k(Uint32Array,6*e);this.namedVectors={};b=E.getStrides(b,f);for(const r in b){f=b[r];let q;switch(f%4){case 0:case 2:q=new k(Uint32Array,f*e);break;case 1:case 3:q=new k(Uint8Array,f*e)}this.namedVectors[r]=new h(q,f)}}var c=d.prototype;c.get=function(b){return this.namedVectors[b].data};
c.getVector=function(b){return this.namedVectors[b]};c.transfer=function(b,e){const f=this.indexVector.buffer(),r={};e.push(f);for(const q in this.namedVectors){const g=this.namedVectors[q];r[q]={};g.transfer(r[q],e)}b.geometryType=this.geometryType;b.indexBuffer=f;b.namedBuffers=r;this.destroy()};c.intoBuffers=function(){const b=B.VertexBuffers.fromVertexVectors(this);this.destroy();return b};c.destroy=function(){this.namedVectors=this.indexVector=null};return d}();x.VertexVectors=a;x.default=h;
Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(x){return function(){function F(B,k){this._pos=0;k=k?this._roundToNearest(k,B.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(k);this._buffer=new B(this._array);this._ctor=B;this._i16View=new Int16Array(this._array)}var E=F.prototype;E._roundToNearest=function(B,k){B=Math.round(B);return B+(k-B%k)};E._ensureSize=function(B){if(this._pos+
B>=this._buffer.length){B=this._roundToNearest(1.5*(this._array.byteLength+B*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);B=new ArrayBuffer(B);const k=new this._ctor(B);k.set(this._buffer,0);this._array=B;this._buffer=k;this._i16View=new Int16Array(this._array)}};E.writeF32=function(B){this._ensureSize(1);const k=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=B;this._pos++;return k};E.push=function(B){this._ensureSize(1);const k=this._pos;this._buffer[this._pos++]=B;
return k};E.writeFixed=function(B){this._buffer[this._pos++]=B};E.setValue=function(B,k){this._buffer[B]=k};E.i1616Add=function(B,k,h){this._i16View[2*B]+=k;this._i16View[2*B+1]+=h};E.getValue=function(B){return this._buffer[B]};E.incr=function(B){if(this._buffer.length<B)throw Error("Increment index overflows the target buffer");this._buffer[B]++};E.decr=function(B){this._buffer[B]--};E.writeRegion=function(B){this._ensureSize(B.length);const k=this._pos;this._buffer.set(B,this._pos);this._pos+=
B.length;return k};E.writeManyFrom=function(B,k,h){for(this._ensureSize(h-k);k!==h;k++)this.writeFixed(B._buffer[k])};E.buffer=function(){const B=this._array.slice(0,4*this._pos);this.destroy();return B};E.toArray=function(){const B=this._array,k=[];for(let h=0;h<B.byteLength/4;h++)k.push(B[h]);return k};E.seek=function(B){this._pos=B};E.destroy=function(){this._buffer=this._array=null};x._createClass(F,[{key:"length",get:function(){return this._pos}}]);return F}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/AttributeStore ../../../layers/features/support/tileUtils".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r){function q(l){switch(l){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function g(l){switch(l){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}E=function(){function l(u,t,m,w,v){this.hasRecords=this._hasAggregate=this._hasDotDensity=!1;this._data={self:new Map,neighbors:[]};this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,id:0,materialKey:0,indexStart:0,
vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=t;this.tileKey=u;this._hasDotDensity=m;this._hasAggregate=w;this._pixelBufferEnabled=v}var n=l.prototype;n.serialize=function(u){const t=[];t.push(this._serializeTileVertexData(this.tileKey,this._data.self));this._data.neighbors.forEach((m,w)=>{var v=1<<w;w=q(v);v=g(v);w=r.getPow2NeighborKey(new k(this.tileKey),w,v,u);t.push(this._serializeTileVertexData(w.id,m))});return t};n._serializeTileVertexData=function(u,t){var m,
w,v,C,A;const y=[];t={[c.WGLGeometryType.MARKER]:null==(m=t.get(c.WGLGeometryType.MARKER))?void 0:m.serialize(y),[c.WGLGeometryType.FILL]:null==(w=t.get(c.WGLGeometryType.FILL))?void 0:w.serialize(y),[c.WGLGeometryType.LINE]:null==(v=t.get(c.WGLGeometryType.LINE))?void 0:v.serialize(y),[c.WGLGeometryType.TEXT]:null==(C=t.get(c.WGLGeometryType.TEXT))?void 0:C.serialize(y),[c.WGLGeometryType.LABEL]:null==(A=t.get(c.WGLGeometryType.LABEL))?void 0:A.serialize(y)};return{message:{tileKey:u,data:t},transferList:y}};
n.featureStart=function(u=0){this._current.insertAfter=u};n.featureEnd=function(){};n.recordStart=function(u,t,m,w,v){this._current.writer=this._getVertexWriter(m,w);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=v;this._current.id=u;this._current.materialKey=t;this._current.geometryType=m;this._current.isDotDensity=!1;this._current.writer.recordStart()};n.recordCount=function(){return this._current.writer.recordCount};
n.vertexCount=function(){return this._current.writer.vertexCount};n.indexCount=function(){return this._current.writer.indexCount};n.vertexBounds=function(u,t,m,w){this._current.bufferingEnabled&&this._addOverlap(u,t,m,w)};n.vertexWrite=function(u){this._current.writer.writeVertex(u)};n.vertexWriteF32=function(u){this._current.writer.writeVertexF32(u)};n.vertexEnd=function(){};n.vertexWriter=function(){return this._current.writer.vertexWriter};n.indexWrite=function(u){this._current.writer.writeIndex(u)};
n.indexWriter=function(){return this._current.writer.indexWriter};n.metricWriter=function(){return this._current.writer.metricWriter};n.metricStart=function(u,t,m,w,v,C,A,y){this._current.writer=this._getVertexWriter(c.WGLGeometryType.LABEL,!1);const p=this._current.writer.metricWriter;p.push(f.getDisplayIdTexel(u));p.push(t);p.push(m);p.push(w);p.push(v);p.push(C);p.push(A);p.push(y);p.push(255);this._current.metricBoxLenPointer=p.push(0)};n.metricEnd=function(){const u=this._current.writer.metricWriter;
0===u.getValue(this._current.metricBoxLenPointer)&&u.seek(u.length-10)};n.metricBoxWrite=function(u,t,m,w){const v=this._current.writer.metricWriter;v.incr(this._current.metricBoxLenPointer);v.push(0);v.push(0);v.push(u);v.push(t);v.push(m);v.push(w)};n.recordEnd=function(){var u=this._current.indexStart,t=this._current.writer.indexCount;if(u===t)return!1;this.hasRecords=!0;var m=this._current.vertStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,
u,t-u,m,this._current.writer.vertexCount-m);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===c.WGLGeometryType.LABEL)return!0;u=this._current.writer;for(t=0;8>t;t++)if(m=1<<t,this._current.overlaps&m){if(!this._data.neighbors[t]){var w=new Map;this._data.neighbors[t]=w}w=this._data.neighbors[t];var v=this._current.geometryType;if(!w.has(v)){const C=b.getStrides(v,this._current.isDotDensity).geometry;w.set(v,new e.VertexDataWriter(v,C,d.PATCH_PIXEL_BUFFER_ALLOC_SIZE))}w=
w.get(this._current.geometryType);v=4096*-q(m);m=4096*-g(m);w.copyLastFrom(u,v,m)}return!0};n._addOverlap=function(u,t,m,w){this._current.overlaps|=255^((u<0+m?148:u>=d.TILE_SIZE-m?41:189)|(t<0+w?224:t>=d.TILE_SIZE-w?7:231))};n._getVertexWriter=function(u,t){if(!this._data.self.has(u)){t=this._data.self;const m=b.getStrides(u,this._hasDotDensity).geometry;t.set(u,new e.VertexDataWriter(u,m,8E3))}return this._data.self.get(u)};F._createClass(l,[{key:"hasAggregates",get:function(){return this._hasAggregate}},
{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);return l}();x.MeshData=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(x,F,E,B,k){let h=function(){function a(c,b,e){this._start={index:0,vertex:0};e=B.getMeshSizeHint(c,b,e);b/=4;this.geometryType=c;this._records=new k(Int32Array,
e.recordBytes);this._indices=new k(Uint32Array,e.indexBytes);this._vertices=new k(Uint32Array,e.vertexBytes);this._metrics=new k(Float32Array,0);this._strideInt=b}var d=a.prototype;d.serialize=function(c){const b=this._records.buffer(),e=this._indices.buffer(),f=this._vertices.buffer(),r=this._metrics.length?this._metrics.buffer():null,q=4*this._strideInt;c.push(b,e,f);return{stride:q,records:b,indices:e,vertices:f,metrics:r}};d.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=
this._vertices.length};d.recordEnd=function(c,b,e,f,r,q,g){this._records.push(c);this._records.push(b);this._records.push(e);this._records.push(f);this._records.push(r);this._records.push(q);this._records.push(g)};d.writeIndex=function(c){this._indices.push(c)};d.writeVertex=function(c){this._vertices.push(c)};d.writeVertexF32=function(c){this._vertices.writeF32(c)};d.copyLastFrom=function(c,b,e){var f=c._records.length-7;const r=c._records.getValue(f),q=c._records.getValue(f+1),g=c._records.getValue(f+
2),l=c._records.getValue(f+4);f=c._records.getValue(f+6);const n=this._vertices.length;var u=(c._start.vertex-this._vertices.length)/this._strideInt;const t=this._indices.length,m=this.vertexCount;for(var w=c._start.index;w!==c._indices.length;w++){const v=c._indices.getValue(w);this._indices.push(v-u)}for(u=c._start.vertex;u!==c._vertices.length;u++)w=c._vertices.getValue(u),this._vertices.push(w);for(c=n;c<=this._vertices.length;c+=this._strideInt)this._vertices.i1616Add(c,b,e);this._records.push(r);
this._records.push(q);this._records.push(g);this._records.push(t);this._records.push(l);this._records.push(m);this._records.push(f)};F._createClass(a,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/E.DISPLAY_RECORD_INT_PER_ELEMENT}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},
{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return a}();x.VertexDataWriter=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g){function l(C,A){return y=>A(C(y))}const n=h.getLogger("esri.views.layers.2d.features.support.AttributeStore"),u=q.createDebugLogger(q.DEBUG_ATTR_UPDATES,n),t=C=>1===(C&2147483648)>>>31?254:255;var m=k("esri-shared-array-buffer"),w=k("esri-atomics");let v=function(){function C(y,p,z,D){this.size=0;this.texelSize=4;const {pixelType:G,layout:I,textureOnly:K}=D;this.textureOnly=K||!1;this.pixelType=G;this._ctype=p;this.layout=I;this._resetRange();this._shared=y;
this.size=z;K||(this.data=this._initData(G,z,y,p))}var A=C.prototype;A.unsetComponentAllTexels=function(y,p){const z=d.unwrap(this.data);for(let D=0;D<this.size*this.size;D++)z[D*this.texelSize+y]&=~p;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};A.setComponentAllTexels=function(y,p){const z=d.unwrap(this.data);for(let D=0;D<this.size*this.size;D++)z[D*this.texelSize+y]|=255&p;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};A.setComponent=function(y,p,z){const D=d.unwrap(this.data);
for(const G of z)D[G*this.texelSize+y]|=p,this.dirtyStart=Math.min(this.dirtyStart,G),this.dirtyEnd=Math.max(this.dirtyEnd,G)};A.setComponentTexel=function(y,p,z){d.unwrap(this.data)[z*this.texelSize+y]|=p;this.dirtyStart=Math.min(this.dirtyStart,z);this.dirtyEnd=Math.max(this.dirtyEnd,z)};A.unsetComponentTexel=function(y,p,z){d.unwrap(this.data)[z*this.texelSize+y]&=~p;this.dirtyStart=Math.min(this.dirtyStart,z);this.dirtyEnd=Math.max(this.dirtyEnd,z)};A.getData=function(y,p){y&=2147483647;return d.unwrap(this.data)[y*
this.texelSize+p]};A.setData=function(y,p,z){y&=2147483647;0===(this.layout&1<<p)?n.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[y*this.texelSize+p]=z,this.dirtyStart=Math.min(this.dirtyStart,y),this.dirtyEnd=Math.max(this.dirtyEnd,y))};A.lock=function(){5121===this.pixelType&&this._shared&&w&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};A.unlock=function(){5121===this.pixelType&&this._shared&&w&&"local"!==this._ctype&&Atomics.store(this.data,
0,0)};A.expand=function(y){this.size=y;if(!this.textureOnly){y=this._initData(this.pixelType,y,this._shared,this._ctype);const p=d.unwrap(this.data);y.set(p);this.data=y}};A.toMessage=function(){const y=this.dirtyStart,p=this.dirtyEnd;var z=this.texelSize;if(y>p)return null;this._resetRange();const D=!this._shared&&"local"!==this._ctype,G=this.pixelType,I=this.layout,K=d.unwrap(this.data);z=D&&K.slice(y*z,(p+1)*z)||null;return{start:y,end:p,data:z,pixelType:G,layout:I}};A._initData=function(y,p,z,
D){z=z&&"local"!==D?SharedArrayBuffer:ArrayBuffer;y=r.getPixelArrayCtor(y);p=new y(new z(p*p*4*y.BYTES_PER_ELEMENT));for(y=0;y<p.length;y+=4)p[y+1]=255;return p};A._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};E._createClass(C,[{key:"buffer",get:function(){return d.andThen(this.data,y=>y.buffer)}}]);return C}();h=function(){function C(y,p){this._client=y;this.config=p;this._attributeComputeMap=new Map;this._blocks=[];this._filters=Array(f.MAX_FILTERS);this._targetType=0;this._abortController=
c.createAbortController();this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;y=p.supportsTextureFloat?5126:5121;u(`Creating AttributeStore ${m?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:y,layout:15},{pixelType:y,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var A=C.prototype;A.destroy=function(){this._abortController.abort()};A.update=function(y,p){this.config=p;p=p.schema.processors[0].storage;
const z=b.diff(this._schema,p);if(y.targets.feature||y.targets.aggregate)y.storage.data=!0;if(z&&(k("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",z),y.storage.data=!0,this._schema=p,this._attributeComputeMap.clear(),!d.isNone(p))){switch(p.target){case "feature":this._targetType=0;break;case "aggregate":this._targetType=1}if("subtype"===p.type)for(const D in p.mapping){if(y=p.mapping[D],d.isSome(y))for(const G of y.mapping)this._bindAttribute(G)}else for(const D of p.mapping)this._bindAttribute(D)}};
A.onTileData=function(y,p){if(!d.isNone(p.addOrUpdate))for(y=p.addOrUpdate.getCursor();y.next();)p=y.getDisplayId(),this.setAttributeData(p,y)};A.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();this._abortController=c.createAbortController()};A.setHighlight=function(){var y=E._asyncToGenerator(function*(p,z){const D=this._getBlock(0);z=z.map(G=>G&2147483647);D.lock();D.unsetComponentAllTexels(0,1);D.setComponent(0,1,z);D.unlock();this._idsToHighlight.clear();
for(const G of p)this._idsToHighlight.add(G);yield this.sendUpdates()});return function(p,z){return y.apply(this,arguments)}}();A.updateFilters=function(){var y=E._asyncToGenerator(function*(p,z){const {config:D,service:G,spatialReference:I}=z;({filters:z}=D);z=z.map((K,N)=>this._updateFilter(K,N,G,I));(yield Promise.all(z)).some(K=>K)&&(p.storage.filters=!0,k("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))});return function(p,z){return y.apply(this,
arguments)}}();A.setData=function(y,p,z,D){this._ensureSizeForTexel(y&2147483647);this._getBlock(p).setData(y,z,D)};A.getData=function(y,p,z){return this._getBlock(p).getData(y,z)};A.getHighlightFlag=function(y){return this._idsToHighlight.has(y)?f.HIGHLIGHT_FLAG:0};A.unsetAttributeData=function(y){y&=2147483647;this._getBlock(0).setData(y,0,0)};A.setAttributeData=function(y,p){const z=y&2147483647;this._ensureSizeForTexel(z);this._getBlock(0).setData(z,0,this.getFilterFlags(p));if(this._targetType===
(y&2147483648)>>>31){y=this._attributeComputeMap;var D=this.config.supportsTextureFloat?1:2;y.size&&y.forEach((G,I)=>{const K=I*D%4;I=this._getBlock(Math.floor(I*D/4)+f.ATTRIBUTE_DATA_VV);G=G(p);if(this.config.supportsTextureFloat)I.setData(z,K,G);else if(G===f.NAN_MAGIC_NUMBER)I.setData(z,K,255),I.setData(z,K+1,255);else{G=a.clamp(Math.round(G),-32767,32766)+32768;const N=(G&65280)>>8;I.setData(z,K,G&255);I.setData(z,K+1,N)}})}};A.sendUpdates=function(){if(this._nextUpdate)return this._nextUpdate.promise;
if(this._currUpdate)return this._nextUpdate=c.createResolver(),this._nextUpdate.promise;const y={blocks:this._blocks.map(p=>d.isSome(p)?p.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var p=()=>{this._currUpdate=null;if(this._nextUpdate){const z=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>z.resolve())}};p=this._client.update(y,this._signal).then(p).catch(p);this._client.render(this._signal);return p}).catch(p=>{if(c.isAbortError(p))return this._createResourcesPromise=
null,this._createResources();n.error(new B("mapview-attribute-store","Encountered an error during client update",p));return Promise.resolve()})};A._ensureSizeForTexel=function(y){for(;y>=this._size*this._size&&!this._expand(););};A._bindAttribute=function(y){function p(){return y.normalizationField?G=>{const I=G.readAttribute(y.normalizationField);return I?G.readAttribute(y.field)/I:null}:G=>G.readAttribute(y.field)}function z(){y.normalizationField&&n.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");
return G=>G.getComputedNumericAtIndex(y.fieldIndex)}let D;if(null!=y.fieldIndex)D=z();else if(y.field)D=p();else return;y.valueRepresentation&&(D=l(D,G=>g.getVisualVariableSizeValueRepresentationRatio(G,y.valueRepresentation)));this._attributeComputeMap.set(y.binding,l(D,G=>null===G||isNaN(G)||Infinity===G?f.NAN_MAGIC_NUMBER:G))};A._createResources=function(){if(d.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(f.ATTRIBUTE_DATA_ANIMATION);u("Initializing AttributeStore");
var y={shared:m&&"local"!==this._client.type,size:this._size,blocks:d.mapMany(this._blocks,p=>({textureOnly:p.textureOnly,buffer:p.buffer,pixelType:p.pixelType}))};this._createResourcesPromise=y=this._client.initialize(y,this._signal).catch(p=>{c.isAbortError(p)?this._createResourcesPromise=null:n.error(new B("mapview-attribute-store","Encountered an error during client initialization",p))});y.then(()=>d.isNone(this._createResourcesPromise)?this._createResources():void 0);return y};A._getBlock=function(y){var p=
this._blocks[y];if(d.isSome(p))return p;u(`Initializing AttributeBlock at index ${y}`);p=new v(m,this._client.type,this._size,this._blockDescriptors[y]);this._blocks[y]=p;this._createResourcesPromise=null;return p};A._expand=function(){if(this._size<this.config.maxTextureSize){const y=this._size<<=1;u("Expanding block size to",y,this._blocks);d.forEachSome(this._blocks,p=>p.expand(y));this._createResourcesPromise=null;this._size=y;return 0}n.error(new B("mapview-limitations","Maximum number of onscreen features exceeded."));
return-1};A._updateFilter=function(){var y=E._asyncToGenerator(function*(p,z,D,G){const I=this._filters[z],K=d.isSome(I)&&I.hash;if(!I&&!p||K===JSON.stringify(p))return!1;if(d.isNone(p)){if(!I)return!1;p=1<<z+1;D=this._getBlock(0);this._filters[z]=null;D.setComponentAllTexels(0,p);this.sendUpdates();return!0}yield(yield this._getFilter(z,D)).update(p,G);return!0});return function(p,z,D,G){return y.apply(this,arguments)}}();A._getFilter=function(){var y=E._asyncToGenerator(function*(p,z){var D=this._filters[p];
if(d.isSome(D))return D;({default:D}=yield new Promise(function(G,I){x(["../../../../../layers/graphics/data/FeatureFilter"],function(K){G(Object.freeze({__proto__:null,"default":K}))},I)}));z=new D({geometryType:z.geometryType,hasM:!1,hasZ:!1,timeInfo:z.timeInfo,fieldsIndex:new e(z.fields)});return this._filters[p]=z});return function(p,z){return y.apply(this,arguments)}}();A.isVisible=function(y){return!!(this._getBlock(0).getData(y,0)&2)};A.getFilterFlags=function(y){let p=0;var z=t(y.getDisplayId());
for(let G=0;G<this._filters.length;G++){var D=this._filters[G];D=!(z&1<<G)||d.isNone(D)||D.check(y);p|=(D?1:0)<<G}z=0;this._idsToHighlight.size&&(y=y.getObjectId(),z=this.getHighlightFlag(y));return p<<1|z};E._createClass(C,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}}]);return C}();F.DISPLAY_ID_TYPE_AGGREGATE=1;F.DISPLAY_ID_TYPE_FEATURE=0;F.default=h;F.getDisplayIdFilterMask=t;F.getDisplayIdTexel=C=>C&2147483647;
F.getDisplayIdType=C=>(C&2147483648)>>>31;F.isAggregateId=function(C){return 1===(C&2147483648)>>>31};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(x){x.DEBUG_ATTR_UPDATES=!1;x.createDebugLogger=(F,E)=>F&&((...B)=>E.warn("DEBUG:",...B))||(()=>null);Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),
function(x,F,E,B,k,h,a){function d(g){return{value:g.value,size:E.toPt(g.size)}}function c(g){return g.map(l=>d(l))}function b(g){return"string"===typeof g||"number"===typeof g?E.toPt(g):{type:"size",expression:g.expression,stops:c(g.stops)}}function e(g){const l={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof g.field)if(g.stops){if(8<g.stops.length)return null;g=g.stops;for(var n=0;8>n;++n){const u=g[Math.min(n,g.length-1)];l.values[n]=u.value;l.opacities[n]=u.opacity}}else return null;
else if(g.stops&&0<=g.stops.length)for(g=g.stops&&0<=g.stops.length&&g.stops[0].opacity,n=0;8>n;n++)l.values[n]=Infinity,l.opacities[n]=g;else return null;return l}function f(g,l,n){g[4*l]=n.r/255;g[4*l+1]=n.g/255;g[4*l+2]=n.b/255;g[4*l+3]=n.a}function r(g){if(F.isNone(g)||g.normalizationField)return null;const l={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof g.field)if(g.stops){if(8<g.stops.length)return null;l.field=
g.field;g=g.stops;for(var n=0;8>n;++n){const u=g[Math.min(n,g.length-1)];l.values[n]=u.value;f(l.colors,n,u.color)}}else return null;else if(g.stops&&0<=g.stops.length)for(g=g.stops&&0<=g.stops.length&&g.stops[0].color,n=0;8>n;n++)l.values[n]=Infinity,f(l.colors,n,g);else return null;for(g=0;32>g;g+=4)B.premultiplyAlpha(l.colors,g,!0);return l}const q=g=>{const l=[],n=[];g=c(g);const u=g.length;for(let t=0;6>t;t++){const m=g[Math.min(t,u-1)];l.push(m.value);n.push(null==m.size?k.NAN_MAGIC_NUMBER:
E.pt2px(m.size))}return{values:new Float32Array(l),sizes:new Float32Array(n)}};x.convertColorVariable=r;x.convertVisualVariables=function(g){const l=g&&0<g.length?{}:null,n=l?{}:null;if(!l)return{vvFields:l,vvRanges:n};for(const u of g)if(u.field&&(l[u.type]=u.field),"size"===u.type)switch(n.size||(n.size={}),g=u,a.getTypeOfSizeVisualVariable(g)){case h.WGLVVFlag.SIZE_MINMAX_VALUE:n.size.minMaxValue={minDataValue:g.minDataValue,maxDataValue:g.maxDataValue,minSize:b(g.minSize),maxSize:b(g.maxSize)};
break;case h.WGLVVFlag.SIZE_SCALE_STOPS:n.size.scaleStops={stops:c(g.stops)};break;case h.WGLVVFlag.SIZE_FIELD_STOPS:if(g.levels){const t={};for(const m in g.levels)t[m]=q(g.levels[m]);n.size.fieldStops={type:"level-dependent",levels:t}}else n.size.fieldStops={type:"static",...q(g.stops)};break;case h.WGLVVFlag.SIZE_UNIT_VALUE:n.size.unitValue={unit:g.valueUnit,valueRepresentation:g.valueRepresentation}}else"color"===u.type?n.color=r(u):"opacity"===u.type?n.opacity=e(u):"rotation"===u.type&&(n.rotation=
{type:u.rotationType});return{vvFields:l,vvRanges:n}};x.getVisualVariableSizeValueRepresentationRatio=function(g,l){if(!g||!l)return g;switch(l){case "radius":case "distance":return 2*g;case "area":return Math.sqrt(g)}return g};x.getVisualVariablesFields=function(g){const l=g&&0<g.length?{}:null;l&&g.forEach(n=>{const u=n.type;n.field&&(l[u]=n.field)});return l};x.normalizeSizeElement=b;x.normalizeSizeStops=c;x.stopToSizeStop=d;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports",
"../../../../core/Error","../../../../core/Logger","./enums","./Utils"],function(x,F,E,B,k){const h=E.getLogger("esri.views.2d.engine.webgl");x.getTypeOfSizeVisualVariable=function(a){if(k.isNumber(a.minDataValue)&&k.isNumber(a.maxDataValue)&&null!=a.minSize&&null!=a.maxSize)return B.WGLVVFlag.SIZE_MINMAX_VALUE;if((a.expression&&"view.scale"===a.expression||a.valueExpression&&"$view.scale"===a.valueExpression)&&Array.isArray(a.stops))return B.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=a.field||a.expression&&
"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&(Array.isArray(a.stops)||"levels"in a&&a.levels))return B.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&null!=a.valueUnit)return B.WGLVVFlag.SIZE_UNIT_VALUE;h.error(new F("mapview-bad-type","Found invalid size VisualVariable",a));return B.WGLVVFlag.NONE};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports",
"./Tile"],function(x,F){function E(B,k,h,a){B=B.clone();const d=1<<B.level;k=B.col+k;h=B.row+h;a&&0>k?(B.col=k+d,--B.world):k>=d?(B.col=k-d,B.world+=1):B.col=k;B.row=h;return B}x.getPow2NeighborKey=E;x.getPow2NeighborTile=function(B,k,h){k=E(B.key,k,h,B.tileInfoView.tileInfo.isWrappable);return new F.Tile(B.tileInfoView,k)};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/Tile":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../rest/support/QuantizationParameters ../../../tiling/TileKey".split(" "),
function(x,F,E,B,k,h,a){function d(b,e){const f=b.bounds,r=e.bounds;return b.key.id!==e.key.id&&b.key.world===e.key.world&&f[0]<=r[0]&&f[1]<=r[1]&&f[2]>=r[2]&&f[3]>=r[3]}let c=function(){function b(f,r){this.key=new a(0,0,0,0);this.bounds=k.create();this.objectIds=new Set;this.key.set(r);r=f.getLODInfoAt(this.key);this.tileInfoView=f;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=r.resolution;this.scale=r.scale;this.level=r.level;this.needsClear=!0}var e=b.prototype;e.clone=
function(){return new b(this.tileInfoView,this.key)};e.createChildTiles=function(){const f=this.key.getChildKeys(),r=E.acquire();for(let q=0;q<f.length;q++)r[q]=new b(this.tileInfoView,f[q]);return r};e.getQuantizationParameters=function(){return h.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};F._createClass(b,[{key:"id",
get:function(){return this.key.id}},{key:"extent",get:function(){return B.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}},{key:"transform",get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}},{key:"bbox",get:function(){const f=this.bounds;return{minX:f[0],minY:f[1],maxX:f[2],maxY:f[3]}}}]);return b}();x.Tile=c;x.default=c;x.isChildOf=function(b,e){return d(e,b)};x.isParentOf=d;Object.defineProperty(x,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore ../../../../layers/features/support/AttributeStore".split(" "),function(x,F,E,B,k,h,a,d,c){E=function(){function b(f,r,q){this._geometryType=f;this._idField=
r;this._templateStore=q}var e=b.prototype;e.update=function(f,r){B.isSome(f.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(f.mesh.labels,r))};e._createLabelTemplates=function(f,r){const q=new Map;if("simple"===f.type){for(var g of f.classes)f=h.fromLabelClass(g,r),q.set(g.index,f);return q}for(const l in f.classes){g=f.classes[l];for(const n of g)g=h.fromLabelClass(n,r),q.set(n.index,g)}return q};e.analyze=function(){var f=F._asyncToGenerator(function*(r,q,g,l,n,u){if(!k.isAborted(u)){var t;
"dictionary"===q.type&&(t=yield q.analyze(this._idField,r.copy(),l,n,u));for(var m=0;r.next();){var w=void 0;w=t?t[m++]:B.isSome(g)&&c.isAggregateId(r.getDisplayId())&&1!==r.readAttribute("cluster_count")?g.match(this._idField,r,this._geometryType,l,n):q.match(this._idField,r,this._geometryType,l,n);r.setGroupId(w);if(d.isDynamicId(w)){w=this._templateStore.getDynamicTemplateGroup(w);for(const v of w)v&&v.analyze&&v.analyze(this._templateStore,r,l,n)}}return this._templateStore.finalize(u)}});return function(r,
q,g,l,n,u){return f.apply(this,arguments)}}();e.analyzeGraphics=function(){var f=F._asyncToGenerator(function*(r,q,g,l,n){if(!k.isAborted(n)){r=r.getCursor();for(q&&(yield q.analyze(this._idField,r.copy(),g,l,n));r.next();){let u=r.getGroupId();if(null==u||-1===u)u=q.match(this._idField,r,r.geometryType,g,l),r.setGroupId(u);if(d.isDynamicId(u)){const t=this._templateStore.getDynamicTemplateGroup(u);for(const m of t)m&&m.analyze&&m.analyze(this._templateStore,r,g,l)}r.setGroupId(u)}return this._templateStore.finalize(n)}});
return function(r,q,g,l,n){return f.apply(this,arguments)}}();e.writeGraphic=function(f,r,q){const g=r.getGroupId(),l=r.getDisplayId(),n=this._templateStore.getTemplateGroup(g);f.featureStart(r.insertAfter);if(null!=l){if(d.isDynamicId(g))for(const u of n)u.bindFeature(r,null,null);if(n){for(const u of n)u&&u.write(f,r,q);f.featureEnd()}}};e.writeCursor=function(f,r,q,g,l,n){const u=r.getGroupId(),t=r.getDisplayId(),m=this._templateStore.getTemplateGroup(u);r.getObjectId();if(null!=t&&m){if(d.isDynamicId(u))for(const w of m)w.bindFeature(r,
q,g);for(const w of m)w.write(f,r,l);B.isSome(n)&&f.hasRecords&&(q=n&&this._findLabelRef(m),this._writeLabels(f,r,n,q,l))}};e._findLabelRef=function(f){for(const r of f)if(r instanceof a)return r;return null};e._writeLabels=function(f,r,q,g,l){for(const n of q)if(B.isSome(n)&&n){const {glyphs:u,rtl:t,index:m}=n;q=this._labelTemplates.get(m);q.setZoomLevel(l);q.bindReferenceTemplate(g);q.bindTextInfo(u,t);q.write(f,r,null)}};F._createClass(b,[{key:"templates",get:function(){return this._templateStore}}]);
return b}();x.WGLMeshFactory=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./meshUtils ./segmentUtils ./WGLTextTemplate".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g){const l=E.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),n=(t,m="mapview-labeling")=>l.error(new F(m,t)),u=function(t){const m=new Map;return w=>{m.has(w)||m.set(w,t(w));return m.get(w)}}(t=>{let m=0;if(0===t)return Infinity;for(;!(t%2);)m++,t/=2;return m});return function(t){function m(v,C,A,y){var p=t.call(this,v,A.font.size,A.haloSize||0,A.color&&d.premultiplyAlphaRGBAArray(A.color)||0,A.haloColor&&d.premultiplyAlphaRGBAArray(A.haloColor)||0,A.horizontalAlignment,
A.verticalAlignment,r.isMapAligned(C.labelPlacement)?1:0,A.font.decoration,!1,A.angle||0,A.xoffset,A.yoffset,A.lineWidth,A.lineHeight,null,null,null,null,null)||this;p._outLineLabelAngle=0;p._refPlacementPadding=0;p._refPlacementDirX=0;p._refPlacementDirY=0;p._refOffsetX=0;p._refOffsetY=0;p._zoomLevel=0;p.geometryType=b.WGLGeometryType.LABEL;var z=!!C.minScale&&y.scaleToZoom(C.minScale)||0;z=B.clamp(z,0,25.5);y=!!C.maxScale&&y.scaleToZoom(C.maxScale)||255;y=B.clamp(y,0,25.5);const [D,G]=a.getAlignmentFromPlacement(C.labelPlacement);
p._xAlignD=D;p._yAlignD=G;p._minZoom=z;p._maxZoom=y;p._refPlacementPadding=h.pt2px(A.haloSize)+c.TEXT_PLACEMENT_PADDING;v=f.LabelMaterialKey.load(v);v.sdf=!0;p._materialKey=v.data;return p}x._inheritsLoose(m,t);m.fromLabelClass=function(v,C){if("esriServerLinePlacementCenterAlong"===v.labelPlacement){const A=v.symbol;A.xoffset=0;A.yoffset=0;A.angle=0;A.font.decoration="none"}return new m(v.materialKey,v,v.symbol,C)};var w=m.prototype;w.setZoomLevel=function(v){this._zoomLevel=v};w.bindReferenceTemplate=
function(v){let C=a.getXDirection(this._xAlignD),A=a.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(k.isNone(v))this._refSymbolAndPlacementOffset=e.i8888to32(0,0,Math.floor(127*C+127),Math.floor(127*A+127));else{if("circle"===v.boundsType&&(C||A)){var y=Math.sqrt(C*C+A*A);C/=y;A/=y}y=Math.max(v.height,v.width);this._refSymbolAndPlacementOffset=e.i8888to32(4*this._refPlacementPadding,y,Math.floor(127*C+127),Math.floor(127*A+127));this._referenceSize=y;this._refPlacementDirX=C;
this._refPlacementDirY=A;this._refOffsetX=v.xOffset;this._refOffsetY=v.yOffset}};w._write=function(v,C){if(!k.isNone(this._shapingInfo)){var A=this._shapingInfo,y=C.getDisplayId(),p="esriGeometryPolygon"===C.geometryType?C.readLegacyCentroid():C.readLegacyGeometry();if(p)switch(this.current={out:v,inId:y,inShaping:A,zoomLevel:this._zoomLevel},C.geometryType){case "esriGeometryPolyline":this._placeLineLabels(p);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(p);break;
default:n("mapview-labeling",`Geometry of type ${C.geometryType} is not supported`)}}};w._isVisible=function(v,C){const A=Math.floor(10*this.current.zoomLevel);return Math.floor(10*v)<=A&&A<=Math.floor(10*C)};w._placePointLabels=function(v){const {out:C,inId:A,inShaping:y}=this.current;this._writeGlyphs(C,A,v,y)};w._placeLineLabels=function(v){v=q.smoothPaths(v.paths,this.current.inShaping.bounds.width);const C=this._placeSubdivGlyphs.bind(this),A=(this._shapedBox.width+128)/2;for(const y of v)q.pathDivide(y,
A,C)};w._placeSubdivGlyphs=function(v,C,A,y){var p=u(C);A=B.log2(Math.min(A,y-A)/(8+this._shapedBox.width/2/2));p=Math.max(this._minZoom,this.current.zoomLevel+1-(0===C?A:Math.min(p,A)));A=this._shapedBox.width/2*2**(this.current.zoomLevel-p);this.current.inShaping.isMultiline?0===C&&this._placeStraight(v,p):this._placeCurved(v,p,A)};w._placeStraight=function(v,C){const {out:A,inId:y,inShaping:p}=this.current;this._writeGlyphs(A,y,v,p,C)};w._placeCurved=function(v,C,A){const {out:y,inId:p}=this.current;
y.metricStart(p,C,v.x,v.y,0,0,0,0);const z=v.clone(),D=(180/Math.PI*v.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*v.angle%360*(254/360));this._placeFirst(z,C,1);this._placeBack(v,z,C,A,1);this._placeForward(v,z,C,A,1);this._outLineLabelAngle=Math.round(254/360*D);this._placeFirst(z,C,0);this._placeBack(v,z,C,A,0);this._placeForward(v,z,C,A,0);y.metricEnd()};w._placeBack=function(v,C,A,y,p){const z=v.clone();for(v=v.backwardLength+0;z.prev()&&!(v>=y);)this._placeOnSegment(z,C,v,A,
-1,p),v+=z.length+0};w._placeForward=function(v,C,A,y,p){const z=v.clone();for(v=v.remainingLength+0;z.next()&&!(v>=y);)this._placeOnSegment(z,C,v,A,1,p),v+=z.length+0};w._placeFirst=function(v,C,A){const y=this.current.inShaping;var p=y.glyphs;const z=this.current.zoomLevel,{out:D,inId:G}=this.current;for(const I of p)p=I.x>y.bounds.x?A:1-A,p=Math.max(0,z+B.log2(Math.abs(I.x+I.width/2-y.bounds.x)/(p*v.remainingLength+(1-p)*v.backwardLength))),p=Math.max(C,p),I.maxZoom=25,I.angle=v.angle+(1-A)*Math.PI,
I.minZoom=p,0>v.x||512<=v.x||0>v.y||512<=v.y||(this._writeGlyph(D,G,v.x,v.y,I),A&&this._isVisible(I.minZoom,I.maxZoom)&&(p=I.bounds,D.metricBoxWrite(p.center[0],p.center[1],p.width,p.height)))};w._placeOnSegment=function(v,C,A,y,p,z){var D=this.current.inShaping.glyphs;const {out:G,inId:I}=this.current,K=this.current.inShaping,N=this.current.zoomLevel;var L=v.x+v.dx/v.length*-p*A,M=v.y+v.dy/v.length*-p*A;for(const H of D)if((D=H.x>K.bounds.x?z:1-z)&&1===p||!D&&-1===p){var O=Math.abs(H.x+H.width/2-
K.bounds.x);D=Math.max(0,N+B.log2(O/A)-.1);O=Math.max(y,N+B.log2(O/(A+v.length+0)));0!==D&&(H.angle=v.angle+(1-z)*Math.PI,H.minZoom=O,H.maxZoom=D,0>L||512<=L||0>M||512<=M||(this._writeGlyph(G,I,L,M,H),z&&this._isVisible(H.minZoom,H.maxZoom)&&(D=H.bounds,G.metricBoxWrite(D.center[0]+(v.x-C.x),D.center[1]+(v.y-C.y),D.width,D.height))))}};w._writeGlyphs=function(v,C,A,y,p=this._minZoom){if(!(0>A.x||512<=A.x||0>A.y||512<=A.y)){var z=A.x+this._refOffsetX;A=A.y-this._refOffsetY;for(const D of y.glyphs)D.minZoom=
p,D.maxZoom=this._maxZoom,this._writeGlyph(v,C,z,A,D);y=y.boundsT;v.metricStart(C,p,z,A,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);v.metricBoxWrite(y.center[0],y.center[1],y.width,y.height);v.metricEnd()}};w._writeVertexCommon=function(v,C,A,y){const p=this._color,z=this._haloColor,D=e.i8888to32(0,0,this._size,this._haloSize);y=e.i8888to32(Math.floor(10*Math.max(y.minZoom,this._minZoom)),Math.floor(10*Math.min(y.maxZoom,this._maxZoom)),this._outLineLabelAngle,
0);v.vertexWrite(A);v.vertexWrite(C);v.vertexWrite(p);v.vertexWrite(z);v.vertexWrite(D);v.vertexWrite(this._refSymbolAndPlacementOffset);v.vertexWrite(y)};x._createClass(m,[{key:"_shapedBox",get:function(){return k.unwrap(this._shapingInfo).bounds}}]);return m}(g)})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(x){x.HAlign=void 0;(function(F){F[F.Left=-1]="Left";F[F.Center=0]="Center";F[F.Right=1]="Right"})(x.HAlign||(x.HAlign={}));x.VAlign=void 0;(function(F){F[F.Top=
1]="Top";F[F.Center=0]="Center";F[F.Bottom=-1]="Bottom";F[F.Baseline=2]="Baseline"})(x.VAlign||(x.VAlign={}));x.getAlignmentFromPlacement=function(F){switch(F){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[x.HAlign.Right,x.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[x.HAlign.Center,x.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[x.HAlign.Left,
x.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[x.HAlign.Right,x.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[x.HAlign.Center,x.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[x.HAlign.Left,x.VAlign.Center];case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[x.HAlign.Right,x.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[x.HAlign.Center,
x.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[x.HAlign.Left,x.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[x.HAlign.Center,x.VAlign.Baseline];default:return console.debug(`Found invalid placement type ${F}`),[x.HAlign.Center,x.VAlign.Center]}};x.getJustification=function(F){switch(F){case "left":return x.HAlign.Left;case "right":return x.HAlign.Right;case "center":case "justify":return x.HAlign.Center}};x.getXAnchorDirection=
function(F){switch(F){case "left":return x.HAlign.Left;case "right":return x.HAlign.Right;case "center":case "justify":return x.HAlign.Center}};x.getXDirection=function(F){switch(F){case x.HAlign.Right:return-1;case x.HAlign.Center:return 0;case x.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${F}`),0}};x.getYAnchorDirection=function(F){switch(F){case "top":return x.VAlign.Top;case "middle":return x.VAlign.Center;case "baseline":return x.VAlign.Baseline;case "bottom":return x.VAlign.Bottom}};
x.getYDirection=function(F){switch(F){case x.VAlign.Top:return 1;case x.VAlign.Center:return 0;case x.VAlign.Bottom:case x.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${F}`),0}};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],function(x,F,E,B){function k(b){return b.length-
1}function h(b){let e=0;for(let f=0;f<k(b);f++)e+=a(b,f);return e}function a(b,e,f=1){const [r,q]=b[e+1];return Math.sqrt(r*r+q*q)*f}function d(b,e,f,r,q){if(!(f<e)){var g=r.clone().seek(f/2);E.isNone(g)||(b(g.clone(),f,q),f=(f-e)/2,g=E.unwrap(g.seek(e/2)),d(b,e,f,r,q+1),d(b,e,f,g,q+1))}}let c=function(){function b(f,r,q,g,l){this._segments=f;this._index=r;this._distance=q;this._xStart=g;this._yStart=l;this._done=!1}b.create=function(f){return new b(f,0,0,f[0][0],f[0][1])};var e=b.prototype;e.clone=
function(){return new b(this._segments,this._index,this._distance,this.xStart,this.yStart)};e.equals=function(f){return this._index===f._index||f._index===this._index-1&&(0===this._distance||1===f._distance)||f._index===this._index+1&&(1===this._distance||0===f._distance)};e.leq=function(f){return this._index<f._index||this._index===f._index&&this._distance<=f._distance};e.geq=function(f){return this._index>f._index||this._index===f._index&&this._distance>=f._distance};e.hasPrev=function(){return 0<=
this._index-1};e.hasNext=function(){return this._index+1<k(this._segments)};e.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};e.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};e._seekBackwards=function(f,r){var q=this.backwardLength;if(f<=q)return this._distance=(q-f)/this.length,this;for(q=this.backwardLength;this.prev();){if(q+
this.length>f)return this._seekBackwards(f-q);q+=this.length}this._distance=0;return r?this:null};e.seek=function(f,r=!1){if(0>f)return this._seekBackwards(Math.abs(f),r);if(f<=this.remainingLength)return this._distance=(this.backwardLength+f)/this.length,this;let q=this.remainingLength;for(;this.next();){if(q+this.length>f)return this.seek(f-q,r);q+=this.length}this._distance=1;return r?this:null};F._createClass(b,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",
get:function(){const f=this.dy;let r=Math.acos((0*f+-1*-this.dx)/(1*this.length));0<f&&(r=2*Math.PI-r);return r}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+
.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:f,dy:r}=this;return Math.sqrt(f*f+r*r)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);
return b}();x.SegmentCursor=c;x.pathDivide=function(b,e,f){const r=h(b);b=c.create(b);const q=r/2,g=Math.floor((r-e)/2/e);b.seek(q-g*e);for(let l=-g;l<=g;l++)512>b.x&&0<=b.x&&512>b.y&&0<=b.y&&f(b.clone(),l,q+l*e,r),b.seek(e)};x.pathLength=h;x.pathSubdivide=function(b,e,f){d(f,e,h(b),c.create(b),0)};x.segmentAt=function(b,e){return b[e+1]};x.segmentCount=k;x.segmentLength=a;x.smoothPaths=function(b,e){for(let z=0;z<b.length;z++){var f=b[z];const D=[];D.push(f[0]);for(var r=1;r<f.length;r++){let [G,
I]=D[r-1];G+=f[r][0];I+=f[r][1];D.push([G,I])}a:{f=D;r=e;if(0>=r)break a;const G=f.length;if(3>G)break a;const I=[];var q=0;I.push(0);for(var g=1;g<G;g++)q+=B.dist(f[g],f[g-1]),I.push(q);r=Math.min(r,.2*q);q=[];q.push(f[0][0]);q.push(f[0][1]);g=f[G-1][0];const K=f[G-1][1];var l=B.sub([0,0],f[0],f[1]);B.normalize(l);f[0][0]+=r*l[0];f[0][1]+=r*l[1];B.sub(l,f[G-1],f[G-2]);B.normalize(l);f[G-1][0]+=r*l[0];f[G-1][1]+=r*l[1];for(l=1;l<G;l++)I[l]+=r;I[G-1]+=r;l=.5*r;for(let N=1;N<G-1;N++){let L=0,M=0,O=
0;for(var n=N-1;0<=n&&!(I[n+1]<I[N]-l);n--){var u=l+I[n+1]-I[N],t=I[n+1]-I[n],m=I[N]-I[n]<l?1:u/t;if(1E-6>Math.abs(m))break;var w=m*m,v=m*u-.5*w*t,C=m*t/r,A=f[n+1],y=f[n][0]-A[0],p=f[n][1]-A[1];L+=C/v*(A[0]*m*u+.5*w*(u*y-t*A[0])-w*m*t*y/3);M+=C/v*(A[1]*m*u+.5*w*(u*p-t*A[1])-w*m*t*p/3);O+=C}for(n=N+1;n<G&&!(I[n-1]>I[N]+l);n++){u=l-I[n-1]+I[N];t=I[n]-I[n-1];m=I[n]-I[N]<l?1:u/t;if(1E-6>Math.abs(m))break;w=m*m;v=m*u-.5*w*t;C=m*t/r;A=f[n-1];y=f[n][0]-A[0];p=f[n][1]-A[1];L+=C/v*(A[0]*m*u+.5*w*(u*y-t*A[0])-
w*m*t*y/3);M+=C/v*(A[1]*m*u+.5*w*(u*p-t*A[1])-w*m*t*p/3);O+=C}q.push(L/O);q.push(M/O)}q.push(g);q.push(K);for(let N=0,L=0;N<G;N++)f[N][0]=q[L++],f[N][1]=q[L++]}f=[];f.push(D[0]);for(r=1;r<D.length;r++){const [G,I]=D[r-1],[K,N]=D[r];f.push([Math.round(K-G),Math.round(N-I)])}b[z]=f}return b};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(x){function F(E,B){return Math.sqrt(E*E+B*B)}x.DEFAULT_MAX_ZOOM=100;x.DEFAULT_MIN_ZOOM=
0;x.dist=function(E,B){return F(E[0]-B[0],E[1]-B[1])};x.getLimitCosine=function(E=2){return 1/Math.max(E,1)};x.getMinMaxZoom=function(E,B){const k=!!E.minScale&&B.scaleToZoom(E.minScale)||0;E=!!E.maxScale&&B.scaleToZoom(E.maxScale)||100;return[k,E]};x.isExtent=function(E){return void 0!==E.xmin&&void 0!==E.ymin&&void 0!==E.xmax&&void 0!==E.ymax};x.isFunction=function(E){return"function"===typeof E};x.isMultipoint=function(E){return void 0!==E.points};x.isPoint=function(E){return void 0!==E.x&&void 0!==
E.y};x.isPolygon=function(E){return void 0!==E.rings};x.isPolyline=function(E){return void 0!==E.paths};x.len=F;x.normalize=function(E){const B=F(E[0],E[1]);E[0]/=B;E[1]/=B};x.sub=function(E,B,k){E[0]=B[0]-k[0];E[1]=B[1]-k[1];return E};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate ../../util/BidiText".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e){return function(f){function r(q,g,l,n,u,t,m,w,v,C,A,y,p,z,D,G,I,K=!1,N,L){var M=f.call(this)||this;M._xOffset=F.pt2px(y);M._yOffset=F.pt2px(p);M._decoration=v||"none";M._color=n;M._haloColor=u;M._haloSize=Math.min(Math.floor(5*F.pt2px(F.toPt(l))),127);M._size=Math.min(Math.round(F.pt2px(g)),127);g=Math.min(Math.round(F.pt2px(g)),127);M._referenceSize=Math.round(Math.sqrt(256*g));M._scale=M._size/24;M._angle=A;M._justify=E.getJustification(t||"center");M._xAlignD=E.getXAnchorDirection(t||
"center");M._yAlignD=E.getYAnchorDirection(m||"baseline");M._baseline="baseline"===(m||"baseline");M._bitset=(1===w?1:0)|(C?1:0)<<1;q=a.MaterialKeyBase.load(q);q.sdf=!0;M._materialKey=q.data;M._lineWidth=F.pt2px(z)||512;M._lineHeight=D||1;M._textPlacement=G;M._effects=I;M._isCIM=K;M._minMaxZoom=h.i1616to32(Math.round(N*k.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(L*k.MIN_MAX_ZOOM_PRECISION_FACTOR));return M}x._inheritsLoose(r,f);r.fromText=function(q,g){const l=new r(q.materialKey,q.font.size,q.haloSize||
0,q.color&&B.premultiplyAlphaRGBAArray(q.color)||0,q.haloColor&&B.premultiplyAlphaRGBAArray(q.haloColor)||0,q.horizontalAlignment,q.verticalAlignment,0,q.font.decoration,!1,q.angle||0,q.xoffset,q.yoffset,q.lineWidth,q.lineHeight,null,null,!1,d.DEFAULT_MIN_ZOOM,d.DEFAULT_MAX_ZOOM),[,n]=e.bidiText(q.text);l.bindTextInfo(g,n);l._vertexBoundsScale=q.maxVVSize?q.maxVVSize/q.font.size:1;return l};r.fromCIMText=function(q,g,l){var n=q.scaleFactor||1;const u=q.size*q.sizeRatio*n,[t,m]=d.getMinMaxZoom(q.scaleInfo,
l);l=new r(q.materialKey,u,q.outlineSize*q.sizeRatio,B.premultiplyAlphaRGBA(q.color),B.premultiplyAlphaRGBA(q.outlineColor),q.horizontalAlignment,q.verticalAlignment,q.alignment,q.decoration,q.colorLocked,q.angle,q.offsetX*q.sizeRatio*n,q.offsetY*q.sizeRatio*n,512,1,q.markerPlacement,q.effects,!0,t,m);[,n]=e.bidiText(q.text);l.bindTextInfo(g,n);l._vertexBoundsScale=q.maxVVSize?q.maxVVSize/u:1;return l};return r}(c(b))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),
function(x,F,E,B,k,h,a,d,c,b){return e=>function(f){function r(...g){g=f.call(this,...g)||this;g._isCIM=!1;g._vertexBoundsScale=1;g.geometryType=a.WGLGeometryType.TEXT;g._aux=d.i8888to32(0,0,g._referenceSize,g._bitset);return g}x._inheritsLoose(r,f);var q=r.prototype;q.bindTextInfo=function(g,l){this._shapingInfo=g&&g.length?F.andThen(g,n=>b.shapeGlyphs(n,l,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,
Math.min(this._lineWidth,512)),lineHeight:h.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null};q._write=function(g,l,n){const u=l.getDisplayId();this._writeGeometry(g,l,u,n)};q._writeGeometry=function(g,l,n,u){const t=this._shapingInfo;if(!F.isNone(t)){if(F.isSome(this._textPlacement))return l=null!=u?u:l.readLegacyGeometry(),this._writePlacedText(g,n,l,t);if(l=u?B.deltaDecodeGeometry(B.convertFromGeometry(u),2):"esriGeometryPolygon"===
l.geometryType?l.readCentroid():l.readUnquantizedGeometry()){if(l.isPoint){const [m,w]=l.coords;return this._writeGlyphs(g,n,{x:m,y:w},t)}l.forEachVertex((m,w)=>this._writeGlyphs(g,n,{x:m,y:w},t))}}};q._writePlacedText=function(g,l,n,u){var t=F.unwrap(this._textPlacement);if(n=k.CIMMarkerPlacementHelper.getPlacement(n,t,E.pt2px(1)))for(t=n.next();null!=t;){const m=t.getAngle();u.setRotation(m);this._writeGlyphs(g,l,{x:t.tx,y:t.ty},u);u.setRotation(-m);t=n.next()}};q._writeGlyphs=function(g,l,n,u){const t=
c.MaterialKeyBase.load(this._materialKey);n=d.i1616to32(Math.round(8*n.x),Math.round(8*n.y));for(const m of u.glyphs){t.textureBinding=m.textureBinding;g.recordStart(l,t.data,this.geometryType,!1,!0);u=m.bounds;const w=this._vertexBoundsScale;g.vertexBounds(u.x*w,u.y*w,u.width*w,u.height*w);this._writeVertices(g,l,n,m);g.recordEnd()}};q._writeGlyph=function(g,l,n,u,t){var m=c.MaterialKeyBase.load(this._materialKey);n=d.i1616to32(Math.round(8*n),Math.round(8*u));m.textureBinding=t.textureBinding;g.recordStart(l,
m.data,this.geometryType,!1,!0);m=t.bounds;u=this._vertexBoundsScale;g.vertexBounds(m.x*u,m.y*u,m.width*u,m.height*u);this._writeVertices(g,l,n,t);g.recordEnd()};q._writeVertices=function(g,l,n,u){const t=g.vertexCount();this._writeVertexCommon(g,l,n,u);g.vertexWrite(u.offsets.upperLeft);g.vertexWrite(u.texcoords.upperLeft);g.vertexEnd();this._writeVertexCommon(g,l,n,u);g.vertexWrite(u.offsets.upperRight);g.vertexWrite(u.texcoords.upperRight);g.vertexEnd();this._writeVertexCommon(g,l,n,u);g.vertexWrite(u.offsets.lowerLeft);
g.vertexWrite(u.texcoords.lowerLeft);g.vertexEnd();this._writeVertexCommon(g,l,n,u);g.vertexWrite(u.offsets.lowerRight);g.vertexWrite(u.texcoords.lowerRight);g.vertexEnd();g.indexWrite(t+0);g.indexWrite(t+1);g.indexWrite(t+2);g.indexWrite(t+1);g.indexWrite(t+3);g.indexWrite(t+2)};q._writeVertexCommon=function(g,l,n,u){u=this._color;const t=this._haloColor,m=d.i8888to32(0,0,this._referenceSize,this._bitset),w=d.i8888to32(0,0,this._size,this._haloSize);g.vertexWrite(n);g.vertexWrite(l);g.vertexWrite(u);
g.vertexWrite(t);g.vertexWrite(w);g.vertexWrite(m);g.vertexWrite(this._minMaxZoom)};return r}(e)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(x,F,E){let B=function(){function k(){}k.getPlacement=function(h,a,d){const c=E.getPlacementOperator(a);if(!c)return null;h=F.cloneAndDecodeGeometry(h);return c.execute(h,a,d)};return k}();x.CIMMarkerPlacementHelper=B;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),
function(x,F,E,B,k,h,a,d,c,b){const e=Math.PI/180;let f=function(){function l(u,t,m,w){this._rotationT=B.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const v=m.rect,C=new Float32Array(8);u*=w;t*=w;const A=m.code?v.width*w:m.metrics.width,y=m.code?v.height*w:m.metrics.height;C[0]=u;C[1]=t;C[2]=u+A;C[3]=t;C[4]=u;C[5]=t+y;C[6]=u+A;C[7]=t+y;this._data=C;this._setTextureCoords(v);this._scale=w;this._mosaic=m;this.x=u;this.y=t;this.maxOffset=Math.max(u+A,t+y)}var n=
l.prototype;n.setTransform=function(u){this._T=u;this._offsets=null};n._setOffsets=function(u){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const t=this._offsets,m=new Float32Array(8),w=E.multiply(B.create(),this._rotationT,this._T);B.transformMany(m,u,w);t.upperLeft=d.i1616to32(8*m[0],8*m[1]);t.upperRight=d.i1616to32(8*m[2],8*m[3]);t.lowerLeft=d.i1616to32(8*m[4],8*m[5]);t.lowerRight=d.i1616to32(8*m[6],8*m[7])};n._setTextureCoords=function({x:u,y:t,width:m,height:w}){this._texcoords=
{upperLeft:d.i1616to32(u,t),upperRight:d.i1616to32(u+m,t),lowerLeft:d.i1616to32(u,t+w),lowerRight:d.i1616to32(u+m,t+w)}};F._createClass(l,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(u){this._angle=u;E.identity(this._rotationT);E.rotate(this._rotationT,this._rotationT,-u);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},
{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},
{key:"bounds",get:function(){if(!this._bounds){const {height:v,width:C}=this._mosaic.metrics;var u=C*this._scale,t=Math.abs(v)*this._scale,m=new Float32Array(8);m[0]=this.x;m[1]=this.y;m[2]=this.x+u;m[3]=this.y;m[4]=this.x;m[5]=this.y+t;m[6]=this.x+u;m[7]=this.y+t;u=E.multiply(B.create(),this._rotationT,this._T);B.transformMany(m,m,u);t=u=Infinity;let A=0;var w=0;for(let y=0;4>y;y++){const p=m[2*y],z=m[2*y+1];u=Math.min(u,p);t=Math.min(t,z);A=Math.max(A,p);w=Math.max(w,z)}m=A-u;w-=t;this._bounds=
new b(u+m/2,t+w/2,m,w)}return this._bounds}}]);return l}();const r=(l,n)=>({code:0,page:0,sdf:!0,rect:new c(0,0,11,8),textureBinding:n,metrics:{advance:0,height:4,width:l,left:0,top:0}});let q=function(){function l(u,t,m){this._rotation=0;this._decorate(u,t,m);this.glyphs=u;this.bounds=this._createBounds(u);this.isMultiline=1<t.length;this._hasRotation=0!==m.angle;this._T=this._createGlyphTransform(this.bounds,m);for(const w of u)w.setTransform(this._T)}var n=l.prototype;n.setRotation=function(u){if(0!==
u||0!==this._rotation){this._rotation=u;var t=this._T;u=E.fromRotation(B.create(),u);E.multiply(t,u,t);for(const m of this.glyphs)m.setTransform(this._T)}};n._decorate=function(u,t,m){if(m.decoration&&"none"!==m.decoration&&u.length){var w=m.scale;m="underline"===m.decoration?30:20;var v=u[0].textureBinding;for(const C of t)u.push(new f(C.startX*w,C.startY*w+m*w,r((C.width+C.glyphWidthEnd)*w,v),1))}};n._createBounds=function(u){let t=Infinity,m=Infinity,w=0;var v=0;for(const C of u)t=Math.min(t,C.xTopLeft),
m=Math.min(m,C.yTopLeft),w=Math.max(w,C.xTopLeft+C.width),v=Math.max(v,C.yBottomRight);u=w-t;v-=m;return new b(t+u/2,m+v/2,u,v)};n._createGlyphTransform=function(u,t){const m=e*t.angle,w=B.create(),v=h.create();E.translate(w,w,k.set(v,t.xOffset,-t.yOffset));t.isCIM?E.rotate(w,w,m):(E.translate(w,w,k.set(v,u.x,u.y)),E.rotate(w,w,m),E.translate(w,w,k.set(v,-u.x,-u.y)));return w};F._createClass(l,[{key:"boundsT",get:function(){var u=this.bounds;const t=k.set(h.create(),u.x,u.y);k.transformMat2d(t,t,
this._T);return this._hasRotation?(u=Math.max(u.width,u.height),new b(t[0],t[1],u,u)):new b(t[0],t[1],u.width,u.height)}}]);return l}(),g=function(l,n,u,t,m,w){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(n,u));this.end=Math.max(0,Math.max(n,u));this.end<l.length&&(this.glyphWidthEnd=l[this.end].metrics.width);this.width=t;this.yMin=m;this.yMax=w};x.ShapedGlyph=f;x.ShapingInfo=q;x.shapeGlyphs=function(l,n,u){const t=u.scale,m=[];{var w=[];var v=1/u.scale*u.maxLineWidth;
var C=n?l.length-1:0;var A=n?-1:l.length;n=n?-1:1;var y=C,p=0,z=0;let K=y,N=K,L=0,M=Infinity,O=0;for(;y!==A;){const {code:H,metrics:J}=l[y];var D=Math.abs(J.top);10!==H&&32!==H&&(M=Math.min(M,D),O=Math.max(O,D+J.height));10===H?(y!==C&&(w.push(new g(l,K,y-n,p,M,O)),M=Infinity,O=0),p=0,K=y+n,N=y+n,z=0):32===H?(N=y+n,z=0,L=J.advance,p+=J.advance):(p>v&&(N!==K?(D=N-2*n,p-=L,w.push(new g(l,K,D,p-z,M,O)),M=Infinity,O=0,K=N,p=z):(w.push(new g(l,K,y-n,p,M,O)),M=Infinity,O=0,N=K=y,p=0)),p+=J.advance,z+=J.advance);
y+=n}v=new g(l,K,y-n,p,M,O);0<=v.start&&v.end<l.length&&w.push(v)}for(v=0;v<w.length;v++);v=C=w[0].yMin;C=w[w.length-1].yMax+u.lineHeight*(w.length-1)+("underline"===u.decoration?4:0)-C;const {vAlign:G,hAlign:I}=u;A=G===a.VAlign.Baseline?1:0;v=(1-A)*-v+C/2*(A?0:G-1)+-26*(A?1:0);for(C=0;C<w.length;C++){const {start:K,end:N,width:L}=w[C];A=L/2*(I+1)*-1-3;n=C*u.lineHeight+v-3;w[C].startX=A;w[C].startY=n;for(y=K;y<=N;y++)p=l[y],10!==p.code&&(z=new f(A+p.metrics.left,n-p.metrics.top,p,t),A+=p.metrics.advance,
m.push(z))}return new q(m,w,u)};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/mathUtils","../../../../../chunks/vec2f32"],function(x,F,E){return function(){function B(h,a,d,c){this.center=E.fromValues(h,a);this.centerT=E.create();this.halfWidth=d/2;this.halfHeight=c/2;this.width=d;this.height=c}var k=B.prototype;k.clone=function(){return new B(this.x,
this.y,this.width,this.height)};k.serialize=function(h){h.writeF32(this.center[0]);h.writeF32(this.center[1]);h.push(this.width);h.push(this.height);return h};k.findCollisionDelta=function(h,a=4){return F.log2(Math.min((h.halfWidth+this.halfWidth+a)/Math.abs(h.centerT[0]-this.centerT[0]),(h.halfHeight+this.halfHeight+a)/Math.abs(h.centerT[1]-this.centerT[1])))};k.extend=function(h){const a=Math.min(this.xmin,h.xmin),d=Math.min(this.ymin,h.ymin),c=Math.max(this.xmax,h.xmax)-a;h=Math.max(this.ymax,
h.ymax)-d;this.width=c;this.height=h;this.halfWidth=c/2;this.halfHeight=h/2;this.x=a+c/2;this.y=d+h/2};B.deserialize=function(h){const a=h.readF32(),d=h.readF32(),c=h.readInt32();h=h.readInt32();return new B(a,d,c,h)};x._createClass(B,[{key:"x",get:function(){return this.center[0]},set:function(h){this.center[0]=h}},{key:"y",get:function(){return this.center[1]},set:function(h){this.center[1]=h}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+
this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return B}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe",
"../../../../../../symbols/cim/effects/CIMEffectHelper"],function(x,F){return function(){function E(){}var B=E.prototype;B.bindFeature=function(k,h,a){};B.write=function(k,h,a){if(x.isNone(this._effects))return this._write(k,h);a=F.CIMEffectHelper.executeEffects(this._effects,h.readLegacyGeometry());let d=F.CIMEffectHelper.next(a);for(;d;)this._write(k,h,d),d=F.CIMEffectHelper.next(a)};B._write=function(k,h,a){};return E}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports",
"../CIMCursor","../CIMEffects","../CIMOperators"],function(x,F,E,B){const k=96/72;let h=function(){function a(){}a.executeEffects=function(d,c){c=F.cloneAndDecodeGeometry(c);c=new E.SimpleGeometryCursor(c);for(const b of d)(d=B.getEffectOperator(b))&&(c=d.execute(c,b,k));return c};a.next=function(d){d=d.next();F.deltaEncodeGeometry(d);return d};return a}();x.CIMEffectHelper=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f){return function(r){function q(g,l,n,u,t,m,w,v,C,A,y,p,z,D,G,I,K,N,L,M,O,H,J){var P=r.call(this)||this;P.angle=u;P.height=w;P.width=m;P.xOffset=l*L;P.yOffset=n*L;P._markerPlacement=M;P._effects=O;P._anchorX=.5-(.5+I)*G.width/G.width;P._anchorY=.5-(.5+K)*G.height/G.height;P._minMaxZoom=d.i1616to32(Math.round(H*a.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(J*a.MIN_MAX_ZOOM_PRECISION_FACTOR));l=(1===D?1:0)|(y?1:0)<<1|(z?1:0)<<2|(p?1:0)<<3;n=G&&G.sdf;g=c.MarkerMaterialKey.load(g);
g.sdf=n;g.pattern=!0;g.textureBinding=G.textureBinding;P._materialKey=g.data;P._fillColor=t;P._outlineColor=C;P._sizeOutlineWidth=d.i8888to32(Math.round(Math.min(Math.sqrt(128*m),255)),Math.round(Math.min(Math.sqrt(128*w),255)),Math.round(Math.min(Math.sqrt(128*A),255)),Math.round(Math.min(Math.sqrt(128*v),255)));t=G.rect.x+a.SPRITE_PADDING;v=G.rect.y+a.SPRITE_PADDING;C=t+G.width;G=v+G.height;P._offsets.xUpperLeft=t;P._offsets.yUpperLeft=v;P._offsets.xUpperRight=C;P._offsets.yUpperRight=v;P._offsets.xBottomLeft=
t;P._offsets.yBottomLeft=G;P._offsets.xBottomRight=C;P._offsets.yBottomRight=G;P._texUpperLeft=d.i1616to32(t,v);P._texUpperRight=d.i1616to32(C,v);P._texBottomLeft=d.i1616to32(t,G);P._texBottomRight=d.i1616to32(C,G);m=m*N*L;w=w*N*L;P._bitestAndDistRatio=d.i1616to32(l,Math.round(64*N));P._computedWidth=m;P._computedHeight=w;m=k.create();w=B.create();P._applyTransformation(w,m);return P}x._inheritsLoose(q,r);q.fromCIMMarker=function(g,l,n){const u=g.size,t=(l&&l.width||1)/(l&&l.height||1)*g.scaleX;var m=
g.scaleSymbolsProportionally&&g.frameHeight?u/g.frameHeight:1;const w=h.premultiplyAlphaRGBA(g.color),v=h.premultiplyAlphaRGBA(g.outlineColor),C=E.pt2px(u),A=C*t,y=E.pt2px(g.offsetX||0),p=E.pt2px(g.offsetY||0);m*=E.pt2px(g.outlineWidth||0);const z=g.alignment||0,D=E.pt2px(g.referenceSize),[G,I]=b.getMinMaxZoom(g.scaleInfo,n);n=g.rotation||0;g.rotateClockwise||(n=-n);let K=0,N=0;const L=g.anchorPoint;L&&(g.isAbsoluteAnchorPoint?u&&(K=-L.x/(u*t),N=L.y/u):(K=L.x,N=L.y));l=new q(g.materialKey,y,p,n,w,
A,C,D,v,m,g.colorLocked,g.scaleSymbolsProportionally,!1,z,l,K,N,g.sizeRatio,F.unwrapOr(g.scaleFactor,1),g.markerPlacement,g.effects,G,I);l._vertexBoundsScaleX=g.maxVVSize?g.maxVVSize/A:1;l._vertexBoundsScaleY=g.maxVVSize?g.maxVVSize/C:1;return l};q.fromPictureMarker=function(g,l){const n=Math.round(E.pt2px(g.width)),u=Math.round(E.pt2px(g.height)),t=a.PICTURE_FILL_COLOR,m=Math.round(E.pt2px(g.xoffset||0)),w=Math.round(E.pt2px(g.yoffset||0));l=new q(g.materialKey,m,w,g.angle,t,n,u,u,0,0,!1,!1,!1,0,
l,0,0,1,1,null,null,b.DEFAULT_MIN_ZOOM,b.DEFAULT_MAX_ZOOM);l._vertexBoundsScaleX=g.maxVVSize?g.maxVVSize/g.width:1;l._vertexBoundsScaleY=g.maxVVSize?g.maxVVSize/g.height:1;return l};q.fromSimpleMarker=function(g,l){const n=h.premultiplyAlphaRGBAArray(g.color),u=Math.round(E.pt2px(g.size)),t=Math.round(E.pt2px(g.xoffset||0)),m=Math.round(E.pt2px(g.yoffset||0)),w=g.style;var v=g.outline;const C=(v&&v.color&&h.premultiplyAlphaRGBAArray(v.color))|0;v=(v&&v.width&&Math.round(E.pt2px(v.width)))|0;l=new q(g.materialKey,
t,m,g.angle,n,u,u,u,C,v,!1,!1,"esriSMSCross"===w||"esriSMSX"===w,0,l,0,0,1.96875,1,null,null,b.DEFAULT_MIN_ZOOM,b.DEFAULT_MAX_ZOOM);l.boundsType="esriSMSCircle"===w?"circle":"square";l._vertexBoundsScaleX=g.maxVVSize?g.maxVVSize/g.size:1;l._vertexBoundsScaleY=g.maxVVSize?g.maxVVSize/g.size:1;return l};q.fromLineSymbolMarker=function(g,l){const n=h.premultiplyAlphaRGBAArray(g.color),u=Math.round(E.pt2px(6*g.lineWidth)),t="cross"===g.style||"x"===g.style;switch(g.placement){case "begin-end":var m="Both";
break;case "begin":m="JustBegin";break;case "end":m="JustEnd";break;default:m="None"}m={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:m,offsetAlongLine:0};l=new q(g.materialKey,0,0,0,n,u,u,u/6,n,t?Math.round(E.pt2px(g.lineWidth)):0,!1,!1,t,1,l,0,0,1.96875,1,m,null,b.DEFAULT_MIN_ZOOM,b.DEFAULT_MAX_ZOOM);l.boundsType="circle"===g.style?"circle":"square";return l};return q}(e(f))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../enums ../../number".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e){const f=3.14159265359/180;return r=>function(q){function g(...n){n=q.call(this,...n)||this;n.angle=0;n.xOffset=0;n.yOffset=0;n.width=0;n.height=0;n.boundsType="square";n._anchorX=0;n._anchorY=0;n._computedWidth=0;n._computedHeight=0;n._vertexBoundsScaleX=1;n._vertexBoundsScaleY=1;n._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};n.geometryType=b.WGLGeometryType.MARKER;return n}x._inheritsLoose(g,
q);var l=g.prototype;l._write=function(n,u,t){const m=u.getDisplayId();n.recordStart(m,this._materialKey,this.geometryType,!1,!0);this._writeGeometry(n,u,m,t);n.recordEnd()};l._writeGeometry=function(n,u,t,m){if(F.isSome(this._markerPlacement))return this._writePlacedMarkers(n,u,m);if(u=m?d.deltaDecodeGeometry(d.convertFromGeometry(m),2):"esriGeometryPolygon"===u.geometryType?u.readCentroid():u.readUnquantizedGeometry()){if(u.isPoint){const [w,v]=u.coords;return!n.hasAggregates&&n.hasPixelBufferEnabled&&
(-1>w||513<=w||-1>v||513<=v)?void 0:this._writeVertices(n,t,this._getPos(w,v),w,v)}u.forEachVertex((w,v)=>this._writeVertices(n,t,this._getPos(w,v),w,v))}};l._writePlacedMarkers=function(n,u,t){t=null!=t?t:u.readLegacyGeometry();if(t=c.CIMMarkerPlacementHelper.getPlacement(t,F.unwrap(this._markerPlacement),E.pt2px(1))){u=u.getDisplayId();for(var m=a.create(),w=k.create(),v=t.next();null!=v;){const {tx:C,ty:A}=v;-128<=C&&640>=C&&-128<=A&&640>=A&&(this._applyTransformation(w,m,v.getAngle()/f),this._writeVertices(n,
u,this._getPos(C,A),C,A));v=t.next()}}};l._writeVertices=function(n,u,t,m,w){const v=n.vertexCount();n.vertexBounds(m+this.xOffset,w-this.yOffset,this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY);n.vertexWrite(t);n.vertexWrite(this._offsetUpperLeft);n.vertexWrite(this._texUpperLeft);n.vertexWrite(this._bitestAndDistRatio);n.vertexWrite(u);n.vertexWrite(this._fillColor);n.vertexWrite(this._outlineColor);n.vertexWrite(this._sizeOutlineWidth);n.vertexWrite(this._minMaxZoom);
n.vertexEnd();n.vertexWrite(t);n.vertexWrite(this._offsetUpperRight);n.vertexWrite(this._texUpperRight);n.vertexWrite(this._bitestAndDistRatio);n.vertexWrite(u);n.vertexWrite(this._fillColor);n.vertexWrite(this._outlineColor);n.vertexWrite(this._sizeOutlineWidth);n.vertexWrite(this._minMaxZoom);n.vertexEnd();n.vertexWrite(t);n.vertexWrite(this._offsetBottomLeft);n.vertexWrite(this._texBottomLeft);n.vertexWrite(this._bitestAndDistRatio);n.vertexWrite(u);n.vertexWrite(this._fillColor);n.vertexWrite(this._outlineColor);
n.vertexWrite(this._sizeOutlineWidth);n.vertexWrite(this._minMaxZoom);n.vertexEnd();n.vertexWrite(t);n.vertexWrite(this._offsetBottomRight);n.vertexWrite(this._texBottomRight);n.vertexWrite(this._bitestAndDistRatio);n.vertexWrite(u);n.vertexWrite(this._fillColor);n.vertexWrite(this._outlineColor);n.vertexWrite(this._sizeOutlineWidth);n.vertexWrite(this._minMaxZoom);n.vertexEnd();n.indexWrite(v+0);n.indexWrite(v+1);n.indexWrite(v+2);n.indexWrite(v+1);n.indexWrite(v+3);n.indexWrite(v+2)};l._applyTransformation=
function(n,u,t=0){B.identity(n);B.translate(n,n,a.fromValues(this.xOffset,-this.yOffset));0!==this.angle+t&&B.rotate(n,n,f*(this.angle+t));t=this._computedWidth;const m=this._computedHeight,w=(this._anchorX-.5)*t,v=(this._anchorY-.5)*m;h.set(u,w,v);h.transformMat2d(u,u,n);this._offsetUpperLeft=e.i1616to32(16*u[0],16*u[1]);this._offsets.xUpperLeft=u[0];this._offsets.yUpperLeft=u[1];h.set(u,w+t,v);h.transformMat2d(u,u,n);this._offsetUpperRight=e.i1616to32(16*u[0],16*u[1]);this._offsets.xUpperRight=
u[0];this._offsets.yUpperRight=u[1];h.set(u,w,v+m);h.transformMat2d(u,u,n);this._offsetBottomLeft=e.i1616to32(16*u[0],16*u[1]);this._offsets.xBottomLeft=u[0];this._offsets.yBottomLeft=u[1];h.set(u,w+t,v+m);h.transformMat2d(u,u,n);this._offsetBottomRight=e.i1616to32(16*u[0],16*u[1]);this._offsets.xBottomRight=u[0];this._offsets.yBottomRight=u[1]};l._getPos=function(n,u){return e.i1616to32(Math.round(8*n),Math.round(8*u))};return g}(r)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaults ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/schemaUtils ../../../../layers/features/textUtils".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n,u){function t(C,A){const y=C.length;C.push(null);A.then(p=>C[y]=p);return C}function m(C){return!!(C&1)}const w=B.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),v=[];B=function(){function C(y,p){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new g["default"];this._fetchResource=
y;this._tileInfo=p}var A=C.prototype;A.createTemplateGroup=function(y,p){this._initErrorTemplates();const z=y.hash;if(this._symbolToTemplate.has(z))return this._symbolToTemplate.get(z);const D=[];p&&this._createMeshTemplates(D,p,!0);this._createMeshTemplates(D,y,!1);y=this._createGroupId("expanded-cim"===y.type);this._idToTemplateGroup.set(y,D);this._symbolToTemplate.set(z,y);return y};A.getTemplateGroup=function(y){return this._idToTemplateGroup.has(y)?this._idToTemplateGroup.get(y):v};A.getDynamicTemplateGroup=
function(y){if(!this._idToTemplateGroup.has(y))return v;m(y)||w.error("mapview-template-store",`Id ${y} does not refer to a dynamic template`);return this._idToTemplateGroup.get(y)};A.getMosaicItem=function(y,p){const z=this._createTemplateId(),D=new Promise(G=>this._idToResolver.set(z,G));this._fetchQueue.push({symbol:y,id:z,glyphIds:p});return D};A.finalize=function(y){return this._fetchQueue.length||this._lock.isHeld()?g.withLock(this._lock,this._fetchAllQueuedResources.bind(this),y):Promise.resolve()};
A._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],n.createSymbolSchema(h.errorPolygonSymbol2D),!1),marker:this._createMeshTemplates([],n.createSymbolSchema(h.errorPointSymbol2D),!1),line:this._createMeshTemplates([],n.createSymbolSchema(h.errorPolylineSymbol2D),!1)})};A._fetchAllQueuedResources=function(y){if(!this._fetchQueue.length)return Promise.resolve();const p=this._fetchQueue,z=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=
[];return Promise.all(z).then(()=>this._fetchResource(p,y).then(D=>{for(const {id:G,mosaicItem:I}of D)this._idToResolver.get(G)(I),this._idToResolver.delete(G)})).catch(D=>{k.isAbortError(D)?this._fetchQueue=this._fetchQueue.concat(p):"worker:port-closed"!==D.name&&w.error(new E("mapview-template-store","Unable to fetch requested texture resources",D))})};A._createGroupId=function(y){return this._idCounter++<<1|(y?1:0)};A._createTemplateId=function(){return this._templateIdCounter++};A._createSMS=
function(){var y=F._asyncToGenerator(function*(p){const {spriteMosaicItem:z}=yield this.getMosaicItem(p);return l.ok(z,w)?r.fromSimpleMarker(p,z):this._markerError});return function(p){return y.apply(this,arguments)}}();A._createPMS=function(){var y=F._asyncToGenerator(function*(p){const {spriteMosaicItem:z}=yield this.getMosaicItem(p);return l.ok(z,w)?r.fromPictureMarker(p,z):this._markerError});return function(p){return y.apply(this,arguments)}}();A._createSFS=function(){var y=F._asyncToGenerator(function*(p,
z){const {spriteMosaicItem:D}=yield this.getMosaicItem(p);return l.ok(D,w)?e.fromSimpleFill(p,D,z):this._fillError});return function(p,z){return y.apply(this,arguments)}}();A._createPFS=function(){var y=F._asyncToGenerator(function*(p,z){const {spriteMosaicItem:D}=yield this.getMosaicItem(p);return l.ok(D,w)?e.fromPictureFill(p,D,z):this._fillError});return function(p,z){return y.apply(this,arguments)}}();A._createSLS=function(){var y=F._asyncToGenerator(function*(p,z){({spriteMosaicItem:z}=yield this.getMosaicItem(p));
return l.ok(z,w)?f.fromSimpleLine(p,z):this._lineError});return function(p,z){return y.apply(this,arguments)}}();A._createLMS=function(){var y=F._asyncToGenerator(function*(p){const {spriteMosaicItem:z}=yield this.getMosaicItem(p);return l.ok(z,w)?r.fromLineSymbolMarker(p,z):this._markerError});return function(p){return y.apply(this,arguments)}}();A._createTS=function(){var y=F._asyncToGenerator(function*(p){const {glyphMosaicItems:z}=yield this.getMosaicItem(p);return q.fromText(p,z)});return function(p){return y.apply(this,
arguments)}}();A._createCIMText=function(){var y=F._asyncToGenerator(function*(p){const {glyphMosaicItems:z}=yield this.getMosaicItem(p.cim,u.codepoints(p.text));return l.ok(z,w)?q.fromCIMText(p,z,this._tileInfo):this._textError});return function(p){return y.apply(this,arguments)}}();A._createCIMFill=function(){var y=F._asyncToGenerator(function*(p){const {spriteMosaicItem:z}=yield this.getMosaicItem(p.cim);return l.ok(z,w)?e.fromCIMFill(p,z,this._tileInfo):this._fillError});return function(p){return y.apply(this,
arguments)}}();A._createCIMLine=function(){var y=F._asyncToGenerator(function*(p){const {spriteMosaicItem:z}=yield this.getMosaicItem(p.cim);return l.ok(z,w)?f.fromCIMLine(p,z,this._tileInfo):this._lineError});return function(p){return y.apply(this,arguments)}}();A._createCIMMarker=function(){var y=F._asyncToGenerator(function*(p){const {spriteMosaicItem:z}=yield this.getMosaicItem(p.cim);return l.ok(z,w)?r.fromCIMMarker(p,z,this._tileInfo):this._markerError});return function(p){return y.apply(this,
arguments)}}();A._createCIM=function(){var y=F._asyncToGenerator(function*(p){const z=p.templateHash;if(this._cimTemplateCache.has(z))return this._cimTemplateCache.get(z);p={...p,cim:{...p.cim,mosaicHash:p.materialHash}};let D;switch(p.type){case "marker":D=this._createCIMMarker(p);break;case "line":D=this._createCIMLine(p);break;case "fill":D=this._createCIMFill(p);break;case "text":D=this._createCIMText(p)}D.then(G=>this._cimTemplateCache.set(z,G));return D});return function(p){return y.apply(this,
arguments)}}();A._createDynamicCIM=function(y){const p=y.templateHash;if(this._cimTemplateCache.has(p))return this._cimTemplateCache.get(p);let z;switch(y.type){case "marker":z=c.fromCIMMarker(y,this._tileInfo);break;case "line":z=d.fromCIMLine(y,this._tileInfo);break;case "fill":z=a.fromCIMFill(y,this._tileInfo);break;case "text":z=b.fromCIMText(y,this._tileInfo)}this._cimTemplateCache.set(p,z);return z};A._createPrimitiveMeshTemplates=function(y,p,z){switch(p.type){case "esriSMS":return t(y,this._createSMS(p));
case "esriPMS":return t(y,this._createPMS(p));case "esriSFS":return t(y,this._createSFS(p,z));case "line-marker":return t(y,this._createLMS(p));case "esriPFS":return t(y,this._createPFS(p,z));case "esriSLS":return t(y,this._createSLS(p,!1));case "esriTS":return t(y,this._createTS(p));default:return w.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),y}};A._createMeshTemplates=function(y,p,z){if(-1!==p.type.indexOf("3d"))return w.error("3D symbols are not supported with MapView"),
y;if("expanded-cim"===p.type){for(const D of p.layers)"function"===typeof D.materialHash?y.push(this._createDynamicCIM(D)):t(y,this._createCIM(D));return y}if("composite-symbol"===p.type){for(const D of p.layers)this._createPrimitiveMeshTemplates(y,D,z);return y}return"cim"===p.type||"label"===p.type||"web-style"===p.type?y:this._createPrimitiveMeshTemplates(y,p,z)};F._createClass(C,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},
{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);return C}();x.WGLTemplateStore=B;x.isDynamicId=m;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f){return function(r){function q(g,l,n){var u;var t=r.call(this,g)||this;t._minMaxZoom=a.i1616to32(Math.round(l*k.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(n*k.MIN_MAX_ZOOM_PRECISION_FACTOR));c.isFunction(g.color)?t._dynamicPropertyMap.set("fillColor",(p,z,D)=>(p=g.color(p,z,D))&&B.premultiplyAlphaRGBA(p)||0):(l=g.color,t.fillColor=l&&B.premultiplyAlphaRGBA(l)||0);let m=0;c.isFunction(g.height)||(m=g.height||0);const w="CIMMarkerPlacementInsidePolygon"===(null==(u=g.cim.placement)?
void 0:u.type)&&g.cim.placement.shiftOddRows?2:1;t._dynamicPropertyMap.set("_height",(p,z,D)=>c.isFunction(g.height)?g.height(p,z,D)*w:m*w);let v=0;c.isFunction(g.offsetX)||(v=E.pt2px(g.offsetX||0)+128,255<v&&(v=255));t._dynamicPropertyMap.set("_offsetX",(p,z,D)=>c.isFunction(g.offsetX)?(p=E.pt2px(g.offsetX(p,z,D))+128,255<p&&(p=255),p):v);let C=1;c.isFunction(g.scaleX)||(C=g.scaleX||1);t._dynamicPropertyMap.set("_scaleX",(p,z,D)=>c.isFunction(g.scaleX)?g.scaleX(p,z,D):C);let A=0;c.isFunction(g.offsetY)||
(A=E.pt2px(-g.offsetY||0)+128,255<A&&(A=255));t._dynamicPropertyMap.set("_offsetY",(p,z,D)=>c.isFunction(g.offsetY)?(p=E.pt2px(-g.offsetY(p,z,D))+128,255<p&&(p=255),p):A);let y=0;c.isFunction(g.angle)||(y=h.radToByte(g.angle)||0);t._dynamicPropertyMap.set("_angle",(p,z,D)=>c.isFunction(g.angle)?h.radToByte(g.angle(p,z,D)):y);t._effects=g.effects;t._cimFillLayer=g;t._fillMaterialKey=d.FillMaterialKey.load(g.materialKey);return t}x._inheritsLoose(q,r);q.fromCIMFill=function(g,l){const [n,u]=c.getMinMaxZoom(g.scaleInfo,
l);return new q(g,n,u)};q.prototype.bindFeature=function(g,l,n){const u=g.readLegacyFeature();this._dynamicPropertyMap.forEach((w,v)=>{this[v]=w(u,l,n)});g=this._fillMaterialKey;var t=this._materialCache,m=this._cimFillLayer;this.aux3=a.i8888to32(0,0,this._angle,m.colorLocked?1:0);m=m.materialHash;m=m(u,l,n);m=t.get(m);t=null;m&&f.ok(m.spriteMosaicItem)&&(t=m.spriteMosaicItem);if(t){const {rect:w,width:v,height:C}=t;m=w.x+k.SPRITE_PADDING;const A=w.y+k.SPRITE_PADDING,y=m+v,p=A+C;let z=F.nextHighestPowerOfTwo(E.pt2px(this._height));
255<z?z=255:0>=z&&(z=F.nextHighestPowerOfTwo(p-A));let D=F.nextHighestPowerOfTwo(E.pt2px(this._height/C*v||0));255<D?D=255:0>=D&&(D=F.nextHighestPowerOfTwo(y-m));const G=this._scaleX;this.tl=a.i1616to32(m,A);this.br=a.i1616to32(y,p);this.aux1=a.i8888to32(D,z,this._offsetX,this._offsetY);this.aux2=a.i1616to32(128*G,128);g.sdf=t.sdf;g.pattern=!0;g.textureBinding=t.textureBinding}else this.aux2=this.aux1=this.br=this.tl=0,g.sdf=!1,g.pattern=!1,g.textureBinding=0;this._materialKey=g.data};return q}(b(e))})},
"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../materialKey/MaterialKey ./templateUtils".split(" "),function(x,F,E,B,k,h,a){return d=>function(c){function b(...f){f=c.call(this,...f)||this;f.forceLibtess=!1;f.geometryType=B.WGLGeometryType.FILL;return f}x._inheritsLoose(b,c);var e=b.prototype;e._write=
function(f,r,q){const g="esriGeometryPoint"===r.geometryType,l=h.FillMaterialKey.load(this._materialKey);f.recordStart(r.getDisplayId(),this._materialKey,this.geometryType,l.dotDensity,g);this._writeGeometry(f,r,l,q,g);f.recordEnd()};e._writeGeometry=function(f,r,q,g,l){l=this._getGeometry(r,g,l);if(!F.isNone(l))if(g=f.indexCount(),1E3<l.lengths[0]||this.forceLibtess||!a.triangulate(f,l)){l=a.triangulateLibtess(f,l);var n=f.indexCount();g!==n&&this._writeVertices(f,r,l,[l.length/2],q)}else n=f.indexCount(),
g!==n&&this._writeVertices(f,r,l.coords,l.lengths,q)};e._writeVertices=function(f,r,q,g,l){const n=r.getDisplayId();let u=0;for(const m of g){var t=u;for(g=m+u;t<g;t++){const w=q[2*t],v=q[2*t+1],C=k.i1616to32(1*w,1*v);f.vertexBounds(w,v,0,0);f.vertexWrite(C);f.vertexWrite(n);l.dotDensity?f.vertexWriteF32(1/Math.abs(r.readGeometryArea())):(f.vertexWrite(this.fillColor),f.vertexWrite(this.tl),f.vertexWrite(this.br),f.vertexWrite(this.aux1),f.vertexWrite(this.aux2),f.vertexWrite(this.aux3),f.vertexWrite(this._minMaxZoom))}u+=
m}};e._getGeometry=function(f,r,q){return(f=r?E.deltaDecodeGeometry(E.convertFromGeometry(r),2):f.readUnquantizedGeometry())?a.clipMarshall(f,q?256:128):null};return b}(d)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../chunks/earcut ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../TileClipper ../bufcut ../Tesselator".split(" "),function(x,F,E,B,k,h,a){function d(q,g,l){let n=0;for(let u=1;u<l;u++)n+=(q[2*(g+u)]-
q[2*(g+u-1)])*(q[2*(g+u)+1]+q[2*(g+u-1)+1]);return n}function c(q,g,l,n,u){let t=0;for(;l<n;l+=3){const m=2*(q.getValue(l)-u),w=2*(q.getValue(l+1)-u),v=2*(q.getValue(l+2)-u);t+=Math.abs((g[m]-g[v])*(g[w+1]-g[m+1])-(g[m]-g[w])*(g[v+1]-g[m+1]))}return t}function b(q,g,l,n,u,t,m,w){u=((q-u)*(t-w)-(g-w)*(u-m))/((q-l)*(t-w)-(g-n)*(u-m));return 0>u||1<u?null:{x:Math.round(q+u*(l-q)),y:Math.round(g+u*(n-g))}}const e=new a,f=new k.TileClipper(0,0,0,1,0),r=new k.TileClipper(0,0,0,1,0);f.setExtent(B.TILE_SIZE);
r.setExtent(B.TILE_SIZE);x.area=d;x.clip=function(q,g,l=0){const n=-l;g+=l;let u=l=0,t=0;for(let w=0;w<q.lengths.length;w++){const v=q.lengths[w],C=t+v;let A=0,y=null;for(;l!==C;){let p=q.coords[2*l],z=q.coords[2*l++ +1],D=p<n||p>=g||z<n||z>=g;for(var m=D;l!==C&&D===m;)D||(q.coords[2*u]=p,q.coords[2*u++ +1]=z,A++),p=q.coords[2*l],z=q.coords[2*l++ +1],D=p<n||p>=g||z<n||z>=g;if(l===C){D?y&&(q.coords[2*u]=y.x,q.coords[2*u++ +1]=y.y,A++):(q.coords[2*u]=p,q.coords[2*u++ +1]=z,A++);continue}m=q.coords[2*
(l-2)];const G=q.coords[2*(l-2)+1];if(m=b(m,G,p,z,n,n,g,n)||b(m,G,p,z,g,n,g,g)||b(m,G,p,z,g,g,n,g)||b(m,G,p,z,n,n,n,g))q.coords[2*u]=m.x,q.coords[2*u++ +1]=m.y,A++,y||(y=m);D||(q.coords[2*u]=p,q.coords[2*u++ +1]=z,A++)}q.lengths[w]=A;t+=v}};x.clipLinesMarshall=function(q,g){r.setPixelMargin(g);const l=-g;g=B.TILE_SIZE+g;let n=[];var u=!1;let t=0;for(;t<q.length;){const m=[],w=q[t];r.reset(2);let [v,C]=w[0];if(u)r.moveTo(v,C);else{if(v<l||v>g||C<l||C>g){u=!0;continue}m.push({x:v,y:C})}let A=!1;const y=
w.length;for(let p=1;p<y;++p)if(v+=w[p][0],C+=w[p][1],u)r.lineTo(v,C);else{if(v<l||v>g||C<l||C>g){A=!0;break}m.push({x:v,y:C})}if(A)u=!0;else{if(u){if(u=r.resultWithStarts())for(const p of u)n.push(p)}else n.push({line:m,start:0});t++;u=!1}}n=n.filter(m=>1<m.line.length);return 0===n.length?null:n};x.clipMarshall=function(q,g){a:{var l=B.TILE_SIZE+128;var n=0;for(var u=0;u<q.lengths.length;u++){var t=q.lengths[u];for(var m=0;m<t;m++){const w=q.coords[2*(m+n)],v=q.coords[2*(m+n)+1];if(-128>w||w>l||
-128>v||v>l){l=!0;break a}}n+=t}l=!1}if(!l)return q;f.setPixelMargin(g);f.reset(3);g=0;for(l=0;l<q.lengths.length;l++){n=q.lengths[l];u=q.coords[2*(0+g)];t=q.coords[2*(0+g)+1];f.moveTo(u,t);for(m=1;m<n;m++)u=q.coords[2*(m+g)],t=q.coords[2*(m+g)+1],f.lineTo(u,t);f.close();g+=n}l=f.result(!1);if(!l)return null;q=[];g=[];for(const w of l){l=0;for(const v of w)g.push(v.x),g.push(v.y),l++;q.push(l)}return new E(q,g)};x.triangleArea=c;x.triangulate=function(q,g){const {coords:l,lengths:n,hasIndeterminateRingOrder:u}=
g;g=q.indexWriter();q=q.vertexCount();if(u)return!1;const t=g.length;let m=0;for(var w=0;w<n.length;){let A=w,y=n[w];w=d(l,m,y);for(var v=[];++A<n.length;){var C=n[A];const p=d(l,m+y,C);if(!(0<p))break;w+=p;v.push(m+y);y+=C}C=g.length;h.bufcut(g,l,m,m+y,v,2,q);v=c(g,l,C,g.length,q);w=Math.abs(w);if(1E-5<Math.abs((v-w)/Math.max(1E-7,w)))return g.seek(t),!1;w=A;m+=y}return!0};x.triangulateEarcut=function(q,g,l){const {coords:n,lengths:u,hasIndeterminateRingOrder:t}=g;if(t)return!1;let m=0;for(var w=
0;w<u.length;){let C=w,A=u[w];for(w=[];++C<u.length;){var v=u[C];if(!(0<d(n,m+A,v)))break;w.push(m+A-m);A+=v}v=g.coords.slice(2*m,2*(m+A));w=F.earcut(v,w,2);for(const y of w)q.push(y+l+m);w=C;m+=A}return!0};x.triangulateLibtess=function(q,g){const l=[],n=[],u=q.indexWriter();q=q.vertexCount();const {coords:t,lengths:m}=g;e.beginPolygon(l,n);let w=0;for(let v=0;v<m.length;v++){const C=g.lengths[v];e.beginContour();for(let A=0;A<C;A++){const y=[t[2*(w+A)],t[2*(w+A)+1],0];e.addVertex(y,y)}e.endContour();
w+=C}e.endPolygon();for(g=0;g<n.length;g++)u.push(n[g]+q);return l};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/chunks/earcut":function(){define(["exports"],function(x){var F={exports:{}};(function(E){(function(B){B=B();void 0!==B&&(E.exports=B)})(function(){function B(p,z,D){D=D||2;var G=z&&z.length,I=G?z[0]*D:p.length,K=k(p,0,I,D,!0),N=[];if(!K||K.next===K.prev)return N;var L;if(G){var M=K;var O=D;K=[];var H;G=0;for(H=z.length;G<H;G++){var J=z[G]*O;var P=G<H-1?z[G+1]*O:p.length;J=
k(p,J,P,O,!1);J===J.next&&(J.steiner=!0);K.push(r(J))}K.sort(c);for(G=0;G<K.length;G++)O=K[G],z=M,(M=b(O,z))?(O=w(M,O),H=h(M,M.next),h(O,O.next),M=z===M?H:z):M=z,M=h(M,M.next);K=M}if(p.length>80*D){var Q=L=p[0];var U=G=p[1];for(O=D;O<I;O+=D)z=p[O],M=p[O+1],z<Q&&(Q=z),M<U&&(U=M),z>L&&(L=z),M>G&&(G=M);L=Math.max(L-Q,G-U);L=0!==L?1/L:0}a(K,N,D,Q,U,L);return N}function k(p,z,D,G,I){if(I===0<y(p,z,D,G))for(I=z;I<D;I+=G)var K=v(I,p[I],p[I+1],K);else for(I=D-G;I>=z;I-=G)K=v(I,p[I],p[I+1],K);K&&l(K,K.next)&&
(C(K),K=K.next);return K}function h(p,z){if(!p)return p;z||(z=p);do{var D=!1;if(p.steiner||!l(p,p.next)&&0!==g(p.prev,p,p.next))p=p.next;else{C(p);p=z=p.prev;if(p===p.next)break;D=!0}}while(D||p!==z);return z}function a(p,z,D,G,I,K,N){if(p){!N&&K&&e(p,G,I,K);for(var L=p,M,O;p.prev!==p.next;){M=p.prev;O=p.next;if(K)var H=d(p,G,I,K);else a:{H=p;var J=H.prev,P=H,Q=H.next;if(0<=g(J,P,Q))H=!1;else{for(var U=H.next.next;U!==H.prev;){if(q(J.x,J.y,P.x,P.y,Q.x,Q.y,U.x,U.y)&&0<=g(U.prev,U,U.next)){H=!1;break a}U=
U.next}H=!0}}if(H)z.push(M.i/D),z.push(p.i/D),z.push(O.i/D),C(p),L=p=O.next;else if(p=O,p===L){if(!N)a(h(p),z,D,G,I,K,1);else if(1===N){p=h(p);N=z;L=D;M=p;do O=M.prev,H=M.next.next,!l(O,H)&&n(O,M,M.next,H)&&m(O,H)&&m(H,O)&&(N.push(O.i/L),N.push(M.i/L),N.push(H.i/L),C(M),C(M.next),M=p=H),M=M.next;while(M!==p);p=h(M);a(p,z,D,G,I,K,2)}else if(2===N)a:{N=p;do{for(L=N.next.next;L!==N.prev;){if(M=N.i!==L.i){H=H=H=H=void 0;M=N;O=L;if(H=M.next.i!==O.i&&M.prev.i!==O.i){b:{H=M;do{if(H.i!==M.i&&H.next.i!==M.i&&
H.i!==O.i&&H.next.i!==O.i&&n(H,H.next,M,O)){H=!0;break b}H=H.next}while(H!==M);H=!1}H=!H}if(H){if(H=m(M,O)&&m(O,M)){H=M;J=!1;P=(M.x+O.x)/2;Q=(M.y+O.y)/2;do H.y>Q!==H.next.y>Q&&H.next.y!==H.y&&P<(H.next.x-H.x)*(Q-H.y)/(H.next.y-H.y)+H.x&&(J=!J),H=H.next;while(H!==M);H=J}H=H&&(g(M.prev,M,O.prev)||g(M,O.prev,O))||l(M,O)&&0<g(M.prev,M,M.next)&&0<g(O.prev,O,O.next)}M=H}if(M){p=w(N,L);N=h(N,N.next);p=h(p,p.next);a(N,z,D,G,I,K);a(p,z,D,G,I,K);break a}L=L.next}N=N.next}while(N!==p)}break}}}}function d(p,
z,D,G){var I=p.prev,K=p.next;if(0<=g(I,p,K))return!1;var N=I.x>p.x?I.x>K.x?I.x:K.x:p.x>K.x?p.x:K.x,L=I.y>p.y?I.y>K.y?I.y:K.y:p.y>K.y?p.y:K.y,M=f(I.x<p.x?I.x<K.x?I.x:K.x:p.x<K.x?p.x:K.x,I.y<p.y?I.y<K.y?I.y:K.y:p.y<K.y?p.y:K.y,z,D,G);z=f(N,L,z,D,G);D=p.prevZ;for(G=p.nextZ;D&&D.z>=M&&G&&G.z<=z;){if(D!==p.prev&&D!==p.next&&q(I.x,I.y,p.x,p.y,K.x,K.y,D.x,D.y)&&0<=g(D.prev,D,D.next))return!1;D=D.prevZ;if(G!==p.prev&&G!==p.next&&q(I.x,I.y,p.x,p.y,K.x,K.y,G.x,G.y)&&0<=g(G.prev,G,G.next))return!1;G=G.nextZ}for(;D&&
D.z>=M;){if(D!==p.prev&&D!==p.next&&q(I.x,I.y,p.x,p.y,K.x,K.y,D.x,D.y)&&0<=g(D.prev,D,D.next))return!1;D=D.prevZ}for(;G&&G.z<=z;){if(G!==p.prev&&G!==p.next&&q(I.x,I.y,p.x,p.y,K.x,K.y,G.x,G.y)&&0<=g(G.prev,G,G.next))return!1;G=G.nextZ}return!0}function c(p,z){return p.x-z.x}function b(p,z){var D=z,G=p.x,I=p.y,K=-Infinity;do{if(I<=D.y&&I>=D.next.y&&D.next.y!==D.y){var N=D.x+(I-D.y)*(D.next.x-D.x)/(D.next.y-D.y);if(N<=G&&N>K){K=N;if(N===G){if(I===D.y)return D;if(I===D.next.y)return D.next}var L=D.x<
D.next.x?D:D.next}}D=D.next}while(D!==z);if(!L)return null;if(G===K)return L;z=L;N=L.x;var M=L.y,O=Infinity;D=L;do{if(G>=D.x&&D.x>=N&&G!==D.x&&q(I<M?G:K,I,N,M,I<M?K:G,I,D.x,D.y)){var H=Math.abs(I-D.y)/(G-D.x);var J;if((J=m(D,p))&&!(J=H<O)&&(J=H===O)&&!(J=D.x>L.x)&&(J=D.x===L.x)){J=L;var P=D;J=0>g(J.prev,J,P.prev)&&0>g(P.next,J,J.next)}J&&(L=D,O=H)}D=D.next}while(D!==z);return L}function e(p,z,D,G){var I=p;do{null===I.z&&(I.z=f(I.x,I.y,z,D,G));if(I.prev.next!==I||I.next.prev!==I)return I.prev.next=
I,I.next.prev=I,e(p,z,D,G);I.prevZ=I.prev;I=I.nextZ=I.next}while(I!==p);I.prevZ.nextZ=null;I.prevZ=null;p=I;var K,N,L,M=1;do{z=p;G=p=null;for(I=0;z;){I++;D=z;for(K=N=0;K<M&&(N++,D=D.nextZ,D);K++);for(L=M;0<N||0<L&&D;)0!==N&&(0===L||!D||z.z<=D.z)?(K=z,z=z.nextZ,N--):(K=D,D=D.nextZ,L--),G?G.nextZ=K:p=K,K.prevZ=G,G=K;z=D}G.nextZ=null;M*=2}while(1<I)}function f(p,z,D,G,I){p=32767*(p-D)*I;z=32767*(z-G)*I;p=(p|p<<8)&16711935;p=(p|p<<4)&252645135;p=(p|p<<2)&858993459;z=(z|z<<8)&16711935;z=(z|z<<4)&252645135;
z=(z|z<<2)&858993459;return(p|p<<1)&1431655765|((z|z<<1)&1431655765)<<1}function r(p){var z=p,D=p;do{if(z.x<D.x||z.x===D.x&&z.y<D.y)D=z;z=z.next}while(z!==p);return D}function q(p,z,D,G,I,K,N,L){return 0<=(I-N)*(z-L)-(p-N)*(K-L)&&0<=(p-N)*(G-L)-(D-N)*(z-L)&&0<=(D-N)*(K-L)-(I-N)*(G-L)}function g(p,z,D){return(z.y-p.y)*(D.x-z.x)-(z.x-p.x)*(D.y-z.y)}function l(p,z){return p.x===z.x&&p.y===z.y}function n(p,z,D,G){var I=t(g(p,z,D)),K=t(g(p,z,G)),N=t(g(D,G,p)),L=t(g(D,G,z));return I!==K&&N!==L||0===I&&
u(p,D,z)||0===K&&u(p,G,z)||0===N&&u(D,p,G)||0===L&&u(D,z,G)?!0:!1}function u(p,z,D){return z.x<=Math.max(p.x,D.x)&&z.x>=Math.min(p.x,D.x)&&z.y<=Math.max(p.y,D.y)&&z.y>=Math.min(p.y,D.y)}function t(p){return 0<p?1:0>p?-1:0}function m(p,z){return 0>g(p.prev,p,p.next)?0<=g(p,z,p.next)&&0<=g(p,p.prev,z):0>g(p,z,p.prev)||0>g(p,p.next,z)}function w(p,z){var D=new A(p.i,p.x,p.y),G=new A(z.i,z.x,z.y),I=p.next,K=z.prev;p.next=z;z.prev=p;D.next=I;I.prev=D;G.next=D;D.prev=G;K.next=G;G.prev=K;return G}function v(p,
z,D,G){p=new A(p,z,D);G?(p.next=G.next,p.prev=G,G.next.prev=p,G.next=p):(p.prev=p,p.next=p);return p}function C(p){p.next.prev=p.prev;p.prev.next=p.next;p.prevZ&&(p.prevZ.nextZ=p.nextZ);p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function A(p,z,D){this.i=p;this.x=z;this.y=D;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function y(p,z,D,G){for(var I=0,K=D-G;z<D;z+=G)I+=(p[K]-p[z])*(p[z+1]+p[K+1]),K=z;return I}B.deviation=function(p,z,D,G){var I=z&&z.length,K=Math.abs(y(p,0,I?z[0]*D:p.length,
D));if(I){I=0;for(var N=z.length;I<N;I++)K-=Math.abs(y(p,z[I]*D,I<N-1?z[I+1]*D:p.length,D))}for(I=z=0;I<G.length;I+=3){N=G[I]*D;var L=G[I+1]*D,M=G[I+2]*D;z+=Math.abs((p[N]-p[M])*(p[L+1]-p[N+1])-(p[N]-p[L])*(p[M+1]-p[N+1]))}return 0===K&&0===z?0:Math.abs((z-K)/K)};B.flatten=function(p){for(var z=p[0][0].length,D={vertices:[],holes:[],dimensions:z},G=0,I=0;I<p.length;I++){for(var K=0;K<p[I].length;K++)for(var N=0;N<z;N++)D.vertices.push(p[I][K][N]);0<I&&(G+=p[I-1].length,D.holes.push(G))}return D};
return B})})(F);x.earcut=F.exports})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./definitions","./Geometry","./GeometryUtils"],function(x,F,E,B,k){let h=function(b,e,f){this.ratio=b;this.x=e;this.y=f},a=function(){function b(f,r,q,g=8,l=8){this.lines=[];this.starts=[];this.validateTessellation=!0;this.pixelRatio=g;this.pixelMargin=l;this.tileSize=E.TILE_SIZE*g;this.dz=f;this.yPos=r;this.xPos=q}var e=b.prototype;e.setPixelMargin=
function(f){f!==this.pixelMargin&&(this.pixelMargin=f,this.setExtent(this._extent))};e.setExtent=function(f){this._extent=f;this.finalRatio=this.tileSize/f*(1<<this.dz);let r=this.pixelRatio*this.pixelMargin;r/=this.finalRatio;f>>=this.dz;r>f&&(r=f);this.margin=r;this.xmin=f*this.xPos-r;this.ymin=f*this.yPos-r;this.xmax=this.xmin+f+2*r;this.ymax=this.ymin+f+2*r};e.reset=function(f){this.type=f;this.lines=[];this.starts=[];this.line=null;this.start=0};e.moveTo=function(f,r){this._pushLine();this._prevIsIn=
this._isIn(f,r);this._moveTo(f,r,this._prevIsIn);this._prevPt=new B.Point(f,r);this._firstPt=new B.Point(f,r);this._dist=0};e.lineTo=function(f,r){const q=this._isIn(f,r),g=new B.Point(f,r),l=B.Point.distance(this._prevPt,g);if(q)if(this._prevIsIn)this._lineTo(f,r,!0);else{var n=this._prevPt;var u=g;f=this._intersect(u,n);this.start=this._dist+l*(1-this._r);this._lineTo(f.x,f.y,!0);this._lineTo(u.x,u.y,!0)}else if(this._prevIsIn)u=this._prevPt,n=g,f=this._intersect(u,n),this._lineTo(f.x,f.y,!0),this._lineTo(n.x,
n.y,!1);else{const m=this._prevPt;if(!(m.x<=this.xmin&&g.x<=this.xmin||m.x>=this.xmax&&g.x>=this.xmax||m.y<=this.ymin&&g.y<=this.ymin||m.y>=this.ymax&&g.y>=this.ymax)){f=[];if(m.x<this.xmin&&g.x>this.xmin||m.x>this.xmin&&g.x<this.xmin){r=(this.xmin-m.x)/(g.x-m.x);var t=m.y+r*(g.y-m.y);t<=this.ymin?u=!1:t>=this.ymax?u=!0:f.push(new h(r,this.xmin,t))}if(m.x<this.xmax&&g.x>this.xmax||m.x>this.xmax&&g.x<this.xmax)r=(this.xmax-m.x)/(g.x-m.x),t=m.y+r*(g.y-m.y),t<=this.ymin?u=!1:t>=this.ymax?u=!0:f.push(new h(r,
this.xmax,t));if(m.y<this.ymin&&g.y>this.ymin||m.y>this.ymin&&g.y<this.ymin)r=(this.ymin-m.y)/(g.y-m.y),t=m.x+r*(g.x-m.x),t<=this.xmin?n=!1:t>=this.xmax?n=!0:f.push(new h(r,t,this.ymin));if(m.y<this.ymax&&g.y>this.ymax||m.y>this.ymax&&g.y<this.ymax)r=(this.ymax-m.y)/(g.y-m.y),t=m.x+r*(g.x-m.x),t<=this.xmin?n=!1:t>=this.xmax?n=!0:f.push(new h(r,t,this.ymax));if(0===f.length)n?u?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):u?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,
this.ymin,!0);else if(1<f.length&&f[0].ratio>f[1].ratio)this.start=this._dist+l*f[1].ratio,this._lineTo(f[1].x,f[1].y,!0),this._lineTo(f[0].x,f[0].y,!0);else for(this.start=this._dist+l*f[0].ratio,n=0;n<f.length;n++)this._lineTo(f[n].x,f[n].y,!0)}this._lineTo(g.x,g.y,!1)}this._dist+=l;this._prevIsIn=q;this._prevPt=g};e.close=function(){if(2<this.line.length){var f=this._firstPt,r=this._prevPt;f.x===r.x&&f.y===r.y||this.lineTo(f.x,f.y);f=this.line;for(r=f.length;4<=r;)if(f[0].x===f[1].x&&f[0].x===
f[r-2].x||f[0].y===f[1].y&&f[0].y===f[r-2].y)f.pop(),f[0].x=f[r-2].x,f[0].y=f[r-2].y,--r;else break}};e.result=function(f=!0){this._pushLine();if(0===this.lines.length)return null;3===this.type&&f&&c.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};e.resultWithStarts=function(){if(2!==this.type)throw Error("Only valid for lines");this._pushLine();const f=this.lines,r=f.length;if(0===r)return null;const q=[];for(let g=0;g<r;g++)q.push({line:f[g],start:this.starts[g]||
0});return q};e._isIn=function(f,r){return f>=this.xmin&&f<=this.xmax&&r>=this.ymin&&r<=this.ymax};e._intersect=function(f,r){let q,g,l;if(r.x>=this.xmin&&r.x<=this.xmax)g=r.y<=this.ymin?this.ymin:this.ymax,l=(g-f.y)/(r.y-f.y),q=f.x+l*(r.x-f.x);else if(r.y>=this.ymin&&r.y<=this.ymax)q=r.x<=this.xmin?this.xmin:this.xmax,l=(q-f.x)/(r.x-f.x),g=f.y+l*(r.y-f.y);else{g=r.y<=this.ymin?this.ymin:this.ymax;q=r.x<=this.xmin?this.xmin:this.xmax;const n=(q-f.x)/(r.x-f.x),u=(g-f.y)/(r.y-f.y);n<u?(l=n,g=f.y+n*
(r.y-f.y)):(l=u,q=f.x+u*(r.x-f.x))}this._r=l;return new B.Point(q,g)};e._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};e._moveTo=function(f,r,q){3!==this.type?q&&(f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),
r=Math.round((r-(this.ymin+this.margin))*this.finalRatio),this.line.push(new B.Point(f,r))):(q||(f<this.xmin&&(f=this.xmin),f>this.xmax&&(f=this.xmax),r<this.ymin&&(r=this.ymin),r>this.ymax&&(r=this.ymax)),f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),r=Math.round((r-(this.ymin+this.margin))*this.finalRatio),this.line.push(new B.Point(f,r)),this._is_v=this._is_h=!1)};e._lineTo=function(f,r,q){if(3!==this.type)if(q){f=Math.round((f-(this.xmin+this.margin))*this.finalRatio);r=Math.round((r-
(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(q=this.line[this.line.length-1],q.equals(f,r)))return;this.line.push(new B.Point(f,r))}else this.line&&0<this.line.length&&this._pushLine();else if(q||(f<this.xmin&&(f=this.xmin),f>this.xmax&&(f=this.xmax),r<this.ymin&&(r=this.ymin),r>this.ymax&&(r=this.ymax)),f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),r=Math.round((r-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){q=this.line[this.line.length-
1];const g=q.x===f,l=q.y===r;g&&l||(this._is_h&&g?(q.x=f,q.y=r,q=this.line[this.line.length-2],q.x===f&&q.y===r?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(q=this.line[this.line.length-2],this._is_h=q.x===f,this._is_v=q.y===r)):(this._is_h=q.x===f,this._is_v=q.y===r)):this._is_v&&l?(q.x=f,q.y=r,q=this.line[this.line.length-2],q.x===f&&q.y===r?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(q=this.line[this.line.length-2],this._is_h=q.x===f,this._is_v=q.y===r)):(this._is_h=
q.x===f,this._is_v=q.y===r)):(this.line.push(new B.Point(f,r)),this._is_h=g,this._is_v=l))}else this.line.push(new B.Point(f,r))};return b}(),d=function(){function b(){}var e=b.prototype;e.setExtent=function(f){this._ratio=4096===f?1:4096/f};e.reset=function(f){this.lines=[];this.line=null};e.moveTo=function(f,r){this.line&&this.lines.push(this.line);this.line=[];const q=this._ratio;this.line.push(new B.Point(f*q,r*q))};e.lineTo=function(f,r){const q=this._ratio;this.line.push(new B.Point(f*q,r*q))};
e.close=function(){const f=this.line;f&&!f[0].isEqual(f[f.length-1])&&f.push(f[0])};e.result=function(){this.line&&this.lines.push(this.line);return 0===this.lines.length?null:this.lines};F._createClass(b,[{key:"validateTessellation",get:function(){return 1>this._ratio}}]);return b}(),c=function(){function b(){}b.simplify=function(e,f,r){if(r){var q=-f,g=e+f,l=-f,n=e+f;e=[];f=[];var u=r.length;for(let t=0;t<u;++t){const m=r[t];if(!m||2>m.length)continue;let w=m[0],v;const C=m.length;for(let A=1;A<
C;++A)v=m[A],w.x===v.x&&(w.x<=q&&(w.y>v.y?(e.push(t),e.push(A),e.push(0),e.push(-1)):(f.push(t),f.push(A),f.push(0),f.push(-1))),w.x>=g&&(w.y<v.y?(e.push(t),e.push(A),e.push(1),e.push(-1)):(f.push(t),f.push(A),f.push(1),f.push(-1)))),w.y===v.y&&(w.y<=l&&(w.x<v.x?(e.push(t),e.push(A),e.push(2),e.push(-1)):(f.push(t),f.push(A),f.push(2),f.push(-1))),w.y>=n&&(w.x>v.x?(e.push(t),e.push(A),e.push(3),e.push(-1)):(f.push(t),f.push(A),f.push(3),f.push(-1)))),w=v}0!==e.length&&0!==f.length&&(b.fillParent(r,
f,e),b.fillParent(r,e,f),q=[],b.calcDeltas(q,f,e),b.calcDeltas(q,e,f),b.addDeltas(q,r))}};b.fillParent=function(e,f,r){const q=r.length,g=f.length;for(let m=0;m<g;m+=4){var l=f[m],n=f[m+1];const w=f[m+2],v=e[l][n-1];l=e[l][n];n=8092;let C=-1;for(let A=0;A<q;A+=4){if(r[A+2]!==w)continue;var u=r[A];const y=r[A+1];var t=e[u][y-1];u=e[u][y];switch(w){case 0:case 1:k.between(v.y,t.y,u.y)&&k.between(l.y,t.y,u.y)&&(t=Math.abs(u.y-t.y),t<n&&(n=t,C=A));break;case 2:case 3:k.between(v.x,t.x,u.x)&&k.between(l.x,
t.x,u.x)&&(t=Math.abs(u.x-t.x),t<n&&(n=t,C=A))}}f[m+3]=C}};b.calcDeltas=function(e,f,r){const q=f.length;for(let g=0;g<q;g+=4){const l=b.calcDelta(g,f,r,[]);e.push(f[g]);e.push(f[g+1]);e.push(f[g+2]);e.push(l)}};b.calcDelta=function(e,f,r,q){e=f[e+3];if(-1===e)return 0;const g=q.length;if(1<g&&q[g-2]===e)return 0;q.push(e);return b.calcDelta(e,r,f,q)+1};b.addDeltas=function(e,f){const r=e.length;let q=0;for(var g=0;g<r;g+=4){var l=e[g+3];l>q&&(q=l)}for(g=0;g<r;g+=4){l=f[e[g]];const n=e[g+1],u=q-e[g+
3];switch(e[g+2]){case 0:l[n-1].x-=u;l[n].x-=u;1===n&&(l[l.length-1].x-=u);n===l.length-1&&(l[0].x-=u);break;case 1:l[n-1].x+=u;l[n].x+=u;1===n&&(l[l.length-1].x+=u);n===l.length-1&&(l[0].x+=u);break;case 2:l[n-1].y-=u;l[n].y-=u;1===n&&(l[l.length-1].y-=u);n===l.length-1&&(l[0].y-=u);break;case 3:l[n-1].y+=u,l[n].y+=u,1===n&&(l[l.length-1].y+=u),n===l.length-1&&(l[0].y+=u)}}};return b}();x.SimpleBuilder=d;x.TileClipper=a;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Geometry":function(){define(["exports"],
function(x){let F=function(){function E(k,h){this.x=k;this.y=h}var B=E.prototype;B.clone=function(){return new E(this.x,this.y)};B.equals=function(k,h){return k===this.x&&h===this.y};B.isEqual=function(k){return k.x===this.x&&k.y===this.y};B.setCoords=function(k,h){this.x=k;this.y=h};B.normalize=function(){var k=this.x;const h=this.y;k=Math.sqrt(k*k+h*h);this.x/=k;this.y/=k};B.rightPerpendicular=function(){const k=this.x;this.x=this.y;this.y=-k};B.move=function(k,h){this.x+=k;this.y+=h};B.assign=
function(k){this.x=k.x;this.y=k.y};B.assignAdd=function(k,h){this.x=k.x+h.x;this.y=k.y+h.y};B.assignSub=function(k,h){this.x=k.x-h.x;this.y=k.y-h.y};B.rotate=function(k,h){const a=this.x,d=this.y;this.x=a*k-d*h;this.y=a*h+d*k};B.scale=function(k){this.x*=k;this.y*=k};B.length=function(){const k=this.x,h=this.y;return Math.sqrt(k*k+h*h)};E.distance=function(k,h){const a=h.x-k.x;k=h.y-k.y;return Math.sqrt(a*a+k*k)};E.add=function(k,h){return new E(k.x+h.x,k.y+h.y)};E.sub=function(k,h){return new E(k.x-
h.x,k.y-h.y)};return E}();x.Point=F;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(x){function F(v,C,A,y,p,z,D){let G;A=0;for(let I=y,K=p-z;I<p;I+=z)A+=(v[K+C*z]-v[I+C*z])*(v[I+1+C*z]+v[K+1+C*z]),K=I;if(D===0<A)for(;y<p;y+=z)G=h(y+C*z,v[y+C*z],v[y+1+C*z],G);else for(p-=z;p>=y;p-=z)G=h(p+C*z,v[p+C*z],v[p+1+C*z],G);G&&l(G,G.next)&&(a(G),G=G.next);return G}function E(v,C=v){if(!v)return v;let A;do if(A=!1,v.steiner||
!l(v,v.next)&&0!==e(v.prev,v,v.next))v=v.next;else{a(v);v=C=v.prev;if(v===v.next)break;A=!0}while(A||v!==C);return C}function B(v,C,A,y,p,z,D,G){if(v){!G&&z&&(v=b(v,y,p,z));for(var I=v;v.prev!==v.next;){var K=v.prev,N=v.next;if(z)var L=k(v,y,p,z);else a:{L=v;var M=L.prev,O=L;const H=L.next;if(0<=e(M,O,H)){L=!1;break a}let J=L.next.next;const P=J;let Q=0;for(;J!==L.prev&&(0===Q||J!==P);){Q++;if(r(M.x,M.y,O.x,O.y,H.x,H.y,J.x,J.y)&&0<=e(J.prev,J,J.next)){L=!1;break a}J=J.next}L=!0}if(L)C.push(K.index/
A+D),C.push(v.index/A+D),C.push(N.index/A+D),a(v),I=v=N.next;else if(v=N,v===I){if(!G)B(E(v),C,A,y,p,z,D,1);else if(1===G){G=C;I=A;K=D;N=v;do L=N.prev,M=N.next.next,!l(L,M)&&f(L,N,N.next,M)&&q(L,M)&&q(M,L)&&(G.push(L.index/I+K),G.push(N.index/I+K),G.push(M.index/I+K),a(N),a(N.next),N=v=M),N=N.next;while(N!==v);v=N;B(v,C,A,y,p,z,D,2)}else if(2===G)a:{G=v;do{for(I=G.next.next;I!==G.prev;){if(K=G.index!==I.index){L=L=L=void 0;K=G;N=I;if(L=K.next.index!==N.index&&K.prev.index!==N.index){b:{L=K;do{if(L.index!==
K.index&&L.next.index!==K.index&&L.index!==N.index&&L.next.index!==N.index&&f(L,L.next,K,N)){L=!0;break b}L=L.next}while(L!==K);L=!1}L=!L}if(L=L&&q(K,N)&&q(N,K)){L=K;M=!1;O=(K.x+N.x)/2;N=(K.y+N.y)/2;do L.y>N!==L.next.y>N&&L.next.y!==L.y&&O<(L.next.x-L.x)*(N-L.y)/(L.next.y-L.y)+L.x&&(M=!M),L=L.next;while(L!==K);L=M}K=L}if(K){v=u(G,I);G=E(G,G.next);v=E(v,v.next);B(G,C,A,y,p,z,D,0);B(v,C,A,y,p,z,D,0);break a}I=I.next}G=G.next}while(G!==v)}break}}}}function k(v,C,A,y){const p=v.prev,z=v.next;if(0<=e(p,
v,z))return!1;const D=p.x>v.x?p.x>z.x?p.x:z.x:v.x>z.x?v.x:z.x,G=p.y>v.y?p.y>z.y?p.y:z.y:v.y>z.y?v.y:z.y,I=g(p.x<v.x?p.x<z.x?p.x:z.x:v.x<z.x?v.x:z.x,p.y<v.y?p.y<z.y?p.y:z.y:v.y<z.y?v.y:z.y,C,A,y);C=g(D,G,C,A,y);A=v.prevZ;for(y=v.nextZ;A&&A.z>=I&&y&&y.z<=C;){if(A!==v.prev&&A!==v.next&&r(p.x,p.y,v.x,v.y,z.x,z.y,A.x,A.y)&&0<=e(A.prev,A,A.next))return!1;A=A.prevZ;if(y!==v.prev&&y!==v.next&&r(p.x,p.y,v.x,v.y,z.x,z.y,y.x,y.y)&&0<=e(y.prev,y,y.next))return!1;y=y.nextZ}for(;A&&A.z>=I;){if(A!==v.prev&&A!==
v.next&&r(p.x,p.y,v.x,v.y,z.x,z.y,A.x,A.y)&&0<=e(A.prev,A,A.next))return!1;A=A.prevZ}for(;y&&y.z<=C;){if(y!==v.prev&&y!==v.next&&r(p.x,p.y,v.x,v.y,z.x,z.y,y.x,y.y)&&0<=e(y.prev,y,y.next))return!1;y=y.nextZ}return!0}function h(v,C,A,y){v=t.create(v,C,A);y?(v.next=y.next,v.prev=y,y.next.prev=v,y.next=v):(v.prev=v,v.next=v);return v}function a(v){v.next.prev=v.prev;v.prev.next=v.next;v.prevZ&&(v.prevZ.nextZ=v.nextZ);v.nextZ&&(v.nextZ.prevZ=v.prevZ)}function d(v){let C=v,A=v;do{if(C.x<A.x||C.x===A.x&&
C.y<A.y)A=C;C=C.next}while(C!==v);return A}function c(v,C){let A=C;const y=v.x,p=v.y;let z=-Infinity,D;do{if(p<=A.y&&p>=A.next.y&&A.next.y!==A.y){var G=A.x+(p-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(G<=y&&G>z){z=G;if(G===y){if(p===A.y)return A;if(p===A.next.y)return A.next}D=A.x<A.next.x?A:A.next}}A=A.next}while(A!==C);if(!D)return null;if(y===z)return D.prev;C=D;G=D.x;const I=D.y;let K=Infinity,N;for(A=D.next;A!==C;)y>=A.x&&A.x>=G&&y!==A.x&&r(p<I?y:z,p,G,I,p<I?z:y,p,A.x,A.y)&&(N=Math.abs(p-A.y)/(y-
A.x),(N<K||N===K&&A.x>D.x)&&q(A,v)&&(D=A,K=N)),A=A.next;return D}function b(v,C,A,y){for(var p;p!==v;p=p.next){p=p||v;null===p.z&&(p.z=g(p.x,p.y,C,A,y));if(p.prev.next!==p||p.next.prev!==p)return p.prev.next=p,p.next.prev=p,b(v,C,A,y);p.prevZ=p.prev;p.nextZ=p.next}v.prevZ.nextZ=null;v.prevZ=null;a:for(A=1;;){y=v;C=v=null;let z=0;for(;y;){z++;p=y;let D=0;for(;D<A&&p;D++)p=p.nextZ;let G=A;for(;0<D||0<G&&p;){let I;0===D?(I=p,p=p.nextZ,G--):0!==G&&p?y.z<=p.z?(I=y,y=y.nextZ,D--):(I=p,p=p.nextZ,G--):(I=
y,y=y.nextZ,D--);C?C.nextZ=I:v=I;I.prevZ=C;C=I}y=p}C.nextZ=null;A*=2;if(2>z)break a}return v}function e(v,C,A){return(C.y-v.y)*(A.x-C.x)-(C.x-v.x)*(A.y-C.y)}function f(v,C,A,y){return l(v,C)&&l(A,y)||l(v,y)&&l(A,C)?!0:0<e(v,C,A)!==0<e(v,C,y)&&0<e(A,y,v)!==0<e(A,y,C)}function r(v,C,A,y,p,z,D,G){return 0<=(p-D)*(C-G)-(v-D)*(z-G)&&0<=(v-D)*(y-G)-(A-D)*(C-G)&&0<=(A-D)*(z-G)-(p-D)*(y-G)}function q(v,C){return 0>e(v.prev,v,v.next)?0<=e(v,C,v.next)&&0<=e(v,v.prev,C):0>e(v,C,v.prev)||0>e(v,v.next,C)}function g(v,
C,A,y,p){v=32767*(v-A)*p;C=32767*(C-y)*p;v=(v|v<<8)&16711935;v=(v|v<<4)&252645135;v=(v|v<<2)&858993459;C=(C|C<<8)&16711935;C=(C|C<<4)&252645135;C=(C|C<<2)&858993459;return(v|v<<1)&1431655765|((C|C<<1)&1431655765)<<1}function l(v,C){return v.x===C.x&&v.y===C.y}function n(v,C){return v.x-C.x}function u(v,C){const A=t.create(v.index,v.x,v.y),y=t.create(C.index,C.x,C.y),p=v.next,z=C.prev;v.next=C;C.prev=v;A.next=p;p.prev=A;y.next=A;A.prev=y;z.next=y;y.prev=z;return y}let t=function(){function v(){this.y=
this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}v.create=function(C,A,y){const p=w<m.length?m[w++]:new v;p.index=C;p.x=A;p.y=y;p.prev=null;p.next=null;p.z=null;p.prevZ=null;p.nextZ=null;p.steiner=!1;return p};return v}();const m=[];let w=0;for(let v=0;8096>v;v++)m.push(new t);x.bufcut=function(v,C,A,y,p,z,D){w=0;var G=(y-A)*z,I=p&&p.length;const K=I?(p[0]-A)*z:G;var N=F(C,A,y,0,K,z,!0);if(N&&N.next!==N.prev){var L;if(I){I=[];for(let J=0,P=p.length;J<P;J++){const Q=
F(C,A,y,p[J]*z,J<P-1?p[J+1]*z:y*z,z,!1);Q===Q.next&&(Q.steiner=!0);I.push(d(Q))}I.sort(n);for(var M of I){y=M;p=N;if(p=c(y,p))y=u(p,y),E(y,y.next);N=E(N,N.next)}}if(G>80*z){var O=G=C[A*z];var H=L=C[1+A*z];for(M=z;M<K;M+=z)y=C[M+A*z],p=C[M+1+A*z],O=Math.min(O,y),H=Math.min(H,p),G=Math.max(G,y),L=Math.max(L,p);L=Math.max(G-O,L-H);L=0!==L?1/L:0}B(N,v,z,O,H,L,D,0)}};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/Tesselator":function(){define(["../../../../../core/Logger"],
function(x){var F={exports:{}};(function(B){(function(k){k=k();void 0!==k&&(B.exports=k)})(function(){var k={DEBUG:!1,assert:function(h,a){if(k.DEBUG&&!h)throw Error("Assertion failed"+(a?": "+a:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,
GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,
GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},geom:{}};k.geom.vertEq=function(h,a){return h.s===a.s&&h.t===a.t};k.geom.vertLeq=function(h,a){return h.s<a.s||h.s===a.s&&h.t<=a.t};k.geom.edgeEval=function(h,a,d){k.assert(k.geom.vertLeq(h,a)&&k.geom.vertLeq(a,d));var c=a.s-h.s,b=d.s-a.s;return 0<c+b?c<b?a.t-h.t+c/(c+b)*(h.t-d.t):a.t-
d.t+b/(c+b)*(d.t-h.t):0};k.geom.edgeSign=function(h,a,d){k.assert(k.geom.vertLeq(h,a)&&k.geom.vertLeq(a,d));var c=a.s-h.s,b=d.s-a.s;return 0<c+b?(a.t-d.t)*c+(a.t-h.t)*b:0};k.geom.transLeq=function(h,a){return h.t<a.t||h.t===a.t&&h.s<=a.s};k.geom.transEval=function(h,a,d){k.assert(k.geom.transLeq(h,a)&&k.geom.transLeq(a,d));var c=a.t-h.t,b=d.t-a.t;return 0<c+b?c<b?a.s-h.s+c/(c+b)*(h.s-d.s):a.s-d.s+b/(c+b)*(d.s-h.s):0};k.geom.transSign=function(h,a,d){k.assert(k.geom.transLeq(h,a)&&k.geom.transLeq(a,
d));var c=a.t-h.t,b=d.t-a.t;return 0<c+b?(a.s-d.s)*c+(a.s-h.s)*b:0};k.geom.edgeGoesLeft=function(h){return k.geom.vertLeq(h.dst(),h.org)};k.geom.edgeGoesRight=function(h){return k.geom.vertLeq(h.org,h.dst())};k.geom.vertL1dist=function(h,a){return Math.abs(h.s-a.s)+Math.abs(h.t-a.t)};k.geom.vertCCW=function(h,a,d){return 0<=h.s*(a.t-d.t)+a.s*(d.t-h.t)+d.s*(h.t-a.t)};k.geom.interpolate_=function(h,a,d,c){h=0>h?0:h;d=0>d?0:d;return h<=d?0===d?(a+c)/2:a+h/(h+d)*(c-a):c+d/(h+d)*(a-c)};k.geom.edgeIntersect=
function(h,a,d,c,b){if(!k.geom.vertLeq(h,a)){var e=h;h=a;a=e}k.geom.vertLeq(d,c)||(e=d,d=c,c=e);k.geom.vertLeq(h,d)||(e=h,h=d,d=e,e=a,a=c,c=e);if(k.geom.vertLeq(d,a))if(k.geom.vertLeq(a,c)){e=k.geom.edgeEval(h,d,a);var f=k.geom.edgeEval(d,a,c);0>e+f&&(e=-e,f=-f);b.s=k.geom.interpolate_(e,d.s,f,a.s)}else e=k.geom.edgeSign(h,d,a),f=-k.geom.edgeSign(h,c,a),0>e+f&&(e=-e,f=-f),b.s=k.geom.interpolate_(e,d.s,f,c.s);else b.s=(d.s+a.s)/2;k.geom.transLeq(h,a)||(e=h,h=a,a=e);k.geom.transLeq(d,c)||(e=d,d=c,c=
e);k.geom.transLeq(h,d)||(e=h,h=d,d=e,e=a,a=c,c=e);k.geom.transLeq(d,a)?k.geom.transLeq(a,c)?(e=k.geom.transEval(h,d,a),f=k.geom.transEval(d,a,c),0>e+f&&(e=-e,f=-f),b.t=k.geom.interpolate_(e,d.t,f,a.t)):(e=k.geom.transSign(h,d,a),f=-k.geom.transSign(h,c,a),0>e+f&&(e=-e,f=-f),b.t=k.geom.interpolate_(e,d.t,f,c.t)):b.t=(d.t+a.t)/2};k.mesh={};k.mesh.makeEdge=function(h){var a=k.mesh.makeEdgePair_(h.eHead);k.mesh.makeVertex_(a,h.vHead);k.mesh.makeVertex_(a.sym,h.vHead);k.mesh.makeFace_(a,h.fHead);return a};
k.mesh.meshSplice=function(h,a){var d=!1,c=!1;h!==a&&(a.org!==h.org&&(c=!0,k.mesh.killVertex_(a.org,h.org)),a.lFace!==h.lFace&&(d=!0,k.mesh.killFace_(a.lFace,h.lFace)),k.mesh.splice_(a,h),c||(k.mesh.makeVertex_(a,h.org),h.org.anEdge=h),d||(k.mesh.makeFace_(a,h.lFace),h.lFace.anEdge=h))};k.mesh.deleteEdge=function(h){var a=h.sym,d=!1;h.lFace!==h.rFace()&&(d=!0,k.mesh.killFace_(h.lFace,h.rFace()));h.oNext===h?k.mesh.killVertex_(h.org,null):(h.rFace().anEdge=h.oPrev(),h.org.anEdge=h.oNext,k.mesh.splice_(h,
h.oPrev()),d||k.mesh.makeFace_(h,h.lFace));a.oNext===a?(k.mesh.killVertex_(a.org,null),k.mesh.killFace_(a.lFace,null)):(h.lFace.anEdge=a.oPrev(),a.org.anEdge=a.oNext,k.mesh.splice_(a,a.oPrev()));k.mesh.killEdge_(h)};k.mesh.addEdgeVertex=function(h){var a=k.mesh.makeEdgePair_(h),d=a.sym;k.mesh.splice_(a,h.lNext);a.org=h.dst();k.mesh.makeVertex_(d,a.org);a.lFace=d.lFace=h.lFace;return a};k.mesh.splitEdge=function(h){var a=k.mesh.addEdgeVertex(h).sym;k.mesh.splice_(h.sym,h.sym.oPrev());k.mesh.splice_(h.sym,
a);h.sym.org=a.org;a.dst().anEdge=a.sym;a.sym.lFace=h.rFace();a.winding=h.winding;a.sym.winding=h.sym.winding;return a};k.mesh.connect=function(h,a){var d=!1,c=k.mesh.makeEdgePair_(h),b=c.sym;a.lFace!==h.lFace&&(d=!0,k.mesh.killFace_(a.lFace,h.lFace));k.mesh.splice_(c,h.lNext);k.mesh.splice_(b,a);c.org=h.dst();b.org=a.org;c.lFace=b.lFace=h.lFace;h.lFace.anEdge=b;d||k.mesh.makeFace_(c,h.lFace);return c};k.mesh.zapFace=function(h){var a=h.anEdge,d=a.lNext;do{var c=d;d=c.lNext;c.lFace=null;if(null===
c.rFace()){c.oNext===c?k.mesh.killVertex_(c.org,null):(c.org.anEdge=c.oNext,k.mesh.splice_(c,c.oPrev()));var b=c.sym;b.oNext===b?k.mesh.killVertex_(b.org,null):(b.org.anEdge=b.oNext,k.mesh.splice_(b,b.oPrev()));k.mesh.killEdge_(c)}}while(c!==a);a=h.prev;h=h.next;h.prev=a;a.next=h};k.mesh.meshUnion=function(h,a){var d=h.fHead,c=h.vHead,b=h.eHead,e=a.fHead,f=a.vHead;a=a.eHead;e.next!==e&&(d.prev.next=e.next,e.next.prev=d.prev,e.prev.next=d,d.prev=e.prev);f.next!==f&&(c.prev.next=f.next,f.next.prev=
c.prev,f.prev.next=c,c.prev=f.prev);a.next!==a&&(b.sym.next.sym.next=a.next,a.next.sym.next=b.sym.next,a.sym.next.sym.next=b,b.sym.next=a.sym.next);return h};k.mesh.deleteMesh=function(h){};k.mesh.makeEdgePair_=function(h){var a=new k.GluHalfEdge,d=new k.GluHalfEdge,c=h.sym.next;d.next=c;c.sym.next=a;a.next=h;h.sym.next=d;a.sym=d;a.oNext=a;a.lNext=d;d.sym=a;d.oNext=d;return d.lNext=a};k.mesh.splice_=function(h,a){var d=h.oNext,c=a.oNext;d.sym.lNext=a;c.sym.lNext=h;h.oNext=c;a.oNext=d};k.mesh.makeVertex_=
function(h,a){var d=a.prev,c=new k.GluVertex(a,d);d.next=c;a.prev=c;a=c.anEdge=h;do a.org=c,a=a.oNext;while(a!==h)};k.mesh.makeFace_=function(h,a){var d=a.prev,c=new k.GluFace(a,d);d.next=c;a.prev=c;c.anEdge=h;c.inside=a.inside;a=h;do a.lFace=c,a=a.lNext;while(a!==h)};k.mesh.killEdge_=function(h){var a=h.next;h=h.sym.next;a.sym.next=h;h.sym.next=a};k.mesh.killVertex_=function(h,a){var d=h.anEdge,c=d;do c.org=a,c=c.oNext;while(c!==d);a=h.prev;h=h.next;h.prev=a;a.next=h};k.mesh.killFace_=function(h,
a){var d=h.anEdge,c=d;do c.lFace=a,c=c.lNext;while(c!==d);a=h.prev;h=h.next;h.prev=a;a.next=h};k.normal={};k.normal.S_UNIT_X_=1;k.normal.S_UNIT_Y_=0;k.normal.projectPolygon=function(h,a,d,c){var b=!1,e=[a,d,c];0===a&&0===d&&0===c&&(k.normal.computeNormal_(h,e),b=!0);d=k.normal.longAxis_(e);a=h.mesh.vHead;if(k.TRUE_PROJECT){k.normal.normalize_(e);c=[0,0,0];var f=[0,0,0];c[d]=0;c[(d+1)%3]=k.normal.S_UNIT_X_;c[(d+2)%3]=k.normal.S_UNIT_Y_;d=k.normal.dot_(c,e);c[0]-=d*e[0];c[1]-=d*e[1];c[2]-=d*e[2];k.normal.normalize_(c);
f[0]=e[1]*c[2]-e[2]*c[1];f[1]=e[2]*c[0]-e[0]*c[2];f[2]=e[0]*c[1]-e[1]*c[0];k.normal.normalize_(f);for(e=a.next;e!==a;e=e.next)e.s=k.normal.dot_(e.coords,c),e.t=k.normal.dot_(e.coords,f)}else for(c=(d+1)%3,f=(d+2)%3,d=0<e[d]?1:-1,e=a.next;e!==a;e=e.next)e.s=e.coords[c],e.t=d*e.coords[f];b&&k.normal.checkOrientation_(h)};k.normal.dot_=function(h,a){return h[0]*a[0]+h[1]*a[1]+h[2]*a[2]};k.normal.normalize_=function(h){var a=h[0]*h[0]+h[1]*h[1]+h[2]*h[2];k.assert(0<a);a=Math.sqrt(a);h[0]/=a;h[1]/=a;h[2]/=
a};k.normal.longAxis_=function(h){var a=0;Math.abs(h[1])>Math.abs(h[0])&&(a=1);Math.abs(h[2])>Math.abs(h[a])&&(a=2);return a};k.normal.computeNormal_=function(h,a){var d=[-2*k.GLU_TESS_MAX_COORD,-2*k.GLU_TESS_MAX_COORD,-2*k.GLU_TESS_MAX_COORD],c=[2*k.GLU_TESS_MAX_COORD,2*k.GLU_TESS_MAX_COORD,2*k.GLU_TESS_MAX_COORD],b=[],e=[],f;h=h.mesh.vHead;for(f=h.next;f!==h;f=f.next)for(var r=0;3>r;++r){var q=f.coords[r];q<c[r]&&(c[r]=q,e[r]=f);q>d[r]&&(d[r]=q,b[r]=f)}f=0;d[1]-c[1]>d[0]-c[0]&&(f=1);d[2]-c[2]>d[f]-
c[f]&&(f=2);if(c[f]>=d[f])a[0]=0,a[1]=0,a[2]=1;else{d=0;c=e[f];b=b[f];e=[0,0,0];c=[c.coords[0]-b.coords[0],c.coords[1]-b.coords[1],c.coords[2]-b.coords[2]];r=[0,0,0];for(f=h.next;f!==h;f=f.next)r[0]=f.coords[0]-b.coords[0],r[1]=f.coords[1]-b.coords[1],r[2]=f.coords[2]-b.coords[2],e[0]=c[1]*r[2]-c[2]*r[1],e[1]=c[2]*r[0]-c[0]*r[2],e[2]=c[0]*r[1]-c[1]*r[0],q=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],q>d&&(d=q,a[0]=e[0],a[1]=e[1],a[2]=e[2]);0>=d&&(a[0]=a[1]=a[2]=0,a[k.normal.longAxis_(c)]=1)}};k.normal.checkOrientation_=
function(h){for(var a=0,d=h.mesh.fHead,c=d.next;c!==d;c=c.next){var b=c.anEdge;if(!(0>=b.winding)){do a+=(b.org.s-b.dst().s)*(b.org.t+b.dst().t),b=b.lNext;while(b!==c.anEdge)}}if(0>a)for(h=h.mesh.vHead,a=h.next;a!==h;a=a.next)a.t=-a.t};k.render={};k.render.renderMesh=function(h,a,d){for(var c=!1,b=-1,e=a.fHead.prev;e!==a.fHead;e=e.prev)if(e.inside){c||(h.callBeginCallback(k.primitiveType.GL_TRIANGLES),c=!0);var f=e.anEdge;k.assert(f.lNext.lNext.lNext===f,"renderMesh called with non-triangulated mesh");
do{if(d){var r=f.rFace().inside?0:1;b!==r&&(b=r,h.callEdgeFlagCallback(!!b))}h.callVertexCallback(f.org.data);f=f.lNext}while(f!==e.anEdge)}c&&h.callEndCallback()};k.render.renderBoundary=function(h,a){for(var d=a.fHead.next;d!==a.fHead;d=d.next)if(d.inside){h.callBeginCallback(k.primitiveType.GL_LINE_LOOP);var c=d.anEdge;do h.callVertexCallback(c.org.data),c=c.lNext;while(c!==d.anEdge);h.callEndCallback()}};k.sweep={};k.sweep.SENTINEL_COORD_=4*k.GLU_TESS_MAX_COORD;k.sweep.TOLERANCE_NONZERO_=!1;k.sweep.computeInterior=
function(h){h.fatalError=!1;k.sweep.removeDegenerateEdges_(h);k.sweep.initPriorityQ_(h);k.sweep.initEdgeDict_(h);for(var a;null!==(a=h.pq.extractMin());){for(;;){var d=h.pq.minimum();if(null===d||!k.geom.vertEq(d,a))break;d=h.pq.extractMin();k.sweep.spliceMergeVertices_(h,a.anEdge,d.anEdge)}k.sweep.sweepEvent_(h,a)}a=h.dict.getMin().getKey();h.event=a.eUp.org;k.sweep.doneEdgeDict_(h);k.sweep.donePriorityQ_(h);k.sweep.removeDegenerateFaces_(h.mesh);h.mesh.checkMesh()};k.sweep.addWinding_=function(h,
a){h.winding+=a.winding;h.sym.winding+=a.sym.winding};k.sweep.edgeLeq_=function(h,a,d){h=h.event;a=a.eUp;d=d.eUp;if(a.dst()===h)return d.dst()===h?k.geom.vertLeq(a.org,d.org)?0>=k.geom.edgeSign(d.dst(),a.org,d.org):0<=k.geom.edgeSign(a.dst(),d.org,a.org):0>=k.geom.edgeSign(d.dst(),h,d.org);if(d.dst()===h)return 0<=k.geom.edgeSign(a.dst(),h,a.org);a=k.geom.edgeEval(a.dst(),h,a.org);h=k.geom.edgeEval(d.dst(),h,d.org);return a>=h};k.sweep.deleteRegion_=function(h,a){a.fixUpperEdge&&k.assert(0===a.eUp.winding);
a.eUp.activeRegion=null;h.dict.deleteNode(a.nodeUp);a.nodeUp=null};k.sweep.fixUpperEdge_=function(h,a){k.assert(h.fixUpperEdge);k.mesh.deleteEdge(h.eUp);h.fixUpperEdge=!1;h.eUp=a;a.activeRegion=h};k.sweep.topLeftRegion_=function(h){var a=h.eUp.org;do h=h.regionAbove();while(h.eUp.org===a);h.fixUpperEdge&&(a=k.mesh.connect(h.regionBelow().eUp.sym,h.eUp.lNext),k.sweep.fixUpperEdge_(h,a),h=h.regionAbove());return h};k.sweep.topRightRegion_=function(h){var a=h.eUp.dst();do h=h.regionAbove();while(h.eUp.dst()===
a);return h};k.sweep.addRegionBelow_=function(h,a,d){var c=new k.ActiveRegion;c.eUp=d;c.nodeUp=h.dict.insertBefore(a.nodeUp,c);return d.activeRegion=c};k.sweep.isWindingInside_=function(h,a){switch(h.windingRule){case k.windingRule.GLU_TESS_WINDING_ODD:return 0!==(a&1);case k.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==a;case k.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<a;case k.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>a;case k.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=a||-2>=
a}k.assert(!1);return!1};k.sweep.computeWinding_=function(h,a){a.windingNumber=a.regionAbove().windingNumber+a.eUp.winding;a.inside=k.sweep.isWindingInside_(h,a.windingNumber)};k.sweep.finishRegion_=function(h,a){var d=a.eUp,c=d.lFace;c.inside=a.inside;c.anEdge=d;k.sweep.deleteRegion_(h,a)};k.sweep.finishLeftRegions_=function(h,a,d){var c=a;for(a=a.eUp;c!==d;){c.fixUpperEdge=!1;var b=c.regionBelow(),e=b.eUp;if(e.org!==a.org){if(!b.fixUpperEdge){k.sweep.finishRegion_(h,c);break}e=k.mesh.connect(a.lPrev(),
e.sym);k.sweep.fixUpperEdge_(b,e)}a.oNext!==e&&(k.mesh.meshSplice(e.oPrev(),e),k.mesh.meshSplice(a,e));k.sweep.finishRegion_(h,c);a=b.eUp;c=b}return a};k.sweep.addRightEdges_=function(h,a,d,c,b,e){var f=!0;do k.assert(k.geom.vertLeq(d.org,d.dst())),k.sweep.addRegionBelow_(h,a,d.sym),d=d.oNext;while(d!==c);for(null===b&&(b=a.regionBelow().eUp.rPrev());;){c=a.regionBelow();d=c.eUp.sym;if(d.org!==b.org)break;d.oNext!==b&&(k.mesh.meshSplice(d.oPrev(),d),k.mesh.meshSplice(b.oPrev(),d));c.windingNumber=
a.windingNumber-d.winding;c.inside=k.sweep.isWindingInside_(h,c.windingNumber);a.dirty=!0;!f&&k.sweep.checkForRightSplice_(h,a)&&(k.sweep.addWinding_(d,b),k.sweep.deleteRegion_(h,a),k.mesh.deleteEdge(b));f=!1;a=c;b=d}a.dirty=!0;k.assert(a.windingNumber-d.winding===c.windingNumber);e&&k.sweep.walkDirtyRegions_(h,a)};k.sweep.callCombine_=function(h,a,d,c,b){var e=[a.coords[0],a.coords[1],a.coords[2]];a.data=null;a.data=h.callCombineCallback(e,d,c);null===a.data&&(b?h.fatalError||(h.callErrorCallback(k.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),
h.fatalError=!0):a.data=d[0])};k.sweep.spliceMergeVertices_=function(h,a,d){var c=[null,null,null,null];c[0]=a.org.data;c[1]=d.org.data;k.sweep.callCombine_(h,a.org,c,[.5,.5,0,0],!1);k.mesh.meshSplice(a,d)};k.sweep.vertexWeights_=function(h,a,d,c,b){var e=k.geom.vertL1dist(a,h),f=k.geom.vertL1dist(d,h),r=b+1;c[b]=.5*f/(e+f);c[r]=.5*e/(e+f);h.coords[0]+=c[b]*a.coords[0]+c[r]*d.coords[0];h.coords[1]+=c[b]*a.coords[1]+c[r]*d.coords[1];h.coords[2]+=c[b]*a.coords[2]+c[r]*d.coords[2]};k.sweep.getIntersectData_=
function(h,a,d,c,b,e){var f=[0,0,0,0],r=[d.data,c.data,b.data,e.data];a.coords[0]=a.coords[1]=a.coords[2]=0;k.sweep.vertexWeights_(a,d,c,f,0);k.sweep.vertexWeights_(a,b,e,f,2);k.sweep.callCombine_(h,a,r,f,!0)};k.sweep.checkForRightSplice_=function(h,a){var d=a.regionBelow(),c=a.eUp,b=d.eUp;if(k.geom.vertLeq(c.org,b.org)){if(0<k.geom.edgeSign(b.dst(),c.org,b.org))return!1;k.geom.vertEq(c.org,b.org)?c.org!==b.org&&(h.pq.remove(c.org.pqHandle),k.sweep.spliceMergeVertices_(h,b.oPrev(),c)):(k.mesh.splitEdge(b.sym),
k.mesh.meshSplice(c,b.oPrev()),a.dirty=d.dirty=!0)}else{if(0>k.geom.edgeSign(c.dst(),b.org,c.org))return!1;a.regionAbove().dirty=a.dirty=!0;k.mesh.splitEdge(c.sym);k.mesh.meshSplice(b.oPrev(),c)}return!0};k.sweep.checkForLeftSplice_=function(h,a){var d=a.regionBelow();h=a.eUp;var c=d.eUp;k.assert(!k.geom.vertEq(h.dst(),c.dst()));if(k.geom.vertLeq(h.dst(),c.dst())){if(0>k.geom.edgeSign(h.dst(),c.dst(),h.org))return!1;a.regionAbove().dirty=a.dirty=!0;d=k.mesh.splitEdge(h);k.mesh.meshSplice(c.sym,d);
d.lFace.inside=a.inside}else{if(0<k.geom.edgeSign(c.dst(),h.dst(),c.org))return!1;a.dirty=d.dirty=!0;d=k.mesh.splitEdge(c);k.mesh.meshSplice(h.lNext,c.sym);d.rFace().inside=a.inside}return!0};k.sweep.checkForIntersect_=function(h,a){var d=a.regionBelow(),c=a.eUp,b=d.eUp,e=c.org,f=b.org,r=c.dst(),q=b.dst(),g=new k.GluVertex;k.assert(!k.geom.vertEq(q,r));k.assert(0>=k.geom.edgeSign(r,h.event,e));k.assert(0<=k.geom.edgeSign(q,h.event,f));k.assert(e!==h.event&&f!==h.event);k.assert(!a.fixUpperEdge&&!d.fixUpperEdge);
if(e===f||Math.min(e.t,r.t)>Math.max(f.t,q.t))return!1;if(k.geom.vertLeq(e,f)){if(0<k.geom.edgeSign(q,e,f))return!1}else if(0>k.geom.edgeSign(r,f,e))return!1;k.geom.edgeIntersect(r,e,q,f,g);k.assert(Math.min(e.t,r.t)<=g.t);k.assert(g.t<=Math.max(f.t,q.t));k.assert(Math.min(q.s,r.s)<=g.s);k.assert(g.s<=Math.max(f.s,e.s));k.geom.vertLeq(g,h.event)&&(g.s=h.event.s,g.t=h.event.t);var l=k.geom.vertLeq(e,f)?e:f;k.geom.vertLeq(l,g)&&(g.s=l.s,g.t=l.t);if(k.geom.vertEq(g,e)||k.geom.vertEq(g,f))return k.sweep.checkForRightSplice_(h,
a),!1;if(!k.geom.vertEq(r,h.event)&&0<=k.geom.edgeSign(r,h.event,g)||!k.geom.vertEq(q,h.event)&&0>=k.geom.edgeSign(q,h.event,g)){if(q===h.event)return k.mesh.splitEdge(c.sym),k.mesh.meshSplice(b.sym,c),a=k.sweep.topLeftRegion_(a),c=a.regionBelow().eUp,k.sweep.finishLeftRegions_(h,a.regionBelow(),d),k.sweep.addRightEdges_(h,a,c.oPrev(),c,c,!0),!0;if(r===h.event)return k.mesh.splitEdge(b.sym),k.mesh.meshSplice(c.lNext,b.oPrev()),d=a,a=k.sweep.topRightRegion_(a),e=a.regionBelow().eUp.rPrev(),d.eUp=b.oPrev(),
b=k.sweep.finishLeftRegions_(h,d,null),k.sweep.addRightEdges_(h,a,b.oNext,c.rPrev(),e,!0),!0;0<=k.geom.edgeSign(r,h.event,g)&&(a.regionAbove().dirty=a.dirty=!0,k.mesh.splitEdge(c.sym),c.org.s=h.event.s,c.org.t=h.event.t);0>=k.geom.edgeSign(q,h.event,g)&&(a.dirty=d.dirty=!0,k.mesh.splitEdge(b.sym),b.org.s=h.event.s,b.org.t=h.event.t);return!1}k.mesh.splitEdge(c.sym);k.mesh.splitEdge(b.sym);k.mesh.meshSplice(b.oPrev(),c);c.org.s=g.s;c.org.t=g.t;c.org.pqHandle=h.pq.insert(c.org);k.sweep.getIntersectData_(h,
c.org,e,r,f,q);a.regionAbove().dirty=a.dirty=d.dirty=!0;return!1};k.sweep.walkDirtyRegions_=function(h,a){for(var d=a.regionBelow();;){for(;d.dirty;)a=d,d=d.regionBelow();if(!a.dirty&&(d=a,a=a.regionAbove(),null===a||!a.dirty))break;a.dirty=!1;var c=a.eUp,b=d.eUp;c.dst()!==b.dst()&&k.sweep.checkForLeftSplice_(h,a)&&(d.fixUpperEdge?(k.sweep.deleteRegion_(h,d),k.mesh.deleteEdge(b),d=a.regionBelow(),b=d.eUp):a.fixUpperEdge&&(k.sweep.deleteRegion_(h,a),k.mesh.deleteEdge(c),a=d.regionAbove(),c=a.eUp));
if(c.org!==b.org)if(c.dst()===b.dst()||a.fixUpperEdge||d.fixUpperEdge||c.dst()!==h.event&&b.dst()!==h.event)k.sweep.checkForRightSplice_(h,a);else if(k.sweep.checkForIntersect_(h,a))break;c.org===b.org&&c.dst()===b.dst()&&(k.sweep.addWinding_(b,c),k.sweep.deleteRegion_(h,a),k.mesh.deleteEdge(c),a=d.regionAbove())}};k.sweep.connectRightVertex_=function(h,a,d){var c=d.oNext,b=a.regionBelow(),e=a.eUp,f=b.eUp,r=!1;e.dst()!==f.dst()&&k.sweep.checkForIntersect_(h,a);k.geom.vertEq(e.org,h.event)&&(k.mesh.meshSplice(c.oPrev(),
e),a=k.sweep.topLeftRegion_(a),c=a.regionBelow().eUp,k.sweep.finishLeftRegions_(h,a.regionBelow(),b),r=!0);k.geom.vertEq(f.org,h.event)&&(k.mesh.meshSplice(d,f.oPrev()),d=k.sweep.finishLeftRegions_(h,b,null),r=!0);r?k.sweep.addRightEdges_(h,a,d.oNext,c,c,!0):(c=k.geom.vertLeq(f.org,e.org)?f.oPrev():e,c=k.mesh.connect(d.lPrev(),c),k.sweep.addRightEdges_(h,a,c,c.oNext,c.oNext,!1),c.sym.activeRegion.fixUpperEdge=!0,k.sweep.walkDirtyRegions_(h,a))};k.sweep.connectLeftDegenerate_=function(h,a,d){var c=
a.eUp;if(k.geom.vertEq(c.org,d))k.assert(k.sweep.TOLERANCE_NONZERO_),k.sweep.TOLERANCE_NONZERO_&&k.sweep.spliceMergeVertices_(h,c,d.anEdge);else if(k.geom.vertEq(c.dst(),d)){if(k.assert(k.sweep.TOLERANCE_NONZERO_),k.sweep.TOLERANCE_NONZERO_){a=k.sweep.topRightRegion_(a);c=a.regionBelow();var b=c.eUp.sym,e=b.oNext,f=e;c.fixUpperEdge&&(k.assert(e!==b),k.sweep.deleteRegion_(h,c),k.mesh.deleteEdge(b),b=e.oPrev());k.mesh.meshSplice(d.anEdge,b);k.geom.edgeGoesLeft(e)||(e=null);k.sweep.addRightEdges_(h,
a,b.oNext,f,e,!0)}}else k.mesh.splitEdge(c.sym),a.fixUpperEdge&&(k.mesh.deleteEdge(c.oNext),a.fixUpperEdge=!1),k.mesh.meshSplice(d.anEdge,c),k.sweep.sweepEvent_(h,d)};k.sweep.connectLeftVertex_=function(h,a){var d=new k.ActiveRegion;d.eUp=a.anEdge.sym;d=h.dict.search(d).getKey();var c=d.regionBelow(),b=d.eUp,e=c.eUp;0===k.geom.edgeSign(b.dst(),a,b.org)?k.sweep.connectLeftDegenerate_(h,d,a):(c=k.geom.vertLeq(e.dst(),b.dst())?d:c,d.inside||c.fixUpperEdge?(b=c===d?k.mesh.connect(a.anEdge.sym,b.lNext):
k.mesh.connect(e.dNext(),a.anEdge).sym,c.fixUpperEdge?k.sweep.fixUpperEdge_(c,b):k.sweep.computeWinding_(h,k.sweep.addRegionBelow_(h,d,b)),k.sweep.sweepEvent_(h,a)):k.sweep.addRightEdges_(h,d,a.anEdge,a.anEdge,null,!0))};k.sweep.sweepEvent_=function(h,a){h.event=a;for(var d=a.anEdge;null===d.activeRegion;)if(d=d.oNext,d===a.anEdge){k.sweep.connectLeftVertex_(h,a);return}a=k.sweep.topLeftRegion_(d.activeRegion);var c=a.regionBelow();d=c.eUp;c=k.sweep.finishLeftRegions_(h,c,null);c.oNext===d?k.sweep.connectRightVertex_(h,
a,c):k.sweep.addRightEdges_(h,a,c.oNext,d,d,!0)};k.sweep.addSentinel_=function(h,a){var d=new k.ActiveRegion,c=k.mesh.makeEdge(h.mesh);c.org.s=k.sweep.SENTINEL_COORD_;c.org.t=a;c.dst().s=-k.sweep.SENTINEL_COORD_;c.dst().t=a;h.event=c.dst();d.eUp=c;d.windingNumber=0;d.inside=!1;d.fixUpperEdge=!1;d.sentinel=!0;d.dirty=!1;d.nodeUp=h.dict.insert(d)};k.sweep.initEdgeDict_=function(h){h.dict=new k.Dict(h,k.sweep.edgeLeq_);k.sweep.addSentinel_(h,-k.sweep.SENTINEL_COORD_);k.sweep.addSentinel_(h,k.sweep.SENTINEL_COORD_)};
k.sweep.doneEdgeDict_=function(h){for(var a=0,d;null!==(d=h.dict.getMin().getKey());)d.sentinel||(k.assert(d.fixUpperEdge),k.assert(1===++a)),k.assert(0===d.windingNumber),k.sweep.deleteRegion_(h,d);h.dict=null};k.sweep.removeDegenerateEdges_=function(h){for(var a=h.mesh.eHead,d,c=a.next;c!==a;c=d){d=c.next;var b=c.lNext;k.geom.vertEq(c.org,c.dst())&&c.lNext.lNext!==c&&(k.sweep.spliceMergeVertices_(h,b,c),k.mesh.deleteEdge(c),c=b,b=c.lNext);if(b.lNext===c){if(b!==c){if(b===d||b===d.sym)d=d.next;k.mesh.deleteEdge(b)}if(c===
d||c===d.sym)d=d.next;k.mesh.deleteEdge(c)}}};k.sweep.initPriorityQ_=function(h){var a=new k.PriorityQ;h.pq=a;h=h.mesh.vHead;var d;for(d=h.next;d!==h;d=d.next)d.pqHandle=a.insert(d);a.init()};k.sweep.donePriorityQ_=function(h){h.pq.deleteQ();h.pq=null};k.sweep.removeDegenerateFaces_=function(h){for(var a,d=h.fHead.next;d!==h.fHead;d=a)a=d.next,d=d.anEdge,k.assert(d.lNext!==d),d.lNext.lNext===d&&(k.sweep.addWinding_(d.oNext,d),k.mesh.deleteEdge(d))};k.tessmono={};k.tessmono.tessellateMonoRegion_=function(h){h=
h.anEdge;for(k.assert(h.lNext!==h&&h.lNext.lNext!==h);k.geom.vertLeq(h.dst(),h.org);h=h.lPrev());for(;k.geom.vertLeq(h.org,h.dst());h=h.lNext);for(var a=h.lPrev(),d;h.lNext!==a;)if(k.geom.vertLeq(h.dst(),a.org)){for(;a.lNext!==h&&(k.geom.edgeGoesLeft(a.lNext)||0>=k.geom.edgeSign(a.org,a.dst(),a.lNext.dst()));)d=k.mesh.connect(a.lNext,a),a=d.sym;a=a.lPrev()}else{for(;a.lNext!==h&&(k.geom.edgeGoesRight(h.lPrev())||0<=k.geom.edgeSign(h.dst(),h.org,h.lPrev().org));)d=k.mesh.connect(h,h.lPrev()),h=d.sym;
h=h.lNext}for(k.assert(a.lNext!==h);a.lNext.lNext!==h;)d=k.mesh.connect(a.lNext,a),a=d.sym};k.tessmono.tessellateInterior=function(h){for(var a,d=h.fHead.next;d!==h.fHead;d=a)a=d.next,d.inside&&k.tessmono.tessellateMonoRegion_(d)};k.tessmono.discardExterior=function(h){for(var a,d=h.fHead.next;d!==h.fHead;d=a)a=d.next,d.inside||k.mesh.zapFace(d)};k.tessmono.setWindingNumber=function(h,a,d){for(var c,b=h.eHead.next;b!==h.eHead;b=c)c=b.next,b.rFace().inside!==b.lFace.inside?b.winding=b.lFace.inside?
a:-a:d?k.mesh.deleteEdge(b):b.winding=0};k.Dict=function(h,a){this.head_=new k.DictNode;this.frame_=h;this.leq_=a};k.Dict.prototype.deleteDict_=function(){};k.Dict.prototype.insertBefore=function(h,a){do h=h.prev;while(null!==h.key&&!this.leq_(this.frame_,h.key,a));a=new k.DictNode(a,h.next,h);h.next.prev=a;return h.next=a};k.Dict.prototype.insert=function(h){return this.insertBefore(this.head_,h)};k.Dict.prototype.deleteNode=function(h){h.next.prev=h.prev;h.prev.next=h.next};k.Dict.prototype.search=
function(h){var a=this.head_;do a=a.next;while(null!==a.key&&!this.leq_(this.frame_,h,a.key));return a};k.Dict.prototype.getMin=function(){return this.head_.next};k.Dict.prototype.getMax=function(){return this.head_.prev};k.DictNode=function(h,a,d){this.key=h||null;this.next=a||this;this.prev=d||this};k.DictNode.prototype.getKey=function(){return this.key};k.DictNode.prototype.getSuccessor=function(){return this.next};k.DictNode.prototype.getPredecessor=function(){return this.prev};k.GluTesselator=
function(){this.state_=k.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=k.windingRule.GLU_TESS_WINDING_ODD;this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};k.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};k.GluTesselator.prototype.gluDeleteTess=
function(){this.requireState_(k.GluTesselator.tessState_.T_DORMANT)};k.GluTesselator.prototype.gluTessProperty=function(h,a){switch(h){case k.gluEnum.GLU_TESS_TOLERANCE:return;case k.gluEnum.GLU_TESS_WINDING_RULE:switch(a){case k.windingRule.GLU_TESS_WINDING_ODD:case k.windingRule.GLU_TESS_WINDING_NONZERO:case k.windingRule.GLU_TESS_WINDING_POSITIVE:case k.windingRule.GLU_TESS_WINDING_NEGATIVE:case k.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=a;return}break;case k.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=
!!a;return;default:this.callErrorCallback(k.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(k.gluEnum.GLU_INVALID_VALUE)};k.GluTesselator.prototype.gluGetTessProperty=function(h){switch(h){case k.gluEnum.GLU_TESS_TOLERANCE:return 0;case k.gluEnum.GLU_TESS_WINDING_RULE:return h=this.windingRule,k.assert(h===k.windingRule.GLU_TESS_WINDING_ODD||h===k.windingRule.GLU_TESS_WINDING_NONZERO||h===k.windingRule.GLU_TESS_WINDING_POSITIVE||h===k.windingRule.GLU_TESS_WINDING_NEGATIVE||h===k.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),
h;case k.gluEnum.GLU_TESS_BOUNDARY_ONLY:return k.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(k.gluEnum.GLU_INVALID_ENUM)}return!1};k.GluTesselator.prototype.gluTessNormal=function(h,a,d){this.normal_[0]=h;this.normal_[1]=a;this.normal_[2]=d};k.GluTesselator.prototype.gluTessCallback=function(h,a){a=a?a:null;switch(h){case k.gluEnum.GLU_TESS_BEGIN:case k.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=a;break;case k.gluEnum.GLU_TESS_EDGE_FLAG:case k.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=
a;break;case k.gluEnum.GLU_TESS_VERTEX:case k.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=a;break;case k.gluEnum.GLU_TESS_END:case k.gluEnum.GLU_TESS_END_DATA:this.endCallback_=a;break;case k.gluEnum.GLU_TESS_ERROR:case k.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=a;break;case k.gluEnum.GLU_TESS_COMBINE:case k.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=a;break;case k.gluEnum.GLU_TESS_MESH:this.meshCallback_=a;break;default:this.callErrorCallback(k.gluEnum.GLU_INVALID_ENUM)}};k.GluTesselator.prototype.gluTessVertex=
function(h,a){var d=!1,c=[0,0,0];this.requireState_(k.GluTesselator.tessState_.T_IN_CONTOUR);for(var b=0;3>b;++b){var e=h[b];e<-k.GLU_TESS_MAX_COORD&&(e=-k.GLU_TESS_MAX_COORD,d=!0);e>k.GLU_TESS_MAX_COORD&&(e=k.GLU_TESS_MAX_COORD,d=!0);c[b]=e}d&&this.callErrorCallback(k.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(c,a)};k.GluTesselator.prototype.gluTessBeginPolygon=function(h){this.requireState_(k.GluTesselator.tessState_.T_DORMANT);this.state_=k.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=
new k.GluMesh;this.polygonData_=h};k.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(k.GluTesselator.tessState_.T_IN_POLYGON);this.state_=k.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};k.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(k.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=k.GluTesselator.tessState_.T_IN_POLYGON};k.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(k.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=k.GluTesselator.tessState_.T_DORMANT;k.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);k.sweep.computeInterior(this);if(!this.fatalError){var h=this.mesh;this.boundaryOnly_?k.tessmono.setWindingNumber(h,1,!0):k.tessmono.tessellateInterior(h);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?k.render.renderBoundary(this,this.mesh):k.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);
if(this.meshCallback_){k.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}k.mesh.deleteMesh(this.mesh);this.mesh=this.polygonData_=null};k.GluTesselator.prototype.requireState_=function(h){this.state_!==h&&this.gotoState_(h)};k.GluTesselator.prototype.gotoState_=function(h){for(;this.state_!==h;)if(this.state_<h)switch(this.state_){case k.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(k.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);
this.gluTessBeginPolygon(null);break;case k.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(k.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case k.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(k.errorType.GLU_TESS_MISSING_END_CONTOUR);this.gluTessEndContour();break;case k.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(k.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};k.GluTesselator.prototype.addVertex_=
function(h,a){var d=this.lastEdge_;null===d?(d=k.mesh.makeEdge(this.mesh),k.mesh.meshSplice(d,d.sym)):(k.mesh.splitEdge(d),d=d.lNext);d.org.data=a;d.org.coords[0]=h[0];d.org.coords[1]=h[1];d.org.coords[2]=h[2];d.winding=1;d.sym.winding=-1;this.lastEdge_=d};k.GluTesselator.prototype.callBeginCallback=function(h){this.beginCallback_&&this.beginCallback_(h,this.polygonData_)};k.GluTesselator.prototype.callVertexCallback=function(h){this.vertexCallback_&&this.vertexCallback_(h,this.polygonData_)};k.GluTesselator.prototype.callEdgeFlagCallback=
function(h){this.edgeFlagCallback_&&this.edgeFlagCallback_(h,this.polygonData_)};k.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};k.GluTesselator.prototype.callCombineCallback=function(h,a,d){return this.combineCallback_?this.combineCallback_(h,a,d,this.polygonData_)||null:null};k.GluTesselator.prototype.callErrorCallback=function(h){this.errorCallback_&&this.errorCallback_(h,this.polygonData_)};k.GluFace=function(h,a){this.next=h||this;
this.prev=a||this;this.anEdge=null;this.inside=!1};k.GluHalfEdge=function(h){this.next=h||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};k.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};k.GluHalfEdge.prototype.dst=function(){return this.sym.org};k.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};k.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};k.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};
k.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};k.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};k.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};k.GluMesh=function(){this.vHead=new k.GluVertex;this.fHead=new k.GluFace;this.eHead=new k.GluHalfEdge;this.eHeadSym=new k.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};k.GluMesh.prototype.checkMesh=function(){if(k.DEBUG){var h=this.fHead,a=this.vHead,d=this.eHead,c,b;for(c=c=h;(b=
c.next)!==h;c=b){k.assert(b.prev===c);c=b.anEdge;do k.assert(c.sym!==c),k.assert(c.sym.sym===c),k.assert(c.lNext.oNext.sym===c),k.assert(c.oNext.sym.lNext===c),k.assert(c.lFace===b),c=c.lNext;while(c!==b.anEdge)}k.assert(b.prev===c&&null===b.anEdge);for(c=c=a;(h=c.next)!==a;c=h){k.assert(h.prev===c);c=h.anEdge;do k.assert(c.sym!==c),k.assert(c.sym.sym===c),k.assert(c.lNext.oNext.sym===c),k.assert(c.oNext.sym.lNext===c),k.assert(c.org===h),c=c.oNext;while(c!==h.anEdge)}k.assert(h.prev===c&&null===
h.anEdge&&null===h.data);for(a=a=d;(c=a.next)!==d;a=c)k.assert(c.sym.next===a.sym),k.assert(c.sym!==c),k.assert(c.sym.sym===c),k.assert(null!==c.org),k.assert(null!==c.dst()),k.assert(c.lNext.oNext.sym===c),k.assert(c.oNext.sym.lNext===c);k.assert(c.sym.next===a.sym&&c.sym===this.eHeadSym&&c.sym.sym===c&&null===c.org&&null===c.dst()&&null===c.lFace&&null===c.rFace())}};k.GluVertex=function(h,a){this.next=h||this;this.prev=a||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=
this.s=0};k.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new k.PriorityQHeap};k.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};k.PriorityQ.prototype.init=function(){this.order_=[];for(var h=0;h<this.size_;h++)this.order_[h]=h;h=function(d){return function(c,b){return k.geom.vertLeq(d[c],d[b])?1:-1}}(this.verts_);this.order_.sort(h);this.initialized_=!0;this.heap_.init();if(k.DEBUG){var a=0+this.size_-1;for(h=0;h<
a;++h)k.assert(k.geom.vertLeq(this.verts_[this.order_[h+1]],this.verts_[this.order_[h]]))}};k.PriorityQ.prototype.insert=function(h){if(this.initialized_)return this.heap_.insert(h);var a=this.size_++;this.verts_[a]=h;return-(a+1)};k.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var h=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var a=this.heap_.minimum();if(k.geom.vertLeq(a,h))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&
null===this.verts_[this.order_[this.size_-1]]);return h};k.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var h=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var a=this.heap_.minimum();if(k.geom.vertLeq(a,h))return a}return h};k.PriorityQ.prototype.remove=function(h){if(0<=h)this.heap_.remove(h);else for(h=-(h+1),k.assert(h<this.verts_.length&&null!==this.verts_[h]),this.verts_[h]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-
1]];)--this.size_};k.PriorityQHeap=function(){this.heap_=k.PriorityQHeap.reallocNumeric_([0],k.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=k.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};k.PriorityQHeap.INIT_SIZE_=32;k.PriorityQHeap.reallocNumeric_=function(h,a){for(var d=Array(a),c=0;c<h.length;c++)d[c]=h[c];for(;c<a;c++)d[c]=0;return d};k.PriorityQHeap.prototype.init=function(){for(var h=this.size_;1<=h;--h)this.floatDown_(h);
this.initialized_=!0};k.PriorityQHeap.prototype.insert=function(h){var a=++this.size_;2*a>this.max_&&(this.max_*=2,this.handles_=k.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));if(0===this.freeList_)var d=a;else d=this.freeList_,this.freeList_=this.handles_[this.freeList_];this.verts_[d]=h;this.handles_[d]=a;this.heap_[a]=d;this.initialized_&&this.floatUp_(a);return d};k.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};k.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};
k.PriorityQHeap.prototype.extractMin=function(){var h=this.heap_,a=this.verts_,d=this.handles_,c=h[1],b=a[c];0<this.size_&&(h[1]=h[this.size_],d[h[1]]=1,a[c]=null,d[c]=this.freeList_,this.freeList_=c,0<--this.size_&&this.floatDown_(1));return b};k.PriorityQHeap.prototype.remove=function(h){var a=this.heap_,d=this.verts_,c=this.handles_;k.assert(1<=h&&h<=this.max_&&null!==d[h]);var b=c[h];a[b]=a[this.size_];c[a[b]]=b;b<=--this.size_&&(1>=b?this.floatDown_(b):k.geom.vertLeq(d[a[b>>1]],d[a[b]])?this.floatDown_(b):
this.floatUp_(b));d[h]=null;c[h]=this.freeList_;this.freeList_=h};k.PriorityQHeap.prototype.floatDown_=function(h){for(var a=this.heap_,d=this.verts_,c=this.handles_,b=a[h];;){var e=h<<1;e<this.size_&&k.geom.vertLeq(d[a[e+1]],d[a[e]])&&(e+=1);k.assert(e<=this.max_);var f=a[e];if(e>this.size_||k.geom.vertLeq(d[b],d[f])){a[h]=b;c[b]=h;break}a[h]=f;c[f]=h;h=e}};k.PriorityQHeap.prototype.floatUp_=function(h){for(var a=this.heap_,d=this.verts_,c=this.handles_,b=a[h];;){var e=h>>1,f=a[e];if(0===e||k.geom.vertLeq(d[f],
d[b])){a[h]=b;c[b]=h;break}a[h]=f;c[f]=h;h=e}};k.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};k.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};k.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return k})})(F);const E=x.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");return function(){function B(){this._indexCounter=
this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new F.exports.GluTesselator;this.glu.gluTessCallback(F.exports.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(F.exports.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(F.exports.gluEnum.GLU_TESS_END,this._endcallback.bind(this));this.glu.gluTessCallback(F.exports.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this));this.glu.gluTessCallback(F.exports.gluEnum.GLU_TESS_ERROR,
this._errorcallback.bind(this));this.glu.gluTessCallback(F.exports.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));this.glu.gluTessProperty(F.exports.gluEnum.GLU_TESS_WINDING_RULE,F.exports.windingRule.GLU_TESS_WINDING_ODD)}var k=B.prototype;k.beginPolygon=function(h,a){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=this._currentVertexIndex=0;this.glu.gluTessBeginPolygon(h);this._indices=a};k.endPolygon=function(){this.glu.gluTessEndPolygon()};
k.beginContour=function(){this.glu.gluTessBeginContour()};k.endContour=function(){this.glu.gluTessEndContour()};k.addVertex=function(h,a){this.glu.gluTessVertex(h,a)};k._vertexCallback=function(h,a){a[a.length]=h[0];a[a.length]=h[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(h=0;3>h;h++)-1===this._triangleIndices[h]&&(this._triangleIndices[h]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[h];this._currentVertexIndex=0}else this._currentVertexIndex++};
k._begincallback=function(){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};k._endcallback=function(){this._currentVertexIndex=0};k._errorcallback=function(h){E.error(`Encountered error during tesselation: ${h}`)};k._combinecallback=function(h){return[h[0],h[1],h[2]]};k._edgeCallback=function(){};return B}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer","./WGLMeshTemplate"],function(x,F,E,B){const k=F.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(h){function a(d){var c=h.call(this)||this;c._ongoingMaterialRequestMap=new Map;c._materialCache=new Map;c._dynamicPropertyMap=new Map;c._cimLayer=d;return c}x._inheritsLoose(a,h);a.prototype.analyze=function(d,c,b,e){c=c.readLegacyFeature();const f=this._materialCache,r=this._cimLayer.materialHash;
if(!r)return k.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const q="function"===typeof r?r(c,b,e):r;if(f.has(q))return d=f.get(q),Promise.resolve(d);if(this._ongoingMaterialRequestMap.has(q))return this._ongoingMaterialRequestMap.get(q);b=E.analyzeCIMResource(this._cimLayer.cim,this._cimLayer.materialOverrides);b.mosaicHash=q;d=d.getMosaicItem(b).then(g=>{this._ongoingMaterialRequestMap.delete(q);f.set(q,g);return g}).catch(g=>{this._ongoingMaterialRequestMap.delete(q);
k.error(".analyze()",g.message);return null});this._ongoingMaterialRequestMap.set(q,d);return d};return a}(B)})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(x,F,E,B,k,h,a,d,c,b){return function(e){function f(r,
q,g){var l=e.call(this,r)||this;l._minMaxZoom=k.i1616to32(Math.round(q*B.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(g*B.MIN_MAX_ZOOM_PRECISION_FACTOR));l._cimLineLayer=r;let n=0;a.isFunction(r.width)||(n=.5*F.pt2px(r.width));l._dynamicPropertyMap.set("_halfWidth",(u,t,m)=>a.isFunction(r.width)?.5*F.pt2px(r.width(u,t,m)):n);a.isFunction(r.cap)?l._dynamicPropertyMap.set("_capType",r.cap):l._capType=r.cap;a.isFunction(r.join)?l._dynamicPropertyMap.set("_joinType",r.join):l._joinType=r.join;a.isFunction(r.color)?
l._dynamicPropertyMap.set("_fillColor",(u,t,m)=>(u=r.color(u,t,m))&&E.premultiplyAlphaRGBA(u)||0):(q=r.color,l._fillColor=q&&E.premultiplyAlphaRGBA(q)||0);a.isFunction(r.miterLimit)?l._dynamicPropertyMap.set("_miterLimitCosine",(u,t,m)=>a.getLimitCosine(r.miterLimit(u,t,m))):l._miterLimitCosine=a.getLimitCosine(r.miterLimit);l._scaleFactor=r.scaleFactor||1;l._isDashed=r.isDashed;l._effects=r.effects;l.tessellationProperties._bitset=r.colorLocked?1:0;l._materialKey=r.materialKey;l._initializeTessellator(!0);
return l}x._inheritsLoose(f,e);f.fromCIMLine=function(r,q){const [g,l]=a.getMinMaxZoom(r.scaleInfo,q);return new f(r,g,l)};f.prototype.bindFeature=function(r,q,g){const l=r.readLegacyFeature();this._dynamicPropertyMap.forEach((u,t)=>{this[t]=u(l,q,g)});this._halfWidth*=this._scaleFactor;r=this._materialCache;var n=this._cimLineLayer.materialHash;n=n(l,q,g);n=r.get(n);r=null;n&&b.ok(n.spriteMosaicItem)&&(r=n.spriteMosaicItem);if(r){this._hasPattern=!0;const {rect:u,width:t,height:m}=r;n=u.x+B.SPRITE_PADDING;
const w=u.y+B.SPRITE_PADDING,v=n+t,C=w+m;this.tessellationProperties._tl=k.i1616to32(n,w);this.tessellationProperties._br=k.i1616to32(v,C)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;n=h.LineMaterialKey.load(this._materialKey);
r&&(n.sdf=r.sdf,n.pattern=!0,n.textureBinding=r.textureBinding);this._materialKey=n.data};return f}(d(c))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),function(x,F,E,B,k,h,a,d){const c=(e,f,r)=>(q,g,l,n,u,t,m,w,v,C,A)=>{l=k.i1616to32(A,Math.ceil(1024*e._halfWidth));
m=k.i8888to32(Math.round(31*m),Math.round(31*w),Math.round(31*v),Math.round(31*C));u=k.i8888to32(31*u,31*t,0,e._bitset);t=e.out;t.vertexBounds(q,g,f,r);t.vertexWrite(k.i1616to32(8*q,8*g));t.vertexWrite(e.id);t.vertexWrite(e._fillColor);t.vertexWrite(m);t.vertexWrite(l);t.vertexWrite(e._tl);t.vertexWrite(e._br);t.vertexWrite(u);t.vertexWrite(k.i1616to32(Math.ceil(1024*e._halfReferenceWidth),0));t.vertexWrite(e.minMaxZoom);t.vertexEnd();return e.offset+e.vertexCount++},b=e=>(f,r,q)=>{const g=e.out;
g.indexWrite(f);g.indexWrite(r);g.indexWrite(q);e.indexCount+=3};return e=>function(f){function r(...g){g=f.call(this,...g)||this;g.tessellationProperties={};g._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};g.geometryType=B.WGLGeometryType.LINE;return g}x._inheritsLoose(r,f);var q=r.prototype;q._initializeTessellator=function(g){var l=a.LineMaterialKey.load(this._materialKey),n=this._tessellationOptions;l=l.vvSizeFieldStops||l.vvSizeMinMaxValue||l.vvSizeScaleStops||l.vvSizeUnitValue;
const u=this.tessellationProperties._halfWidth<E.THIN_LINE_HALF_WIDTH_THRESHOLD;this.tessellationProperties.minMaxZoom=this._minMaxZoom;g=u&&!g&&!l;n.wrapDistance=65535;n.textured=this._isDashed||this._hasPattern;n.offset=this.tessellationProperties.offset;n.halfWidth=this.tessellationProperties._halfWidth;n=g?0:1;this._lineTessellator=new h.LineTessellation(c(this.tessellationProperties,n,n),b(this.tessellationProperties),g)};q._write=function(g,l,n){const u="esriGeometryPoint"===l.geometryType;
g.recordStart(l.getDisplayId(),this._materialKey,this.geometryType,!1,u);this._writeGeometry(g,l,n,u);g.recordEnd()};q._writeGeometry=function(g,l,n,u){n=null!=n?n:l.readLegacyGeometry();u=this._getLines(n,u);F.isNone(u)||this._writeVertices(g,l,u)};q._getLines=function(g,l){if(F.isNone(g))return null;g=g.paths||g.rings;return F.isNone(g)?null:d.clipLinesMarshall(g,l?256:16)};q._writeVertices=function(g,l,n){l=l.getDisplayId();const u=g.vertexCount(),t=this.tessellationProperties,m=this._tessellationOptions;
t.out=g;t.id=l;t.indexCount=0;t.vertexCount=0;t.offset=u;m.capType=this._capType;m.joinType=this._joinType;for(const {line:w,start:v}of n)m.initialDistance=v%65535,this._lineTessellator.tessellate(w,m)};return r}(e)})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["exports","./definitions"],function(x,F){function E(e,f){return e.x===f.x&&e.y===f.y}function B(e,f){e.x=f.y;e.y=-f.x;return e}function k(e,f){e.x=-f.y;e.y=f.x;return e}function h(e,f){e.x=f.x;e.y=f.y;return e}function a(e,f){e.x=
-f.x;e.y=-f.y;return e}function d(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function c(e,f,r,q){e.x=f.x*r+f.y*q;e.y=f.x*q-f.y*r;return e}let b=function(){function e(r,q,g){this.writeVertex=r;this.writeTriangle=q;this.canUseThinTessellation=g;this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.textureNormalLeft={x:0,y:1};this.textureNormalRight={x:0,y:-1};this.textureNormal={x:void 0,y:void 0};this.joinNormal={x:void 0,y:void 0};this.inner={x:void 0,y:void 0};this.outer={x:void 0,
y:void 0};this.roundStart={x:void 0,y:void 0};this.roundEnd={x:void 0,y:void 0};this.startBreak={x:void 0,y:void 0};this.endBreak={x:void 0,y:void 0};this.innerPrev={x:void 0,y:void 0};this.innerNext={x:void 0,y:void 0};this.bevelStart={x:void 0,y:void 0};this.bevelEnd={x:void 0,y:void 0};this.bevelMiddle={x:void 0,y:void 0}}var f=e.prototype;f.tessellate=function(r,q){if(r){var g=r.length;if(!(1>=g)){var l=0;for(let n=1;n<g;n++)E(r[n],r[l])||++l===n||(r[l]=r[n]);r.length=l+1}}this.canUseThinTessellation&&
q.halfWidth<F.THIN_LINE_HALF_WIDTH_THRESHOLD&&!q.offset?this.tessellateThin_(r,q):this.tessellate_(r,q)};f.tessellateThin_=function(r,q){if(!(2>r.length)){var g=q.wrapDistance||65535;q=q.initialDistance||0;var l=!1,n=r[0].x,u=r[0].y,t=r.length;for(let C=1;C<t;++C){l&&(l=!1,q=0);let A=r[C].x,y=r[C].y;var m=A-n;let p=y-u;var w=Math.sqrt(m*m+p*p);m/=w;p/=w;if(q+w>g){l=!0;var v=(g-q)/w;w=g-q;A=(1-v)*n+v*A;y=(1-v)*u+v*y;--C}v=this.writeVertex(n,u,0,0,m,p,p,-m,0,-1,q);n=this.writeVertex(n,u,0,0,m,p,-p,
m,0,1,q);q+=w;w=this.writeVertex(A,y,0,0,m,p,p,-m,0,-1,q);m=this.writeVertex(A,y,0,0,m,p,-p,m,0,1,q);this.writeTriangle(v,n,w);this.writeTriangle(n,w,m);n=A;u=y}}};f.tessellate_=function(r,q){var g=r[r.length-1];const l=E(r[0],g);if(!(r.length<(l?3:2))){var n=q.pixelCoordRatio,u=null!=q.capType?q.capType:0,t=null!=q.joinType?q.joinType:2,m=null!=q.miterLimit?Math.min(q.miterLimit,4):2,w=null!=q.roundLimit?Math.min(q.roundLimit,1.05):1.05,v=null!=q.halfWidth?q.halfWidth:2,C=!!q.textured,A=null,y=null,
p=this.prevNormal,z=this.nextNormal,D=-1,G=-1,I=this.joinNormal,K=this.textureNormalLeft,N=this.textureNormalRight,L=this.textureNormal,M=-1,O=-1,H=q.wrapDistance||65535,J=q.initialDistance||0,P=this.writeVertex,Q=this.writeTriangle;q=function(ka,na,qa,pa,ra,ua){ka=P(U,aa,ha,ca,qa,pa,ka,na,ra,ua,J);0<=M&&0<=O&&0<=ka&&Q(M,O,ka);M=O;return O=ka};l&&(A=r[r.length-2],z.x=g.x-A.x,z.y=g.y-A.y,G=d(z),z.x/=G,z.y/=G);g=!1;for(let ka=0;ka<r.length;++ka){g&&(g=!1,J=0);A&&(p.x=-z.x,p.y=-z.y,D=G,J+D>H&&(g=!0));
g?(y=(H-J)/D,D=H-J,A={x:(1-y)*A.x+y*r[ka].x,y:(1-y)*A.y+y*r[ka].y},--ka):A=r[ka];var U=A.x;var aa=A.y;var ba=0>=ka&&!g,ia=ka===r.length-1;ba||(J+=D);(y=ia?l?r[1]:null:r[ka+1])?(z.x=y.x-U,z.y=y.y-aa,G=d(z),z.x/=G,z.y/=G):(z.x=void 0,z.y=void 0);if(!l){if(ba){k(I,z);var ha=I.x;var ca=I.y;2===u&&(q(-z.y-z.x,z.x-z.y,z.x,z.y,0,-1),q(z.y-z.x,-z.x-z.y,z.x,z.y,0,1));1===u&&(q(-z.y-z.x,z.x-z.y,z.x,z.y,-1,-1),q(z.y-z.x,-z.x-z.y,z.x,z.y,-1,1));if(1===u||0===u)q(-z.y,z.x,z.x,z.y,0,-1),q(z.y,-z.x,z.x,z.y,0,1);
continue}if(ia){B(I,p);ha=I.x;ca=I.y;if(1===u||0===u)q(p.y,-p.x,-p.x,-p.y,0,-1),q(-p.y,p.x,-p.x,-p.y,0,1);2===u&&(q(p.y-p.x,-p.x-p.y,-p.x,-p.y,0,-1),q(-p.y-p.x,p.x-p.y,-p.x,-p.y,0,1));1===u&&(q(p.y-p.x,-p.x-p.y,-p.x,-p.y,1,-1),q(-p.y-p.x,p.x-p.y,-p.x,-p.y,1,1));continue}}var S=void 0;ba=-(p.x*z.y-p.y*z.x);.01>Math.abs(ba)?0<p.x*z.x+p.y*z.y?(I.x=p.x,I.y=p.y,ba=1,S=Number.MAX_VALUE,y=!0):(k(I,z),S=ba=1,y=!1):(I.x=(p.x+z.x)/ba,I.y=(p.y+z.y)/ba,S=d(I),y=(S-1)*v*n,y=4<S||y>D&&y>G);ha=I.x;ca=I.y;var R=
t;switch(t){case 0:1.05>S&&(R=2);break;case 1:S<w&&(R=2);break;case 2:S>m&&(R=0)}switch(R){case 2:q(I.x,I.y,-p.x,-p.y,0,-1);q(-I.x,-I.y,-p.x,-p.y,0,1);if(ia)break;C&&(y=g?0:J,M=this.writeVertex(U,aa,ha,ca,z.x,z.y,I.x,I.y,0,-1,y),O=this.writeVertex(U,aa,ha,ca,z.x,z.y,-I.x,-I.y,0,1,y));break;case 0:ba=0>ba;var Y=void 0;ba?(R=M,M=O,O=R,Y=K,R=N):(Y=N,R=K);var ea=void 0,T=void 0;y?(ea=ba?k(this.innerPrev,p):B(this.innerPrev,p),T=ba?B(this.innerNext,z):k(this.innerNext,z)):ea=T=ba?a(this.inner,I):h(this.inner,
I);S=ba?B(this.bevelStart,p):k(this.bevelStart,p);q(ea.x,ea.y,-p.x,-p.y,Y.x,Y.y);ea=q(S.x,S.y,-p.x,-p.y,R.x,R.y);if(ia)break;ia=ba?k(this.bevelEnd,z):B(this.bevelEnd,z);y?(y=this.writeVertex(U,aa,ha,ca,-p.x,-p.y,0,0,0,0,J),M=this.writeVertex(U,aa,ha,ca,z.x,z.y,T.x,T.y,Y.x,Y.y,J),O=this.writeVertex(U,aa,ha,ca,z.x,z.y,ia.x,ia.y,R.x,R.y,J),this.writeTriangle(ea,y,O)):(C?(y=this.bevelMiddle,y.x=(S.x+ia.x)/2,y.y=(S.y+ia.y)/2,c(L,y,-p.x,-p.y),q(y.x,y.y,-p.x,-p.y,L.x,L.y),c(L,y,z.x,z.y),M=this.writeVertex(U,
aa,ha,ca,z.x,z.y,y.x,y.y,L.x,L.y,J),O=this.writeVertex(U,aa,ha,ca,z.x,z.y,T.x,T.y,Y.x,Y.y,J)):(y=M,M=O,O=y),q(ia.x,ia.y,z.x,z.y,R.x,R.y));ba&&(y=M,M=O,O=y);break;case 1:{ba=0>ba;var W=void 0;ba?(R=M,M=O,O=R,R=K,W=N):(R=N,W=K);var X=ba?a(this.inner,I):h(this.inner,I);y?(T=ba?k(this.innerPrev,p):B(this.innerPrev,p),Y=ba?B(this.innerNext,z):k(this.innerNext,z)):Y=T=X;ea=ba?B(this.roundStart,p):k(this.roundStart,p);var fa=ba?k(this.roundEnd,z):B(this.roundEnd,z);T=q(T.x,T.y,-p.x,-p.y,R.x,R.y);ea=q(ea.x,
ea.y,-p.x,-p.y,W.x,W.y);if(ia)break;ia=this.writeVertex(U,aa,ha,ca,-p.x,-p.y,0,0,0,0,J);y||this.writeTriangle(M,O,ia);X=a(this.outer,X);W=this.writeVertex(U,aa,ha,ca,z.x,z.y,fa.x,fa.y,W.x,W.y,J);let na,qa;if(fa=2<S){var ja=void 0;S!==Number.MAX_VALUE?(X.x/=S,X.y/=S,ja=p.x*X.x+p.y*X.y,ja=(S*(ja*ja-1)+1)/ja):ja=-1;na=ba?B(this.startBreak,p):k(this.startBreak,p);na.x+=p.x*ja;na.y+=p.y*ja;qa=ba?k(this.endBreak,z):B(this.endBreak,z);qa.x+=z.x*ja;qa.y+=z.y*ja}c(L,X,-p.x,-p.y);S=this.writeVertex(U,aa,ha,
ca,-p.x,-p.y,X.x,X.y,L.x,L.y,J);c(L,X,z.x,z.y);X=C?this.writeVertex(U,aa,ha,ca,z.x,z.y,X.x,X.y,L.x,L.y,J):S;ja=ia;const pa=C?this.writeVertex(U,aa,ha,ca,z.x,z.y,0,0,0,0,J):ia;let ra=-1,ua=-1;fa&&(c(L,na,-p.x,-p.y),ra=this.writeVertex(U,aa,ha,ca,-p.x,-p.y,na.x,na.y,L.x,L.y,J),c(L,qa,z.x,z.y),ua=this.writeVertex(U,aa,ha,ca,z.x,z.y,qa.x,qa.y,L.x,L.y,J));C?fa?(this.writeTriangle(ja,ea,ra),this.writeTriangle(ja,ra,S),this.writeTriangle(pa,X,ua),this.writeTriangle(pa,ua,W)):(this.writeTriangle(ja,ea,S),
this.writeTriangle(pa,X,W)):fa?(this.writeTriangle(ia,ea,ra),this.writeTriangle(ia,ra,ua),this.writeTriangle(ia,ua,W)):(this.writeTriangle(ia,ea,S),this.writeTriangle(ia,X,W));y?M=this.writeVertex(U,aa,ha,ca,z.x,z.y,Y.x,Y.y,R.x,R.y,J):(M=C?this.writeVertex(U,aa,ha,ca,z.x,z.y,Y.x,Y.y,R.x,R.y,J):T,this.writeTriangle(M,pa,W));O=W;ba&&(y=M,M=O,O=y)}}}}};return e}();x.LineTessellation=b;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g){const l=a.create(),n=h.create(),u=E.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");return function(t){function m(w,v,C){var A=t.call(this,w)||this;A._cimMarkerLayer=w;A._minMaxZoom=b.i1616to32(Math.round(v*c.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(C*c.MIN_MAX_ZOOM_PRECISION_FACTOR));f.isFunction(w.color)?A._dynamicPropertyMap.set("_fillColor",(y,p,z)=>d.premultiplyAlphaRGBA(w.color(y,p,z))):A._fillColor=d.premultiplyAlphaRGBA(w.color);f.isFunction(w.outlineColor)?
A._dynamicPropertyMap.set("_outlineColor",(y,p,z)=>d.premultiplyAlphaRGBA(w.outlineColor(y,p,z))):A._outlineColor=d.premultiplyAlphaRGBA(w.outlineColor);f.isFunction(w.size)?A._dynamicPropertyMap.set("_size",(y,p,z)=>k.pt2px(w.size(y,p,z))):A._size=k.pt2px(w.size);f.isFunction(w.scaleX)?A._dynamicPropertyMap.set("_scaleX",w.scaleX):A._scaleX=w.scaleX;f.isFunction(w.offsetX)?A._dynamicPropertyMap.set("xOffset",(y,p,z)=>k.pt2px(w.offsetX(y,p,z))):A.xOffset=k.pt2px(w.offsetX);f.isFunction(w.offsetY)?
A._dynamicPropertyMap.set("yOffset",(y,p,z)=>k.pt2px(w.offsetY(y,p,z))):A.yOffset=k.pt2px(w.offsetY);f.isFunction(w.outlineWidth)?A._dynamicPropertyMap.set("_outlineWidth",(y,p,z)=>k.pt2px(w.outlineWidth(y,p,z))):A._outlineWidth=k.pt2px(w.outlineWidth);f.isFunction(w.rotation)?A._dynamicPropertyMap.set("_angle",w.rotation):A._angle=w.rotation;A._scaleFactor=B.unwrapOr(w.scaleFactor,1);A._markerPlacement=w.markerPlacement;A._effects=w.effects;A._bitSet=(1===w.alignment?1:0)|(w.colorLocked?1:0)<<1|
(w.scaleSymbolsProportionally?1:0)<<3;A._materialKey=w.materialKey;return A}x._inheritsLoose(m,t);m.fromCIMMarker=function(w,v){const [C,A]=f.getMinMaxZoom(w.scaleInfo,v);return new m(w,C,A)};m.prototype.bindFeature=function(w,v,C){const A=w.readLegacyFeature();this._dynamicPropertyMap.forEach((J,P)=>{this[P]=J(A,v,C)});w=this._cimMarkerLayer.materialHash;w="function"===typeof w?w(A,v,C):w;if((w=this._materialCache.get(w))&&g.ok(w.spriteMosaicItem)&&w.spriteMosaicItem){w=w.spriteMosaicItem;var y=
this._cimMarkerLayer.sizeRatio,p=w.width/w.height*this._scaleX,z=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,D=this._size,G=D*p,I=this.xOffset,K=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var N=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/k.pt2px(this._cimMarkerLayer.frameHeight):1,L=this._outlineWidth*N,M=k.pt2px(this._cimMarkerLayer.referenceSize),O=N=0,H=this._cimMarkerLayer.anchorPoint;H&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?
this._size&&(N=-H.x/(this._size*p),O=H.y/this._size):(N=H.x,O=H.y));this._sizeOutlineWidth=b.i8888to32(Math.round(Math.min(Math.sqrt(128*G),255)),Math.round(Math.min(Math.sqrt(128*D),255)),Math.round(Math.min(Math.sqrt(128*L),255)),Math.round(Math.min(Math.sqrt(128*M),255)));this.angle=z;this._bitestAndDistRatio=b.i1616to32(this._bitSet,Math.round(64*y));p=w.rect.x+c.SPRITE_PADDING;z=w.rect.y+c.SPRITE_PADDING;L=p+w.width;M=z+w.height;this._texUpperLeft=b.i1616to32(p,z);this._texUpperRight=b.i1616to32(L,
z);this._texBottomLeft=b.i1616to32(p,M);this._texBottomRight=b.i1616to32(L,M);p=e.MarkerMaterialKey.load(this._materialKey);p.sdf=w.sdf;p.pattern=!0;p.textureBinding=w.textureBinding;this._materialKey=p.data;this._anchorX=.5-(.5+N)*w.width/w.width;this._anchorY=.5-(.5+O)*w.height/w.height;G=G*y*this._scaleFactor;D=D*y*this._scaleFactor;G*=w.rect.width/w.width;D*=w.rect.height/w.height;this._computedWidth=G;this._computedHeight=D;this._applyTransformation(n,l);this.xOffset=I;this.yOffset=K}else u.error(new F("mapview-cim",
"Encountered an error when binding feature"))};return m}(r(q))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),function(x,F,E,B,k,h,a,d,c,b,e){return function(f){function r(g,l,
n){var u=f.call(this,g)||this;u._horizontalAlignment="center";u._verticalAlignment="middle";u._textToGlyphs=new Map;u._minMaxZoom=h.i1616to32(Math.round(l*k.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(n*k.MIN_MAX_ZOOM_PRECISION_FACTOR));l=g.scaleFactor||1;u._cimTextLayer=g;d.isFunction(g.color)?u._dynamicPropertyMap.set("_color",(v,C,A)=>B.premultiplyAlphaRGBA(g.color(v,C,A))):u._color=B.premultiplyAlphaRGBA(g.color);d.isFunction(g.color)?u._dynamicPropertyMap.set("_haloColor",(v,C,A)=>B.premultiplyAlphaRGBA(g.outlineColor(v,
C,A))):u._haloColor=B.premultiplyAlphaRGBA(g.outlineColor);let t;d.isFunction(g.size)||(t=Math.min(Math.round(F.pt2px(g.size*g.sizeRatio)),127));u._dynamicPropertyMap.set("_size",(v,C,A)=>d.isFunction(g.size)?Math.min(Math.round(F.pt2px(g.size(v,C,A)*g.sizeRatio)),127):t);d.isFunction(g.outlineSize)?u._dynamicPropertyMap.set("_haloSize",(v,C,A)=>Math.min(Math.floor(5*F.pt2px(g.outlineSize(v,C,A)*g.sizeRatio)),127)):u._haloSize=Math.min(Math.floor(5*F.pt2px(g.outlineSize*g.sizeRatio)),127);let m;d.isFunction(g.offsetX)||
(m=Math.round(F.pt2px(g.offsetX*g.sizeRatio)));u._dynamicPropertyMap.set("_xOffset",(v,C,A)=>d.isFunction(g.offsetX)?Math.round(F.pt2px(g.offsetX(v,C,A)*g.sizeRatio)):m);let w;d.isFunction(g.offsetY)||(w=Math.round(F.pt2px(g.offsetY*g.sizeRatio)));u._dynamicPropertyMap.set("_yOffset",(v,C,A)=>d.isFunction(g.offsetY)?Math.round(F.pt2px(g.offsetY(v,C,A)*g.sizeRatio)):w);d.isFunction(g.angle)?u._dynamicPropertyMap.set("_angle",g.angle):u._angle=g.angle;d.isFunction(g.horizontalAlignment)?u._dynamicPropertyMap.set("_horizontalAlignment",
g.horizontalAlignment):u._horizontalAlignment=g.horizontalAlignment;d.isFunction(g.verticalAlignment)?u._dynamicPropertyMap.set("_verticalAlignment",g.verticalAlignment):u._verticalAlignment=g.verticalAlignment;u._scaleFactor=l;d.isFunction(g.text)?u._dynamicPropertyMap.set("_text",g.text):u._text=g.text;l=Math.min(Math.round(F.pt2px(g.referenceSize*g.sizeRatio)),127);u._referenceSize=Math.round(Math.sqrt(256*l));u._materialKey=g.materialKey;l=a.TextMaterialKey.load(u._materialKey);l.sdf=!0;u._bitset=
(1===g.alignment?1:0)|(g.colorLocked?1:0)<<1;u._materialKey=l.data;u._decoration="none";u._lineHeight=1;u._lineWidth=512;u._textPlacement=g.markerPlacement;u._effects=g.effects;u._isCIM=!0;return u}x._inheritsLoose(r,f);r.fromCIMText=function(g,l){const [n,u]=d.getMinMaxZoom(g.scaleInfo,l);return new r(g,n,u)};var q=r.prototype;q.analyze=function(){var g=x._asyncToGenerator(function*(l,n,u,t){n=n.readLegacyFeature();var m=this._cimTextLayer;u="string"===typeof m.text?m.text:"function"===typeof m.text?
m.text(n,u,t):"";l=yield l.getMosaicItem(this._cimTextLayer.cim,e.codepoints(u));this._textToGlyphs.set(u,l.glyphMosaicItems);return l});return function(l,n,u,t){return g.apply(this,arguments)}}();q.bindFeature=function(g,l,n){const u=g.readLegacyFeature();this._dynamicPropertyMap.forEach((t,m)=>{this[m]=t(u,l,n)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/24,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=E.getXAnchorDirection(this._horizontalAlignment||
"center"),this._yAlignD=E.getYAnchorDirection(this._verticalAlignment||"baseline"),g=this._textToGlyphs.get(this._text),this.bindTextInfo(g,!1)):this._shapingInfo=null};return r}(c(b))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(x){x.codepoints=function(F){const E=Array(F.length);for(let B=0;B<F.length;B++)E[B]=F.charCodeAt(B);return E};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e){return function(f){function r(q,g,l,n,u,t,m,w,v,C,A){var y=f.call(this)||this;y._effects=v;q=d.FillMaterialKey.load(q);g&&(q.sdf=g.sdf,q.pattern=!0,q.textureBinding=g.textureBinding);y.fillColor=l;y.tl=n;y.br=u;y.aux1=t;y.aux2=m;y.aux3=w;y._minMaxZoom=a.i1616to32(Math.round(C*k.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(A*k.MIN_MAX_ZOOM_PRECISION_FACTOR));y._materialKey=q.data;return y}x._inheritsLoose(r,f);r.fromCIMFill=function(q,g,l){var n=q.color;n=n&&B.premultiplyAlphaRGBA(n)||
0;const u=q.materialKey,[t,m]=c.getMinMaxZoom(q.scaleInfo,l);if(!g)return g=a.i8888to32(0,0,0,q.colorLocked?1:0),new r(u,null,n,0,0,0,0,g,q.effects,t,m);const {rect:w,width:v,height:C}=g;var A=w.x+k.SPRITE_PADDING;const y=w.y+k.SPRITE_PADDING;var p=A+v;const z=y+C;var D=F.nextHighestPowerOfTwo(C);255<D?D=255:0>=D&&(D=F.nextHighestPowerOfTwo(z-y));var G=F.nextHighestPowerOfTwo(v||0);255<G?G=255:0>=G&&(G=F.nextHighestPowerOfTwo(p-A));let I=E.pt2px(q.offsetX||0)+128;255<I&&(I=255);let K=E.pt2px(-q.offsetY||
0)+128;255<K&&(K=255);l=q.scaleX||1;A=a.i1616to32(A,y);p=a.i1616to32(p,z);D=a.i8888to32(G,D,I,K);l=a.i1616to32(128*l,128);G=a.i8888to32(0,0,h.degToByte(q.angle),q.colorLocked?1:0);return new r(u,g,n,A,p,D,l,G,q.effects,t,m)};r.fromSimpleFill=function(q,g,l=!1){var {color:n}=q;n=n&&"esriSFSNull"!==q.style&&B.premultiplyAlphaRGBAArray(n)||0;l=a.i8888to32(0,0,0,l?255:0);q=q.materialKey;if(!g)return new r(q,null,n,0,0,0,0,l,null,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM);const {rect:u,width:t,height:m}=g;
var w=u.x+k.SPRITE_PADDING,v=u.y+k.SPRITE_PADDING;const C=w+t,A=v+m,y=a.i1616to32(w,v),p=a.i1616to32(C,A);w=a.i8888to32(F.nextHighestPowerOfTwo(C-w),F.nextHighestPowerOfTwo(A-v),0,0);v=a.i1616to32(128,128);return new r(q,g,n,y,p,w,v,l,null,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM)};r.fromPictureFill=function(q,g,l=!1){const n=k.PICTURE_FILL_COLOR,{rect:u,width:t,height:m}=g;var w=u.x+k.SPRITE_PADDING,v=u.y+k.SPRITE_PADDING,C=w+t,A=v+m;w=a.i1616to32(w,v);C=a.i1616to32(C,A);A=F.nextHighestPowerOfTwo(E.pt2px(q.width));
255<A&&(A=255);v=F.nextHighestPowerOfTwo(E.pt2px(q.height));255<v&&(v=255);let y=E.pt2px(q.xoffset)+128;255<y&&(y=255);let p=E.pt2px(-q.yoffset)+128;255<p&&(p=255);A=a.i8888to32(A,v,y,p);v=a.i1616to32(128*q.xscale,128*q.yscale);l=a.i8888to32(0,0,0,l?255:0);return new r(q.materialKey,g,n,w,C,A,v,l,null,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM)};return r}(b(e))})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e){const f=F.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");return function(r){function q(g,l,n,u,t,m,w,v,C,A,y,p,z,D,G,I,K){var N=r.call(this)||this;g=d.LineMaterialKey.load(g);l&&(g.sdf=l.sdf,g.pattern=!0,g.textureBinding=l.textureBinding);N._capType=u;N._joinType=t;N._miterLimitCosine=c.getLimitCosine(m);N.tessellationProperties._fillColor=w;N.tessellationProperties._tl=v;N.tessellationProperties._br=C;N._hasPattern=A;N._isDashed=y;N._isColorLocked=p;N._zOrder=
D;N._effects=G;N._minMaxZoom=h.i1616to32(Math.round(I*k.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(K*k.MIN_MAX_ZOOM_PRECISION_FACTOR));N._materialKey=g.data;N.tessellationProperties._bitset=p?1:0;N.tessellationProperties._halfWidth=.5*n;N.tessellationProperties._halfReferenceWidth=.5*z;N.tessellationProperties.offset=0;N._initializeTessellator(!1);return N}x._inheritsLoose(q,r);q.fromCIMLine=function(g,l,n){var u=g.color,t=g.scaleFactor||1;const m=g.isDashed;let w=g.cap;m&&1===w&&(w=2);const v=g.join;
t*=E.pt2px(g.width);const C=E.pt2px(g.referenceWidth),A=E.pt2px(g.miterLimit);u=u&&B.premultiplyAlphaRGBA(u)||0;const [y,p]=c.getMinMaxZoom(g.scaleInfo,n);if(!l)return new q(g.materialKey,l,t,w,v,A,u,0,0,!1,m,g.colorLocked,C,g.zOrder,g.effects,y,p);const {rect:z,width:D,height:G}=l;var I=z.x+k.SPRITE_PADDING;const K=z.y+k.SPRITE_PADDING;n=I+D;const N=K+G;I=h.i1616to32(I,K);n=h.i1616to32(n,N);return new q(g.materialKey,l,t,w,v,A,u,I,n,!0,m,g.colorLocked,C,g.zOrder,g.effects,y,p)};q.fromSimpleLine=
function(g,l){var {color:n}=g;const u="esriSLSSolid"!==g.style&&"esriSLSNull"!==g.style,t=a.getCapType(g.cap||"round"),m=a.getJoinType(g.join||"round");n=n&&"esriSLSNull"!==g.style&&B.premultiplyAlphaRGBAArray(n)||0;"esriSLSNull"===g.style&&(n=0);const w=E.pt2px(g.width),v=g.miterLimit;if(!l)return new q(g.materialKey,l,w,t,m,v,n,0,0,!1,u,!1,w,0,null,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM);const {rect:C,width:A,height:y}=l;var p=C.x+k.SPRITE_PADDING;const z=C.y+k.SPRITE_PADDING;var D=p+A;const G=z+
y;p=h.i1616to32(p,z);D=h.i1616to32(D,G);return new q(g.materialKey,l,w,t,m,v,n,p,D,!0,u,!1,w,0,null,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM)};q.fromPictureLineSymbol=function(g,l,n,u){f.error("PictureLineSymbol support does not exist!");return null};return q}(b(e))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(x,F,E){function B(){B=F._asyncToGenerator(function*(h,a,d){try{yield h.acquire(),
yield a(d),h.release()}catch(c){throw h.release(),c;}});return B.apply(this,arguments)}let k=function(){function h(){this._resolver=null}var a=h.prototype;a.isHeld=function(){return!!this._resolver};a.acquire=function(){var d=F._asyncToGenerator(function*(){if(!this._resolver)return this._resolver=E.createResolver(),Promise.resolve();yield this._resolver.promise;yield this.acquire()});return function(){return d.apply(this,arguments)}}();a.release=function(){const d=this._resolver;this._resolver=null;
d.resolve()};return h}();x.default=k;x.withLock=function(h,a,d){return B.apply(this,arguments)};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/features/schemaUtils":function(){define("exports ../../../../renderers/ClassBreaksRenderer ../../../../renderers/DictionaryRenderer ../../../../renderers/DotDensityRenderer ../../../../renderers/HeatmapRenderer ../../../../renderers/Renderer ../../../../renderers/SimpleRenderer ../../../../renderers/UniqueValueRenderer ../../../../renderers/support/jsonUtils ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/Logger ../../../../core/maybe ../../../../core/screenUtils ../../../../symbols/support/jsonUtils ../../engine/webgl/enums ../../engine/webgl/Utils ../../engine/webgl/materialKey/MaterialKey ../../engine/webgl/util/vvFlagUtils ./support/pixelBuffering ./support/rendererUtils ../support/clusterUtils ../support/util".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n,u,t,m,w,v,C,A){function y(T){switch(T.type){case "line-marker":var W;return{type:"line-marker",color:null==(W=T.color)?void 0:W.toJSON(),placement:T.placement,style:T.style};default:return l.fromJSON(T.toJSON()).toJSON()}}function p(T,W,X){if(!T)return null;var fa=0;let ja=!1,ka=0;q.isSome(W)&&(ka=w.getPtMaxVVSize(W),"visualVariables"in W&&(fa=m.getVVFlags(W.visualVariables||[]),ja="dot-density"===W.type));switch(T.type){case "simple-fill":case "picture-fill":return z(T,
fa,ja,X);case "simple-marker":case "picture-marker":return W=ka,fa=t.createMaterialKey(n.WGLGeometryType.MARKER,fa,!1,!1),X=X?t.hydrateMaterialKey(fa):fa,fa=y(T),T={materialKey:X,hash:T.hash(),...fa,angle:T.angle,maxVVSize:W};case "simple-line":return D(T,fa,X);case "text":return W=ka,fa=t.createMaterialKey(n.WGLGeometryType.TEXT,fa,!1,!1),X=X?t.hydrateMaterialKey(fa):fa,fa=y(T),T={materialKey:X,hash:T.hash(),...fa,angle:T.angle,maxVVSize:W};case "label":return W=fa,fa=T.toJSON(),W=t.createMaterialKey(n.WGLGeometryType.LABEL,
W,!1,!1,fa.labelPlacement),T={materialKey:X?t.hydrateMaterialKey(W):W,hash:T.hash(),...fa,labelPlacement:fa.labelPlacement};case "cim":return{type:"cim",rendererKey:fa,data:T.data,maxVVSize:ka};case "web-style":return{...y(T),type:"web-style",hash:T.hash(),rendererKey:fa,maxVVSize:ka};default:throw Error(`symbol not supported ${T.type}`);}}function z(T,W,X,fa){X=t.createMaterialKey(n.WGLGeometryType.FILL,W,!1,X);var ja=fa?t.hydrateMaterialKey(X):X;const ka=T.clone();X=ka.outline;ka.outline=null;T=
[];ja={materialKey:ja,hash:ka.hash(),...y(ka)};T.push(ja);X&&(W=t.createMaterialKey(n.WGLGeometryType.LINE,W,!0,!1),fa={materialKey:fa?t.hydrateMaterialKey(W):W,hash:X.hash(),...y(X)},T.push(fa));return{type:"composite-symbol",layers:T,hash:T.reduce((na,qa)=>qa.hash+na,"")}}function D(T,W,X){var fa=t.createMaterialKey(n.WGLGeometryType.LINE,W,!1,!1);const ja=X?t.hydrateMaterialKey(fa):fa;T=T.clone();fa=T.marker;T.marker=null;const ka=[];ka.push({materialKey:ja,hash:T.hash(),...y(T)});if(fa){var na;
W=t.createMaterialKey(n.WGLGeometryType.MARKER,W,!1,!1);X=X?t.hydrateMaterialKey(W):W;fa.color=null!=(na=fa.color)?na:T.color;ka.push({materialKey:X,hash:fa.hash(),lineWidth:T.width,...y(fa)})}return{type:"composite-symbol",layers:ka,hash:ka.reduce((qa,pa)=>pa.hash+qa,"")}}function G(T,W){const X=T.labelPlacement;var fa=ea[W];if(!T.symbol)return Y.warn("No ILabelClass symbol specified."),!0;if(!fa)return Y.error(new b("mapview-labeling:unsupported-geometry-type",`Unable to create labels for Feature Layer, ${W} is not supported`)),
!0;fa.some(ja=>ja===X)||(fa=fa[0],X&&Y.warn(`Found invalid label placement type ${X} for ${W}. Defaulting to ${fa}`),T.labelPlacement=fa);return!1}function I(T,W){T=f.clone(T);return T.some(X=>G(X,W))?[]:T}function K(T,W=!1){try{var X,fa;const ja=J(T,W),ka={};ja.map(na=>{a:{switch(na.target){case "feature":M(ka,L(T),na);na=void 0;break a;case "aggregate":if(!("featureReduction"in T)){na=void 0;break a}var qa=T.featureReduction;if("selection"===qa.type)throw new b("ValidationError","Mapview does not support `selection` reduction type",
qa);M(ka,L(T),na);ka.aggregate||(ka.aggregate={name:"aggregate",input:"feature",filters:null,attributes:{},params:{clusterRadius:g.pt2px(qa.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(g.pt2px(qa.clusterMaxSize)/64),fields:na.aggregateFields}});N(ka.aggregate,na.attributes.fields);na=void 0;break a}na=void 0}return na});return{source:{definitionExpression:T.definitionExpression,fields:T.fields.map(na=>na.toJSON()),gdbVersion:T.gdbVersion,historicMoment:null==(X=T.historicMoment)?void 0:X.getTime(),
outFields:T.availableFields,pixelBuffer:T.pixelBuffer,spatialReference:T.spatialReference.toJSON(),timeExtent:null==(fa=T.timeExtent)?void 0:fa.toJSON()},attributes:{fields:{},indexCount:0},processors:ja,targets:ka}}catch(ja){if("ValidationError"===ja.fieldName)return Y.error(ja),null;throw ja;}}function N(T,W){for(const X in W){const fa=W[X];if(fa.target!==T.name)continue;const ja=T.attributes[X];ja?(ja.context.mesh=ja.context.mesh||fa.context.mesh,ja.context.storage=ja.context.storage||fa.context.storage):
T.attributes[X]=fa}return T}function L(T){var W,X,fa,ja,ka;return[null!=(W=null==(X=T.filter)?void 0:X.toJSON())?W:null,null!=(fa=null==(ja=T.effect)?void 0:null==(ka=ja.filter)?void 0:ka.toJSON())?fa:null]}function M(T,W,X){T.feature||(T.feature={name:"feature",input:"source",filters:W,attributes:{}});N(T.feature,X.attributes.fields);return T}function O(T,W){return W.field?H(T,{...W,type:"field",field:W.field}):W.valueExpression?H(T,{...W,type:"expression",valueExpression:W.valueExpression}):{field:null,
fieldIndex:null}}function H(T,W){switch(W.type){case "expression":var X=W.valueExpression;if(!T.fields[X]){var fa=T.indexCount++;T.fields[X]={...W,name:X,fieldIndex:fa}}return{fieldIndex:T.fields[X].fieldIndex};case "label-expression":return X=JSON.stringify(W.label),T.fields[X]||(fa=T.indexCount++,T.fields[X]={...W,name:X,fieldIndex:fa}),{fieldIndex:T.fields[X].fieldIndex};case "field":X=W.field;if("aggregate"===W.target&&T.fields[X])return{field:X};T.fields[X]={...W,name:X};return{field:X};case "statistic":return T.fields[W.name]=
{...W},{field:W.name}}}function J(T,W=!1){const X=[];let fa=0;X.push(Q(T,fa++,W));return X}function P(T,W,X,fa,ja,ka=!1){W=H(W,{type:"label-expression",target:fa,context:{mesh:!0},resultType:"string",label:{labelExpression:X.labelExpression,labelExpressionInfo:X.labelExpressionInfo?{expression:X.labelExpressionInfo.expression}:null,symbol:!!X.symbol,where:X.where}});({fieldIndex:W}=W);return{...p(X,T,ka),fieldIndex:W,target:fa,index:ja}}function Q(T,W,X=!1){const fa={indexCount:0,fields:{}};var ja=
"featureReduction"in T&&T.featureReduction;W=ja?"aggregate":"feature";if("sublayers"in T){var ka={type:"subtype",subtypeField:T.subtypeField,renderers:{}},na={type:"subtype",mapping:{},target:"feature"},qa={type:"subtype",classes:{}};ja={type:"symbol",target:"feature",aggregateFields:[],attributes:fa,storage:na,mesh:{matcher:ka,aggregateMatcher:null,labels:qa}};var pa=new Set;let va=0;for(const {renderer:xa,subtypeCode:wa,labelingInfo:Ga,labelsVisible:Fa}of T.sublayers){T=ha(fa,W,xa,X);var ra=aa(fa,
W,xa),ua=Fa&&Ga;if("visualVariables"in xa&&xa.visualVariables&&xa.visualVariables.length)throw new b("ValidationError","Visual variables are currently not supported for subtype layers");if("dictionary"===T.type)throw new b("ValidationError","Dictionary renderer is not supported in subtype layers");if("subtype"===T.type)throw new b("ValidationError","Nested subtype renderers is not supported");if(q.isSome(ra)&&"subtype"===ra.type)throw new b("ValidationError","Nested subtype storage is not supported");
if(q.isSome(ra)&&"dot-density"===ra.type)throw new b("ValidationError","Dot density attributes are not supported in subtype layers");if(pa.has(wa))throw new b("ValidationError","Subtype codes for sublayers must be unique");pa.add(wa);ka.renderers[wa]=T;na.mapping[wa]=ra;ua&&(qa.classes[wa]=ua.map(Aa=>P(xa,fa,Aa,"feature",va++,X)))}return ja}switch(T.renderer.type){case "heatmap":{const {blurRadius:va,fieldOffset:xa,field:wa}=T.renderer;return{type:"heatmap",aggregateFields:[],attributes:fa,target:W,
storage:null,mesh:{blurRadius:va,fieldOffset:xa,field:O(fa,{target:W,field:wa,resultType:"numeric"}).field}}}default:{ka=[];const va="aggregate"===W?C.createClusterRenderer(ka,T.renderer,ja,null):T.renderer;U(fa,ka);na=ha(fa,W,va,X);pa=null;qa=aa(fa,W,va);ra=A.toJSONGeometryType(T.geometryType);T=T.labelsVisible&&T.labelingInfo||[];ua=[];if(ja){if("selection"===ja.type)throw new b("ValidationError","Mapview does not support `selection` reduction type",ja);ja.symbol&&(pa=new a({symbol:ja.symbol,visualVariables:"visualVariables"in
va?va.visualVariables:null}),pa=ha(fa,W,pa,X));ua=ja&&ja.labelsVisible&&ja.labelingInfo||[]}T=I(T,ra);ua=I(ua,ra);let xa=0;T=[...T.map(wa=>P(va,fa,wa,"feature",xa++,X)),...ua.map(wa=>P(va,fa,wa,"aggregate",xa++,X))];return{type:"symbol",target:W,attributes:fa,aggregateFields:ka,storage:qa,mesh:{matcher:na,labels:{type:"simple",classes:T},aggregateMatcher:pa}}}}}function U(T,W){const X={mesh:!0,storage:!0};for(const fa of W){const {name:ja,outStatistic:ka}=fa,{statisticType:na,onStatisticField:qa}=
ka;let pa=W=null,ra=null;"onStatisticValueExpression"in ka?pa=H(T,{type:"expression",target:"feature",valueExpression:ka.onStatisticValueExpression,resultType:"numeric"}).fieldIndex:"onStatisticNormalizationField"in ka?(W=H(T,{type:"field",target:"feature",field:qa,resultType:"numeric"}).field,ra=ka.onStatisticNormalizationField):W=H(T,{type:"field",target:"feature",field:qa,resultType:"numeric"}).field;H(T,{type:"statistic",target:"aggregate",name:ja,context:X,inField:W,inNormalizationField:ra,inFieldIndex:pa,
statisticType:na})}}function aa(T,W,X){switch(X.type){case "dot-density":return ba(T,W,X.attributes);case "simple":case "class-breaks":case "unique-value":case "dictionary":return ia(T,W,X.visualVariables);case "heatmap":return null}}function ba(T,W,X){return X&&X.length?{type:"dot-density",mapping:X.map((fa,ja)=>{const {field:ka,fieldIndex:na}=O(T,{valueExpression:fa.valueExpression,field:fa.field,resultType:"numeric",target:W});return{binding:ja,field:ka,fieldIndex:na}}),target:W}:{type:"dot-density",
mapping:[],target:W}}function ia(T,W,X){if(!X||!X.length)return{type:"visual-variable",mapping:[],target:W};const fa={storage:!0};return{type:"visual-variable",mapping:v.simplifyVisualVariables(X).map(ja=>{var ka;const na=u.getVVType(ja.type),{field:qa,fieldIndex:pa}=O(T,{target:W,valueExpression:ja.valueExpression,field:ja.field,context:fa,resultType:"numeric"});switch(ja.type){case "size":return"$view.scale"===ja.valueExpression?null:{type:"size",binding:na,field:qa,fieldIndex:pa,normalizationField:O(T,
{target:W,field:ja.normalizationField,context:fa,resultType:"numeric"}).field,valueRepresentation:null!=(ka=ja.valueRepresentation)?ka:null};case "color":return{type:"color",binding:na,field:qa,fieldIndex:pa,normalizationField:O(T,{target:W,field:ja.normalizationField,context:fa,resultType:"numeric"}).field};case "opacity":return{type:"opacity",binding:na,field:qa,fieldIndex:pa,normalizationField:O(T,{target:W,field:ja.normalizationField,context:fa,resultType:"numeric"}).field};case "rotation":return{type:"rotation",
binding:na,field:qa,fieldIndex:pa}}}).filter(ja=>ja),target:W}}function ha(T,W,X,fa=!1){T=q.unwrapOr(T,{indexCount:0,fields:{}});switch(X.type){case "simple":case "dot-density":return ca(T,X,"dot-density"===X.type,fa);case "class-breaks":return S(T,W,X,fa);case "unique-value":return R(T,W,X,fa);case "dictionary":return{type:"dictionary",renderer:X.toJSON()}}}function ca(T,W,X,fa=!1){T=W.getSymbols();return{type:"simple",symbol:p(T.length?T[0]:null,W,fa),isDotDensity:X}}function S(T,W,X,fa=!1){const ja=
X.backgroundFillSymbol,{field:ka,fieldIndex:na}=O(T,{target:W,field:X.field,valueExpression:X.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}});W=X.normalizationType;W="log"===W?"esriNormalizeByLog":"percent-of-total"===W?"esriNormalizeByPercentOfTotal":"field"===W?"esriNormalizeByField":null;const qa=X.classBreakInfos.map(pa=>({symbol:p(pa.symbol,X,fa),min:pa.minValue,max:pa.maxValue})).sort((pa,ra)=>pa.min-ra.min);return{type:"interval",attributes:T.fields,field:ka,fieldIndex:na,
backgroundFillSymbol:p(ja,X,fa),defaultSymbol:p(X.defaultSymbol,X,fa),intervals:qa,normalizationField:X.normalizationField,normalizationTotal:X.normalizationTotal,normalizationType:W,isMaxInclusive:X.isMaxInclusive}}function R(T,W,X,fa=!1){const ja=[],ka=X.backgroundFillSymbol;W={target:W,context:{mesh:!0},resultType:"string"};if(X.field&&"string"!==typeof X.field)throw new b("ValidationError","Expected renderer.field to be a string",X);const {field:na,fieldIndex:qa}=O(T,{...W,field:X.field,valueExpression:X.valueExpression});
for(const pa of X.uniqueValueInfos)ja.push({value:""+pa.value,symbol:p(pa.symbol,X,fa)});return{type:"map",attributes:T.fields,field:na,fieldIndex:qa,field2:O(T,{...W,field:X.field2}).field,field3:O(T,{...W,field:X.field3}).field,fieldDelimiter:X.fieldDelimiter,backgroundFillSymbol:p(ka,X),defaultSymbol:p(X.defaultSymbol,X),map:ja}}const Y=r.getLogger("esri.views.2d.layers.features.schemaUtils"),ea={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),
esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};x.addAggregateFields=U;x.createMatcherSchema=ha;x.createSchema=function(T){e("esri-2d-update-debug")&&console.debug("Created new schema",K(T,!0));return K(T)};x.createSymbolSchema=p;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["exports","../enums","../visualVariablesUtils"],function(x,F,E){x.getVVFlags=function(B){if(!B)return F.WGLVVFlag.NONE;
let k=0;for(const h of B)"size"===h.type?(B=E.getTypeOfSizeVisualVariable(h),k|=B,"outline"===h.target&&(k|=B<<4)):"color"===h.type?k|=F.WGLVVFlag.COLOR:"opacity"===h.type?k|=F.WGLVVFlag.OPACITY:"rotation"===h.type&&(k|=F.WGLVVFlag.ROTATION);return k};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/pixelBuffering":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/screenUtils ../../../../../symbols/cim/CIMSymbolHelper ../../../../../symbols/cim/Rect ../../../engine/webgl/definitions ../../graphics/graphicsUtils".split(" "),
function(x,F,E,B,k,h,a){function d(m){if(!("visualVariables"in m&&m.hasVisualVariables("size")))return 0;m=m.getVisualVariablesForType("size");if(!m[0])return 0;m=m[0];if("stops"===m.transformationType)return m.stops.map(w=>w.size).reduce(l,0);if("clamped-linear"===m.transformationType){let w=-Infinity,v=-Infinity;w="number"===typeof m.maxSize?m.maxSize:m.maxSize.stops.map(C=>C.size).reduce(l,0);v="number"===typeof m.minSize?m.minSize:m.minSize.stops.map(C=>C.size).reduce(l,0);return Math.max(w,v)}if("real-world-size"===
m.transformationType)return 30}function c(){c=F._asyncToGenerator(function*(m,w,v){if(!m||v&&"cluster"===v.type)return 0;if("heatmap"===m.type)return Math.round(3*m.blurRadius);if("dot-density"===m.type)return 0;if("dictionary"===m.type)return"esriGeometryPoint"===w||"esriGeometryMultipoint"===w?100:200;w=m.getSymbols();m=d(m);v=[];for(var C of w)v.push(r(C,m));C=yield Promise.all(v);return E.pt2px(C.reduce(l,0))});return c.apply(this,arguments)}function b(m,w){return null==m?w:m}function e(m,w){return f.apply(this,
arguments)}function f(){f=F._asyncToGenerator(function*(m,w){if("simple-marker"===m.type)return w=Math.max(b(m.size,12),w),g(m)+.707*w;if("picture-marker"===m.type){var v=Math.max(b(m.height,12),w);w=b(m.width,12)*(v/b(m.height,12))/2;v/=2;return g(m)+Math.sqrt(w*w+v*v)}if("text"===m.type){if(v=m.text&&m.text.length){w=[];for(let C=0;C<v;C++)w.push({...t,code:m.text.charCodeAt(C)});w={glyphMosaicItems:w}}else w={glyphMosaicItems:[t]};a.getTextSymbolSize(u,m.toJSON(),w);return Math.max(Math.abs(u[0]),
Math.abs(u[1]))+Math.max(u[2],u[3])}return"simple-line"===m.type?(v=Math.max(b(m.width,.75),w)/2,m.marker?Math.max(6*m.width,2*w):v):"simple-fill"===m.type||"picture-fill"===m.type?Math.max(null==m.outline?0:b(m.outline.width,0),w)/2:"cim"===m.type?(m=B.CIMSymbolHelper.getEnvelope(m.data))?Math.sqrt(m.width*m.width+m.height*m.height):0:"web-style"===m.type?e(yield m.fetchCIMSymbol(),w):0});return f.apply(this,arguments)}function r(m,w){return q.apply(this,arguments)}function q(){q=F._asyncToGenerator(function*(m,
w){return m.type in n?Math.min(yield e(m,w),75):0});return q.apply(this,arguments)}function g(m){const w=b(m.xoffset,0);m=b(m.yoffset,0);return Math.sqrt(w*w+m*m)}function l(m,w){return Math.max(m,w)}const n={"simple-marker":1,"picture-marker":1,text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1},u=[0,0,0,0],t={sdf:!0,code:99,metrics:h.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,rect:new k(0,0,24,24),page:0,textureBinding:2};x.computePxBuffer=function(m,w,v){return c.apply(this,arguments)};
x.getPtMaxVVSize=d;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("exports ../../../../core/has ../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/mat2d ../../../../chunks/mat2df32 ../../../../chunks/vec2 ../../../../chunks/vec2f32 ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/normalizeUtilsCommon ../../../../geometry/support/spatialReferenceUtils ../../../../symbols/cim/CIMSymbolHelper ../../engine/webgl/alignmentUtils ../../engine/webgl/mesh/templates/shapingUtils ../../engine/webgl/util/BidiText".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n,u){function t(M,O,H,J,P,Q){let U,aa;var ba=B.pt2px(H.xoffset);const ia=B.pt2px(H.yoffset),ha=A*H.angle;Q*=A;switch(H.type){case "esriSMS":U=aa=B.pt2px(H.size);break;case "esriPMS":U=B.pt2px(H.width),aa=B.pt2px(H.height)}.04>P&&(J=.04*J/P);H=k.identity(y);k.translate(H,H,a.set(p,M,O));k.rotate(H,H,Q-ha);k.scale(H,H,a.set(p,J,-J));k.translate(H,H,a.set(p,ba,-ia));M=[0,0];a.transformMat2d(M,a.set(p,-.5*U,-.5*aa),H);O=[0,0];a.transformMat2d(O,a.set(p,-.5*U,.5*
aa),H);J=[0,0];a.transformMat2d(J,a.set(p,.5*U,-.5*aa),H);ba=[0,0];a.transformMat2d(ba,a.set(p,.5*U,.5*aa),H);return{rings:[[M,J,ba,O,M]]}}function m(M,O,H,J,P,Q){var U=g.CIMSymbolHelper.getEnvelope(H.data);if(!U)return null;.04>P&&(J=.04*J/P);P=B.pt2px(U.width);var aa=B.pt2px(U.height);H=B.pt2px(U.x);U=B.pt2px(U.y);const ba=0*A,ia=A*Q;Q=k.identity(y);k.translate(Q,Q,a.set(p,M,O));k.rotate(Q,Q,ia-ba);k.scale(Q,Q,a.set(p,J,J));M=[0,0];a.transformMat2d(M,a.set(p,H,U+aa),Q);O=[0,0];a.transformMat2d(O,
a.set(p,H,U),Q);J=[0,0];a.transformMat2d(J,a.set(p,H+P,U+aa),Q);aa=[0,0];a.transformMat2d(aa,a.set(p,H+P,U),Q);return{rings:[[M,J,aa,O,M]]}}function w(M,O,H,J,P,Q){var U=B.pt2px(H.xoffset),aa=B.pt2px(H.yoffset);H=A*H.angle;const ba=A*Q;Q=k.identity(y);k.translate(Q,Q,a.set(p,M,O));k.rotate(Q,Q,ba);k.scale(Q,Q,a.set(p,P,-P));M=J[0]+J[2]/2;O=J[1]+J[3]/2;k.translate(Q,Q,a.set(p,U,-aa));k.translate(Q,Q,a.set(p,M,O));k.rotate(Q,Q,H);k.translate(Q,Q,a.set(p,-M,-O));U=[0,0];a.transformMat2d(U,a.set(p,J[0],
J[1]),Q);aa=[0,0];a.transformMat2d(aa,a.set(p,J[0],J[1]+J[3]),Q);H=[0,0];a.transformMat2d(H,a.set(p,J[0]+J[2],J[1]),Q);M=[0,0];a.transformMat2d(M,a.set(p,J[0]+J[2],J[1]+J[3]),Q);return{rings:[[U,H,M,aa,U]]}}function v(M){switch(M.symbol.type){case "esriSFS":case "esriPFS":return(M=M.symbol.outline)?M.width:0;case "esriSLS":return B.pt2px(M.symbol.width);case "esriSMS":return B.pt2px(M.symbol.size);case "esriPMS":return B.pt2px(Math.max(M.symbol.width,M.symbol.height));case "esriTS":{const O=[0,0,
0,0];C(O,M.symbol,M.mosaicItem);return Math.max(O[2],O[3])+Math.max(Math.abs(O[0]),Math.abs(O[1]))}case "expanded-cim":M=g.CIMSymbolHelper.getEnvelope(M.symbol.data);if(-Infinity===M.width||-Infinity===M.height)M.width=10,M.height=10,M.x=0,M.y=0;return B.pt2px(Math.sqrt(M.width*M.width+M.height*M.height));case "composite-symbol":return M.symbol.layers.length?v({symbol:M.symbol.layers[M.symbol.layers.length-1],mosaicItem:null}):0;default:return 0}}function C(M,O,H){if(!H||0===H.glyphMosaicItems.length)return M;
const J=u.bidiText(O.text)[1];O=n.shapeGlyphs(H.glyphMosaicItems,J,{scale:B.pt2px(O.font.size)/24,angle:O.angle,xOffset:O.xoffset,yOffset:O.yoffset,hAlign:l.getXAnchorDirection(O.horizontalAlignment||"center"),vAlign:l.getYAnchorDirection(O.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(O.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(O.lineHeight||1,4)),decoration:O.font.decoration||"none",isCIM:!1}).bounds;M[0]=B.pt2px(O.x-O.halfWidth);M[1]=B.pt2px(O.y-O.halfHeight);
M[2]=B.pt2px(O.width);M[3]=B.pt2px(O.height);return M}const A=Math.PI/180,y=h.create(),p=d.create(),z=d.create(),D=d.create(),G=d.create(),I=d.create(),K=d.create(),N=d.create(),L=d.create();x.PIXEL_BUFFER=50;x.TILE_SIZE=512;x.getBounds=function(M,O,H,J,P,Q,U){if(!J||!H.symbol)return M[0]=M[1]=M[2]=M[3]=0,O[0]=O[1]=O[2]=O[3]=0,M;if(e.isPoint(J)){var aa=J.x;const ia=J.y;"esriTS"===H.symbol.type&&0===O[2]&&0===O[3]&&C(O,H.symbol,H.mosaicItem);J=aa;aa=ia;H=H.symbol;switch(H.type){case "esriSMS":case "esriPMS":var ba=
t(J,aa,H,P,Q,0);break;case "esriTS":ba=w(J,aa,H,O,P,0);break;case "cim":case "CIMSymbolReference":case "expanded-cim":ba=m(J,aa,H,P,Q,0)}O=0;for(P=0;P<ba.rings[0].length-1;P++)H=ba.rings[0][P],H=(J-H[0])*(J-H[0])+(aa-H[1])*(aa-H[1]),O=Math.max(O,H);O=Math.sqrt(O);ba=f.normalizeMapX(J-O,U);J=f.normalizeMapX(J+O,U);if(ba>J&&(U=q.getInfo(U))){const [ha,ca]=U.valid;ba=ha;J=ca}M[0]=ba;M[1]=aa-O;M[2]=J;M[3]=aa+O}else b.getBoundsXY(M,J),U=O[0],0===U&&(U=v(H),O[0]=U),U=P*U/2,M[0]-=U,M[1]-=U,M[2]+=U,M[3]+=
U;return M};x.getCIMMarkerBounds=m;x.getMarkerSymbolBounds=t;x.getTextSymbolBounds=w;x.getTextSymbolSize=C;x.graphicGeometryToNumber=function(M){switch(E.unwrap(M.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};x.intersectingInternationalDateline=function(M,O){if(!O.isWrappable)return null;const [H,J]=r.getSpatialReferenceMinMaxX(O);return M[2]>J?[c.create([M[0],M[1],J,M[3]]),c.create([H,M[1],H+M[2]-J,M[3]])]:M[0]<H?[c.create([H,M[1],M[2],M[3]]),c.create([J-
(H-M[0]),M[1],J,M[3]])]:null};x.isMarkerSymbol=function(M){return"simple-marker"===M||"picture-marker"===M||"esriSMS"===M||"esriPMS"===M};x.isPointOnPolyline=function(M,O,H,J){a.set(G,O,H);M=M.paths;let P,Q,U,aa,ba,ia,ha,ca=Infinity;for(let R=0;R<M.length;R++){const Y=M[R];if(!(2>Y.length))for(let ea=1;ea<Y.length;ea++){var S=Y[ea-1][0];Q=Y[ea-1][1];P=Y[ea][0];U=Y[ea][1];aa=Math.min(S,P)-J;ba=Math.min(Q,U)-J;ia=Math.max(S,P)+J;ha=Math.max(Q,U)+J;O<aa||O>ia||H<ba||H>ha||(a.set(z,S,Q),a.set(D,P,U),
a.subtract(I,D,z),a.subtract(K,z,G),a.scale(N,I,a.dot(I,K)/a.dot(I,I)),a.subtract(L,K,N),S=a.dot(L,L),ca>S&&(ca=S))}}return Math.sqrt(ca)<=J};x.isTextSymbol=function(M){return"text"===M||"esriTS"===M};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/rendererUtils":function(){define(["exports","../../../../../core/Logger","../../../../../core/screenUtils"],function(x,F,E){function B(a){return("size"===a.type||"color"===a.type||"opacity"===a.type)&&null!=a.stops}
function k(a){var d=a.type;var c=a.stops;if(8>=c.length)d=c;else if(h.warn(`Found ${c.length} Visual Variable stops, but MapView only supports ${8}. Displayed stops will be simplified.`),16<c.length){{const [u,...t]=c;var b=t.pop(),e=t[0].value,f=t[t.length-1].value,r=(f-e)/6;const m=[];for(;e<f;e+=r){for(var q=0;e>=t[q].value;)q++;var g=t[q],l=c[q-1],n=e-l.value;g=g.value===l.value?1:n/(g.value-l.value);"color"===d?(l=t[q],q=c[q-1],n=l.color.clone(),n.r=(1-g)*q.color.r+g*n.r,n.g=(1-g)*q.color.g+
g*n.g,n.b=(1-g)*q.color.b+g*n.b,n.a=(1-g)*q.color.a+g*n.a,m.push({value:e,color:n,label:l.label})):"size"===d?(l=t[q],n=c[q-1],q=E.toPt(l.size),n=E.toPt(n.size),m.push({value:e,size:(1-g)*n+g*q,label:l.label})):(l=t[q],m.push({value:e,opacity:(1-g)*c[q-1].opacity+g*l.opacity,label:l.label}))}d=[u,...m,b]}}else{{const [u,...t]=c;for(d=t.pop();6<t.length;){b=c=0;for(f=1;f<t.length;f++)r=Math.abs(t[f].value-t[f-1].value),r>b&&(b=r,c=f);t.splice(c,1)}d=[u,...t,d]}}a.stops=d;return a}const h=F.getLogger("esri.renderers.visualVariables.support.utils");
x.simplifyVVRenderer=a=>{if(!("visualVariables"in a&&a.visualVariables&&a.visualVariables.length))return a;a=a.clone();const d=a.visualVariables.map(c=>B(c)?k(c):c);a.visualVariables=d;return a};x.simplifyVisualVariables=function(a){return a.map(d=>B(d)?k(d.clone()):d)};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/support/clusterUtils":function(){define("exports ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine/LevelDependentSizeVariable".split(" "),
function(x,F,E,B,k,h,a,d,c){function b(m,w,v){switch(m){case "avg":case "avg_angle":return`cluster_avg_${w}`;case "mode":return`cluster_type_${w}`;case "norm":return m=w.toLowerCase()+",norm:field,"+v.toLowerCase(),"cluster_avg_"+h.createMD5Hash(m)}}function e(m,w){const {name:v,outStatistic:C}=w,{onStatisticField:A,onStatisticValueExpression:y,statisticType:p}=C;y?(w=h.createMD5Hash(y.toLowerCase()),m.push({name:v,outStatistic:{onStatisticField:w,onStatisticValueExpression:y,statisticType:p}})):
A?m.push({name:v,outStatistic:{onStatisticField:A,statisticType:p}}):q.error(new F("mapview-unsupported-field","Unable to handle field",{field:w}))}function f(m,w,v){const C=h.createMD5Hash(w),A="mode"===v?`cluster_type_${C}`:`cluster_avg_${C}`;m.some(y=>y.name===A)||m.push({name:A,outStatistic:{onStatisticField:C,onStatisticValueExpression:w,statisticType:v}});return A}function r(m,w,v,C){if("cluster_count"===w||m.some(y=>y.name===w))return w;const A=b(v,w,C);m.some(y=>y.name===A)||("norm"===v?m.push({name:A,
outStatistic:{onStatisticField:w,onStatisticNormalizationField:C,statisticType:v}}):m.push({name:A,outStatistic:{onStatisticField:w,statisticType:v}}));return A}const q=B.getLogger("esri.views.2d.layers.support.clusterUtils");E.add("esri-cluster-arcade-enabled",!0);const g=E("esri-cluster-arcade-enabled"),l=m=>{for(const w of m)if("size"===w.type)return w;return null},n=m=>{for(const w of m)if("cluster_count"===w.field)return!0;return!1},u=(m,w)=>{const v=[new d({value:0,size:0}),new d({value:1})];
if(k.isNone(w))return new a({field:"cluster_count",stops:[...v,new d({value:2,size:0})]});const C=Object.keys(w).reduce((A,y)=>({...A,[y]:[...v,new d({value:Math.max(2,w[y].minValue),size:m.clusterMinSize}),new d({value:Math.max(3,w[y].maxValue),size:m.clusterMaxSize})]}),{});return new c.LevelDependentSizeVariable({field:"cluster_count",levels:C})},t=m=>{const w=v=>q.error(new F("Unsupported-renderer",v,{renderer:m}));if("unique-value"===m.type){if(m.field2||m.field3)return w("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),
!1}else if("class-breaks"===m.type){if(m.normalizationField){const v=m.normalizationType;if("field"!==v)return w(`FeatureReductionCluster does not support a normalizationType of ${v}`),!1}}else if("simple"!==m.type)return w(`FeatureReductionCluster does not support renderers of type ${m.type}`),!1;if(!g){if("valueExpression"in m&&m.valueExpression)return w("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in
m&&m.visualVariables||[]).some(v=>!!("valueExpression"in v&&v.valueExpression)))return w("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};x.createClusterCountSizeVariable=u;x.createClusterRenderer=(m,w,v,C)=>{w=w.clone();if(!t(w))return w;if(v.fields)for(var A of v.fields)e(m,A);if("visualVariables"in w){A=(w.visualVariables||[]).filter(p=>"$view.scale"!==p.valueExpression);const y=l(A);A.forEach(p=>
{"rotation"===p.type?p.field?p.field=r(m,p.field,"avg_angle"):p.valueExpression&&(p.field=f(m,p.valueExpression,"avg_angle"),p.valueExpression=null):p.normalizationField?(p.field=r(m,p.field,"norm",p.normalizationField),p.normalizationField=null):p.field?p.field=r(m,p.field,"avg"):(p.field=f(m,p.valueExpression,"avg"),p.valueExpression=null)});k.isNone(y)&&!n(A)&&(A.push(u(v,C)),w.dynamicClusterSize=!0);w.visualVariables=A}switch(w.type){case "unique-value":w.field?w.field=r(m,w.field,"mode"):w.valueExpression&&
(w.field=f(m,w.valueExpression,"mode"),w.valueExpression=null);break;case "class-breaks":w.normalizationField?(w.field=r(m,w.field,"norm",w.normalizationField),w.normalizationField=null):w.field?w.field=r(m,w.field,"avg"):(w.field=f(m,w.valueExpression,"avg"),w.valueExpression=null)}return w};x.findSizeVV=l;x.hasClusterCountVV=n;x.isClusterCompatibleRenderer=t;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/core/MD5":function(){define(["exports"],function(x){function F(d,c){const b=(d&65535)+
(c&65535);return(d>>16)+(c>>16)+(b>>16)<<16|b&65535}function E(d,c,b,e,f,r){d=F(F(c,d),F(e,r));return F(d<<f|d>>>32-f,b)}function B(d,c,b,e,f,r,q){return E(c&b|~c&e,d,c,f,r,q)}function k(d,c,b,e,f,r,q){return E(c&e|b&~e,d,c,f,r,q)}function h(d,c,b,e,f,r,q){return E(b^(c|~e),d,c,f,r,q)}const a={Base64:0,Hex:1,String:2,Raw:3};x.createMD5Hash=function(d,c=a.Hex){c=c||a.Base64;var b=[];for(let f=0,r=8*d.length;f<r;f+=8)b[f>>5]|=(d.charCodeAt(f/8)&255)<<f%32;{d=8*d.length;b[d>>5]|=128<<d%32;b[(d+64>>>
9<<4)+14]=d;d=1732584193;var e=-271733879;let f=-1732584194,r=271733878;for(let q=0;q<b.length;q+=16){const g=d,l=e,n=f,u=r;d=B(d,e,f,r,b[q+0],7,-680876936);r=B(r,d,e,f,b[q+1],12,-389564586);f=B(f,r,d,e,b[q+2],17,606105819);e=B(e,f,r,d,b[q+3],22,-1044525330);d=B(d,e,f,r,b[q+4],7,-176418897);r=B(r,d,e,f,b[q+5],12,1200080426);f=B(f,r,d,e,b[q+6],17,-1473231341);e=B(e,f,r,d,b[q+7],22,-45705983);d=B(d,e,f,r,b[q+8],7,1770035416);r=B(r,d,e,f,b[q+9],12,-1958414417);f=B(f,r,d,e,b[q+10],17,-42063);e=B(e,f,
r,d,b[q+11],22,-1990404162);d=B(d,e,f,r,b[q+12],7,1804603682);r=B(r,d,e,f,b[q+13],12,-40341101);f=B(f,r,d,e,b[q+14],17,-1502002290);e=B(e,f,r,d,b[q+15],22,1236535329);d=k(d,e,f,r,b[q+1],5,-165796510);r=k(r,d,e,f,b[q+6],9,-1069501632);f=k(f,r,d,e,b[q+11],14,643717713);e=k(e,f,r,d,b[q+0],20,-373897302);d=k(d,e,f,r,b[q+5],5,-701558691);r=k(r,d,e,f,b[q+10],9,38016083);f=k(f,r,d,e,b[q+15],14,-660478335);e=k(e,f,r,d,b[q+4],20,-405537848);d=k(d,e,f,r,b[q+9],5,568446438);r=k(r,d,e,f,b[q+14],9,-1019803690);
f=k(f,r,d,e,b[q+3],14,-187363961);e=k(e,f,r,d,b[q+8],20,1163531501);d=k(d,e,f,r,b[q+13],5,-1444681467);r=k(r,d,e,f,b[q+2],9,-51403784);f=k(f,r,d,e,b[q+7],14,1735328473);e=k(e,f,r,d,b[q+12],20,-1926607734);d=E(e^f^r,d,e,b[q+5],4,-378558);r=E(d^e^f,r,d,b[q+8],11,-2022574463);f=E(r^d^e,f,r,b[q+11],16,1839030562);e=E(f^r^d,e,f,b[q+14],23,-35309556);d=E(e^f^r,d,e,b[q+1],4,-1530992060);r=E(d^e^f,r,d,b[q+4],11,1272893353);f=E(r^d^e,f,r,b[q+7],16,-155497632);e=E(f^r^d,e,f,b[q+10],23,-1094730640);d=E(e^f^
r,d,e,b[q+13],4,681279174);r=E(d^e^f,r,d,b[q+0],11,-358537222);f=E(r^d^e,f,r,b[q+3],16,-722521979);e=E(f^r^d,e,f,b[q+6],23,76029189);d=E(e^f^r,d,e,b[q+9],4,-640364487);r=E(d^e^f,r,d,b[q+12],11,-421815835);f=E(r^d^e,f,r,b[q+15],16,530742520);e=E(f^r^d,e,f,b[q+2],23,-995338651);d=h(d,e,f,r,b[q+0],6,-198630844);r=h(r,d,e,f,b[q+7],10,1126891415);f=h(f,r,d,e,b[q+14],15,-1416354905);e=h(e,f,r,d,b[q+5],21,-57434055);d=h(d,e,f,r,b[q+12],6,1700485571);r=h(r,d,e,f,b[q+3],10,-1894986606);f=h(f,r,d,e,b[q+10],
15,-1051523);e=h(e,f,r,d,b[q+1],21,-2054922799);d=h(d,e,f,r,b[q+8],6,1873313359);r=h(r,d,e,f,b[q+15],10,-30611744);f=h(f,r,d,e,b[q+6],15,-1560198380);e=h(e,f,r,d,b[q+13],21,1309151649);d=h(d,e,f,r,b[q+4],6,-145523070);r=h(r,d,e,f,b[q+11],10,-1120210379);f=h(f,r,d,e,b[q+2],15,718787259);e=h(e,f,r,d,b[q+9],21,-343485551);d=F(d,g);e=F(e,l);f=F(f,n);r=F(r,u)}b=[d,e,f,r]}switch(c){case a.Raw:return b;case a.Hex:c=[];for(let f=0,r=4*b.length;f<r;f++)c.push("0123456789abcdef".charAt(b[f>>2]>>f%4*8+4&15)+
"0123456789abcdef".charAt(b[f>>2]>>f%4*8&15));return c=c.join("");case a.String:c=[];for(let f=0,r=32*b.length;f<r;f+=8)c.push(String.fromCharCode(b[f>>5]>>>f%32&255));return c=c.join("");case a.Base64:c=[];for(let f=0,r=4*b.length;f<r;f+=3)for(d=(b[f>>2]>>f%4*8&255)<<16|(b[f+1>>2]>>(f+1)%4*8&255)<<8|b[f+2>>2]>>(f+2)%4*8&255,e=0;4>e;e++)8*f+6*e>32*b.length?c.push("\x3d"):c.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>6*(3-e)&63));return c=c.join("")}};x.outputTypes=
a;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r){var q;x.LevelDependentSizeVariable=q=function(g){function l(){return g.apply(this,arguments)||this}F._inheritsLoose(l,g);var n=l.prototype;n.writeLevels=function(u,t,m){for(const w in u){t.stops=this.levels[w];break}};n.clone=function(){return new q({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:r.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:r.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(u=>u.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:B.clone(this.levels)})};return l}(f);E.__decorate([k.property()],x.LevelDependentSizeVariable.prototype,"levels",void 0);
E.__decorate([e.writer("levels")],x.LevelDependentSizeVariable.prototype,"writeLevels",null);x.LevelDependentSizeVariable=q=E.__decorate([b.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],x.LevelDependentSizeVariable);Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/support/util":function(){define(["exports","../../../../core/jsonMap"],function(x,F){const E=new F.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",
esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});x.analyzeRings=function(B,k,h){const a=[],d=[];let c=0,b=0;for(const e of B){B=b;let f=e[0][0],r=e[0][1];a[b++]=f;a[b++]=r;let q=0;for(let g=1;g<e.length;++g){const l=f,n=r;f=e[g][0];r=e[g][1];q+=r*l-f*n;a[b++]=f;a[b++]=r}k(q/2);0<q?(0<B-c&&(h(c,B,a,d),c=B),d.length=0):0>q?0<B-c?d.push(.5*(B-c)):b=B:b=B}0<b-c&&h(c,b,a,d)};x.toJSONGeometryType=function(B){return E.toJSON(B)};Object.defineProperty(x,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../support/arcadeOnDemand ../../../../../symbols/cim/cimSymbolUtils ../../../../../symbols/cim/utils ../../../arcade/callExpressionWithFeature ../../../layers/features/schemaUtils".split(" "),function(x,F,E,B,k,h,a,d,c,b,e){function f(v,C,A){return r.apply(this,arguments)}function r(){r=
E._asyncToGenerator(function*(v,C,A){switch(v.type){case "simple":return n.fromBasicRenderer(v,C,A);case "map":return m.fromUVRenderer(v,C,A);case "interval":return t.fromCBRenderer(v,C,A);case "dictionary":return w.fromDictionaryRenderer(v,C,A);case "subtype":return u.fromSubtypes(v,C,A)}});return r.apply(this,arguments)}function q(v,C){return g.apply(this,arguments)}function g(){g=E._asyncToGenerator(function*(v,C){const A=v||1;if("number"===typeof A)return(p,z,D)=>A;const y=yield a.createRendererExpression(A,
C.spatialReference,C.fields);return(p,z,D)=>b(y,p,{$view:D},C.geometryType,z)||1});return g.apply(this,arguments)}const l=k.getLogger("esri/views/2d/engine/webgl/util/Matcher");let n=function(){function v(){this.type="feature";this._defaultResult=null}v.fromBasicRenderer=function(){var A=E._asyncToGenerator(function*(y,p,z){const D=new v;y.symbol&&(y=yield d.expandSymbol(y.symbol,z),p=p.createTemplateGroup(y,null),D.setDefault(p));return D});return function(y,p,z){return A.apply(this,arguments)}}();
var C=v.prototype;C.size=function(){return 1};C.getDefault=function(){return this._defaultResult};C.setDefault=function(A){this._defaultResult=A};C.match=function(A,y,p,z,D){return this.getDefault()};C.analyze=function(){var A=E._asyncToGenerator(function*(y,p,z,D,G){return null});return function(y,p,z,D,G){return A.apply(this,arguments)}}();return v}(),u=function(v){function C(A,y){var p=v.call(this)||this;p._subMatchers=A;p._subtypeField=y;return p}E._inheritsLoose(C,v);C.fromSubtypes=function(){var A=
E._asyncToGenerator(function*(y,p,z){const D=new Map,G=[];for(const I in y.renderers){const K=parseInt(I,10),N=f(y.renderers[I],p,z).then(L=>D.set(K,L));G.push(N)}yield Promise.all(G);return new C(D,y.subtypeField)});return function(y,p,z){return A.apply(this,arguments)}}();C.prototype.match=function(A,y,p,z,D){var G=y.readAttribute(this._subtypeField);return(G=this._subMatchers.get(G))?G.match(A,y,p,z,D):null};return C}(n),t=function(v){function C(y,p,z,D){var G=v.call(this)||this;G.type="interval";
G._intervals=[];G._isMaxInclusive=p;G._fieldIndex=D;G._field=y;G._normalizationInfo=z;return G}E._inheritsLoose(C,v);C.fromCBRenderer=function(){var y=E._asyncToGenerator(function*(p,z,D){const {isMaxInclusive:G,normalizationField:I,normalizationTotal:K,normalizationType:N}=p,L=new C(p.field,G,{normalizationField:I,normalizationTotal:K,normalizationType:N},p.fieldIndex),M=yield d.expandSymbol(p.backgroundFillSymbol,D);yield Promise.all(p.intervals.map(function(){var O=E._asyncToGenerator(function*(H){var J=
yield d.expandSymbol(H.symbol,D);J=yield z.createTemplateGroup(J,M);L.add({min:H.min,max:H.max},J)});return function(H){return O.apply(this,arguments)}}()));if(p=yield d.expandSymbol(p.defaultSymbol,D))p=yield z.createTemplateGroup(p,M),L.setDefault(p);return L});return function(p,z,D){return y.apply(this,arguments)}}();var A=C.prototype;A.add=function(y,p){this._intervals.push({interval:y,result:p});this._intervals.sort((z,D)=>z.interval.min-D.interval.min)};A.size=function(){return v.prototype.size.call(this)+
this._intervals.length};A.match=function(y,p,z,D,G){if(null==this._fieldIndex&&!this._field)return this.getDefault();y=null!=this._fieldIndex?p.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(p);if(!y&&(null===y||void 0===y||isNaN(y)))return this.getDefault();for(p=0;p<this._intervals.length;p++){const {interval:I,result:K}=this._intervals[p];z=this._isMaxInclusive?y<=I.max:y<I.max;if(y>=I.min&&z)return K}return this.getDefault()};A._needsNormalization=function(){const y=this._normalizationInfo;
return y&&(y.normalizationField||y.normalizationTotal||y.normalizationType)};A._getValueFromField=function(y){const p=y.readAttribute(this._field);if(!this._needsNormalization()||null==p)return p;const {normalizationField:z,normalizationTotal:D,normalizationType:G}=this._normalizationInfo;y=!!z&&y.readAttribute(z);if(G)switch(G){case "esriNormalizeByField":return(y||void 0)&&p/y;case "esriNormalizeByLog":return Math.log(p)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return p/D*100;default:l.error(`Found unknown normalization type: ${G}`)}else l.error("Normalization is required, but no type was set!")};
return C}(n),m=function(v){function C(y,p,z){var D=v.call(this)||this;D.type="map";D._nullResult=null;D._resultsMap=new Map;D._fieldsIndex=z;D._fields=y;D._seperator=p||"";return D}E._inheritsLoose(C,v);C.fromUVRenderer=function(){var y=E._asyncToGenerator(function*(p,z,D){const G=p.fieldDelimiter,I=[p.field];p.field2&&I.push(p.field2);p.field3&&I.push(p.field3);const K=yield d.expandSymbol(p.backgroundFillSymbol,D),N=new C(I,G,p.fieldIndex);yield Promise.all(p.map.map(function(){var L=E._asyncToGenerator(function*(M){var O=
yield d.expandSymbol(M.symbol,D);O=yield z.createTemplateGroup(O,K);"\x3cNull\x3e"===M.value?N.setNullResult(O):N.add(M.value,O)});return function(M){return L.apply(this,arguments)}}()));if(p=yield d.expandSymbol(p.defaultSymbol,D))p=yield z.createTemplateGroup(p,K),N.setDefault(p);return N});return function(p,z,D){return y.apply(this,arguments)}}();var A=C.prototype;A.setNullResult=function(y){this._nullResult=y};A.add=function(y,p){this._resultsMap.set(y.toString(),p)};A.size=function(){return v.prototype.size.call(this)+
this._resultsMap.size};A.match=function(y,p,z,D,G){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();y=null!=this._fieldsIndex?p.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(p);if(null!==this._nullResult&&(null==y||""===y||"\x3cNull\x3e"===y))return this._nullResult;if(!y&&null==y)return this.getDefault();y=y.toString();return this._resultsMap.has(y)?this._resultsMap.get(y):this.getDefault()};A._getValueFromFields=function(y){const p=[];for(const z of this._fields){const D=
y.readAttribute(z);null==D||""===D?p.push("\x3cNull\x3e"):p.push(D)}return p.join(this._seperator)};return C}(n),w=function(v){function C(y,p,z,D){var G=v.call(this)||this;G.type="dictionary";G._groupIdCache=new h(100);G._renderer=y;G._fieldMap=y.fieldMap;G._symbolFields=y.getSymbolFields();G._templates=p;G._info=z;G._scaleFn=D;return G}E._inheritsLoose(C,v);C.fromDictionaryRenderer=function(){var y=E._asyncToGenerator(function*(p,z,D){p=(yield new Promise(function(I,K){x(["../../../../../renderers/DictionaryRenderer"],
function(N){I(Object.freeze({__proto__:null,"default":N}))},K)})).default.fromJSON(p.renderer);yield p.fetchResources({spatialReference:D.spatialReference,fields:D.fields});const G=yield q(p.scaleExpression,D);return new C(p,z,D,G)});return function(p,z,D){return y.apply(this,arguments)}}();var A=C.prototype;A._analyzeFeature=function(){var y=E._asyncToGenerator(function*(p,z,D,G){p=p.readLegacyFeature();const I=this._scaleFn(p,z,D);z=this._attributeHash(p)+"-"+I;const K=this._groupIdCache.get(z);
if(K)return K;D=yield this._renderer.getSymbolAsync(p,{...D,spatialReference:this._info.spatialReference,abortOptions:G,fields:this._info.fields});D=e.createSymbolSchema(D,this._renderer);G=d.expandSymbol(D,this._info,G).then(N=>{if("expanded-cim"!==N.type)return l.error(new B("mapview-bad-type",`Found unexpected type ${N.type} in dictionary response`)),null;N.hash+="-"+I;for(const L of N.layers)L.scaleFactor=I,L.templateHash+="-"+I,"text"===L.type&&"string"===typeof L.text&&-1<L.text.indexOf("[")&&
(L.text=c.createLabelOverrideFunction(this._fieldMap,L.text,L.cim.textCase));return this._templates.createTemplateGroup(N,null)});this._groupIdCache.put(z,G,1);return G});return function(p,z,D,G){return y.apply(this,arguments)}}();A.analyze=function(){var y=E._asyncToGenerator(function*(p,z,D,G,I){p=z.getCursor();for(z=[];p.next();)z.push(this._analyzeFeature(p,D,G,I));return Promise.all(z)});return function(p,z,D,G,I){return y.apply(this,arguments)}}();A.match=function(y,p,z,D,G){return null};A._attributeHash=
function(y){let p="";for(const z of this._symbolFields){const D=this._fieldMap[z];D&&(p+=y.attributes[D]+"-")}return p};return C}(n);F.DictionaryMatcher=w;F.FeatureMatcher=n;F.IntervalMatcher=t;F.MapMatcher=m;F.SubtypeMatcher=u;F.createMatcher=f;Object.defineProperty(F,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports","./displayIdUtils","./StaticBitSet"],function(x,F,E){function B(h,a,d){if(!(h.length>a))for(;h.length<=a;)h.push(d)}
let k=function(){function h(){this._numerics=[];this._strings=[];this._idGenerator=new F.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var a=h.prototype;a.createBitset=function(){const d=this._bitsets.length;this._bitsets.push(E.StaticBitSet.create(this._allocatedSize,2147483647));return d+1};a.getBitset=function(d){return this._bitsets[d-1]};a._expand=function(){this._allocatedSize<<=1;for(const d of this._bitsets)d.resize(this._allocatedSize)};
a._ensureNumeric=function(d,c){this._numerics[d]||(this._numerics[d]=[]);B(this._numerics[d],c,0)};a._ensureInstanceId=function(d){B(this._instanceIds,d,0)};a._ensureString=function(d,c){this._strings[d]||(this._strings[d]=[]);B(this._strings[d],c,null)};a.createDisplayId=function(d=!1){const c=this._idGenerator.createId();c>this._allocatedSize&&this._expand();return((d?2147483648:0)|c)>>>0};a.releaseDisplayId=function(d){for(const c of this._bitsets)c.unset(d);return this._idGenerator.releaseId(d&
2147483647)};a.getComputedNumeric=function(d,c){return this.getComputedNumericAtIndex(d&2147483647,0)};a.setComputedNumeric=function(d,c,b){return this.setComputedNumericAtIndex(d&2147483647,b,0)};a.getComputedString=function(d,c){return this.getComputedStringAtIndex(d&2147483647,0)};a.setComputedString=function(d,c,b){return this.setComputedStringAtIndex(d&2147483647,0,b)};a.getComputedNumericAtIndex=function(d,c){d&=2147483647;this._ensureNumeric(c,d);return this._numerics[c][d]};a.setComputedNumericAtIndex=
function(d,c,b){d&=2147483647;this._ensureNumeric(c,d);this._numerics[c][d]=b};a.getInstanceId=function(d){d&=2147483647;this._ensureInstanceId(d);return this._instanceIds[d]};a.setInstanceId=function(d,c){d&=2147483647;this._ensureInstanceId(d);this._instanceIds[d]=c};a.getComputedStringAtIndex=function(d,c){d&=2147483647;this._ensureString(c,d);return this._strings[c][d]};a.setComputedStringAtIndex=function(d,c,b){d&=2147483647;this._ensureString(c,d);this._strings[c][d]=b};a.getXMin=function(d){return this._bounds[4*
(d&2147483647)]};a.getYMin=function(d){return this._bounds[4*(d&2147483647)+1]};a.getXMax=function(d){return this._bounds[4*(d&2147483647)+2]};a.getYMax=function(d){return this._bounds[4*(d&2147483647)+3]};a.setBounds=function(d,c){c=c.readHydratedGeometry();if(!c||!c.coords.length)return!1;let b=Infinity,e=Infinity,f=-Infinity,r=-Infinity;c.forEachVertex((q,g)=>{b=Math.min(b,q);e=Math.min(e,g);f=Math.max(f,q);r=Math.max(r,g)});d&=2147483647;B(this._bounds,4*d+4,0);this._bounds[4*d]=b;this._bounds[4*
d+1]=e;this._bounds[4*d+2]=f;this._bounds[4*d+3]=r;return!0};return h}();x.ComputedAttributeStorage=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/displayIdUtils":function(){define(["exports"],function(x){let F=function(){function E(){this._freeIds=[];this._idCounter=1}var B=E.prototype;B.createId=function(k=!1){var h=this._getFreeId();return((k?2147483648:0)|h)>>>0};B.releaseId=function(k){this._freeIds.push(k)};B._getFreeId=function(){return this._freeIds.length?
this._freeIds.pop():this._idCounter++};return E}();x.DISPLAY_ID_TYPE_AGGREGATE=1;x.DISPLAY_ID_TYPE_FEATURE=0;x.DisplayIdGenerator=F;x.getDisplayIdIndex=function(E){return E&2147483647};x.getDisplayIdType=function(E){return(E&2147483648)>>>31};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/GraphicsReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader ./FeatureSetReaderJSON".split(" "),
function(x,F,E,B,k,h){h=function(a){function d(b,e){return a.call(this,b,e,null)||this}F._inheritsLoose(d,a);d.from=function(b){const e=k.FeatureSetReader.createInstance(),f=[];b=b.filter(r=>!!r.geometry);for(const r of b)b=E.getJsonType(r.geometry),B.convertFromGraphics(f,[r],b,!1,!1,"uid");return new d(e,f)};var c=d.prototype;c.readGraphic=function(){return this._current};c.getCursor=function(){return this.copy()};c.copy=function(){const b=new d(this.instance,this._features);this.copyInto(b);return b};
F._createClass(d,[{key:"geometryType",get:function(){const b=this._current;return b?b.geometryType:null}},{key:"insertAfter",get:function(){return this._current.insertAfter}}]);return d}(h.FeatureSetReaderJSON);x.GraphicsReader=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),
function(x,F,E,B,k,h,a,d,c,b){let e=0;E=function(){function f(q){this.type="FeatureSetReader";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=null;this._joined=[];this._objectIdToIndex=null;this.instance=q}f.createInstance=function(){e++;return e=65535<e?0:e};var r=f.prototype;r.setArcadeSpatialReference=function(q){this._arcadeSpatialReference=q};r.attachStorage=function(q){this._storage=q};r.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");
};r.getStorage=function(){return this._storage};r.getComputedNumeric=function(q){return this.getComputedNumericAtIndex(0)};r.setComputedNumeric=function(q,g){return this.setComputedNumericAtIndex(g,0)};r.getComputedString=function(q){return this.getComputedStringAtIndex(0)};r.setComputedString=function(q,g){return this.setComputedStringAtIndex(0,g)};r.getComputedNumericAtIndex=function(q){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),q)};r.setComputedNumericAtIndex=function(q,
g){this._storage.setComputedNumericAtIndex(this.getDisplayId(),q,g)};r.getComputedStringAtIndex=function(q){return this._storage.getComputedStringAtIndex(this.getDisplayId(),q)};r.setComputedStringAtIndex=function(q,g){return this._storage.setComputedStringAtIndex(this.getDisplayId(),q,g)};r.transform=function(q,g,l,n){const u=this.copy();u._tx+=q;u._ty+=g;u._sx*=l;u._sy*=n;return u};r.readAttribute=function(q,g=!1){var l=this._readAttribute(q,g);if(void 0!==l)return l;for(const n of this._joined)if(n.setIndex(this.getIndex()),
l=n._readAttribute(q,g),void 0!==l)return l};r.readAttributes=function(){const q=this._readAttributes();for(const g of this._joined){g.setIndex(this.getIndex());const l=g._readAttributes();for(const n of Object.keys(l))q[n]=l[n]}return q};r.joinAttributes=function(q){this._joined.push(q)};r.readArcadeFeature=function(){return this};r.geometry=function(){var q=this.readHydratedGeometry();q=a.convertToGeometry(q,this.geometryType,this.hasZ,this.hasM);if(q=b.fromJSON(q))q.spatialReference=this._arcadeSpatialReference;
return q};r.field=function(q){return this.readAttribute(q,!0)};r.hasField=function(q){return!0};r.setField=function(q,g){};r.keys=function(){return[]};r.castToText=function(){return""};r.removeIds=function(q){if(k.isNone(this._objectIdToIndex)){var g=new Map;const l=this.getCursor();for(;l.next();)g.set(l.getObjectId(),l.getIndex());this._objectIdToIndex=g}g=this._objectIdToIndex;for(const l of q)g.has(l)&&this.removeAtIndex(g.get(l))};r.removeAtIndex=function(q){k.isNone(this._deleted)&&(this._deleted=
c.StaticBitSet.create(this.getSize()));this._deleted.set(q)};r.features=function*(){const q=this.getCursor();for(;q.next();)yield q.readOptimizedFeature()};r._getExists=function(){return k.isNone(this._deleted)||!this._deleted.has(this.getIndex())};r._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;const q=this.readUnquantizedGeometry();if(!q||q.hasIndeterminateRingOrder)return null;const g=k.unwrapOr(this.getQuantizationTransform(),null);return h.getCentroidOptimizedGeometry(new d,
q,this.hasM,this.hasZ,g)};r.copyInto=function(q){q.seen=this.seen;q._storage=this._storage;q._arcadeSpatialReference=this._arcadeSpatialReference;q._joined=this._joined;q._tx=this._tx;q._ty=this._ty;q._sx=this._sx;q._sy=this._sy;q._deleted=this._deleted;q._objectIdToIndex=this._objectIdToIndex};F._createClass(f,[{key:"isEmpty",get:function(){return k.isSome(this._deleted)&&this._deleted.countSet()===this.getSize()}}]);return f}();x.FeatureSetReader=E;Object.defineProperty(x,"__esModule",{value:!0})})},
"esri/layers/graphics/centroid":function(){define(["exports"],function(x){function F(B,k,h,a,d,c,b=1){c=d?c?4:3:c?3:2;let e=h,f=h+c,r=0,q=0,g=h=0,l=0;for(let n=0,u=a-1;n<u;n++,e+=c,f+=c){a=k[e];const t=k[e+1],m=k[e+2],w=k[f],v=k[f+1],C=k[f+2];let A=a*v-w*t;g+=A;r+=(a+w)*A;q+=(t+v)*A;d&&(A=a*C-w*m,h+=(m+C)*A,l+=A);a<B[0]&&(B[0]=a);a>B[1]&&(B[1]=a);t<B[2]&&(B[2]=t);t>B[3]&&(B[3]=t);d&&(m<B[4]&&(B[4]=m),m>B[5]&&(B[5]=m))}0<g*b&&(g*=-1);0<l*b&&(l*=-1);if(!g)return null;B=[r,q,.5*g];d&&(B[3]=h,B[4]=.5*
l);return B}function E(B,k,h,a,d){d=a?d?4:3:d?3:2;let c=k,b=k+d,e=0,f=0,r=0,q=0;for(let u=0,t=h-1;u<t;u++,c+=d,b+=d){var g=B[c];const m=B[c+1],w=B[c+2],v=B[b],C=B[b+1],A=B[b+2];if(a){{var l=v-g;var n=C-m;const y=A-w;l=Math.sqrt(l*l+n*n+y*y)}}else l=v-g,n=C-m,l=Math.sqrt(l*l+n*n);l&&(e+=l,a?(g=[g+.5*(v-g),m+.5*(C-m),w+.5*(A-w)],f+=l*g[0],r+=l*g[1],q+=l*g[2]):(g=[g+.5*(v-g),m+.5*(C-m)],f+=l*g[0],r+=l*g[1]))}return 0<e?a?[f/e,r/e,q/e]:[f/e,r/e]:0<h?a?[B[k],B[k+1],B[k+2]]:[B[k],B[k+1]]:null}x.getCentroidOptimizedGeometry=
function(B,k,h,a,d){if(!k||!k.lengths.length)return null;const c="upperLeft"===(null==d?void 0:d.originPosition)?-1:1;B.lengths.length&&(B.lengths.length=0);B.coords.length&&(B.coords.length=0);d=B.coords;const b=[],e=h?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:r}=k,q=h?
a?4:3:a?3:2;let g=0;for(var l of f){const n=F(e,r,g,l,h,a,c);n&&b.push(n);g+=l*q}b.sort((n,u)=>{let t=c*n[2]-c*u[2];0===t&&h&&(t=n[4]-u[4]);return t});b.length&&(l=6*b[0][2],d[0]=b[0][0]/l,d[1]=b[0][1]/l,h&&(l=6*b[0][4],d[2]=0!==l?b[0][3]/l:0),d[0]<e[0]||d[0]>e[1]||d[1]<e[2]||d[1]>e[3]||h&&(d[2]<e[4]||d[2]>e[5]))&&(d.length=0);if(!d.length)if(k=k.lengths[0]?E(r,0,f[0],h,a):null)d[0]=k[0],d[1]=k[1],h&&2<k.length&&(d[2]=k[2]);else return null;return B};x.lineCentroid=E;Object.defineProperty(x,"__esModule",
{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../../../../../layers/graphics/featureConversionUtils","./FeatureSetReader"],function(x,F,E,B,k){function h({coords:d,lengths:c}){let b=0;for(const e of c){for(c=1;c<e;c++)d[2*(b+c)]+=d[2*(b+c)-2],d[2*(b+c)+1]+=d[2*(b+c)-1];b+=e}}let a=function(d){function c(e,f,r){e=d.call(this,e)||this;e._featureIndex=-1;e._dateFields=
new Set;e._geometryType=r;e._features=f;return e}F._inheritsLoose(c,d);c.fromFeatures=function(e,f,r){r=B.convertFromFeatures([],e,f,!1,!1,r);for(let q=0;q<r.length;q++)r[q].displayId=e[q].displayId;return c.fromOptimizedFeatures(r,f)};c.fromFeatureSet=function(e,f){e=B.convertFromFeatureSet(e,f);return c.fromOptimizedFeatureSet(e)};c.fromOptimizedFeatureSet=function(e){const {features:f,geometryType:r}=e,q=c.fromOptimizedFeatures(f,r);q._exceededTransferLimit=e.exceededTransferLimit;q._transform=
e.transform;for(const g of e.fields)"esriFieldTypeDate"===g.type&&q._dateFields.add(g.name);return q};c.fromOptimizedFeatures=function(e,f,r){const q=k.FeatureSetReader.createInstance();e=new c(q,e,f);e._transform=r;return e};var b=c.prototype;b.removeIds=function(e){const f=new Set(e);this._features=this._features.filter(r=>!f.has(r.objectId))};b.append=function(e){for(const f of e)this._features.push(f)};b.getSize=function(){return this._features.length};b.getCursor=function(){return this.copy()};
b.getQuantizationTransform=function(){return this._transform};b.getAttributeHash=function(){let e="";for(const f in this._current.attributes)e+=this._current.attributes[f];return e};b.getIndex=function(){return this._featureIndex};b.setIndex=function(e){this._featureIndex=e};b.getObjectId=function(){return this._current.objectId};b.getDisplayId=function(){return this._current.displayId};b.setDisplayId=function(e){this._current.displayId=e};b.getGroupId=function(){return this._current.groupId};b.setGroupId=
function(e){this._current.groupId=e};b.copy=function(){const e=new c(this.instance,this._features,this.geometryType);this.copyInto(e);return e};b.next=function(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};b.readLegacyFeature=function(){return B.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};b.readOptimizedFeature=function(){return this._current};b.readLegacyPointGeometry=function(){return this.readGeometry()?
{x:this.getX(),y:this.getY()}:null};b.readLegacyGeometry=function(){const e=this.readGeometry();return B.convertToGeometry(e,this.geometryType,this.hasZ,this.hasM)};b.readLegacyCentroid=function(){const e=this.readCentroid();return e?{x:e.coords[0]*this._sx+this._tx,y:e.coords[1]*this._sy+this._ty}:null};b.readGeometryArea=function(){return B.getQuantizedArea(this._current.geometry,2)};b.readUnquantizedGeometry=function(){var e=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!e)return e;
e=e.clone();h(e);return e};b.readHydratedGeometry=function(){var e=this._current.geometry;if(!e)return null;e=e.clone();E.isSome(this._transform)&&B.unquantizeOptimizedGeometry(e,e,this.hasZ,this.hasM,this._transform);return e};b.getXHydrate=function(){const e=this._current.geometry.coords[0],f=this.getQuantizationTransform();return E.isNone(f)?e:e*f.scale[0]+f.translate[0]};b.getYHydrate=function(){const e=this._current.geometry.coords[1],f=this.getQuantizationTransform();return E.isNone(f)?e:f.translate[1]-
e*f.scale[1]};b.getX=function(){return this._current.geometry.coords[0]*this._sx+this._tx};b.getY=function(){return this._current.geometry.coords[1]*this._sy+this._ty};b.readGeometry=function(){if(!this._current.hasGeometry)return null;const e=this._current.geometry.clone();if(e.isPoint)return e.coords[0]=e.coords[0]*this._sx+this._tx,e.coords[1]=e.coords[1]*this._sy+this._ty,e;let f=0;for(const r of e.lengths)e.coords[2*f]=e.coords[2*f]*this._sx+this._tx,e.coords[2*f+1]=e.coords[2*f+1]*this._sy+
this._ty,f+=r;return e};b.readCentroid=function(){if(!this._current.hasGeometry)return null;if(!this._current.centroid){var e=this._computeCentroid();if(!e)return null;e.coords[0]=(e.coords[0]-this._tx)/this._sx;e.coords[1]=(e.coords[1]-this._ty)/this._sy;this._current.centroid=e}e=this._current.centroid.clone();e.coords[0]=e.coords[0]*this._sx+this._tx;e.coords[1]=e.coords[1]*this._sx+this._ty;return e};b._readAttribute=function(e,f){var r=this._current.attributes[e];if(void 0!==r)return null!=r&&
f&&this._dateFields.has(e)?new Date(r):r;r=this.readAttributes();e=e.toLocaleLowerCase().trim();for(const q in r)if(q.toLocaleLowerCase().trim()===e)return e=this._current.attributes[q],null!=e&&f&&this._dateFields.has(q)?new Date(e):e};b.copyInto=function(e){d.prototype.copyInto.call(this,e);e._featureIndex=this._featureIndex;e._transform=this._transform;e._dateFields=this._dateFields};b._readAttributes=function(){return this._current.attributes};F._createClass(c,[{key:"_current",get:function(){return this._features[this._featureIndex]}},
{key:"geometryType",get:function(){return this._geometryType}},{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return c}(k.FeatureSetReader);x.FeatureSetReaderJSON=a;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/TileStore":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Evented ../../../../../core/has ../../../../../chunks/rbush ./Tile ../../../tiling/TileCoverage ../../../tiling/TileKey".split(" "),
function(x,F,E,B,k,h,a){const d={added:[],removed:[]},c=new Set,b=new a(0,0,0,0);return function(e){function f(q){var g=e.call(this)||this;g._tiles=new Map;g._index=B.rbush(9,E("csp-restrictions")?l=>({minX:l.bounds[0],minY:l.bounds[1],maxX:l.bounds[2],maxY:l.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);g.tiles=[];g.tileScheme=q;return g}x._inheritsLoose(f,e);var r=f.prototype;r.destroy=function(){this.clear()};r.clear=function(){this.tiles.length=0;this._tiles.clear();this._index.clear()};
r.has=function(q){return this._tiles.has(q)};r.get=function(q){return this._tiles.get(q)};r.boundsIntersections=function(q){return this._index.search({minX:q[0],minY:q[1],maxX:q[2],maxY:q[3]})};r.updateTiles=function(q){const g={added:[],removed:[]};for(const l of q.added)if(!this.has(l)){const n=new k.Tile(this.tileScheme,l);this._tiles.set(l,n);this._index.insert(n);g.added.push(n)}for(const l of q.removed)this.has(l)&&(q=this.get(l),this._tiles.delete(l),this._index.remove(q),g.removed.push(q));
this.tiles.length=0;this._tiles.forEach(l=>this.tiles.push(l));(g.added.length||g.removed.length)&&this.emit("update",g)};r.setViewState=function(q){if(q=this.tileScheme.getTileCoverage(q,0)){var {spans:g,lodInfo:l}=q,{level:n}=l;if(0<g.length)for(const {row:t,colFrom:m,colTo:w}of g)for(var u=m;u<=w;u++){const v=b.set(n,t,l.normalizeCol(u),l.getWorldForColumn(u)).id;c.add(v);if(!this.has(v)){const C=new k.Tile(this.tileScheme,v);this._tiles.set(v,C);this._index.insert(C);this.tiles.push(C);d.added.push(C)}}for(n=
this.tiles.length-1;0<=n;n--)u=this.tiles[n],c.has(u.id)||(this._tiles.delete(u.id),this.tiles.splice(n,1),this._index.remove(u),d.removed.push(u));(d.added.length||d.removed.length)&&this.emit("update",d);h.pool.release(q);c.clear();d.added.length=0;d.removed.length=0}};return f}(F)})},"esri/chunks/rbush":function(){define(["exports","./quickselect"],function(x,F){function E(g,l){if(!(this instanceof E))return new E(g,l);this._maxEntries=Math.max(4,g||9);this._minEntries=Math.max(2,Math.ceil(.4*
this._maxEntries));l&&("function"===typeof l?this.toBBox=l:this._initFormat(l));this.clear()}function B(g,l){k(g,0,g.children.length,l,g)}function k(g,l,n,u,t){t||(t=r(null));t.minX=Infinity;t.minY=Infinity;t.maxX=-Infinity;t.maxY=-Infinity;for(var m;l<n;l++)m=g.children[l],h(t,g.leaf?u(m):m);return t}function h(g,l){g.minX=Math.min(g.minX,l.minX);g.minY=Math.min(g.minY,l.minY);g.maxX=Math.max(g.maxX,l.maxX);g.maxY=Math.max(g.maxY,l.maxY);return g}function a(g,l){return g.minX-l.minX}function d(g,
l){return g.minY-l.minY}function c(g){return(g.maxX-g.minX)*(g.maxY-g.minY)}function b(g){return g.maxX-g.minX+(g.maxY-g.minY)}function e(g,l){return g.minX<=l.minX&&g.minY<=l.minY&&l.maxX<=g.maxX&&l.maxY<=g.maxY}function f(g,l){return l.minX<=g.maxX&&l.minY<=g.maxY&&l.maxX>=g.minX&&l.maxY>=g.minY}function r(g){return{children:g,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function q(g,l,n,u,t){for(var m=[l,n],w;m.length;)n=m.pop(),l=m.pop(),n-l<=u||(w=l+Math.ceil((n-
l)/u/2)*u,F.quickselect(g,w,l,n,t),m.push(l,w,w,n))}E.prototype={all:function(){return this._all(this.data,[])},search:function(g){var l=this.data,n=[],u=this.toBBox;if(!f(g,l))return n;for(var t=[],m,w,v,C;l;){m=0;for(w=l.children.length;m<w;m++)v=l.children[m],C=l.leaf?u(v):v,f(g,C)&&(l.leaf?n.push(v):e(g,C)?this._all(v,n):t.push(v));l=t.pop()}return n},collides:function(g){var l=this.data,n=this.toBBox;if(!f(g,l))return!1;for(var u=[],t,m,w,v;l;){t=0;for(m=l.children.length;t<m;t++)if(w=l.children[t],
v=l.leaf?n(w):w,f(g,v)){if(l.leaf||e(g,v))return!0;u.push(w)}l=u.pop()}return!1},load:function(g){if(!g||!g.length)return this;if(g.length<this._minEntries){for(var l=0,n=g.length;l<n;l++)this.insert(g[l]);return this}g=this._build(g.slice(),0,g.length-1,0);this.data.children.length?this.data.height===g.height?this._splitRoot(this.data,g):(this.data.height<g.height&&(l=this.data,this.data=g,g=l),this._insert(g,this.data.height-g.height-1,!0)):this.data=g;return this},insert:function(g){g&&this._insert(g,
this.data.height-1);return this},clear:function(){this.data=r([]);return this},remove:function(g,l){if(!g)return this;for(var n=this.data,u=this.toBBox(g),t=[],m=[],w,v,C,A;n||t.length;){n||(n=t.pop(),v=t[t.length-1],w=m.pop(),A=!0);if(n.leaf){a:{C=g;var y=n.children,p=l;if(p){for(var z=0;z<y.length;z++)if(p(C,y[z])){C=z;break a}C=-1}else C=y.indexOf(C)}if(-1!==C){n.children.splice(C,1);t.push(n);this._condense(t);break}}A||n.leaf||!e(n,u)?v?(w++,n=v.children[w],A=!1):n=null:(t.push(n),m.push(w),
w=0,v=n,n=n.children[0])}return this},toBBox:function(g){return g},compareMinX:a,compareMinY:d,toJSON:function(){return this.data},fromJSON:function(g){this.data=g;return this},_all:function(g,l){for(var n=[];g;)g.leaf?l.push.apply(l,g.children):n.push.apply(n,g.children),g=n.pop();return l},_build:function(g,l,n,u){var t=n-l+1,m=this._maxEntries;if(t<=m){var w=r(g.slice(l,n+1));B(w,this.toBBox);return w}u||(u=Math.ceil(Math.log(t)/Math.log(m)),m=Math.ceil(t/Math.pow(m,u-1)));w=r([]);w.leaf=!1;w.height=
u;t=Math.ceil(t/m);m=t*Math.ceil(Math.sqrt(m));var v;for(q(g,l,n,m,this.compareMinX);l<=n;l+=m){var C=Math.min(l+m-1,n);q(g,l,C,t,this.compareMinY);for(v=l;v<=C;v+=t){var A=Math.min(v+t-1,C);w.children.push(this._build(g,v,A,u-1))}}B(w,this.toBBox);return w},_chooseSubtree:function(g,l,n,u){for(var t,m,w,v,C,A,y,p;;){u.push(l);if(l.leaf||u.length-1===n)break;y=p=Infinity;t=0;for(m=l.children.length;t<m;t++)w=l.children[t],C=c(w),A=(Math.max(w.maxX,g.maxX)-Math.min(w.minX,g.minX))*(Math.max(w.maxY,
g.maxY)-Math.min(w.minY,g.minY))-C,A<p?(p=A,y=C<y?C:y,v=w):A===p&&C<y&&(y=C,v=w);l=v||l.children[0]}return l},_insert:function(g,l,n){var u=this.toBBox;n=n?g:u(g);u=[];var t=this._chooseSubtree(n,this.data,l,u);t.children.push(g);for(h(t,n);0<=l;)if(u[l].children.length>this._maxEntries)this._split(u,l),l--;else break;this._adjustParentBBoxes(n,u,l)},_split:function(g,l){var n=g[l],u=n.children.length,t=this._minEntries;this._chooseSplitAxis(n,t,u);u=this._chooseSplitIndex(n,t,u);u=r(n.children.splice(u,
n.children.length-u));u.height=n.height;u.leaf=n.leaf;B(n,this.toBBox);B(u,this.toBBox);l?g[l-1].children.push(u):this._splitRoot(n,u)},_splitRoot:function(g,l){this.data=r([g,l]);this.data.height=g.height+1;this.data.leaf=!1;B(this.data,this.toBBox)},_chooseSplitIndex:function(g,l,n){var u,t;var m=t=Infinity;for(u=l;u<=n-l;u++){var w=k(g,0,u,this.toBBox);var v=k(g,u,n,this.toBBox);var C=Math.max(0,Math.min(w.maxX,v.maxX)-Math.max(w.minX,v.minX))*Math.max(0,Math.min(w.maxY,v.maxY)-Math.max(w.minY,
v.minY));w=c(w)+c(v);if(C<m){m=C;var A=u;t=w<t?w:t}else C===m&&w<t&&(t=w,A=u)}return A},_chooseSplitAxis:function(g,l,n){var u=g.leaf?this.compareMinX:a,t=g.leaf?this.compareMinY:d,m=this._allDistMargin(g,l,n,u);l=this._allDistMargin(g,l,n,t);m<l&&g.children.sort(u)},_allDistMargin:function(g,l,n,u){g.children.sort(u);u=this.toBBox;var t=k(g,0,l,u),m=k(g,n-l,n,u),w=b(t)+b(m),v;for(v=l;v<n-l;v++){var C=g.children[v];h(t,g.leaf?u(C):C);w+=b(t)}for(v=n-l-1;v>=l;v--)C=g.children[v],h(m,g.leaf?u(C):C),
w+=b(m);return w},_adjustParentBBoxes:function(g,l,n){for(;0<=n;n--)h(l[n],g)},_condense:function(g){for(var l=g.length-1,n;0<=l;l--)0===g[l].children.length?0<l?(n=g[l-1].children,n.splice(n.indexOf(g[l]),1)):this.clear():B(g[l],this.toBBox)},_initFormat:function(g){var l=["return a"," - b",";"];this.compareMinX=new Function("a","b",l.join(g[0]));this.compareMinY=new Function("a","b",l.join(g[1]));this.toBBox=new Function("a","return {minX: a"+g[0]+", minY: a"+g[1]+", maxX: a"+g[2]+", maxY: a"+g[3]+
"};")}};x.rbush=E})},"esri/chunks/quickselect":function(){define(["exports"],function(x){var F={exports:{}};(function(E){(function(B){B=B();void 0!==B&&(E.exports=B)})(function(){function B(a,d,c,b,e){for(;b>c;){if(600<b-c){var f=b-c+1,r=d-c+1,q=Math.log(f),g=.5*Math.exp(2*q/3);q=.5*Math.sqrt(q*g*(f-g)/f)*(0>r-f/2?-1:1);B(a,d,Math.max(c,Math.floor(d-r*g/f+q)),Math.min(b,Math.floor(d+(f-r)*g/f+q)),e)}f=a[d];r=c;g=b;k(a,c,d);for(0<e(a[b],f)&&k(a,c,b);r<g;){k(a,r,g);r++;for(g--;0>e(a[r],f);)r++;for(;0<
e(a[g],f);)g--}0===e(a[c],f)?k(a,c,g):(g++,k(a,g,b));g<=d&&(c=g+1);d<=g&&(b=g-1)}}function k(a,d,c){var b=a[d];a[d]=a[c];a[c]=b}function h(a,d){return a<d?-1:a>d?1:0}return function(a,d,c,b,e){B(a,d,c||0,b||a.length-1,e||h)}})})(F);x.quickselect=F.exports})},"esri/views/2d/layers/graphics/GraphicStore":function(){define("../../../../core/has ../../../../core/screenUtils ../../../../core/unitUtils ../../../../chunks/rbush ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/contains ../../../../geometry/support/extentUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/normalizeUtilsCommon ../../../../geometry/support/spatialReferenceUtils ../../../../symbols/cim/utils ./GraphicStoreItem ./graphicsUtils".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q){function g(u,t,m,w,v){l.minX=t;l.minY=m;l.maxX=w;l.maxY=v;return u.search(l)}const l={minX:0,minY:0,maxX:0,maxY:0},n=k.create();return function(){function u(m,w,v,C,A,y){this._graphics=C;this._onAdd=A;this._onRemove=y;this._index=B.rbush(9,x("csp-restrictions")?p=>({minX:p.bounds[0],minY:p.bounds[1],maxX:p.bounds[2],maxY:p.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);this._itemByGraphic=new Map;this._currentLevel=-Infinity;this._tileInfoView=
m;this._uidFieldName=v;if(w=m.getClosestInfoForScale(w))this._currentLevel=w.level,this._resolution=this._tileInfoView.getTileResolution(w.level);this._metersPerUnit=e.isValid(m.spatialReference)?E.getMetersPerUnit(m.spatialReference):1}var t=u.prototype;t.hitTest=function(m,w,v,C,A){m=c.normalizeMapX(m,this._tileInfoView.spatialReference);var y=.5*C*v;n[0]=m-y;n[1]=w-y;n[2]=m+y;n[3]=w+y;v=.5*C*(v+q.PIXEL_BUFFER);var p=g(this._index,m-v,w-v,m+v,w+v);if(!p||0===p.length)return[];v={x:m,y:w};y=[];for(const D of p)if(D.graphic.visible)switch(d.getJsonType(D.geometry)){case "esriGeometryPoint":{p=
D.symbol;if(!p)continue;const {x:G,y:I}=D.geometry;var z=C*this._metersPerUnit;let K;switch(p.type){case "esriTS":K=q.getTextSymbolBounds(G,I,p,D.size,C,A);break;case "expanded-cim":K=q.getCIMMarkerBounds(G,I,p,C,z,A);break;case "esriSMS":case "esriPMS":K=q.getMarkerSymbolBounds(G,I,p,C,z,A)}h.polygonContainsPoint(K,v)&&y.push(D)}break;case "esriGeometryPolyline":p=D.symbol;z=0;if("expanded-cim"===p.type){p=p.layers;if(!p||0===p.length)continue;z=p.findIndex(G=>"line"===G.type);if(-1===z)continue;
z=f.evaluateValueOrFunction(p[z].width,null,null)}else{p=p.layers;if(!p||0===p.length)continue;z=p[0].width}p=1.5*C*window.devicePixelRatio*F.pt2px(z);q.isPointOnPolyline(D.geometry,m,w,p)&&y.push(D);break;case "esriGeometryEnvelope":p=D.geometry;p=k.fromValues(p.xmin,p.ymin,p.xmax,p.ymax);k.intersects(p,n)&&y.push(D);break;case "esriGeometryPolygon":if(h.polygonContainsPoint(D.geometry,v)){y.push(D);break}p=a.getPolygonExtent(D.geometry);if(Math.abs(p.ymax-p.ymin)<5*C||Math.abs(p.xmax-p.xmin)<5*
C)p=k.fromValues(p.xmin,p.ymin,p.xmax,p.ymax),k.intersects(p,n)&&y.push(D);break;case "esriGeometryMultipoint":{p=D.symbol;if(!p)continue;z=D.geometry.points;let G;for(let I=0;I<z.length;I++)if(G="esriTS"===p.type?q.getTextSymbolBounds(z[I][0],z[I][1],p,D.size,C,A):q.getMarkerSymbolBounds(z[I][0],z[I][1],p,C,C*this._metersPerUnit,A),h.polygonContainsPoint(G,v)){y.push(D);break}}}y.sort((D,G)=>{const I=q.graphicGeometryToNumber(D.graphic),K=q.graphicGeometryToNumber(G.graphic);return I===K?G.zorder-
D.zorder:I-K});return y.map(D=>D.graphic)};t.getGraphicsData=function(m,w,v){const C=this._searchForItems(w);if(0===C.length||0===v.length)return[];C.sort((G,I)=>G.zorder-I.zorder);C[0].insertAfter=-1;for(var A=1;A<C.length;A++)C[A].insertAfter=C[A-1].graphic.uid;C.sort((G,I)=>G.graphic.uid-I.graphic.uid);v.sort((G,I)=>G.uid-I.uid);let y=A=0,p;const z=[],D={originPosition:"upperLeft",scale:[w.resolution,w.resolution],translate:[w.bounds[0],w.bounds[3]]};for(const G of v){for(y=-2;A<C.length;)if(p=
C[A],A++,G.uid===p.graphic.uid){y=p.insertAfter;break}if(!p.geometry||-2===y)continue;v=p.getGeometryQuantized(D,w.bounds);const I={...p.graphic.attributes};I[this._uidFieldName]=G.uid;null==p.groupId&&(p.groupId=m.createTemplateGroup(p.symbol,null));z.push({centroid:r.getCentroidQuantized(p,D),geometry:v,attributes:I,symbol:p.symbol,groupId:p.groupId,insertAfter:y,zorder:p.zorder})}z.sort((G,I)=>G.zorder-I.zorder);return z};t.queryTileData=function(m,w){const {bounds:v,resolution:C}=w,A=this._searchForItems(w),
y=[];if(0===A.length)return y;this._createTileGraphics(y,m,A,{originPosition:"upperLeft",scale:[C,C],translate:[v[0],v[3]]},w.bounds);return y};t.has=function(m){return this._itemByGraphic.has(m)};t.getBounds=function(m){return this._itemByGraphic.has(m)?this._itemByGraphic.get(m).bounds:null};t.addOrModify=function(m,w,v){if(m)return this.has(m)&&this.remove(m),this._onAdd(m),w=r.acquire(m,w,v,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference),this._itemByGraphic.set(m,
w),v&&this._index.insert(w),w.bounds};t.remove=function(m){if(this._itemByGraphic.has(m)){this._onRemove(m);var w=this._itemByGraphic.get(m);this._index.remove(w);this._itemByGraphic.delete(m)}};t.updateZ=function(){const m=this._graphics.items;for(let v=0;v<m.length;v++){var w=m[v];if(w=this._itemByGraphic.get(w))w.zorder=v}};t.update=function(m,w,v){const C=this._itemByGraphic.get(m);C.groupId=null;const A=k.clone(C.bounds);C.size[0]=C.size[1]=0;this._index.remove(C);C.set(m,w,v,this._resolution,
this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference);v&&this._index.insert(C);return{oldBounds:A,newBounds:C.bounds}};t.updateLevel=function(m){if(this._currentLevel!==m){this._currentLevel=m;var w=this._tileInfoView;this._resolution=w.getTileResolution(m);this._index.clear();m=this._itemByGraphic;var v=[];for(const [,C]of m)C.updateBounds(this._resolution,this._resolution*this._metersPerUnit,w.spatialReference),C.geometry&&v.push(C);this._index.load(v)}};t.clear=function(){this._itemByGraphic.clear();
this._index.clear()};t._createTileGraphics=function(m,w,v,C,A){const y=this._uidFieldName;v.sort((I,K)=>I.zorder-K.zorder);let p,z,D,G;for(let I=0;I<v.length;I++){D=v[I];p=D.graphic;z=D.getGeometryQuantized(C,A);G=0===I?-1:v[I-1].graphic.uid;const K={...D.graphic.attributes};K[y]=p.uid;null==D.groupId&&(D.groupId=w.createTemplateGroup(D.symbol,null));m.push({centroid:r.getCentroidQuantized(D,C),geometry:z,attributes:K,symbol:D.symbol,groupId:D.groupId,insertAfter:G,zorder:D.zorder})}};t._searchForItems=
function(m){var w=this._tileInfoView.spatialReference,v=m.bounds;if(w.isWrappable){const [C,A]=b.getSpatialReferenceMinMaxX(w);w=1E-5>Math.abs(v[2]-A);const y=1E-5>Math.abs(v[0]-C);if(!(w&&y||!w&&!y))return m=m.resolution,m=w?k.create([C,v[1],C+m*q.PIXEL_BUFFER,v[3]]):k.create([A-m*q.PIXEL_BUFFER,v[1],A,v[3]]),v=g(this._index,v[0],v[1],v[2],v[3]),m=g(this._index,m[0],m[1],m[2],m[3]),[...new Set([...v,...m])]}return g(this._index,v[0],v[1],v[2],v[3])};return u}()})},"esri/views/2d/layers/graphics/GraphicStoreItem":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/quantizationUtils ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./graphicsUtils".split(" "),
function(x,F,E,B,k,h,a,d,c){function b(r){r.coords.length=0;r.lengths.length=0}const e=new d,f=new d;d=function(){function r(){this.bounds=E.create();this.graphic=null;this.size=[0,0,0,0]}r.acquire=function(g=null,l,n,u,t,m){let w;0===r._pool.length?w=new r:(w=r._pool.pop(),this._set.delete(w));w.acquire(g,l,n,u,t,m);return w};r.release=function(g){g&&!this._set.has(g)&&(g.release(),this._pool.push(g),this._set.add(g))};r.getCentroidQuantized=function(g,l){if(k.isPolygon(g.geometry)){const n=g.symbol;
if(F.isNone(n))return null;if(c.isMarkerSymbol(n.type)||c.isTextSymbol(n.type))return g=B.polygonCentroid(g.geometry),h.quantizePoint(l,{},{x:g[0],y:g[1]},!1,!1)}return null};var q=r.prototype;q.acquire=function(g=null,l,n,u,t,m){g&&this.set(g,l,n,u,t,m)};q.release=function(){this.geometry=this.symbolResource=this.graphic=null};q.set=function(g,l,n,u,t,m){this.graphic=g;this.geometry=n;this.symbolResource=l;this.resolution=u;this.updateBounds(u,t,m)};q.updateBounds=function(g,l,n){c.getBounds(this.bounds,
this.size,this.symbolResource,this.geometry,g,l,n)};q.getGeometryQuantized=function(g,l){var n=this.geometry;if(k.isPolygon(n)){if(n=n.rings,1===n.length&&2===n[0].length)return h.quantizeGeometry(g,{paths:[[n[0][0],n[0][1]]]})}else{if(k.isPolyline(n))return b(e),b(f),a.convertFromPolyline(e,n),a.generalizeOptimizedGeometry(f,e,n.hasZ,n.hasM,"esriGeometryPolyline",g.scale[0]),a.quantizeOptimizedGeometry(e,f,n.hasZ,n.hasM,"esriGeometryPolyline",g),a.convertToPolyline(e,n.hasZ,n.hasM);if(k.isMultipoint(n)){const u=
.5*this.resolution*this.size[0];n=n.points.filter(t=>E.containsPointWithMargin(l,t,u));return 0===n.length?{points:n}:h.quantizeGeometry(g,{points:n})}}return h.quantizeGeometry(g,this.geometry)};x._createClass(r,[{key:"symbol",get:function(){return this.symbolResource.symbol}}]);return r}();d._pool=[];d._set=new Set;return d})},"esri/views/layers/GraphicsView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass".split(" "),
function(x,F,E,B,k,h,a,d,c,b){x.GraphicsView=e=>{e=function(f){function r(){var q=f.apply(this,arguments)||this;q.graphics=null;q.renderer=null;return q}F._inheritsLoose(r,f);return r}(B.IdentifiableMixin(e));E.__decorate([k.property()],e.prototype,"graphics",void 0);E.__decorate([k.property()],e.prototype,"renderer",void 0);E.__decorate([k.property()],e.prototype,"updating",void 0);E.__decorate([k.property()],e.prototype,"view",void 0);return e=E.__decorate([b.subclass("esri.views.layers.GraphicsView")],
e)};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/webgl/enums","./BaseGraphicContainer"],function(x,F,E){return function(B){function k(){return B.apply(this,arguments)||this}x._inheritsLoose(k,B);var h=k.prototype;h.renderChildren=function(a){this.attributeView.bindTextures(a.context);this.children.some(d=>d.hasData)&&(B.prototype.renderChildren.call(this,a),a.drawPhase===
F.WGLDrawPhase.MAP&&this._renderChildren(a),a.drawPhase===F.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(a))};h._renderHighlight=function(a){var {painter:d}=a;d=d.effects.highlight;d.bind(a);this._renderChildren(a,d.defines);d.draw(a);d.unbind()};return k}(E)})},"esri/views/2d/layers/graphics/BaseGraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/FeatureContainer"],function(x,F){return function(E){function B(h){return E.call(this,h)||this}x._inheritsLoose(B,
E);var k=B.prototype;k.onTileData=function(h,a){h.patch(a);this.contains(h)||this.addChild(h);this.requestRender()};k.onTileError=function(h){h.clear();this.contains(h)||this.addChild(h)};k._renderChildren=function(h,a){for(const d of this.children)d.isReady&&d.hasData&&(d.commit(h),h.context.setStencilFunction(514,d.stencilRef,255),d._displayList.replay(h,d,a))};x._createClass(B,[{key:"hasLabels",get:function(){return!1}}]);return B}(F.FeatureContainer)})},"esri/views/2d/engine/FeatureContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/promiseUtils ../../../core/Queue ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/WGLRendererInfo".split(" "),
function(x,F,E,B,k,h,a){h=function(d){function c(e){var f=d.call(this,e)||this;f._rendererInfo=new a.WGLRendererInfo;f._materialItemsRequestQueue=new B;f.attributeView=new k.AttributeStoreView(()=>f.onAttributeStoreUpdate());return f}F._inheritsLoose(c,d);var b=c.prototype;b.destroy=function(){this.removeAllChildren();this.children.forEach(e=>e.destroy());this.attributeView.destroy();this._materialItemsRequestQueue.clear()};b.setRendererInfo=function(e,f,r){this._rendererInfo.setInfo(e,f,r);this.requestRender()};
b.getMaterialItems=function(){var e=F._asyncToGenerator(function*(f,r){if(!f||0===f.length)return null;const q=E.createResolver();this._materialItemsRequestQueue.push({items:f,abortOptions:r,resolver:q});this.requestRender();return q.promise});return function(f,r){return e.apply(this,arguments)}}();b.doRender=function(e){e.context.capabilities.enable("textureFloat");e.context.capabilities.enable("vao");if(0<this._materialItemsRequestQueue.length){let f=this._materialItemsRequestQueue.pop();for(;f;)this._processMaterialItemRequest(e,
f),f=this._materialItemsRequestQueue.pop()}d.prototype.doRender.call(this,e)};b.renderChildren=function(e){for(const f of this.children)f.commit(e);this._rendererInfo.update(e.state);d.prototype.renderChildren.call(this,e)};b.createRenderParams=function(e){return{...d.prototype.createRenderParams.call(this,e),rendererInfo:this._rendererInfo,attributeView:this.attributeView}};b.onAttributeStoreUpdate=function(){};b._processMaterialItemRequest=function(e,{items:f,abortOptions:r,resolver:q}){const {painter:g,
pixelRatio:l}=e;e=f.map(n=>g.textureManager.rasterizeItem(n.symbol,l,n.glyphIds,r));Promise.all(e).then(n=>{this.stage?(n=n.map((u,t)=>({id:f[t].id,mosaicItem:u})),q.resolve(n)):q.reject()},q.reject)};return c}(h["default"]);x.FeatureContainer=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/ProgramCache ../../../webgl/Renderbuffer ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ../../../webgl/Texture ../../../webgl/VertexArrayObject ./definitions ./Utils ./util/debug".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n,u,t){const m=k.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),w=t.createDebugLogger(t.DEBUG_ATTR_UPDATES,m);let v=function(){function C(y,p,z){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;const {buffer:D,pixelType:G,textureOnly:I}=y;y=u.getPixelArrayCtor(G);this.shared=z;this.pixelType=G;this.size=p;this.textureOnly=I;I||(this.data=new y(h.unwrap(D)));this._resetRange()}var A=C.prototype;A.destroy=function(){h.andThen(this._texture,
y=>y.dispose());for(const y in this._fbos)h.andThen(this._fbos[y],p=>{"0"===y&&p.detachColorTexture();p.dispose()}),this._fbos[y]=null;this._texture=null};A.setData=function(y,p,z){y&=2147483647;const D=h.unwrap(this.data);p=y*this.texelSize+p;!D||p>=D.length||(D[p]=z,this.dirtyStart=Math.min(this.dirtyStart,y),this.dirtyEnd=Math.max(this.dirtyEnd,y))};A.getData=function(y,p){if(h.isNone(this.data))return null;y=(y&2147483647)*this.texelSize+p;return!this.data||y>=this.data.length?null:this.data[y]};
A.getTexture=function(y){return h.unwrapOr(this._texture,()=>this._initTexture(y))};A.getFBO=function(y,p=0){if(h.isNone(this._fbos[p])){const z=0===p?this.getTexture(y):this._textureDesc;this._fbos[p]=new c(y,{colorTarget:0,depthStencilTarget:0},z)}return this._fbos[p]};A.updateTexture=function(y,p){if(!this.locked){try{const z=this.dirtyStart,D=this.dirtyEnd;if(!this.hasDirty)return;this._resetRange();const G=h.unwrap(this.data).buffer,I=this.getTexture(y),K=(z-z%this.size)/this.size,N=(D-D%this.size)/
this.size,L=K*this.size*4,M=4*(this.size+N*this.size)-L,O=u.getPixelArrayCtor(this.pixelType),H=new O(G,L*O.BYTES_PER_ELEMENT,M),J=this.size;y=N-K+1;if(y>this.size){m.error(new E("mapview-webgl","Out-of-bounds index when updating AttributeData"));return}I.updateData(0,0,K,J,y,H)}catch(z){}p()}};A.update=function(y){const {data:p,start:z,end:D}=y;if(h.isSome(p)){const G=this.data,I=z*this.texelSize;for(let K=0;K<p.length;K++)y.layout&1<<K%this.texelSize&&(G[I+K]=p[K])}this.dirtyStart=Math.min(this.dirtyStart,
z);this.dirtyEnd=Math.max(this.dirtyEnd,D)};A.resize=function(y,p){const z=this.size;this.size=p;this.textureOnly?z!==this.size&&(this._lastTexture=this._texture,this._texture=null):(p=u.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new p(h.unwrap(y.buffer)))};A._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};A._initTexture=function(y){const p=new g(y,this._textureDesc,h.unwrapOr(this.data,void 0));if(h.isSome(this._lastTexture)&&this._fbos[0]){const G=this._lastTexture.descriptor.width,
I=this._lastTexture.descriptor.height,K=this._lastTexture.descriptor.dataType,N=this._lastTexture.descriptor.pixelFormat,L=this.getFBO(y);var z=u.getPixelBytes(K),D=u.getPixelArrayCtor(K);z=new ArrayBuffer(G*I*z*this.texelSize);D=new D(z);z=y.getBoundFramebufferObject();const {x:M,y:O,width:H,height:J}=y.getViewport();y.bindFramebuffer(L);L.readPixels(0,0,G,I,N,K,D);p.updateData(0,0,0,2*G,I/2,D);y.setViewport(M,O,H,J);y.bindFramebuffer(z)}this.destroy();return this._texture=p};F._createClass(C,[{key:"_textureDesc",
get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}}},{key:"locked",get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&B("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1}},{key:"hasDirty",get:function(){return this.dirtyEnd>=this.dirtyStart}}]);return C}();k=function(){function C(y){this._onUpdate=y;this._locked=this._forceNextUpload=this._initialized=!1}var A=C.prototype;
A.initialize=function(y){const {blocks:p,shared:z,size:D}=y;this.shared=z;this.size=D;w("Initializing AttributeStoreView",y);if(h.isNone(this._data))this._data=h.mapMany(p,G=>new v(G,D,z));else for(y=0;y<this._data.length;y++){const G=this._data[y],I=p[y];h.isSome(I)&&(h.isNone(G)?this._data[y]=new v(I,D,z):G.resize(I,D))}this._initialized=!0};A.destroy=function(){h.andThen(this._data,y=>h.mapMany(y,p=>p.destroy()));h.andThen(this._defaultTexture,y=>y.dispose())};A.isUpdating=function(){if(h.isNone(this._data))return!0;
const y=h.isSome(this._pendingAttributeUpdate);B("esri-2d-log-updating")&&console.log(`Updating AttributeStoreView ${y}
  -> hasPendingUpdate ${y}`);return y};A.getBlock=function(y){return h.isNone(this._data)?null:this._data[y]};A.setLabelMinZoom=function(y,p){this.setData(y,0,1,p)};A.getLabelMinZoom=function(y){return this.getData(y,0,1,255)};A.getFilterFlags=function(y){return this.getData(y,0,0,0)};A.getVVSize=function(y){return this.getData(y,n.ATTRIBUTE_DATA_VV,0,0)};A.getData=function(y,p,z,D){if(!this._data)return 0;p=h.unwrap(this._data)[p];if(h.isNone(p))return 0;y=p.getData(y,z);return h.isSome(y)?y:D};
A.setData=function(y,p,z,D){p=h.unwrap(this._data)[p];h.unwrap(p).setData(y,z,D)};A.lockTextureUpload=function(){this._locked=!0};A.unlockTextureUpload=function(){this._locked=!1};A.forceTextureUpload=function(){this._forceNextUpload=!0};A.requestUpdate=function(){var y=F._asyncToGenerator(function*(p){if(this._pendingAttributeUpdate)m.error(new E("mapview-webgl","Tried to update attribute data with a pending update"));else{var z=a.createResolver();w("AttributeStoreView Update Requested",p);this._pendingAttributeUpdate=
{data:p,resolver:z};return z.promise}});return function(p){return y.apply(this,arguments)}}();A.update=function(){if(this._initialized&&h.isSome(this._pendingAttributeUpdate)){const {data:y,resolver:p}=this._pendingAttributeUpdate,z=h.unwrap(this._data);for(let D=0;D<y.blocks.length;D++){const G=y.blocks[D];h.andThen(z[D],I=>h.andThen(G,K=>{w(`Updating block ${D}`,K);I.update(K)}))}this._pendingAttributeUpdate=null;p();this._onUpdate()}};A.bindTextures=function(y){this.update();const p=this._getDefaultTexture(y);
if(this._initialized){var z=h.unwrap(this._data);if(!this._locked||this._forceNextUpload)h.forEachSome(z,D=>D.updateTexture(y,()=>this._onUpdate())),this._forceNextUpload=!1;y.bindTexture(h.mapOr(z[0],p,D=>D.getTexture(y)),n.TEXTURE_BINDING_ATTRIBUTE_DATA_0);y.bindTexture(h.mapOr(z[1],p,D=>D.getTexture(y)),n.TEXTURE_BINDING_ATTRIBUTE_DATA_1);y.bindTexture(h.mapOr(z[2],p,D=>D.getTexture(y)),n.TEXTURE_BINDING_ATTRIBUTE_DATA_2);y.bindTexture(h.mapOr(z[3],p,D=>D.getTexture(y)),n.TEXTURE_BINDING_ATTRIBUTE_DATA_3)}else y.bindTexture(p,
n.TEXTURE_BINDING_ATTRIBUTE_DATA_0),y.bindTexture(p,n.TEXTURE_BINDING_ATTRIBUTE_DATA_1),y.bindTexture(p,n.TEXTURE_BINDING_ATTRIBUTE_DATA_2),y.bindTexture(p,n.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};A._getDefaultTexture=function(y){h.isNone(this._defaultTexture)&&(this._defaultTexture=new g(y,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return C}();x.AttributeStoreView=k;Object.defineProperty(x,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/TileContainer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(x,F,E,B,k,h,a){const d=(c,b)=>0!==c.key.level-b.key.level?c.key.level-b.key.level:0!==c.key.row-b.key.row?c.key.row-b.key.row:c.key.col-b.key.col;k=function(c){function b(f){var r=c.call(this)||this;r._tileInfoView=f;return r}F._inheritsLoose(b,c);var e=b.prototype;e.renderChildren=
function(f){this.sortChildren(d);this.setStencilReference();c.prototype.renderChildren.call(this,f)};e.createRenderParams=function(f){const {state:r}=f;return{...c.prototype.createRenderParams.call(this,f),requiredLevel:this._tileInfoView.getClosestInfoForScale(r.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(r.scale)}};e.prepareRenderPasses=function(f){const r=c.prototype.prepareRenderPasses.call(this,f);r.push(f.registerRenderPass({name:"stencil",brushes:[a],drawPhase:B.WGLDrawPhase.DEBUG|
B.WGLDrawPhase.MAP|B.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()}));E("esri-tiles-debug")&&r.push(f.registerRenderPass({name:"tileInfo",brushes:[h],drawPhase:B.WGLDrawPhase.DEBUG,target:()=>this.children}));return r};e.getStencilTarget=function(){return this.children};e.updateTransforms=function(f){for(const r of this.children){const q=this._tileInfoView.getTileResolution(r.key);r.setTransform(f,q)}};e.setStencilReference=function(){let f=1;for(const r of this.children)r.stencilRef=
f++};F._createClass(b,[{key:"requiresDedicatedFBO",get:function(){return!1}}]);return b}(k);x.default=k;x.sortByLevel=d;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../brushes ../Container ./ClippingInfo ./enums".split(" "),function(x,F,E,B,k,h,a){return function(d){function c(){var e=d.apply(this,arguments)||this;e.name=e.constructor.name;return e}
x._inheritsLoose(c,d);var b=c.prototype;b.doRender=function(e){const f=this.createRenderParams(e),{painter:r,globalOpacity:q,profiler:g,drawPhase:l}=f,n=l===a.WGLDrawPhase.LABEL?1:q*this.computedOpacity;g.recordContainerStart(this.name);r.beforeRenderLayer(f,this._clippingInfos?255:0,n);this.updateTransforms(e.state);this.renderChildren(f);r.compositeLayer(f,n);g.recordContainerEnd()};b.renderChildren=function(e){E.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(e.painter));
for(const f of this.children)f.beforeRender(e);for(const f of this._renderPasses)try{f.render(e)}catch(r){}for(const f of this.children)f.afterRender(e)};b.createRenderParams=function(e){return{...e,requireFBO:this.requiresDedicatedFBO}};b.prepareRenderPasses=function(e){return[e.registerRenderPass({name:"clip",brushes:[B.brushes.clip],target:()=>this._clippingInfos,drawPhase:a.WGLDrawPhase.MAP|a.WGLDrawPhase.LABEL|a.WGLDrawPhase.LABEL_ALPHA|a.WGLDrawPhase.DEBUG|a.WGLDrawPhase.HIGHLIGHT})]};b.updateTransforms=
function(e){for(const f of this.children)f.setTransform(e)};b.onAttach=function(){d.prototype.onAttach.call(this);this._updateClippingInfo()};b.onDetach=function(){d.prototype.onDetach.call(this);this._updateClippingInfo()};b._updateClippingInfo=function(){E.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(f=>f.destroy()),this._clippingInfos=null);if(this.stage){var e=this._clips;E.isSome(e)&&e.length&&(this._clippingInfos=e.items.map(f=>h.fromClipArea(this.stage,f)));this.requestRender()}};
x._createClass(c,[{key:"clips",set:function(e){this._clips=e;this.children.forEach(f=>f.clips=e);this._updateClippingInfo()}}]);return c}(k.Container)})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),function(x,F,E,B,k,h,a){const d=E.getLogger("esri.views.2d.engine.webgl.ClippingInfo");return function(c){function b(f,
r){var q=c.call(this)||this;q._clip=r;q._cache={};q.stage=f;q._handle=r.watch("version",()=>q._invalidate());q.ready();return q}x._inheritsLoose(b,c);b.fromClipArea=function(f,r){return new b(f,r)};var e=b.prototype;e._destroyGL=function(){B.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);B.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)};e.destroy=function(){this._destroyGL();this._handle.remove()};e.getVAO=function(f,r,q,g){const [l,n]=r.size;
if("geometry"===this._clip.type||this._lastWidth!==l||this._lastHeight!==n)this._lastWidth=l,this._lastHeight=n,this._destroyGL();if(B.isNone(this._cache.vao)){r=this._createMesh(r,this._clip);const u=r.getIndexBuffer(f),t=r.getVertexBuffers(f);this._cache.mesh=r;this._cache.vao=new a(f,q,g,t,u)}return this._cache.vao};e._invalidate=function(){this._destroyGL();this.requestRender()};e._createScreenRect=function(f,r){const [q,g]=f.size;f="string"===typeof r.left?parseFloat(r.left)/100*q:r.left;const l=
"string"===typeof r.right?parseFloat(r.right)/100*q:r.right,n="string"===typeof r.top?parseFloat(r.top)/100*g:r.top;r="string"===typeof r.bottom?parseFloat(r.bottom)/100*g:r.bottom;return{x:f,y:n,width:Math.max(q-l-f,0),height:Math.max(g-r-n,0)}};e._createMesh=function(f,r){switch(r.type){case "rect":return h.fromRect(this._createScreenRect(f,r));case "path":return h.fromPath(r);case "geometry":return h.fromGeometry(f,r);default:return d.error(new F("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),
h.fromRect({x:0,y:0,width:1,height:1})}};return b}(k.DisplayObject)})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../chunks/earcut ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject".split(" "),function(x,F,E,B,k,h,a,d,c,b,e){const f=
E.getLogger("esri.views.2d.engine.webgl.Mesh2D"),r=({coords:q,lengths:g},l)=>{const n=[];for(let m=0,w=0;m<g.length;w+=g[m],m+=1){const v=w;for(var u=[];m<g.length-1;m+=1,w+=g[m]){{var t=w+g[m];let C=0;for(let A=1;A<g[m+1];A++)C+=(q[2*(t+A)]-q[2*(t+A-1)])*(q[2*(t+A)+1]+q[2*(t+A-1)+1]);t=l?0<C:0>C}if(!t)break;u.push(w+g[m]-v)}t=q.slice(2*v,2*(w+g[m]));u=k.earcut(t,u,2);for(const C of u)n.push(C+v)}return n};return function(){function q(l,n,u,t=!1){this._cache={};this.vertices=l;this.indices=n;this.primitiveType=
u;this.isMapSpace=t}q.fromRect=function({x:l,y:n,width:u,height:t}){return q.fromScreenExtent({xmin:l,ymin:n,xmax:l+u,ymax:n+t})};q.fromPath=function(l){var n=d.convertFromNestedArray(new c,l.path,!1,!1);l=n.coords;n=new Uint32Array(r(n,!0));const u=new Uint32Array(l.length/2);for(let t=0;t<u.length;t++)u[t]=b.i1616to32(Math.floor(l[2*t]),Math.floor(l[2*t+1]));return new q({geometry:u},n,4)};q.fromGeometry=function(l,n){const u=n.geometry.type;switch(u){case "polygon":return q.fromPolygon(l,n.geometry);
case "extent":return q.fromMapExtent(l,n.geometry);default:return f.error(new F("mapview-bad-type",`Unable to create a mesh from type ${u}`,n)),q.fromRect({x:0,y:0,width:1,height:1})}};q.fromPolygon=function(l,n){var u=d.convertFromPolygon(new c,n,!1,!1);n=u.coords;u=new Uint32Array(r(u,!1));const t=new Uint32Array(n.length/2),m=a.create(),w=a.create();for(let v=0;v<t.length;v++)h.set(m,n[2*v],n[2*v+1]),l.toScreen(w,m),t[v]=b.i1616to32(Math.floor(w[0]),Math.floor(w[1]));return new q({geometry:t},
u,4,!0)};q.fromScreenExtent=function({xmin:l,xmax:n,ymin:u,ymax:t}){l={geometry:new Uint32Array([b.i1616to32(l,u),b.i1616to32(n,u),b.i1616to32(l,t),b.i1616to32(l,t),b.i1616to32(n,u),b.i1616to32(n,t)])};n=new Uint32Array([0,1,2,3,4,5]);return new q(l,n,4)};q.fromMapExtent=function(l,n){const [u,t]=l.toScreen([0,0],[n.xmin,n.ymin]),[m,w]=l.toScreen([0,0],[n.xmax,n.ymax]);l={geometry:new Uint32Array([b.i1616to32(u,t),b.i1616to32(m,t),b.i1616to32(u,w),b.i1616to32(u,w),b.i1616to32(m,t),b.i1616to32(m,w)])};
n=new Uint32Array([0,1,2,3,4,5]);return new q(l,n,4)};var g=q.prototype;g.destroy=function(){B.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const l in this._cache.vertexBuffers)B.isSome(this._cache.vertexBuffers[l])&&this._cache.vertexBuffers[l].dispose()};g.getIndexBuffer=function(l,n=35044){this._cache.indexBuffer||(this._cache.indexBuffer=e.createIndex(l,n,this.indices));return this._cache.indexBuffer};g.getVertexBuffers=function(l,n=35044){this._cache.vertexBuffers||
(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((u,t)=>({...u,[t]:e.createVertex(l,n,this.vertices[t])}),{}));return this._cache.vertexBuffers};x._createClass(q,[{key:"elementType",get:function(){a:switch(this.indices.BYTES_PER_ELEMENT){case 1:var l=5121;break a;case 2:l=5123;break a;case 4:l=5125;break a;default:throw new F("Cannot get DataType of array");}return l}}]);return q}()})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../Color ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../renderers/support/lengthUtils ./definitions ./Utils ../../../webgl/capabilities".split(" "),
function(x,F,E,B,k,h,a,d,c,b){function e(q,g){const l=g.length;if(q<g[0].value||1===l)return g[0].size;for(let n=1;n<l;n++)if(q<g[n].value)return g[n-1].size+(q-g[n-1].value)/(g[n].value-g[n-1].value)*(g[n].size-g[n-1].size);return g[l-1].size}function f(q,g,l=0){if(B.isNone(g))q[l+0]=0,q[l+1]=0,q[l+2]=0,q[l+3]=0;else{var {r:n,g:u,b:t,a:m}=g;q[l+0]=n*m/255;q[l+1]=u*m/255;q[l+2]=t*m/255;q[l+3]=m}}let r=function(){function q(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=
new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1}}var g=q.prototype;g.getSizeVVFieldStops=function(l){const n=this._vvSizeFieldStops;switch(n.type){case "static":return n;
case "level-dependent":return B.unwrapOr(n.levels[l],()=>{var u=Infinity,t=0;for(var m in n.levels){const w=parseFloat(m),v=Math.abs(l-w);v<u&&(u=v,t=w)}if(Infinity===u)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};u=2**((l-t)/2);t=B.unwrap(n.levels[t]);m=new Float32Array(t.values);m[2]*=u;m[3]*=u;return{sizes:B.unwrap(t.sizes),values:m}})}};g.update=function(l){B.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,l)};g.setInfo=function(l,
n,u){B.isSome(u)&&u.forEach(t=>this._updateEffects(t));this._vvInfo=n;switch(l.type){case "dot-density":this._updateDotDensityInfo(l)}};g.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,oesTextureFloat:b().supportsTextureFloat}};g.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1};g._updateEffects=function(l){B.isSome(l)&&l.filter&&l.filter.enabled&&(this.outsideLabelsVisible=l.excludedLabelsVisible)};
g._updateVisualVariables=function(l,n){const u=this._vvMaterialParameters;u.vvOpacityEnabled=!1;u.vvSizeEnabled=!1;u.vvColorEnabled=!1;u.vvRotationEnabled=!1;if(l){var t=l.size;if(t){u.vvSizeEnabled=!0;if(t.minMaxValue){const w=t.minMaxValue;let v;if(c.isDefined(w.minSize)&&c.isDefined(w.maxSize))if(c.isNumber(w.minSize)&&c.isNumber(w.maxSize)){v=k.pt2px(w.minSize);var m=k.pt2px(w.maxSize)}else m=n.scale,v=k.pt2px(e(m,w.minSize.stops)),m=k.pt2px(e(m,w.maxSize.stops));this.vvSizeMinMaxValue.set([w.minDataValue,
w.maxDataValue,v,m])}t.scaleStops&&(this.vvSizeScaleStopsValue=k.pt2px(e(n.scale,t.scaleStops.stops)));t.unitValue&&(this.vvSizeUnitValueToPixelsRatio=h.getMetersPerUnitForSR(n.spatialReference)/a.meterIn[t.unitValue.unit]/n.resolution);t.fieldStops&&(this._vvSizeFieldStops=t.fieldStops)}if(n=l.color)u.vvColorEnabled=!0,this.vvColorValues.set(n.values),this.vvColors.set(n.colors);if(n=l.opacity)u.vvOpacityEnabled=!0,this.vvOpacityValues.set(n.values),this.vvOpacities.set(n.opacities);if(l=l.rotation)u.vvRotationEnabled=
!0,u.vvRotationType=l.type}};g._updateDotDensityInfo=function(l){var n=l.attributes;this.ddDotValue=l.dotValue;this.ddDotScale=l.referenceScale;this.ddDotSize=l.dotSize;this.ddDotBlending=l.dotBlendingEnabled;this.ddSeed=l.seed;for(let u=0;u<d.DOT_DENSITY_MAX_FIELDS;u++){const t=u>=n.length?new E([0,0,0,0]):n[u].color;f(this.ddColors,t,4*u)}for(n=0;8>n;n++)this.ddActiveDots[n]=n<l.attributes.length?1:0;f(this.ddBackgroundColor,l.backgroundColor)};F._createClass(q,[{key:"vvMaterialParameters",get:function(){return this._vvMaterialParameters}}]);
return q}();x.WGLRendererInfo=r;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/navigation/MapViewNavigation":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Viewpoint ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../geometry/Point ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l){const n=new E({targetGeometry:new e}),u=[0,0];E=function(t){function m(v){v=t.call(this,v)||this;v._endTimer=null;v.animationManager=null;return v}x._inheritsLoose(m,t);var w=m.prototype;w.initialize=function(){this.pan=new q({navigation:this});this.rotate=new l({navigation:this});this.pinch=new g({navigation:this});this.zoomBox=new r({view:this.view,navigation:this})};w.destroy=function(){this.zoomBox.destroy();this.animationManager=this.zoomBox=null};w.begin=
function(){this._set("interacting",!0)};w.end=function(){this._lastEventTimestamp=performance.now();this._startTimer(250)};w.zoom=function(){var v=x._asyncToGenerator(function*(C,A=this._getDefaultAnchor()){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>C?this.zoomIn(A):this.zoomOut(A);this.setViewpoint(A,C,0,[0,0])});return function(C){return v.apply(this,arguments)}}();w.zoomIn=function(){var v=x._asyncToGenerator(function*(C){var A=this.view;
A=A.constraints.snapToNextScale(A.scale);return this._zoomToScale(A,C)});return function(C){return v.apply(this,arguments)}}();w.zoomOut=function(){var v=x._asyncToGenerator(function*(C){var A=this.view;A=A.constraints.snapToPreviousScale(A.scale);return this._zoomToScale(A,C)});return function(C){return v.apply(this,arguments)}}();w.setViewpoint=function(v,C,A,y){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,v,C,A,y);this.end()};w.setViewpointImmediate=
function(v,C=0,A=[0,0],y=this._getDefaultAnchor()){this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,y,v,C,A)};w.continousRotateClockwise=function(){const v=this.get("view.viewpoint");this.animationManager.animateContinous(v,C=>{f.rotateBy(C,C,-1)})};w.continousRotateCounterclockwise=function(){const v=this.get("view.viewpoint");this.animationManager.animateContinous(v,C=>{f.rotateBy(C,C,1)})};w.resetRotation=function(){this.view.rotation=0};w.continousPanLeft=function(){this._continuousPan([-10,
0])};w.continousPanRight=function(){this._continuousPan([10,0])};w.continousPanUp=function(){this._continuousPan([0,10])};w.continousPanDown=function(){this._continuousPan([0,-10])};w.stop=function(){this.pan.stopMomentumNavigation();this.animationManager.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))};w._continuousPan=function(v){const C=this.get("view.viewpoint");this.animationManager.animateContinous(C,A=>{f.translateBy(A,
A,v);this.view.constraints.constrainByGeometry(A)})};w._startTimer=function(v){return null!==this._endTimer?this._endTimer:this._endTimer=setTimeout(()=>{this._endTimer=null;const C=performance.now()-this._lastEventTimestamp;250>C?this._endTimer=this._startTimer(C):this._set("interacting",!1)},v)};w._getDefaultAnchor=function(){const {size:v,padding:{left:C,right:A,top:y,bottom:p}}=this.view;u[0]=.5*(v[0]-A+C);u[1]=.5*(v[1]-p+y);return u};w._zoomToScale=function(){var v=x._asyncToGenerator(function*(C,
A=this._getDefaultAnchor()){const {view:y}=this,{constraints:p,scale:z,viewpoint:D,size:G,padding:I}=y,K=p.canZoomInTo(C),N=p.canZoomOutTo(C);if(!(C<z&&!K||C>z&&!N))return f.padAndScaleAndRotateBy(n,D,C/z,0,A,G,I),p.constrainByGeometry(n),y.goTo(n,{animate:!0})});return function(C){return v.apply(this,arguments)}}();w._scaleRotateTranslateViewpoint=function(v,C,A,y,p){var {view:z}=this;const {size:D,padding:G,constraints:I,scale:K,viewpoint:N}=z;var L=K*A;z=I.canZoomInTo(L);L=I.canZoomOutTo(L);if(1>
A&&!z||1<A&&!L)A=1;f.translateBy(N,N,p);f.padAndScaleAndRotateBy(v,N,A,y,C,D,G);return I.constrainByGeometry(v)};return m}(B);F.__decorate([k.property()],E.prototype,"animationManager",void 0);F.__decorate([k.property({type:Boolean,readOnly:!0})],E.prototype,"interacting",void 0);F.__decorate([k.property()],E.prototype,"pan",void 0);F.__decorate([k.property()],E.prototype,"pinch",void 0);F.__decorate([k.property()],E.prototype,"rotate",void 0);F.__decorate([k.property()],E.prototype,"view",void 0);
F.__decorate([k.property()],E.prototype,"zoomBox",void 0);return E=F.__decorate([b.subclass("esri.views.2d.navigation.MapViewNavigation")],E)})},"esri/views/2d/navigation/ZoomBox":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../input/InputManager".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e){E=function(f){function r(g){g=f.call(this,g)||this;g._container=null;g._overlay=null;g._backgroundShape=null;g._boxShape=null;g._box={x:0,y:0,width:0,height:0};g._redraw=g._redraw.bind(x._assertThisInitialized(g));return g}x._inheritsLoose(r,f);var q=r.prototype;q.destroy=function(){this.view=null};q._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};q._update=function(g,l,n,u){this._box.x=g;this._box.y=l;this._box.width=n;this._box.height=
u;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};q._end=function(g,l,n,u,t){const m=this.view;g=m.toMap(B.createScreenPoint(g+.5*n,l+.5*u));n=Math.max(n/m.width,u/m.height);-1===t&&(n=1/n);this._destroyOverlay();this.navigation.end();m.goTo({center:g,scale:m.scale*n})};q._updateBox=function(g,l,n,u){const t=this._boxShape;t.setAttributeNS(null,"x",""+g);t.setAttributeNS(null,"y",""+l);t.setAttributeNS(null,"width",""+n);t.setAttributeNS(null,"height",""+u);t.setAttributeNS(null,"class",
"esri-zoom-box__outline")};q._updateBackground=function(g,l,n,u){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(g,l,n,u,this.view.width,this.view.height))};q._createContainer=function(){const g=document.createElement("div");g.className="esri-zoom-box__container";this.view.root.appendChild(g);this._container=g};q._createOverlay=function(){var g=this.view.width,l=this.view.height;const n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttributeNS(null,"d","M 0 0 L "+
g+" 0 L "+g+" "+l+" L 0 "+l+" Z");n.setAttributeNS(null,"class","esri-zoom-box__overlay-background");g=document.createElementNS("http://www.w3.org/2000/svg","rect");l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");l.setAttributeNS(null,"class","esri-zoom-box__overlay");l.appendChild(n);l.appendChild(g);this._container.appendChild(l);this._backgroundShape=n;this._boxShape=g;this._overlay=l};
q._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};q._toSVGPath=function(g,l,n,u,t,m){n=g+n;u=l+u;return"M 0 0 L "+t+" 0 L "+t+" "+m+" L 0 "+m+" ZM "+g+" "+l+" L "+g+" "+u+" L "+n+" "+u+" L "+n+" "+l+" Z"};q._handleDrag=function(g,l){var n=g.x,u=g.y,t=g.origin.x;const m=g.origin.y;let w;n>t?(w=t,t=n-t):(w=n,t-=n);u>m?(n=m,u-=m):(n=u,u=m-u);switch(g.action){case "start":this._start();
break;case "update":this._update(w,n,t,u);break;case "end":this._end(w,n,t,u,l)}g.stopPropagation()};q._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var {x:g,y:l,width:n,height:u}=this._box;this._updateBox(g,l,n,u);this._updateBackground(g,l,n,u);this._rafId=requestAnimationFrame(this._redraw)}};x._createClass(r,[{key:"view",set:function(g){this._handles&&this._handles.forEach(l=>{l.remove()});this._handles=null;this._destroyOverlay();this._set("view",g);g&&(g.on("drag",["Shift"],
l=>this._handleDrag(l,1),e.ViewEventPriorities.INTERNAL),g.on("drag",["Shift","Ctrl"],l=>this._handleDrag(l,-1),e.ViewEventPriorities.INTERNAL))}}]);return r}(E);F.__decorate([k.property()],E.prototype,"navigation",void 0);F.__decorate([k.property()],E.prototype,"view",null);return E=F.__decorate([b.subclass("esri.views.2d.navigation.ZoomBox")],E)})},"esri/views/2d/navigation/actions/Pan":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/Logger ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator ../../../../geometry/Point".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n){E=function(u){function t(w){var v=u.call(this,w)||this;v.animationTime=0;v.momentumEstimator=new l.PanPlanarMomentumEstimator(500,6,.92);v.momentum=null;v.tmpMomentum=q.create();v.momentumFinished=!1;v.viewpoint=new B({targetGeometry:new n,scale:0,rotation:0});v.watch("momentumFinished",C=>{C&&v.navigation.stop()});return v}x._inheritsLoose(t,u);var m=t.prototype;m.begin=function(w,v){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(v);
this.previousDrag=v};m.update=function(w,v){this.addToEstimator(v);let C=v.center.x,A=v.center.y;const y=this.previousDrag;C=y?y.center.x-C:-C;A=y?A-y.center.y:A;w.viewpoint=g.translateBy(this.viewpoint,w.viewpoint,[C||0,A||0]);this.previousDrag=v};m.end=function(w,v){this.addToEstimator(v);this.momentum=w.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(w);this.previousDrag=null;this.navigation.end()};m.addToEstimator=
function(w){var v=w.center.x;const C=w.center.y,A=h.createScreenPointArray(-v,C);v=q.fromValues(-v,C,0);this.momentumEstimator.add(A,v,.001*w.timestamp)};m.onAnimationUpdate=function(w){this.navigation.animationManager.animateContinous(w.viewpoint,(v,C)=>{this.momentumFinished=!this.momentum||this.momentum.isFinished(this.animationTime);C*=.001;if(!this.momentumFinished){const A=this.momentum.valueDelta(this.animationTime,C);r.scale(this.tmpMomentum,this.momentum.direction,A);g.translateBy(v,v,this.tmpMomentum);
w.constraints.constrainByGeometry(v)}this.animationTime+=C})};m.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};return t}(k);F.__decorate([a.property()],E.prototype,"momentumFinished",void 0);F.__decorate([a.property()],E.prototype,"viewpoint",void 0);F.__decorate([a.property()],E.prototype,"navigation",void 0);return E=F.__decorate([f.subclass("esri.views.2d.navigation.actions.Pan")],E)})},"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec3 ../../chunks/vec3f64 ./FilteredFiniteDifference ./Momentum".split(" "),
function(x,F,E,B,k,h){let a=function(d){function c(b,e,f,r,q){b=d.call(this,b,e,f)||this;b.sceneVelocity=r;b.direction=q;return b}F._inheritsLoose(c,d);c.prototype.value=function(b){return d.prototype.valueFromInitialVelocity.call(this,this.sceneVelocity,b)};return c}(h.Momentum);h=function(){function d(b=300,e=12,f=.84){this.minimumInitialVelocity=b;this.stopVelocity=e;this.friction=f;this.enabled=!0;this.time=new k.FilteredFiniteDifference(.6);this.screen=[new k.FilteredFiniteDifference(.4),new k.FilteredFiniteDifference(.4)];
this.scene=[new k.FilteredFiniteDifference(.6),new k.FilteredFiniteDifference(.6),new k.FilteredFiniteDifference(.6)];this.tmpDirection=B.create()}var c=d.prototype;c.add=function(b,e,f){!this.enabled||this.time.hasLastValue&&.015>this.time.computeDelta(f)||(this.screen[0].update(b[0]),this.screen[1].update(b[1]),this.scene[0].update(e[0]),this.scene[1].update(e[1]),this.scene[2].update(e[2]),this.time.update(f))};c.reset=function(){this.screen[0].reset();this.screen[1].reset();this.scene[0].reset();
this.scene[1].reset();this.scene[2].reset();this.time.reset()};c.evaluateMomentum=function(){if(!this.enabled||!this.screen[0].hasFilteredDelta)return null;var b=this.screen[0].filteredDelta;const e=this.screen[1].filteredDelta;b=Math.sqrt(b*b+e*e)/this.time.filteredDelta;return Math.abs(b)<this.minimumInitialVelocity?null:this.createMomentum(b,this.stopVelocity,this.friction)};c.createMomentum=function(b,e,f){E.set(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);
const r=E.length(this.tmpDirection);0<r&&E.scale(this.tmpDirection,this.tmpDirection,1/r);return new a(b,e,f,r/this.time.filteredDelta,this.tmpDirection)};return d}();x.PanPlanarMomentum=a;x.PanPlanarMomentumEstimator=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/navigation/FilteredFiniteDifference":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(x,F){let E=function(){function B(h){this.gain=h}var k=B.prototype;k.update=function(h){if(this.hasLastValue){const a=
this.computeDelta(h);this.updateDelta(a)}this.lastValue=h};k.reset=function(){this.filteredDelta=this.lastValue=void 0};k.computeDelta=function(h){return h-this.lastValue};k.updateDelta=function(h){this.filteredDelta=this.hasFilteredDelta?(1-this.gain)*this.filteredDelta+this.gain*h:h};F._createClass(B,[{key:"hasLastValue",get:function(){return void 0!==this.lastValue}},{key:"hasFilteredDelta",get:function(){return void 0!==this.filteredDelta}}]);return B}();x.FilteredFiniteDifference=E;Object.defineProperty(x,
"__esModule",{value:!0})})},"esri/views/navigation/Momentum":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(x,F){let E=function(){function B(h,a,d){this._initialVelocity=h;this._stopVelocity=a;this._friction=d;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}var k=B.prototype;k.isFinished=function(h){return h>this.duration};k.value=function(h){return this.valueFromInitialVelocity(this._initialVelocity,
h)};k.valueDelta=function(h,a){const d=this.value(h);return this.value(h+a)-d};k.valueFromInitialVelocity=function(h,a){a=Math.min(a,this.duration);const d=1-this.friction;return h*(d**a-1)/Math.log(d)};F._createClass(B,[{key:"duration",get:function(){return this._duration}},{key:"friction",get:function(){return this._friction}}]);return B}();x.Momentum=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/navigation/actions/Pinch":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/Logger ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator ../../../../geometry/Point".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n){E=function(u){function t(w){var v=u.call(this,w)||this;v._animationTime=0;v._momentumFinished=!1;v._rotationMomentumEstimator=new g.RotationMomentumEstimator(.6,.15,.95);v._rotationDirection=1;v._zoomDirection=1;v._zoomMomentumEstimator=new l.ZoomMomentumEstimator;v._zoomOnly=null;v.zoomMomentum=null;v.rotateMomentum=null;v.viewpoint=new B({targetGeometry:new n,scale:0,rotation:0});v.watch("_momentumFinished",C=>{C&&v.navigation.stop()});return v}x._inheritsLoose(t,
u);var m=t.prototype;m.begin=function(w,v){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=v.angle;this._previousRadius=this._startRadius=v.radius;this._previousCenter=v.center;this._updateTimestamp=null;w.constraints.rotationEnabled&&this.addToRotateEstimator(0,v.timestamp);this.addToZoomEstimator(v,1)};m.update=function(w,v){null===this._updateTimestamp&&(this._updateTimestamp=v.timestamp);
const C=v.angle,A=v.radius,y=v.center,p=Math.abs(180*(C-this._startAngle)/Math.PI),z=Math.abs(A-this._startRadius),D=this._startRadius/A;if(this._previousRadius){const G=A/this._previousRadius;let I=180*(C-this._previousAngle)/Math.PI;this._rotationDirection=0<=I?1:-1;this._zoomDirection=1<=G?1:-1;w.constraints.rotationEnabled?(null===this._zoomOnly&&200<v.timestamp-this._updateTimestamp&&(this._zoomOnly=0<z-p),null===this._zoomOnly||this._zoomOnly?I=0:this.addToRotateEstimator(C-this._startAngle,
v.timestamp)):I=0;this.addToZoomEstimator(v,D);this.navigation.setViewpoint([y.x,y.y],1/G,I,[this._previousCenter.x-y.x,y.y-this._previousCenter.y])}this._previousAngle=C;this._previousRadius=A;this._previousCenter=y};m.end=function(w){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(w);this.navigation.end()};m.addToRotateEstimator=
function(w,v){this._rotationMomentumEstimator.add(w,.001*v)};m.addToZoomEstimator=function(w,v){this._zoomMomentumEstimator.add(v,.001*w.timestamp)};m.canZoomIn=function(w){const v=w.scale;w=w.constraints.effectiveMaxScale;return 0===w||v>w};m.canZoomOut=function(w){const v=w.scale;w=w.constraints.effectiveMinScale;return 0===w||v<w};m.onAnimationUpdate=function(w){this.navigation.animationManager.animateContinous(w.viewpoint,(v,C)=>{var A=!this.canZoomIn(w)&&1<this._zoomDirection||!this.canZoomOut(w)&&
1>this._zoomDirection,y=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime);A=A||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime);C*=.001;this._momentumFinished=y&&A;if(!this._momentumFinished){y=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,C))*this._rotationDirection*180/Math.PI:0;A=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,C)):1;const z=r.create();var p=r.create();if(this._previousCenter){f.set(z,
this._previousCenter.x,this._previousCenter.y);q.getPaddingScreenTranslation(p,w.size,w.padding);f.add(z,z,p);const {constraints:D,scale:G}=w;p=G*A;1>A&&!D.canZoomInTo(p)?(A=G/D.effectiveMaxScale,this.rotateMomentum=this.zoomMomentum=null):1<A&&!D.canZoomOutTo(p)&&(A=G/D.effectiveMinScale,this.rotateMomentum=this.zoomMomentum=null);q.scaleAndRotateBy(v,w.viewpoint,A,y,z,w.size);w.constraints.constrainByGeometry(v)}}this._animationTime+=C})};m.stopMomentumNavigation=function(){if(this.rotateMomentum||
this.zoomMomentum)this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};return t}(k);F.__decorate([h.property()],E.prototype,"_momentumFinished",void 0);F.__decorate([h.property()],E.prototype,"viewpoint",void 0);F.__decorate([h.property()],E.prototype,"navigation",void 0);return E=F.__decorate([e.subclass("esri.views.2d.navigation.actions.Pinch")],E)})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./MomentumEstimator"],function(x,F,E){E=function(B){function k(h=3,a=.01,d=.95,c=12){return B.call(this,h,a,d,c)||this}F._inheritsLoose(k,B);k.prototype.add=function(h,a){if(this.value.hasLastValue){const d=this.value.lastValue;for(h-=d;h>Math.PI;)h-=2*Math.PI;for(;h<-Math.PI;)h+=2*Math.PI;h=d+h}B.prototype.add.call(this,h,a)};return k}(E.MomentumEstimator);x.RotationMomentumEstimator=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/navigation/MomentumEstimator":function(){define(["exports",
"../../core/mathUtils","./FilteredFiniteDifference","./Momentum"],function(x,F,E,B){let k=function(){function h(d=2.5,c=.01,b=.95,e=12){this.minimumInitialVelocity=d;this.stopVelocity=c;this.friction=b;this.maxVelocity=e;this.enabled=!0;this.value=new E.FilteredFiniteDifference(.8);this.time=new E.FilteredFiniteDifference(.3)}var a=h.prototype;a.add=function(d,c){if(this.enabled){if(this.time.hasLastValue){if(.01>this.time.computeDelta(c))return;if(this.value.hasFilteredDelta){const b=this.value.computeDelta(d);
0>this.value.filteredDelta*b&&this.value.reset()}}this.time.update(c);this.value.update(d)}};a.reset=function(){this.value.reset();this.time.reset()};a.evaluateMomentum=function(){if(!this.enabled||!this.value.hasFilteredDelta)return null;let d=this.value.filteredDelta/this.time.filteredDelta;d=F.clamp(d,-this.maxVelocity,this.maxVelocity);return Math.abs(d)<this.minimumInitialVelocity?null:this.createMomentum(d,this.stopVelocity,this.friction)};a.createMomentum=function(d,c,b){return new B.Momentum(d,
c,b)};return h}();x.MomentumEstimator=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./Momentum","./MomentumEstimator"],function(x,F,E,B){let k=function(h){function a(c,b,e){return h.call(this,c,b,e)||this}F._inheritsLoose(a,h);var d=a.prototype;d.value=function(c){c=h.prototype.value.call(this,c);return Math.exp(c)};d.valueDelta=function(c,b){const e=h.prototype.value.call(this,
c);c=h.prototype.value.call(this,c+b);return Math.exp(c-e)};return a}(E.Momentum);E=function(h){function a(c=2.5,b=.01,e=.95,f=12){return h.call(this,c,b,e,f)||this}F._inheritsLoose(a,h);var d=a.prototype;d.add=function(c,b){h.prototype.add.call(this,Math.log(c),b)};d.createMomentum=function(c,b,e){return new k(c,b,e)};return a}(B.MomentumEstimator);x.ZoomMomentum=k;x.ZoomMomentumEstimator=E;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/navigation/actions/Rotate":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/Logger ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../../geometry/Point".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g){const l=r.create(),n=r.create();E=function(u){function t(w){w=u.call(this,w)||this;w._previousCenter=r.create();w.viewpoint=new B({targetGeometry:new g,scale:0,rotation:0});return w}x._inheritsLoose(t,u);var m=t.prototype;m.begin=function(w,v){this.navigation.begin();f.set(this._previousCenter,v.center.x,v.center.y)};m.update=function(w,v){const {state:{size:C,padding:A}}=w;f.set(l,v.center.x,v.center.y);q.getAnchor(n,C,A);w.viewpoint=q.rotateBy(this.viewpoint,
w.state.paddedViewState.viewpoint,q.angleBetween(n,this._previousCenter,l));f.copy(this._previousCenter,l)};m.end=function(){this.navigation.end()};return t}(k);F.__decorate([h.property()],E.prototype,"viewpoint",void 0);F.__decorate([h.property()],E.prototype,"navigation",void 0);return E=F.__decorate([e.subclass("esri.views.2d.actions.Rotate")],E)})},"esri/views/2d/magnifier/MagnifierView2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/Handles ../../../core/mathUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/urlUtils ../../../core/watchUtils ../../webgl/BufferObject ../../webgl/FramebufferObject ../../webgl/Program ../../webgl/ProgramCache ../../webgl/Renderbuffer ../../webgl/RenderingContext ../../webgl/ShaderCompiler ../../webgl/Texture ../../webgl/VertexArrayObject ../engine/DisplayObject ../engine/webgl/enums ../engine/webgl/shaders/MagnifierPrograms ../../magnifier/resources".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l,n,u,t,m,w){return function(v){function C(){var y=v.call(this)||this;y._handles=new E;y._resourcePixelRatio=1;y.visible=!1;return y}x._inheritsLoose(C,v);var A=C.prototype;A.destroy=function(){this._handles.destroy();this._handles=null;this._disposeRenderResources();this._resourcesTask&&(this._resourcesTask.abort(),this._resourcesTask=null)};A.doRender=function(y){const p=y.context;if(!this._resourcesTask)this._reloadResources();else if(y.drawPhase===t.WGLDrawPhase.MAP&&
this._canRender()){this._updateResources(y);var z=this._magnifier;if(!k.isNone(z.position)){var D=y.pixelRatio,G=z.size*D,I=Math.ceil(1/z.factor*G);this._readbackTexture.resize(I,I);var {size:K}=y.state;y=D*K[0];K=D*K[1];var N=.5*I,L=.5*I,M=B.clamp(D*z.position.x,N,y-N-1),O=B.clamp(K-D*z.position.y,L,K-L-1);p.setBlendingEnabled(!0);N=M-N;L=O-L;var H=this._readbackTexture;p.bindTexture(H,0);p.gl.copyTexImage2D(H.descriptor.target,0,H.descriptor.pixelFormat,N,L,I,I,0);var J=(I=null==(J=this.background)?
void 0:J.color)?[I.a*I.r/255,I.a*I.g/255,I.a*I.b/255,I.a]:[1,1,1,1];I=-1+(M+z.offset.x*D)/y*2;D=-1+(O-z.offset.y*D)/K*2;y=G/y*2;G=G/K*2;K=this._program;p.bindVAO(this._vertexArrayObject);p.bindTexture(this._overlayTexture,6);p.bindTexture(this._maskTexture,7);p.useProgram(K);K.setUniform4fv("u_background",J);K.setUniform1i("u_readbackTexture",0);K.setUniform1i("u_overlayTexture",6);K.setUniform1i("u_maskTexture",7);K.setUniform4f("u_drawPos",I,D,y,G);K.setUniform1i("u_maskEnabled",z.maskEnabled?1:
0);K.setUniform1i("u_overlayEnabled",z.overlayEnabled?1:0);p.setStencilTestEnabled(!1);p.setColorMask(!0,!0,!0,!0);p.drawArrays(5,0,4);p.bindVAO()}}};A._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier};A._reloadResources=function(){var y=this;this._resourcesTask&&this._resourcesTask.abort();const p=k.isSome(this._magnifier)?this._magnifier.maskUrl:null,z=k.isSome(this._magnifier)?this._magnifier.overlayUrl:null;this._resourcesTask=h.createTask(function(){var D=x._asyncToGenerator(function*(G){const I=
k.isNone(p)||k.isNone(z)?w.loadMagnifierResources(G):null,K=k.isSome(p)?F(p,{responseType:"image",signal:G}).then(M=>M.data):I.then(M=>M.mask);G=k.isSome(z)?F(z,{responseType:"image",signal:G}).then(M=>M.data):I.then(M=>M.overlay);const [N,L]=yield Promise.all([K,G]);y.mask=N;y.overlay=L;y._disposeRenderResources();y.requestRender()});return function(G){return D.apply(this,arguments)}}())};A._disposeRenderResources=function(){this._readbackTexture=k.disposeMaybe(this._readbackTexture);this._overlayTexture=
k.disposeMaybe(this._overlayTexture);this._maskTexture=k.disposeMaybe(this._maskTexture);this._vertexArrayObject=k.disposeMaybe(this._vertexArrayObject);this._program=k.disposeMaybe(this._program)};A._updateResources=function(y){y.pixelRatio!==this._resourcePixelRatio&&this._disposeRenderResources();if(!this._readbackTexture){var p=y.context;this._resourcePixelRatio=y.pixelRatio;var z=Math.ceil(this._magnifier.size*y.pixelRatio);this._program=m.createMagnifierProgram(p);var D=new Uint16Array([0,1,
0,0,1,1,1,0]);this._vertexArrayObject=new n(p,m.magnifierProgramTemplate.attributes,{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:c.createVertex(p,35044,D)});this.overlay.width=z;this.overlay.height=z;this._overlayTexture=new l(p,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0,preMultiplyAlpha:a.isSVG(this.overlay.src)&&y.driverTestResult.svgAlwaysPremultipliesAlpha?!1:!0},this.overlay);
this.mask.width=z;this.mask.height=z;this._maskTexture=new l(p,{target:3553,pixelFormat:6406,internalFormat:6406,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.mask);y=1/this._magnifier.factor;this._readbackTexture=new l(p,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:Math.ceil(y*z),height:Math.ceil(y*z)})}};x._createClass(C,[{key:"background",get:function(){return this._background},set:function(y){this._background=
y;this.requestRender()}},{key:"magnifier",get:function(){return this._magnifier},set:function(y){this._magnifier=y;this._handles.removeAll();this._handles.add([d.init(y,"version",()=>{this.visible=y.visible&&k.isSome(y.position)&&0<y.size;this.requestRender()}),y.watch(["mask","overlay"],()=>this._reloadResources()),y.watch("size",()=>{this._disposeRenderResources();this.requestRender()})])}}]);return C}(u.DisplayObject)})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define("exports ../../../../webgl/BufferObject ../../../../webgl/FramebufferObject ../../../../webgl/Program ../../../../webgl/ProgramCache ../../../../webgl/Renderbuffer ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/programUtils ./sources/resolver".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f){const r={shaders:{vertexShader:f.resolveIncludes("magnifier/magnifier.vert"),fragmentShader:f.resolveIncludes("magnifier/magnifier.frag")},attributes:new Map([["a_pos",0]])};x.createMagnifierProgram=function(q){return e.createProgram(q,r)};x.magnifierProgramTemplate=r;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/magnifier/resources":function(){define(["require","exports","../../chunks/_rollupPluginBabelHelpers","../../core/promiseUtils","../../support/requestImageUtils"],
function(x,F,E,B,k){function h(){h=E._asyncToGenerator(function*(a){var d=new Promise(function(b,e){x(["./mask-svg"],function(f){b(Object.freeze({__proto__:null,"default":f}))},e)}),c=new Promise(function(b,e){x(["./overlay-svg"],function(f){b(Object.freeze({__proto__:null,"default":f}))},e)});d=k.requestImage((yield d).default,{signal:a});c=k.requestImage((yield c).default,{signal:a});c={mask:yield d,overlay:yield c};B.throwIfAborted(a);return c});return h.apply(this,arguments)}F.loadMagnifierResources=
function(a){return h.apply(this,arguments)};Object.defineProperty(F,"__esModule",{value:!0})})},"esri/support/requestImageUtils":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../request"],function(x,F,E){function B(){B=F._asyncToGenerator(function*(k,h){({data:k}=yield E(k,{responseType:"image",...h}));return k});return B.apply(this,arguments)}x.requestImage=function(k,h){return B.apply(this,arguments)};Object.defineProperty(x,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["exports",
"../../../chunks/mat4"],function(x,F){x.mat4=F.mat4;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["exports","../../../chunks/mat4f32"],function(x,F){x.mat4f32=F.mat4f32;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["exports","../../../chunks/vec3f32"],function(x,F){x.vec3f32=F.vec3f32;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/chunks/vec3f32":function(){define(["exports"],
function(x){function F(){return new Float32Array(3)}function E(n){const u=new Float32Array(3);u[0]=n[0];u[1]=n[1];u[2]=n[2];return u}function B(n,u,t){const m=new Float32Array(3);m[0]=n;m[1]=u;m[2]=t;return m}function k(n,u){return new Float32Array(n,u,3)}function h(){return F()}function a(){return B(1,1,1)}function d(){return B(1,0,0)}function c(){return B(0,1,0)}function b(){return B(0,0,1)}const e=F(),f=a(),r=d(),q=c(),g=b();var l=Object.freeze({__proto__:null,create:F,clone:E,fromValues:B,createView:k,
zeros:h,ones:a,unitX:d,unitY:c,unitZ:b,ZEROS:e,ONES:f,UNIT_X:r,UNIT_Y:q,UNIT_Z:g});x.ONES=f;x.UNIT_X=r;x.UNIT_Y=q;x.UNIT_Z=g;x.ZEROS=e;x.clone=E;x.create=F;x.createView=k;x.fromValues=B;x.ones=a;x.unitX=d;x.unitY=c;x.unitZ=b;x.vec3f32=l;x.zeros=h})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["exports","../../../chunks/vec4f32"],function(x,F){x.vec4f32=F.vec4f32;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/Bitmap":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/mat3 ../../../chunks/mat3f32 ../../../chunks/vec2f32 ../../webgl/BufferObject ../../webgl/FramebufferObject ../../webgl/Program ../../webgl/ProgramCache ../../webgl/Renderbuffer ../../webgl/RenderingContext ../../webgl/ShaderCompiler ../../webgl/Texture ../../webgl/VertexArrayObject ./DisplayObject ./ImageryBitmapSource".split(" "),
function(x,F,E,B,k,h,a,d,c,b,e,f,r,q,g,l){function n(t){const m=document.createElement("canvas");m.width=t.width;m.height=t.height;t.render(m.getContext("2d"));return m}function u(t,m,w){const v={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};m&&w&&(v.width=m,v.height=w);return new r(t,v)}h=function(t){function m(v=null,C,A=!0){var y=t.call(this)||this;y.requestRenderOnSourceChangedEnabled=A;y._textureInvalidated=!0;y.stencilRef=0;y.coordScale=[1,1];y._height=void 0;
y.pixelRatio=1;y.resolution=0;y.rotation=0;y._source=null;y._width=void 0;y.x=0;y.y=0;y.transforms={dvs:B.create()};y.blendFunction=C;y.source=v;y.requestRender=y.requestRender.bind(F._assertThisInitialized(y));return y}F._inheritsLoose(m,t);var w=m.prototype;w.destroy=function(){this._texture&&(this._texture.dispose(),this._texture=null)};w.beforeRender=function(v){t.prototype.beforeRender.call(this,v);this.updateTexture(v.context)};w.invalidateTexture=function(){this._textureInvalidated||(this._textureInvalidated=
!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())};w.setTransform=function(v){const C=E.identity(this.transforms.dvs),[A,y]=v.toScreenNoRotation([0,0],this.x,this.y);var p=this.resolution/this.pixelRatio/v.resolution;const z=p*this.width;p*=this.height;const D=Math.PI*this.rotation/180;E.translate(C,C,k.fromValues(A,y));E.translate(C,C,k.fromValues(z/2,p/2));E.rotate(C,C,-D);E.translate(C,C,k.fromValues(-z/2,-p/2));E.scaleByVec2(C,C,k.fromValues(z,p));E.multiply(this.transforms.dvs,
v.displayViewMat3,C)};w.setSamplingProfile=function(v){this._texture&&(v.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(v.samplingMode))};w.bind=function(v,C){this._texture&&v.bindTexture(this._texture,C)};w.updateTexture=function(v){if(this.stage)this._textureInvalidated&&(this._textureInvalidated=!1,this._texture||(this._texture=this.source?u(v,this.sourceWidth,this.sourceHeight):u(v)),(v=this.source)?(this._texture.resize(this.sourceWidth,
this.sourceHeight),v&&"render"in v?v instanceof l?(v=v.getRenderedRasterPixels(),this._texture.setData(v.renderedRasterPixels)):this._texture.setData(n(v)):!v||"render"in v||this._texture.setData(v),this.ready()):this._texture.setData(null));else{var C;null==(C=this._texture)?void 0:C.dispose();this._texture=null}};w.onAttach=function(){this.invalidateTexture()};w.onDetach=function(){this.invalidateTexture()};F._createClass(m,[{key:"isSourceScaled",get:function(){return this.width!==this.sourceWidth||
this.height!==this.sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(v){this._height=v}},{key:"source",get:function(){return this._source},set:function(v){this._source=v;this.invalidateTexture()}},{key:"sourceHeight",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}},{key:"sourceWidth",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:
this._source.width}},{key:"width",get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(v){this._width=v}}]);return m}(g.DisplayObject);x.Bitmap=h;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["../../../chunks/_rollupPluginBabelHelpers"],function(x){return function(){function F(B,k,h){this.pixelBlock=B;this.extent=k;this.originalPixelBlock=h}var E=F.prototype;E.render=function(B){var k=this.pixelBlock;
if(k){var h=this.filter({pixelBlock:k});k=h.pixelBlock.getAsRGBA();h=B.createImageData(h.pixelBlock.width,h.pixelBlock.height);h.data.set(k);B.putImageData(h,0,0)}};E.getRenderedRasterPixels=function(){const B=this.filter({pixelBlock:this.pixelBlock});return{width:B.pixelBlock.width,height:B.pixelBlock.height,renderedRasterPixels:new Uint8Array(B.pixelBlock.getAsRGBA().buffer)}};x._createClass(F,[{key:"width",get:function(){return this.pixelBlock?this.pixelBlock.width:0}},{key:"height",get:function(){return this.pixelBlock?
this.pixelBlock.height:0}}]);return F}()})},"esri/views/2d/engine/BitmapContainer":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","./brushes","./webgl/enums","./webgl/WGLContainer"],function(x,F,E,B,k){k=function(h){function a(){return h.apply(this,arguments)||this}F._inheritsLoose(a,h);a.prototype.prepareRenderPasses=function(d){const c=d.registerRenderPass({name:"bitmap",brushes:[E.brushes.bitmap],target:()=>this.children,drawPhase:B.WGLDrawPhase.MAP});return[...h.prototype.prepareRenderPasses.call(this,
d),c]};F._createClass(a,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(d=>"additive"===d.blendFunction)}}]);return a}(k);x.BitmapContainer=k;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/BitmapTile":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","./Bitmap","./webgl/TiledDisplayObject"],function(x,F,E,B){B=function(k){function h(d,c,b,e=null){var f=k.call(this,d,c,b,b)||this;f.bitmap=new E.Bitmap(e,"standard",!1);f.bitmap.coordScale=
b;f.bitmap.once("isReady",()=>f.ready());return f}F._inheritsLoose(h,k);var a=h.prototype;a.destroy=function(){k.prototype.destroy.call(this);this.bitmap.destroy()};a.beforeRender=function(d){k.prototype.beforeRender.call(this,d);this.bitmap.beforeRender(d)};a.afterRender=function(d){k.prototype.afterRender.call(this,d);this.bitmap.afterRender(d)};a.setTransform=function(d,c){k.prototype.setTransform.call(this,d,c);this.bitmap.transforms.dvs=this.transforms.dvs};a.onAttach=function(){this.bitmap.stage=
this.stage};a.onDetach=function(){this.bitmap&&(this.bitmap.stage=null)};F._createClass(h,[{key:"stencilRef",get:function(){return this.bitmap.stencilRef},set:function(d){this.bitmap.stencilRef=d}}]);return h}(B.TiledDisplayObject);x.BitmapTile=B;Object.defineProperty(x,"__esModule",{value:!0})})},"esri/views/2d/engine/BitmapTileContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/aaBoundingRect ./BitmapTile ./brushes ./webgl/enums ./webgl/TileContainer".split(" "),
function(x,F,E,B,k,h,a){a=function(d){function c(){return d.apply(this,arguments)||this}F._inheritsLoose(c,d);var b=c.prototype;b.createTile=function(e){const f=this._tileInfoView.getTileBounds(E.create(),e);return new B.BitmapTile(e,f,this._tileInfoView.tileInfo.size)};b.destroyTile=function(){};b.prepareRenderPasses=function(e){const f=e.registerRenderPass({name:"bitmap (tile)",brushes:[k.brushes.bitmap],target:()=>this.children.map(r=>r.bitmap),drawPhase:h.WGLDrawPhase.MAP});return[...d.prototype.prepareRenderPasses.call(this,
e),f]};b.doRender=function(e){this.visible&&e.drawPhase===h.WGLDrawPhase.MAP&&d.prototype.doRender.call(this,e)};F._createClass(c,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(e=>"additive"===e.bitmap.blendFunction)}}]);return c}(a["default"]);x.BitmapTileContainer=a;Object.defineProperty(x,"__esModule",{value:!0})})},"*noref":1}});
define("exports ./engine/Stage ./LabelManager ./layers/graphics/GraphicsView2D ./layers/graphics/GraphicContainer ./navigation/MapViewNavigation ./magnifier/MagnifierView2D".split(" "),function(x,F,E,B,k,h,a){x.Stage=F.Stage;x.LabelManager=E;x.GraphicsView2D=B;x.GraphicContainer=k;x.MapViewNavigation=h;x.MagnifierView2D=a;Object.defineProperty(x,"__esModule",{value:!0})});