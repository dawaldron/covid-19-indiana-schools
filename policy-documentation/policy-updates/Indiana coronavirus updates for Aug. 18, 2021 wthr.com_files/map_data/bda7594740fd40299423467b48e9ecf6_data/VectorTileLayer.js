// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/mixins/ArcGISCachedService":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../support/serviceTileInfoProperty ../support/TilemapCache ../../geometry/SpatialReference".split(" "),function(k,
x,u,a,h,g,e,f,r,c,n,z,G,l){k.ArcGISCachedService=p=>{p=function(v){function M(){var I=v.apply(this,arguments)||this;I.copyright=null;I.minScale=0;I.maxScale=0;I.spatialReference=null;I.tileInfo=null;I.tilemapCache=null;return I}x._inheritsLoose(M,v);var E=M.prototype;E.readMinScale=function(I,C){return null!=C.minLOD&&null!=C.maxLOD?I:0};E.readMaxScale=function(I,C){return null!=C.minLOD&&null!=C.maxLOD?I:0};E.readTilemapCache=function(I,C){return C.capabilities&&-1<C.capabilities.indexOf("Tilemap")?
new G.TilemapCache({layer:this}):null};x._createClass(M,[{key:"supportsBlankTile",get:function(){return 10.2<=this.version}}]);return M}(p);u.__decorate([h.property({json:{read:{source:"copyrightText"}}})],p.prototype,"copyright",void 0);u.__decorate([h.property()],p.prototype,"minScale",void 0);u.__decorate([c.reader("service","minScale")],p.prototype,"readMinScale",null);u.__decorate([h.property()],p.prototype,"maxScale",void 0);u.__decorate([c.reader("service","maxScale")],p.prototype,"readMaxScale",
null);u.__decorate([h.property({type:l})],p.prototype,"spatialReference",void 0);u.__decorate([h.property({readOnly:!0})],p.prototype,"supportsBlankTile",null);u.__decorate([h.property(z.serviceTileInfoProperty)],p.prototype,"tileInfo",void 0);u.__decorate([h.property()],p.prototype,"tilemapCache",void 0);u.__decorate([c.reader("service","tilemapCache",["capabilities"])],p.prototype,"readTilemapCache",null);u.__decorate([h.property()],p.prototype,"version",void 0);return p=u.__decorate([n.subclass("esri.layers.mixins.ArcGISCachedService")],
p)};Object.defineProperty(k,"__esModule",{value:!0})})},"esri/layers/support/serviceTileInfoProperty":function(){define(["exports","./TileInfo"],function(k,x){function u(h,g,e,f){if(!h)return null;const {minScale:r,maxScale:c,minLOD:n,maxLOD:z}=g;if(null!=n&&null!=z)return f&&f.ignoreMinMaxLOD?x.fromJSON(h):x.fromJSON({...h,lods:h.lods.filter(({level:G})=>null!=G&&G>=n&&G<=z)});if(0!==r&&0!==c){const G=r?Math.round(1E4*r)/1E4:Infinity,l=c?Math.round(1E4*c)/1E4:-Infinity;return x.fromJSON({...h,lods:h.lods.filter(p=>
{p=Math.round(1E4*p.scale)/1E4;return p<=G&&p>=l})})}return x.fromJSON(h)}const a={type:x,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:u}}}}};k.readServiceTileInfo=u;k.serviceTileInfoProperty=a;Object.defineProperty(k,"__esModule",{value:!0})})},"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(k,x,u,a,h,g,e,f,r,c,n,z,G,l,p,v,M,E){var I;u=new u.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});a=I=function(C){function B(q){q=C.call(this,q)||this;q.dpi=96;q.format=null;q.origin=null;q.minScale=0;q.maxScale=0;q.size=null;q.spatialReference=null;return q}k._inheritsLoose(B,C);B.create=function(q=
{}){const {resolutionFactor:D=1,scales:F,size:A=256,spatialReference:K=l.WebMercator,numLODs:N=24}=q;if(!v.isValid(K)){q=[];if(F)for(var L=0;L<F.length;L++){var Q=F[L];q.push({level:L,scale:Q,resolution:Q})}else for(L=5E-4,Q=N-1;0<=Q;Q--)q.unshift({level:Q,scale:L,resolution:L}),L*=2;return new I({dpi:96,lods:q,origin:new G(0,0,K),size:[A,A],spatialReference:K})}L=v.getInfo(K);q=q.origin?new G({x:q.origin.x,y:q.origin.y,spatialReference:K}):L?new G({x:L.origin[0],y:L.origin[1],spatialReference:K}):
new G({x:0,y:0,spatialReference:K});L=1/(39.37*h.getMetersPerUnitForSR(K)*96);Q=[];if(F)for(var R=0;R<F.length;R++){var W=F[R];Q.push({level:R,scale:W,resolution:W*L})}else{var U=v.isGeographic(K)?512/A*5.916575275917094E8:256/A*5.91657527591555E8;R=Math.ceil(N/D);Q.push({level:0,scale:U,resolution:U*L});for(W=1;W<R;W++)U/=2**D,Q.push({level:W,scale:U,resolution:U*L})}return new I({dpi:96,lods:Q,origin:q,size:[A,A],spatialReference:K})};var w=B.prototype;w.readOrigin=function(q,D){return G.fromJSON({spatialReference:D.spatialReference,
...q})};w.readSize=function(q,D){return[D.cols,D.rows]};w.writeSize=function(q,D){D.cols=q[0];D.rows=q[0]};w.zoomToScale=function(q){const D=this.scales;if(0>=q)return D[0];if(q>=D.length-1)return D[D.length-1];{const F=Math.floor(q);return D[F]/(D[F]/D[F+1])**(q-F)}};w.scaleToZoom=function(q){const D=this.scales,F=D.length-1;let A=0;for(;A<F;A++){const K=D[A],N=D[A+1];if(K<=q)break;if(N===q)return A+1;if(K>q&&N<q)return A+Math.log(K/q)/Math.log(K/N)}return A};w.snapScale=function(q,D=.95){q=this.scaleToZoom(q);
return q%Math.floor(q)>=D?this.zoomToScale(Math.ceil(q)):this.zoomToScale(Math.floor(q))};w.tileAt=function(q,D,F,A){var K=this.lodAt(q);if(!K)return null;let N;if("number"===typeof D)N=D,D=F;else{if(v.equals(D.spatialReference,this.spatialReference))N=D.x,D=D.y;else{A=M.project(D,this.spatialReference);if(!A)return null;N=A.x;D=A.y}A=F}F=K.resolution*this.size[0];K=K.resolution*this.size[1];A||(A={id:null,level:0,row:0,col:0,extent:p.create()});A.level=q;A.row=Math.floor((this.origin.y-D)/K+.001);
A.col=Math.floor((N-this.origin.x)/F+.001);this.updateTileInfo(A);return A};w.updateTileInfo=function(q,D=0){var F=this.lodAt(q.level);F||1!==D||(D=this.lods[this.lods.length-1],D.level<q.level&&(F=D));if(F){var A=q.level-F.level;D=F.resolution*this.size[0]/2**A;F=F.resolution*this.size[1]/2**A;q.id=`${q.level}/${q.row}/${q.col}`;q.extent||(q.extent=p.create());q.extent[0]=this.origin.x+q.col*D;q.extent[1]=this.origin.y-(q.row+1)*F;q.extent[2]=q.extent[0]+D;q.extent[3]=q.extent[1]+F}};w.upsampleTile=
function(q){const D=this._upsampleLevels[q.level];if(!D||-1===D.parentLevel)return!1;q.level=D.parentLevel;q.row=Math.floor(q.row/D.factor+.001);q.col=Math.floor(q.col/D.factor+.001);this.updateTileInfo(q);return!0};w.getTileBounds=function(q,D){var {resolution:F}=this.lodAt(D.level);const A=F*this.size[0];F*=this.size[1];q[0]=this.origin.x+D.col*A;q[1]=this.origin.y-(D.row+1)*F;q[2]=q[0]+A;q[3]=q[1]+F;return q};w.lodAt=function(q){return this._levelToLOD&&this._levelToLOD[q]||null};w.clone=function(){return I.fromJSON(this.write({}))};
w._initializeUpsampleLevels=function(){const q=this.lods;this._upsampleLevels=[];let D=null;for(let F=0;F<q.length;F++){const A=q[F];this._upsampleLevels[A.level]={parentLevel:D?D.level:-1,factor:D?D.resolution/A.resolution:0};D=A}};k._createClass(B,[{key:"isWrappable",get:function(){const {spatialReference:q,origin:D}=this;if(q&&D){const F=v.getInfo(q);return q.isWrappable&&Math.abs(F.origin[0]-D.x)<=F.dx}return!1}},{key:"lods",set:function(q){let D=0,F=0;const A=[];this._levelToLOD={};q&&(D=-Infinity,
F=Infinity,q.forEach(K=>{A.push(K.scale);D=K.scale>D?K.scale:D;F=K.scale<F?K.scale:F;this._levelToLOD[K.level]=K}));this._set("scales",A);this._set("minScale",D);this._set("maxScale",F);this._set("lods",q);this._initializeUpsampleLevels()}}]);return B}(a.JSONSupport);x.__decorate([g.property({type:Number,json:{write:!0}})],a.prototype,"compressionQuality",void 0);x.__decorate([g.property({type:Number,json:{write:!0}})],a.prototype,"dpi",void 0);x.__decorate([g.property({type:String,json:{read:u.read,
write:u.write,origins:{"web-scene":{read:!1,write:!1}}}})],a.prototype,"format",void 0);x.__decorate([g.property({readOnly:!0})],a.prototype,"isWrappable",null);x.__decorate([g.property({type:G,json:{write:!0}})],a.prototype,"origin",void 0);x.__decorate([c.reader("origin")],a.prototype,"readOrigin",null);x.__decorate([g.property({type:[E],value:null,json:{write:!0}})],a.prototype,"lods",null);x.__decorate([g.property({readOnly:!0})],a.prototype,"minScale",void 0);x.__decorate([g.property({readOnly:!0})],
a.prototype,"maxScale",void 0);x.__decorate([g.property({readOnly:!0})],a.prototype,"scales",void 0);x.__decorate([g.property({cast:C=>Array.isArray(C)?C:"number"===typeof C?[C,C]:[256,256]})],a.prototype,"size",void 0);x.__decorate([c.reader("size",["rows","cols"])],a.prototype,"readSize",null);x.__decorate([z.writer("size",{cols:{type:f.Integer},rows:{type:f.Integer}})],a.prototype,"writeSize",null);x.__decorate([g.property({type:l,json:{write:!0}})],a.prototype,"spatialReference",void 0);return a=
I=x.__decorate([n.subclass("esri.layers.support.TileInfo")],a)})},"esri/geometry/support/aaBoundingRect":function(){define(["exports","../../core/has","../../core/maybe","../Extent"],function(k,x,u,a){function h(l=G){return[l[0],l[1],l[2],l[3]]}function g(l){return l[0]>=l[2]?0:l[2]-l[0]}function e(l){return l[1]>=l[3]?0:l[3]-l[1]}function f(l,p,v){return p>=l[0]&&v>=l[1]&&p<=l[2]&&v<=l[3]}function r(l,p){l[0]=p[0];l[1]=p[1];l[2]=p[2];l[3]=p[3];return l}function c(l){return 4===l.length}function n(l,
p,v){return l<p?p:l>v?v:l}const z=[Infinity,Infinity,-Infinity,-Infinity],G=[0,0,0,0];k.NEGATIVE_INFINITY=z;k.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];k.UNIT=[0,0,1,1];k.ZERO=G;k.allFinite=function(l){for(let p=0;4>p;p++)if(!isFinite(l[p]))return!1;return!0};k.area=function(l){return g(l)*e(l)};k.center=function(l,p=[0,0]){p[0]=(l[0]+l[2])/2;p[1]=(l[1]+l[3])/2;return p};k.clone=function(l){return[l[0],l[1],l[2],l[3]]};k.contains=function(l,p){return p[0]>=l[0]&&p[2]<=l[2]&&p[1]>=
l[1]&&p[3]<=l[3]};k.containsPoint=function(l,p){return f(l,p[0],p[1])};k.containsPointObject=function(l,p){return f(l,p.x,p.y)};k.containsPointWithMargin=function(l,p,v){return p[0]>=l[0]-v&&p[1]>=l[1]-v&&p[0]<=l[2]+v&&p[1]<=l[3]+v};k.containsXY=f;k.create=h;k.diameter=function(l){const p=g(l);l=e(l);return Math.sqrt(p*p+l*l)};k.distance=function(l,p){const v=(l[1]+l[3])/2,M=Math.max(Math.abs(p[0]-(l[0]+l[2])/2)-g(l)/2,0);l=Math.max(Math.abs(p[1]-v)-e(l)/2,0);return Math.sqrt(M*M+l*l)};k.empty=function(l){return l?
r(l,z):h(z)};k.equals=function(l,p,v){if(u.isNone(l)||u.isNone(p))return l===p;if(!c(l)||!c(p))return!1;if(v)for(let M=0;M<l.length;M++){if(!v(l[M],p[M]))return!1}else for(v=0;v<l.length;v++)if(l[v]!==p[v])return!1;return!0};k.expand=function(l,p,v=l){if("length"in p)if(c(p))v[0]=Math.min(l[0],p[0]),v[1]=Math.min(l[1],p[1]),v[2]=Math.max(l[2],p[2]),v[3]=Math.max(l[3],p[3]);else{if(2===p.length||3===p.length)v[0]=Math.min(l[0],p[0]),v[1]=Math.min(l[1],p[1]),v[2]=Math.max(l[2],p[0]),v[3]=Math.max(l[3],
p[1])}else switch(p.type){case "extent":v[0]=Math.min(l[0],p.xmin);v[1]=Math.min(l[1],p.ymin);v[2]=Math.max(l[2],p.xmax);v[3]=Math.max(l[3],p.ymax);break;case "point":v[0]=Math.min(l[0],p.x),v[1]=Math.min(l[1],p.y),v[2]=Math.max(l[2],p.x),v[3]=Math.max(l[3],p.y)}return v};k.expandPointInPlace=function(l,p){p[0]<l[0]&&(l[0]=p[0]);p[0]>l[2]&&(l[2]=p[0]);p[1]<l[1]&&(l[1]=p[1]);p[1]>l[3]&&(l[3]=p[1])};k.expandWithNestedArray=function(l,p,v=l){const M=p.length;let E=l[0],I=l[1],C=l[2];l=l[3];for(let B=
0;B<M;B++){const w=p[B];E=Math.min(E,w[0]);I=Math.min(I,w[1]);C=Math.max(C,w[0]);l=Math.max(l,w[1])}v[0]=E;v[1]=I;v[2]=C;v[3]=l;return v};k.fromExtent=function(l,p=h()){p[0]=l.xmin;p[1]=l.ymin;p[2]=l.xmax;p[3]=l.ymax;return p};k.fromValues=function(l,p,v,M,E=h()){E[0]=l;E[1]=p;E[2]=v;E[3]=M;return E};k.height=e;k.intersection=function(l,p,v=l){const M=p[0],E=p[1],I=p[2];p=p[3];v[0]=n(l[0],M,I);v[1]=n(l[1],E,p);v[2]=n(l[2],M,I);v[3]=n(l[3],E,p);return v};k.intersects=function(l,p){return Math.max(p[0],
l[0])<=Math.min(p[2],l[2])&&Math.max(p[1],l[1])<=Math.min(p[3],l[3])};k.is=c;k.isPoint=function(l){return(0===g(l)||!isFinite(l[0]))&&(0===e(l)||!isFinite(l[1]))};k.offset=function(l,p,v,M=l){M[0]=l[0]+p;M[1]=l[1]+v;M[2]=l[2]+p;M[3]=l[3]+v;return M};k.pad=function(l,p,v=l){v[0]=l[0]-p;v[1]=l[1]-p;v[2]=l[2]+p;v[3]=l[3]+p;return v};k.set=r;k.setMax=function(l,p,v=l){v[2]=p[0];v[3]=p[1];v!==l&&(v[0]=l[0],v[1]=l[1]);return l};k.setMin=function(l,p,v=l){v[0]=p[0];v[1]=p[1];v!==l&&(v[2]=l[2],v[3]=l[3]);
return v};k.size=function(l,p){p[0]=l[2]-l[0];p[1]=l[3]-l[1]};k.toExtent=function(l,p){return new a({xmin:l[0],ymin:l[1],xmax:l[2],ymax:l[3],spatialReference:p})};k.width=g;Object.defineProperty(k,"__esModule",{value:!0})})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass".split(" "),
function(k,x,u,a,h,g,e,f,r){var c;u=c=function(n){function z(G){G=n.call(this,G)||this;G.level=0;G.levelValue=null;G.resolution=0;G.scale=0;return G}k._inheritsLoose(z,n);z.prototype.clone=function(){return new c({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};return z}(u.JSONSupport);x.__decorate([a.property({type:g.Integer,json:{write:!0}})],u.prototype,"level",void 0);x.__decorate([a.property({type:String,json:{write:!0}})],u.prototype,"levelValue",void 0);
x.__decorate([a.property({type:Number,json:{write:!0}})],u.prototype,"resolution",void 0);x.__decorate([a.property({type:Number,json:{write:!0}})],u.prototype,"scale",void 0);return u=c=x.__decorate([r.subclass("esri.layers.support.LOD")],u)})},"esri/layers/support/TilemapCache":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/Accessor ../../core/Error ../../core/Handles ../../core/Logger ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/scheduling ../../core/urlUtils ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/cast ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ./Tilemap".split(" "),
function(k,x,u,a,h,g,e,f,r,c,n,z,G,l,p,v,M,E,I,C){var B;const w=f.getLogger("esri.layers.support.TilemapCache");k.TilemapCache=B=function(q){function D(A){A=q.call(this,A)||this;A._handles=new e;A._pendingTilemapRequests={};A._availableLevels={};A.levels=5;A.cacheByteSize=2097152;A.request=a;A._prefetchingEnabled=!0;return A}x._inheritsLoose(D,q);var F=D.prototype;F.initialize=function(){this._tilemapCache=new r(this.cacheByteSize);this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers?"],
()=>this._initializeTilemapDefinition()),l.init(this,"layer.tileInfo.lods",A=>this._initializeAvailableLevels(A),!0)]);this._initializeTilemapDefinition()};F.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)};F.castLevels=function(A){return 2>=A?(w.error("Minimum levels for Tilemap is 3, but got ",A),3):A};F.fetchTilemap=function(A,K,N,L){if(!this._availableLevels[A])return Promise.reject(new g("tilemap-cache:level-unavailable",`Level ${A} is unavailable in the service`));
const Q=this._tmpTilemapDefinition;if(A=this._tilemapFromCache(A,K,N,Q))return Promise.resolve(A);const R=L&&L.signal;L={...L,signal:null};return new Promise((W,U)=>{n.onAbort(R,()=>U(n.createAbortError()));const Y=C.tilemapDefinitionId(Q);let ca=this._pendingTilemapRequests[Y];if(!ca){ca=C.Tilemap.fromDefinition(Q,L).then(ea=>{this._tilemapCache.put(Y,ea,ea.byteSize);return ea});const da=()=>delete this._pendingTilemapRequests[Y];this._pendingTilemapRequests[Y]=ca;ca.then(da,da)}ca.then(W,U)})};
F.getAvailability=function(A,K,N){return this._availableLevels[A]?(A=this._tilemapFromCache(A,K,N,this._tmpTilemapDefinition))?A.getAvailability(K,N):"unknown":"unavailable"};F.getAvailabilityUpsample=function(A,K,N,L){L.level=A;L.row=K;L.col=N;A=this.layer.tileInfo;for(A.updateTileInfo(L);;)if(K=this.getAvailability(L.level,L.row,L.col),"unavailable"===K){if(!A.upsampleTile(L))return"unavailable"}else return K};F.fetchAvailability=function(A,K,N,L){return this._availableLevels[A]?this.fetchTilemap(A,
K,N,L).catch(Q=>Q).then(Q=>{if(Q instanceof C.Tilemap)return Q=Q.getAvailability(K,N),"unavailable"===Q?Promise.reject(new g("tile-map:tile-unavailable","Tile is not available",{level:A,row:K,col:N})):Q;if(n.isAbortError(Q))throw Q;return"unknown"}):Promise.reject(new g("tilemap-cache:level-unavailable",`Level ${A} is unavailable in the service`))};F.fetchAvailabilityUpsample=function(A,K,N,L,Q){L.level=A;L.row=K;L.col=N;const R=this.layer.tileInfo;R.updateTileInfo(L);const W=this.fetchAvailability(A,
K,N,Q).catch(U=>{if(n.isAbortError(U))throw U;if(R.upsampleTile(L))return this.fetchAvailabilityUpsample(L.level,L.row,L.col,L);throw U;});this._fetchAvailabilityUpsamplePrefetch(L.id,A,K,N,Q,W);return W};F._fetchAvailabilityUpsamplePrefetch=function(){var A=x._asyncToGenerator(function*(K,N,L,Q,R,W){if(this._prefetchingEnabled){var U=`prefetch-${K}`;if(!this._handles.has(U)){var Y=n.createAbortController();W.then(()=>Y.abort(),()=>Y.abort());var ca=!1;this._handles.add({remove(){ca||(ca=!0,Y.abort())}},
U);yield z.waitTicks(10,Y.signal).catch(()=>{});ca||(ca=!0,this._handles.remove(U));if(!n.isAborted(Y))for(K={id:K,level:N,row:L,col:Q},R={...R,signal:Y.signal},N=this.layer.tileInfo,L=0;B._prefetches.length<B._maxPrefetch&&N.upsampleTile(K);++L){const da=this.fetchAvailability(K.level,K.row,K.col,R);B._prefetches.push(da);Q=()=>{B._prefetches.removeUnordered(da)};da.then(Q,Q)}}}});return function(K,N,L,Q,R,W){return A.apply(this,arguments)}}();F._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var A=
this.layer.parsedUrl,K=A.query;this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:A.path,query:K?G.objectToQuery(K):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}};F._tilemapFromCache=function(A,K,N,L){L.level=A;L.row=K-K%this.size;L.col=N-N%this.size;A=C.tilemapDefinitionId(L);return this._tilemapCache.get(A)};F._initializeAvailableLevels=function(A){this._availableLevels={};A&&A.forEach(K=>
this._availableLevels[K.level]=!0)};x._createClass(D,[{key:"size",get:function(){return 1<<this.levels}},{key:"test",get:function(){const A=this;return{get prefetchingEnabled(){return A._prefetchingEnabled},set prefetchingEnabled(K){A._prefetchingEnabled=K},hasTilemap(K,N,L){return!!A._tilemapFromCache(K,N,L,A._tmpTilemapDefinition)}}}}]);return D}(h);k.TilemapCache._maxPrefetch=4;k.TilemapCache._prefetches=new c({initialSize:B._maxPrefetch});u.__decorate([p.property({constructOnly:!0,type:Number})],
k.TilemapCache.prototype,"levels",void 0);u.__decorate([M.cast("levels")],k.TilemapCache.prototype,"castLevels",null);u.__decorate([p.property({readOnly:!0,type:Number})],k.TilemapCache.prototype,"size",null);u.__decorate([p.property({constructOnly:!0,type:Number})],k.TilemapCache.prototype,"cacheByteSize",void 0);u.__decorate([p.property({constructOnly:!0})],k.TilemapCache.prototype,"layer",void 0);u.__decorate([p.property({constructOnly:!0})],k.TilemapCache.prototype,"request",void 0);k.TilemapCache=
B=u.__decorate([I.subclass("esri.layers.support.TilemapCache")],k.TilemapCache);Object.defineProperty(k,"__esModule",{value:!0})})},"esri/layers/support/Tilemap":function(){define(["exports","../../request","../../core/arrayUtils","../../core/Error","../../core/lang"],function(k,x,u,a,h){function g(f){if("vector-tile"===f.service.type)var r=`${f.service.url}/tilemap/${f.level}/${f.row}/${f.col}/${f.width}/${f.height}`;else r=f.service.tileServers,r=`${r&&r.length?r[f.row%r.length]:f.service.url}/tilemap/${f.level}/${f.row}/${f.col}/${f.width}/${f.height}`;
(f=f.service.query)&&(r=`${r}?${f}`);return r}let e=function(){function f(){this.location={left:0,top:0,width:0,height:0};this._allAvailability="unknown";this.byteSize=40}var r=f.prototype;r.getAvailability=function(c,n){if("unknown"!==this._allAvailability)return this._allAvailability;c=(c-this.location.top)*this.location.width+(n-this.location.left);n=c>>3;const z=this._tileAvailabilityBitSet;return 0>n||n>z.length?"unknown":z[n]&1<<c%8?"available":"unavailable"};r._updateFromData=function(c){let n=
!0,z=!0;const G=new Uint8Array(Math.ceil(this.location.width*this.location.height/8));let l=0;for(let p=0;p<c.length;p++){const v=p%8;c[p]?(z=!1,G[l]|=1<<v):n=!1;7===v&&++l}z?this._allAvailability="unavailable":n?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=G,this.byteSize+=G.length)};f.fromDefinition=function(c,n){const z=c.service.request||x,{row:G,col:l,width:p,height:v}=c,M={query:{f:"json"}};n=n?{...M,...n}:M;return z(g(c),n).then(E=>E.data).catch(E=>
{if(E&&E.details&&422===E.details.httpStatus)return{location:{top:G,left:l,width:p,height:v},valid:!0,data:u.constant(p*v,0)};throw E;}).then(E=>{if(E.location&&(E.location.top!==G||E.location.left!==l||E.location.width!==p||E.location.height!==v))throw new a("tilemap:location-mismatch","Tilemap response for different location than requested",{response:E,definition:{top:G,left:l,width:p,height:v}});return f.fromJSON(E)})};f.fromJSON=function(c){f.validateJSON(c);const n=new f;n.location=Object.freeze(h.clone(c.location));
n._updateFromData(c.data);return Object.freeze(n)};f.validateJSON=function(c){if(!c||!c.location)throw new a("tilemap:missing-location","Location missing from tilemap response");if(!1===c.valid)throw new a("tilemap:invalid","Tilemap response was marked as invalid");if(!c.data)throw new a("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(c.data))throw new a("tilemap:data-mismatch","Data must be an array of numbers");if(c.data.length!==c.location.width*c.location.height)throw new a("tilemap:data-mismatch",
"Number of data items does not match width/height of tilemap");};return f}();k.Tilemap=e;k.default=e;k.tilemapDefinitionId=function(f){return`${f.level}/${f.row}/${f.col}/${f.width}/${f.height}`};Object.defineProperty(k,"__esModule",{value:!0})})},"esri/layers/support/imageUtils":function(){define(["exports"],function(k){k.checkWebPSupport=function(x){const u={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA\x3d\x3d",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA\x3d\x3d",
animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};return new Promise(a=>{const h=new Image;h.onload=()=>{h.onload=h.onerror=null;a(0<h.width&&0<h.height)};h.onerror=()=>{h.onload=h.onerror=null;a(!1)};h.src="data:image/webp;base64,"+u[x]})};Object.defineProperty(k,"__esModule",{value:!0})})},"esri/layers/support/SpriteSource":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../request","../../core/Error",
"../../core/Logger","../../core/urlUtils"],function(k,x,u,a,h){const g=a.getLogger("esri.layers.support.SpriteSource");return function(){function e(r,c,n,z){this.baseURL=r;this.devicePixelRatio=c;this.maxTextureSize=n;this._spriteImageFormat=z;this._isRetina=!1;this._spritesData={};this.height=this.width=this.image=null;this.loadStatus="not-loaded"}var f=e.prototype;f.getSpriteInfo=function(r){return this._spritesData[r]};f.load=function(){var r=k._asyncToGenerator(function*(c){if(this.baseURL){this.loadStatus=
"loading";try{yield this._loadSprites(c),this.loadStatus="loaded"}catch{this.loadStatus="failed"}}else this.loadStatus="failed"});return function(c){return r.apply(this,arguments)}}();f._loadSprites=function(r){this._isRetina=1.15<this.devicePixelRatio?!0:!1;const c=h.urlToObject(this.baseURL),n=c.query?"?"+h.objectToQuery(c.query):"",z=this._isRetina?"@2x":"",G=`${c.path}${z}.${this._spriteImageFormat}${n}`;return Promise.all([x(`${c.path}${z}.json${n}`,r),x(G,{responseType:"image",...r})]).then(([l,
p])=>{var v=Object.keys(l.data);if(!v||0===v.length||1===v.length&&"_ssl"===v[0]||!p||!p.data)return this._spritesData=this.image=null,this.width=this.height=0,Promise.resolve(null);this._spritesData=l.data;l=p.data;p=Math.max(this.maxTextureSize,4096);if(l.width>p||l.height>p)throw l=`Sprite resource for style ${c.path} is bigger than the maximum allowed of ${p} pixels}`,g.error(l),new u("SpriteSource",l);this.width=l.width;this.height=l.height;p=document.createElement("canvas");v=p.getContext("2d");
p.width=l.width;p.height=l.height;v.drawImage(l,0,0,l.width,l.height);l=v.getImageData(0,0,l.width,l.height);l=new Uint8Array(l.data);for(v=0;v<l.length;v+=4)p=l[v+3]/255,l[v]*=p,l[v+1]*=p,l[v+2]*=p;this.image=l})};k._createClass(e,[{key:"spriteNames",get:function(){const r=[];for(const c in this._spritesData)r.push(c);r.sort();return r}}]);return e}()})},"esri/layers/support/vectorTileLayerLoader":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../config ../../request ../../core/promiseUtils ../../core/urlUtils ../../views/2d/engine/vectorTiles/style/VectorTileSource".split(" "),
function(k,x,u,a,h,g,e){function f(){f=x._asyncToGenerator(function*(E,I){const C={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:"",spriteFormat:"png"},[B,w]="string"===typeof E?[E,null]:[null,E.jsonUrl],q=B?g.urlToObject(B):null;yield n(C,"esri",E,w,I);E={layerDefinition:C.validatedSource,url:B,parsedUrl:q,serviceUrl:C.sourceUrl,style:C.style,styleUrl:C.styleUrl,spriteUrl:C.style.sprite&&c(C.styleBase,
C.style.sprite),spriteFormat:C.spriteFormat,glyphsUrl:C.style.glyphs&&c(C.styleBase,C.style.glyphs),sourceNameToSource:C.sourceNameToSource,primarySourceName:C.primarySourceName};r(E.spriteUrl);r(E.glyphsUrl);return E});return f.apply(this,arguments)}function r(E){E&&(E=g.getOrigin(E),M&&-1===M.indexOf(E)&&M.push(E))}function c(...E){let I=void 0;for(let C=0;C<E.length;++C)g.isProtocolRelative(E[C])?I&&(I=I.split("://")[0]+":"+E[C].trim()):I=g.isAbsolute(E[C])?E[C]:g.join(I,E[C]);return g.removeTrailingSlash(I)}
function n(E,I,C,B,w){return z.apply(this,arguments)}function z(){z=x._asyncToGenerator(function*(E,I,C,B,w){h.throwIfAborted(w);if("string"===typeof C){B=g.normalize(C);r(B);var q=g.urlToObject(B);q=yield a(q.path,{query:{f:"json"},responseType:"json",...w});C=B}else q={data:C},C=C.jsonUrl||null;const D=q.data;q.ssl&&(C&&(C=C.replace(/^http:/i,"https:")),B&&(B=B.replace(/^http:/i,"https:")));return D.sources?(E.styleUrl=C||null,G(E,D,B,w)):D.sources?Promise.reject("You must specify the URL or the JSON for a service or for a style."):
E.sourceUrl?p(E,D,B,!1,I,w):(E.sourceUrl=C||null,p(E,D,B,!0,I,w))});return z.apply(this,arguments)}function G(E,I,C,B){return l.apply(this,arguments)}function l(){l=x._asyncToGenerator(function*(E,I,C,B){C=C?g.removeFile(C):g.appBaseUrl;E.styleBase=C;E.style=I;E.styleUrl&&r(E.styleUrl);I["sprite-format"]&&"webp"===I["sprite-format"].toLowerCase()&&(E.spriteFormat="webp");const w=[];if(I.sources&&I.sources.esri){const q=I.sources.esri;q.url?yield n(E,"esri",c(C,q.url),void 0,B):w.push(n(E,"esri",q,
C,B))}for(const q of Object.keys(I.sources))"esri"!==q&&"vector"===I.sources[q].type&&(I.sources[q].url?w.push(n(E,q,c(C,I.sources[q].url),void 0,B)):I.sources[q].tiles&&w.push(n(E,q,I.sources[q],C,B)));yield Promise.all(w)});return l.apply(this,arguments)}function p(E,I,C,B,w,q){return v.apply(this,arguments)}function v(){v=x._asyncToGenerator(function*(E,I,C,B,w,q){C=C?g.removeTrailingSlash(C)+"/":g.appBaseUrl;if(I.hasOwnProperty("tileInfo"))var D=I;else{var F={xmin:-2.0037507067161843E7,ymin:-2.0037507067161843E7,
xmax:2.0037507067161843E7,ymax:2.0037507067161843E7,spatialReference:{wkid:102100}},A=78271.51696400007,K=2.958287637957775E8,N=[],L=I.hasOwnProperty("minzoom")?parseFloat(I.minzoom):0,Q=I.hasOwnProperty("maxzoom")?parseFloat(I.maxzoom):22;for(let R=0;R<=Q;R++)R>=L&&N.push({level:R,scale:K,resolution:A}),A/=2,K/=2;for(D of I.tiles)r(c(C,D));D={capabilities:"TilesOnly",initialExtent:F,fullExtent:F,minScale:0,maxScale:0,tiles:I.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-2.0037508342787E7,
y:2.0037508342787E7},lods:N,spatialReference:{wkid:102100}}}}F=new e(w,C,D);if(!B&&E.primarySourceName in E.sourceNameToSource){A=E.sourceNameToSource[E.primarySourceName];if(!A.isCompatibleWith(F))return Promise.resolve();null!=F.fullExtent&&(null!=A.fullExtent?A.fullExtent.union(F.fullExtent):A.fullExtent=F.fullExtent.clone());A.tileInfo.lods.length<F.tileInfo.lods.length&&(A.tileInfo=F.tileInfo)}B?(E.sourceBase=C,E.source=I,E.validatedSource=D,E.primarySourceName=w,E.sourceUrl&&r(E.sourceUrl)):
r(C);E.sourceNameToSource[w]=F;if(!E.style)return null==I.defaultStyles?Promise.reject():"string"===typeof I.defaultStyles?n(E,"",c(C,I.defaultStyles,"root.json"),void 0,q):n(E,"",I.defaultStyles,c(C,"root.json"),q)});return v.apply(this,arguments)}const M=u.defaults&&u.defaults.io.corsEnabledServers;k.loadMetadata=function(E,I){return f.apply(this,arguments)};Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/VectorTileSource":function(){define("../../../../../core/lang ../../../../../core/urlUtils ../../../../../geometry/Extent ../../../../../layers/support/serviceTileInfoProperty ../../../../../layers/support/TilemapCache ../TileIndex".split(" "),
function(k,x,u,a,h,g){return function(){function e(r,c,n){this.tileMapURL="";this.fullExtent=this.tileIndex=this.capabilities=this.tileInfo=this.parsedUrl=this.tilemapCache=null;this.name=r;if(this.sourceUrl=c)this.parsedUrl=x.urlToObject(this.sourceUrl);const z=this.parsedUrl.path,G=this.parsedUrl.query?"?"+x.objectToQuery(this.parsedUrl.query):"";r=k.clone(n);const l=r.tiles;c&&l.forEach((M,E)=>{x.isAbsolute(M)||(l[E]=x.join(z,M)+G)});this.tileServers=l;n.tileMap&&(this.tileMapURL=x.join(c,n.tileMap));
var p=n.capabilities&&n.capabilities.split(",").map(M=>M.toLowerCase().trim());c=!!n.exportTilesAllowed;p=!!p&&-1!==p.indexOf("tilemap");const v=c&&n.hasOwnProperty("maxExportTilesCount")?n.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:c,supportsTileMap:p},exportTiles:c?{maxExportTilesCount:+v}:null};this.tileInfo=a.readServiceTileInfo(r.tileInfo,r,null,{ignoreMinMaxLOD:!0});p&&(this.type="vector-tile",this.tilemapCache=new h.TilemapCache({layer:this}),this.tileIndex=new g(this.tilemapCache));
this.fullExtent=u.fromJSON(n.fullExtent)}var f=e.prototype;f.getRefKey=function(r,c){return this.tileIndex?this.tileIndex.dataKey(r,c):Promise.resolve(r)};f.getSourceTileUrl=function(r,c,n){let z=this.tileServers[c%this.tileServers.length];return z=z.replace(/\{z\}/gi,r.toString()).replace(/\{y\}/gi,c.toString()).replace(/\{x\}/gi,n.toString())};f.isCompatibleWith=function(r){var c=this.tileInfo;r=r.tileInfo;if(!c.spatialReference.equals(r.spatialReference)||!c.origin.equals(r.origin)||Math.round(c.dpi)!==
Math.round(r.dpi))return!1;c=c.lods;r=r.lods;const n=Math.min(c.length,r.length);for(let z=0;z<n;z++){const G=c[z],l=r[z];if(G.level!==l.level||Math.round(G.scale)!==Math.round(l.scale))return!1}return!0};return e}()})},"esri/views/2d/engine/vectorTiles/TileIndex":function(){define(["../../../../core/promiseUtils","../../../../layers/support/TilemapCache","../../tiling/TileKey"],function(k,x,u){return function(){function a(g){if(g instanceof x.TilemapCache)this._tilemapCache=g;else if(g&&"index"in
g)this._tilemap=g.index;else throw Error("Invalid tilemap!");}var h=a.prototype;h.dataKey=function(g,e){if(this._tilemapCache){const {level:f,row:r,col:c}=g,n=new u(g);return this._tilemapCache.fetchAvailabilityUpsample(f,r,c,n,e).then(()=>{n.world=g.world;return n}).catch(z=>{if(k.isAbortError(z))throw z;return null})}return this._getIndexedDataKey(g)};h.forEach=function(g,e,f,r,c){this._callback=c;this._maxLevel=e+g;this._forEach(this._tilemap,e,f,r)};h._forEach=function(g,e,f,r){0!==g&&(this._callback(e,
f,r),e!==this._maxLevel&&"object"===typeof g&&(this._forEach(g[0],e+1,2*f,2*r),this._forEach(g[1],e+1,2*f,2*r+1),this._forEach(g[2],e+1,2*f+1,2*r),this._forEach(g[3],e+1,2*f+1,2*r+1)))};h._getIndexedDataKey=function(g){const e=[g];if(0>g.level||0>g.row||0>g.col||0<g.row>>g.level||0<g.col>>g.level)return Promise.resolve(null);for(;0!==g.level;)g=new u(g.level-1,g.row>>1,g.col>>1,g.world),e.push(g);g=this._tilemap;let f=e.pop(),r,c;if(1===g)return Promise.resolve(f);for(;e.length;)if(r=e.pop(),c=(r.col&
1)+((r.row&1)<<1),g){if(0===g[c]){f=null;break}if(1===g[c]){f=r;break}f=r;g=g[c]}return Promise.resolve(f)};return a}()})},"esri/views/2d/tiling/TileKey":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/ObjectPool"],function(k,x){let u=function(){function a(g,e,f,r){this.set(g,e,f,r)}a.getId=function(g,e,f,r){return"object"===typeof g?`${g.level}/${g.row}/${g.col}/${g.world}`:`${g}/${e}/${f}/${r}`};var h=a.prototype;h.acquire=function(g,e,f,r){this.set(g,e,f,r)};h.contains=
function(g){const e=g.level-this.level;return this.row===g.row>>e&&this.col===g.col>>e&&this.world===g.world};h.equals=function(g){return this.level===g.level&&this.row===g.row&&this.col===g.col&&this.world===g.world};h.clone=function(){return new a(this)};h.release=function(){this.world=this.col=this.row=this.level=0};h.set=function(g,e,f,r){if(null==g)this.world=this.col=this.row=this.level=0;else if("object"===typeof g)this.level=g.level||0,this.row=g.row||0,this.col=g.col||0,this.world=g.world||
0;else if("string"===typeof g){const [c,n,z,G]=g.split("/");this.level=parseFloat(c);this.row=parseFloat(n);this.col=parseFloat(z);this.world=parseFloat(G)}else this.level=+g,this.row=+e,this.col=+f,this.world=+r||0;return this};h.toString=function(){return`${this.level}/${this.row}/${this.col}/${this.world}`};h.getParentKey=function(){return 0>=this.level?null:new a(this.level-1,this.row>>1,this.col>>1,this.world)};h.getChildKeys=function(){const g=this.level+1,e=this.row<<1,f=this.col<<1,r=this.world;
return[new a(g,e,f,r),new a(g,e,f+1,r),new a(g,e+1,f,r),new a(g,e+1,f+1,r)]};h.compareRowMajor=function(g){return this.row<g.row?-1:this.row>g.row?1:this.col<g.col?-1:this.col>g.col?1:0};k._createClass(a,[{key:"key",get:function(){return this}},{key:"id",get:function(){return this.toString()},set:function(g){this.set(g)}}]);return a}();u.pool=new x(u,null,null,25,50);return u})},"esri/views/2d/engine/vectorTiles/SchemaHelper":function(){define(["../../../../layers/support/LOD","../../../../layers/support/TileInfo"],
function(k,x){return function(){function u(h,g){this.lockedSchemaPixelSize=h;this.isGCS=g}var a=u.prototype;a.getLevelRowColumn=function(h){return this.isGCS?[h[0],h[1]>>1,h[2]>>1]:256===this.lockedSchemaPixelSize&&0<h[0]?[h[0]-1,h[1]>>1,h[2]>>1]:h};a.adjustLevel=function(h){return this.isGCS?h:256===this.lockedSchemaPixelSize?0<h?h-1:0:h};a.getShift=function(h,g){let e=0,f=0;if(256===this.lockedSchemaPixelSize||this.isGCS)h[2]%2&&(e=g),h[1]%2&&(f=g);return[e,f]};a.getScale=function(h){if(this.isGCS){if(512===
this.lockedSchemaPixelSize)return 4}else if(256===this.lockedSchemaPixelSize&&0===h)return 1;return 2};u.create256x256CompatibleTileInfo=function(h){if(!h)return null;if(256===h.size[0]&&256===h.size[1])return h;const g=h.spatialReference.isGeographic,e=[],f=h.lods.length;for(let r=0;r<f;r++){const c=h.lods[r];e.push(new k({level:c.level,scale:c.scale,resolution:g?c.resolution:2*c.resolution}))}return new x({size:[256,256],dpi:h.dpi,format:h.format,compressionQuality:h.compressionQuality,origin:h.origin,
spatialReference:h.spatialReference,lods:e})};u.create512x512CompatibleTileInfo=function(h){if(!h||256===h.size[0]||256===h.size[1])return null;const g=[],e=h.lods.length;for(let f=0;f<e;f++){const r=h.lods[f];g.push(new k({level:r.level,scale:r.scale,resolution:.5*r.resolution}))}return new x({size:[512,512],dpi:h.dpi,format:h.format,compressionQuality:h.compressionQuality,origin:h.origin,spatialReference:h.spatialReference,lods:g})};return u}()})},"esri/views/2d/engine/vectorTiles/tileInfoUtils":function(){define(["exports",
"../../../../layers/support/TileInfo"],function(k,x){k.areSchemasOverlapping=function(u,a){if(u===a)return!0;if(!u&&null!=a||null!=u&&!a||!u.spatialReference.equals(a.spatialReference)||u.dpi!==a.dpi)return!1;var h=u.origin;const g=a.origin;if(1E-6<=Math.abs(h.x-g.x)||1E-6<=Math.abs(h.y-g.y))return!1;u.lods[0].scale>a.lods[0].scale?(h=u,u=a):h=a;for(a=h.lods[0].scale;a>=u.lods[u.lods.length-1].scale-1E-6;a/=2)if(1E-6>Math.abs(a-u.lods[0].scale))return!0;return!1};k.unionTileInfos=function(u,a){if(u===
a)return u;if(!u&&null!=a)return a;if(null!=u&&!a)return u;const h=u.size[0],g=u.format,e=u.dpi,f={x:u.origin.x,y:u.origin.y},r=u.spatialReference.toJSON();var c=u.lods[0].scale>a.lods[0].scale?u.lods[0]:a.lods[0];u=(u.lods[u.lods.length-1].scale<=a.lods[a.lods.length-1].scale?u.lods[u.lods.length-1]:a.lods[a.lods.length-1]).scale;a=[];let n=c.scale;c=c.resolution;let z=0;for(;n>u;)a.push({level:z,resolution:c,scale:n}),z++,n/=2,c/=2;return new x({size:[h,h],dpi:e,format:g||"pbf",origin:f,lods:a,
spatialReference:r})};Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleRepository":function(){define(["./StyleLayer"],function(k){return function(){function x(a,h){this._style=a;this.backgroundBucketIds=[];this._uidToLayer=new Map;this._layerByName={};this._runningId=0;a.layers||(a.layers=[]);this.version=parseFloat(a.version);this.sprite=h?h.spriteUrl:a.sprite;this.glyphs=h?h.glyphsUrl:a.glyphs;if(this.layers=a.layers.map((g,e,f)=>this._create(g,e,
f)))for(h=0;h<this.layers.length;h++)a=this.layers[h],this._layerByName[a.id.toLowerCase()]=a,this._uidToLayer.set(a.uid,a),0===a.type&&this.backgroundBucketIds.push(a.id);this._identifyRefLayers()}var u=x.prototype;u.isPainterDataDriven=function(a){return(a=this._layerByName[a.toLowerCase()])?a.isPainterDataDriven():!1};u.getStyleLayerId=function(a){return a>=this.layers.length?null:this.layers[a].id};u.getStyleLayerByUID=function(a){a=this._uidToLayer.get(a);return null!=a?a:null};u.getStyleLayerIndex=
function(a){return(a=this._layerByName[a.toLowerCase()])?this.layers.indexOf(a):-1};u.setStyleLayer=function(a,h){if(a&&a.id){var g=this._style;null!=h&&h>=this.layers.length&&(h=this.layers.length-1);var e=!0,f;if(f=this._layerByName[a.id.toLowerCase()]){const r=this.layers.indexOf(f);h||(h=r);h===r?(e=!1,f=x._recreateLayer(a,f),this.layers[h]=f,g.layers[h]=a):(this.layers.splice(r,1),g.layers.splice(r,1),f=this._create(a,h,this.layers),this.layers.splice(h,0,f),g.layers.splice(h,0,a))}else f=this._create(a,
h,this.layers),!h||h>=this.layers.length?(this.layers.push(f),g.layers.push(a)):(this.layers.splice(h,0,f),g.layers.splice(h,0,a));this._layerByName[a.id.toLowerCase()]=f;this._uidToLayer.set(f.uid,f);e&&this._recomputeZValues();this._identifyRefLayers()}};u.getStyleLayer=function(a){return(a=this._layerByName[a.toLowerCase()])?{type:a.typeName,id:a.id,source:a.source,"source-layer":a.sourceLayer,minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:a.layout,paint:a.paint}:null};u.deleteStyleLayer=
function(a){const h=this._layerByName[a.toLowerCase()];h&&(delete this._layerByName[a.toLowerCase()],this._uidToLayer.delete(h.uid),a=this.layers.indexOf(h),this.layers.splice(a,1),this._style.layers.splice(a,1),this._recomputeZValues(),this._identifyRefLayers())};u.getLayerById=function(a){return this._layerByName[a.toLowerCase()]};u.getLayoutProperties=function(a){return(a=this._layerByName[a.toLowerCase()])?a.layout:null};u.getPaintProperties=function(a){return(a=this._layerByName[a.toLowerCase()])?
a.paint:null};u.setPaintProperties=function(a,h){if(a=this._layerByName[a.toLowerCase()]){var g=x._recreateLayer({type:a.typeName,id:a.id,source:a.source,"source-layer":a.sourceLayer,minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:a.layout,paint:h},a),e=this.layers.indexOf(a);this.layers[e]=g;this._style.layers[e].paint=h;this._layerByName[a.id.toLowerCase()]=g;this._uidToLayer.set(a.uid,g)}};u.setLayoutProperties=function(a,h){if(a=this._layerByName[a.toLowerCase()]){var g=x._recreateLayer({type:a.typeName,
id:a.id,source:a.source,"source-layer":a.sourceLayer,minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:h,paint:a.paint},a),e=this.layers.indexOf(a);this.layers[e]=g;this._style.layers[e].layout=h;this._layerByName[a.id.toLowerCase()]=g;this._uidToLayer.set(a.uid,g)}};u.setStyleLayerVisibility=function(a,h){if(a=this._layerByName[a.toLowerCase()]){var g=a.layout||{};g.visibility=h;h=x._recreateLayer({type:a.typeName,id:a.id,source:a.source,"source-layer":a.sourceLayer,minzoom:a.minzoom,maxzoom:a.maxzoom,
filter:a.filter,layout:g,paint:a.paint},a);var e=this.layers.indexOf(a);this.layers[e]=h;this._style.layers[e].layout=g;this._layerByName[a.id.toLowerCase()]=h;this._uidToLayer.set(a.uid,h)}};u.getStyleLayerVisibility=function(a){var h;a=this._layerByName[a.toLowerCase()];if(!a)return"none";a=a.layout;return null!=(h=null==a?void 0:a.visibility)?h:"visible"};u._recomputeZValues=function(){const a=this.layers,h=1/(a.length+1);for(let g=0;g<a.length;g++)a[g].z=1-(1+g)*h};u._identifyRefLayers=function(){const a=
[],h=[];let g=0;for(const n of this.layers){const z=n.layout;if(1===n.type){var e,f=n,r=n.source+"|"+n.sourceLayer;r+=null!=(e="|"+(null==z?void 0:z.visibility))?e:"";r+="|"+n.minzoom;r+="|"+n.maxzoom;r+="|"+JSON.stringify(n.filter);if(f.hasDataDrivenFill||f.hasDataDrivenOutline)r+="|"+g;a.push({key:r,layer:n})}else if(2===n.type){var c;f=n;r=n.source+"|"+n.sourceLayer;r+=null!=(c="|"+(null==z?void 0:z.visibility))?c:"";r+="|"+n.minzoom;r+="|"+n.maxzoom;r+="|"+JSON.stringify(n.filter);r+="|"+(void 0!==
z?z["line-cap"]:"");r+="|"+(void 0!==z?z["line-join"]:"");f.hasDataDrivenLine&&(r+="|"+g);h.push({key:r,layer:n})}++g}this._assignRefLayers(a);this._assignRefLayers(h)};u._assignRefLayers=function(a){a.sort((c,n)=>c.key<n.key?-1:c.key>n.key?1:0);let h,g;const e=a.length;for(let c=0;c<e;c++){const n=a[c];if(n.key===h)n.layer.refLayerId=g;else if(h=n.key,g=n.layer.id,1===n.layer.type){if(!n.layer.getPaintProperty("fill-outline-color"))for(var f=c+1;f<e;f++){var r=a[f];if(r.key===h){if(r.layer.getPaintProperty("fill-outline-color")){a[c]=
r;a[f]=n;g=r.layer.id;break}}else break}}else if(2===n.layer.type)for(f=n.layer,r=c+1;r<e;r++){const z=a[r];if(z.key!==h)break;const G=z.layer;if(f.canUseThinTessellation&&!G.canUseThinTessellation||!f.canUseThinTessellation&&(G.getPaintProperty("line-pattern")||G.getPaintProperty("line-dasharray")))f=G,a[c]=z,a[r]=n,g=z.layer.id}}};u._create=function(a,h,g){h=1-1/(g.length+1)*(1+h);g=this._runningId++;switch(a.type){case "background":return new k.BackgroundStyleLayer(0,a,h,g);case "fill":return new k.FillStyleLayer(1,
a,h,g);case "line":return new k.LineStyleLayer(2,a,h,g);case "symbol":return new k.SymbolStyleLayer(3,a,h,g);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new k.CircleStyleLayer(4,a,h,g)}throw Error("Unknown vector tile layer");};x._recreateLayer=function(a,h){switch(a.type){case "background":return new k.BackgroundStyleLayer(0,a,h.z,h.uid);case "fill":return new k.FillStyleLayer(1,a,h.z,h.uid);case "line":return new k.LineStyleLayer(2,a,h.z,h.uid);case "symbol":return new k.SymbolStyleLayer(3,
a,h.z,h.uid);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new k.CircleStyleLayer(4,a,h.z,h.uid)}};return x}()})},"esri/views/2d/engine/vectorTiles/style/StyleLayer":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../shaders/VTLBackgroundMaterial ../shaders/VTLCircleMaterial ../shaders/VTLFillMaterial ../shaders/VTLLineMaterial ../shaders/VTLSymbolMaterial ./Filter ./StyleDefinition ./StyleProperty ../../webgl/definitions".split(" "),
function(k,x,u,a,h,g,e,f,r,c,n){let z=function(){function C(w,q,D,F){this.type=w;this.typeName=q.type;this.id=q.id;this.source=q.source;this.sourceLayer=q["source-layer"];this.minzoom=q.minzoom;this.maxzoom=q.maxzoom;this.filter=q.filter;this.layout=q.layout;this.paint=q.paint;this.z=D;this.uid=F;switch(w){case 0:this._layoutDefinition=r.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=r.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=r.StyleDefinition.fillLayoutDefinition;
this._paintDefinition=r.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=r.StyleDefinition.lineLayoutDefinition;this._paintDefinition=r.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=r.StyleDefinition.symbolLayoutDefinition;this._paintDefinition=r.StyleDefinition.symbolPaintDefinition;break;case 4:this._layoutDefinition=r.StyleDefinition.circleLayoutDefinition,this._paintDefinition=r.StyleDefinition.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout);
this._paintProperties=this._parsePaint(this.paint)}var B=C.prototype;B.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=f.createFilter(this.filter)};B.getLayoutProperty=function(w){return this._layoutProperties[w]};B.getPaintProperty=function(w){return this._paintProperties[w]};B.getLayoutValue=function(w,q,D){let F;const A=this._layoutProperties[w];A&&(F=A.getValue(q,D));void 0===F&&(F=this._layoutDefinition[w]["default"]);return F};B.getPaintValue=
function(w,q,D){let F;const A=this._paintProperties[w];A&&(F=A.getValue(q,D));void 0===F&&(F=this._paintDefinition[w]["default"]);return F};B.isPainterDataDriven=function(){const w=this._paintProperties;if(w)for(const q in w)if(w[q].isDataDriven)return!0;return!1};B._parseLayout=function(w){const q={};for(const D in w){const F=this._layoutDefinition[D];F&&(q[D]=new c(F,w[D]))}return q};B._parsePaint=function(w){const q={};for(const D in w){const F=this._paintDefinition[D];F&&(q[D]=new c(F,w[D]))}return q};
B.computeAttributesKey=function(w,q,D,F){let A=0,K=0;for(const N of q){q=3;if(!N||N!==F){const {isLayout:L,isOptional:Q}=D[N];q=L?this.getLayoutProperty(N):this.getPaintProperty(N);q=null!=q&&q.interpolator?2:null!=q&&q.isDataDriven?1:Q&&!q?3:0}K|=q<<A;A+=2}return K<<3|w};return C}(),G=function(C){function B(w,q,D,F){w=C.call(this,w,q,D,F)||this;w.backgroundMaterial=new u.VTLBackgroundMaterial(w.computeAttributesKey(0,u.VTLBackgroundMaterial.ATTRIBUTES,u.VTLBackgroundMaterial.ATTRIBUTES_INFO));return w}
x._inheritsLoose(B,C);return B}(z),l=function(C){function B(w,q,D,F){w=C.call(this,w,q,D,F)||this;q=w.getPaintProperty("fill-color");D=w.getPaintProperty("fill-opacity");F=w.getPaintProperty("fill-pattern");w.hasDataDrivenColor=null==q?void 0:q.isDataDriven;w.hasDataDrivenOpacity=null==D?void 0:D.isDataDriven;w.hasDataDrivenFill=w.hasDataDrivenColor||w.hasDataDrivenOpacity||(null==F?void 0:F.isDataDriven);D=w.getPaintProperty("fill-outline-color");w.outlineUsesFillColor=!D;w.hasDataDrivenOutlineColor=
null==D?void 0:D.isDataDriven;w.hasDataDrivenOutline=D?D.isDataDriven:q?q.isDataDriven:!1;w.hasDataDrivenOutline=(D?w.hasDataDrivenOutlineColor:w.hasDataDrivenColor)||w.hasDataDrivenOpacity;w.fillMaterial=new h.VTLFillMaterial(w.computeAttributesKey(1,h.VTLFillMaterial.ATTRIBUTES,h.VTLFillMaterial.ATTRIBUTES_INFO));w.outlineMaterial=new h.VTLOutlineMaterial(w.computeAttributesKey(2,w.outlineUsesFillColor?h.VTLOutlineMaterial.ATTRIBUTES_FILL:h.VTLOutlineMaterial.ATTRIBUTES_OUTLINE,w.outlineUsesFillColor?
h.VTLOutlineMaterial.ATTRIBUTES_INFO_FILL:h.VTLOutlineMaterial.ATTRIBUTES_INFO_OUTLINE),w.outlineUsesFillColor);return w}x._inheritsLoose(B,C);return B}(z),p=function(C){function B(w,q,D,F){var A,K,N,L,Q,R,W,U,Y;w=C.call(this,w,q,D,F)||this;q=w.getPaintProperty("line-pattern");w.lineMaterial=new g.VTLLineMaterial(w.computeAttributesKey(3,g.VTLLineMaterial.ATTRIBUTES,g.VTLLineMaterial.ATTRIBUTES_INFO,q?"line-dasharray":""));w.hasDataDrivenLine=(null==(A=w.getPaintProperty("line-blur"))?void 0:A.isDataDriven)||
(null==(K=w.getPaintProperty("line-color"))?void 0:K.isDataDriven)||(null==(N=w.getPaintProperty("line-gap-width"))?void 0:N.isDataDriven)||(null==(L=w.getPaintProperty("line-offset"))?void 0:L.isDataDriven)||(null==(Q=w.getPaintProperty("line-opacity"))?void 0:Q.isDataDriven)||(null==(R=w.getPaintProperty("line-pattern"))?void 0:R.isDataDriven)||(null==(W=w.getPaintProperty("line-dasharray"))?void 0:W.isDataDriven)||(null==(U=w.getLayoutProperty("line-cap"))?void 0:U.isDataDriven)||(null==(Y=w.getPaintProperty("line-width"))?
void 0:Y.isDataDriven);w.canUseThinTessellation=!1;!w.hasDataDrivenLine&&(A=w.getPaintProperty("line-width"),!A||"number"===typeof A&&.5*A<n.THIN_LINE_HALF_WIDTH_THRESHOLD)&&(A=w.getPaintProperty("line-offset"),!A||"number"===typeof A&&0===A)&&(w.canUseThinTessellation=!0);return w}x._inheritsLoose(B,C);B.prototype.getDashKey=function(w,q){switch(q){case 0:q="Butt";break;case 1:q="Round";break;case 2:q="Square";break;default:q="Butt"}return`dasharray-[${w.toString()}]-${q}`};return B}(z),v=function(C){function B(w,
q,D,F){var A,K,N,L,Q,R,W,U,Y,ca,da,ea;w=C.call(this,w,q,D,F)||this;w.iconMaterial=new e.VTLIconMaterial(w.computeAttributesKey(4,e.VTLIconMaterial.ATTRIBUTES,e.VTLIconMaterial.ATTRIBUTES_INFO));w.textMaterial=new e.VTLTextMaterial(w.computeAttributesKey(6,e.VTLTextMaterial.ATTRIBUTES,e.VTLTextMaterial.ATTRIBUTES_INFO));w.hasDataDrivenIcon=(null==(A=w.getPaintProperty("icon-color"))?void 0:A.isDataDriven)||(null==(K=w.getPaintProperty("icon-halo-blur"))?void 0:K.isDataDriven)||(null==(N=w.getPaintProperty("icon-halo-color"))?
void 0:N.isDataDriven)||(null==(L=w.getPaintProperty("icon-halo-width"))?void 0:L.isDataDriven)||(null==(Q=w.getPaintProperty("icon-opacity"))?void 0:Q.isDataDriven)||(null==(R=w.getLayoutProperty("icon-size"))?void 0:R.isDataDriven);w.hasDataDrivenText=(null==(W=w.getPaintProperty("text-color"))?void 0:W.isDataDriven)||(null==(U=w.getPaintProperty("text-halo-blur"))?void 0:U.isDataDriven)||(null==(Y=w.getPaintProperty("text-halo-color"))?void 0:Y.isDataDriven)||(null==(ca=w.getPaintProperty("text-halo-width"))?
void 0:ca.isDataDriven)||(null==(da=w.getPaintProperty("text-opacity"))?void 0:da.isDataDriven)||(null==(ea=w.getLayoutProperty("text-size"))?void 0:ea.isDataDriven);return w}x._inheritsLoose(B,C);return B}(z),M=function(C){function B(w,q,D,F){w=C.call(this,w,q,D,F)||this;w.circleMaterial=new a.VTLCircleMaterial(w.computeAttributesKey(5,a.VTLCircleMaterial.ATTRIBUTES,a.VTLCircleMaterial.ATTRIBUTES_INFO));return w}x._inheritsLoose(B,C);return B}(z),E=function(){function C(B,w,q){var D,F,A,K,N;this.allowOverlap=
B.getLayoutValue("icon-allow-overlap",w);this.ignorePlacement=B.getLayoutValue("icon-ignore-placement",w);this.keepUpright=B.getLayoutValue("icon-keep-upright",w);this.optional=B.getLayoutValue("icon-optional",w);this.rotationAlignment=B.getLayoutValue("icon-rotation-alignment",w);2===this.rotationAlignment&&(this.rotationAlignment=q?0:1);q=B.getLayoutProperty("icon-anchor");null!=(D=q)&&D.isDataDriven?this._anchorProp=q:this.anchor=B.getLayoutValue("icon-anchor",w);q=B.getLayoutProperty("icon-offset");
null!=(F=q)&&F.isDataDriven?this._offsetProp=q:this.offset=B.getLayoutValue("icon-offset",w);q=B.getLayoutProperty("icon-padding");null!=(A=q)&&A.isDataDriven?this._paddingProp=q:this.padding=B.getLayoutValue("icon-padding",w);q=B.getLayoutProperty("icon-rotate");null!=(K=q)&&K.isDataDriven?this._rotateProp=q:this.rotate=B.getLayoutValue("icon-rotate",w);q=B.getLayoutProperty("icon-size");null!=(N=q)&&N.isDataDriven?this._sizeProp=q:this.size=B.getLayoutValue("icon-size",w)}C.prototype.update=function(B,
w){this._anchorProp&&(this.anchor=this._anchorProp.getValue(B,w));this._offsetProp&&(this.offset=this._offsetProp.getValue(B,w));this._paddingProp&&(this.padding=this._paddingProp.getValue(B,w));this._rotateProp&&(this.rotate=this._rotateProp.getValue(B,w));this._sizeProp&&(this.size=this._sizeProp.getValue(B,w))};return C}(),I=function(){function C(B,w,q){var D,F,A,K,N,L,Q,R,W,U,Y;this.allowOverlap=B.getLayoutValue("text-allow-overlap",w);this.ignorePlacement=B.getLayoutValue("text-ignore-placement",
w);this.keepUpright=B.getLayoutValue("text-keep-upright",w);this.optional=B.getLayoutValue("text-optional",w);this.rotationAlignment=B.getLayoutValue("text-rotation-alignment",w);2===this.rotationAlignment&&(this.rotationAlignment=q?0:1);q=B.getLayoutProperty("text-anchor");null!=(D=q)&&D.isDataDriven?this._anchorProp=q:this.anchor=B.getLayoutValue("text-anchor",w);q=B.getLayoutProperty("text-justify");null!=(F=q)&&F.isDataDriven?this._justifyProp=q:this.justify=B.getLayoutValue("text-justify",w);
q=B.getLayoutProperty("text-letter-spacing");null!=(A=q)&&A.isDataDriven?this._letterSpacingProp=q:this.letterSpacing=B.getLayoutValue("text-letter-spacing",w);q=B.getLayoutProperty("text-line-height");null!=(K=q)&&K.isDataDriven?this._lineHeightProp=q:this.lineHeight=B.getLayoutValue("text-line-height",w);q=B.getLayoutProperty("text-max-angle");null!=(N=q)&&N.isDataDriven?this._maxAngleProp=q:this.maxAngle=B.getLayoutValue("text-max-angle",w);q=B.getLayoutProperty("text-max-width");null!=(L=q)&&
L.isDataDriven?this._maxWidthProp=q:this.maxWidth=B.getLayoutValue("text-max-width",w);q=B.getLayoutProperty("text-offset");null!=(Q=q)&&Q.isDataDriven?this._offsetProp=q:this.offset=B.getLayoutValue("text-offset",w);q=B.getLayoutProperty("text-padding");null!=(R=q)&&R.isDataDriven?this._paddingProp=q:this.padding=B.getLayoutValue("text-padding",w);q=B.getLayoutProperty("text-rotate");null!=(W=q)&&W.isDataDriven?this._rotateProp=q:this.rotate=B.getLayoutValue("text-rotate",w);q=B.getLayoutProperty("text-size");
null!=(U=q)&&U.isDataDriven?this._sizeProp=q:this.size=B.getLayoutValue("text-size",w);q=B.getLayoutProperty("text-writing-mode");null!=(Y=q)&&Y.isDataDriven?this._writingModeProp=q:this.writingMode=B.getLayoutValue("text-writing-mode",w)}C.prototype.update=function(B,w){this._anchorProp&&(this.anchor=this._anchorProp.getValue(B,w));this._justifyProp&&(this.justify=this._justifyProp.getValue(B,w));this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(B,w));this._lineHeightProp&&
(this.lineHeight=this._lineHeightProp.getValue(B,w));this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(B,w));this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(B,w));this._offsetProp&&(this.offset=this._offsetProp.getValue(B,w));this._paddingProp&&(this.padding=this._paddingProp.getValue(B,w));this._rotateProp&&(this.rotate=this._rotateProp.getValue(B,w));this._sizeProp&&(this.size=this._sizeProp.getValue(B,w));this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(B,
w))};return C}();k.BackgroundStyleLayer=G;k.CircleStyleLayer=M;k.FillStyleLayer=l;k.IconLayout=E;k.LineStyleLayer=p;k.StyleLayer=z;k.SymbolStyleLayer=v;k.TextLayout=I;Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLBackgroundMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(k,x,u){u=function(a){function h(e){return a.call(this,e)||this}x._inheritsLoose(h,a);var g=h.prototype;g.geometryInfo=
function(){return h.GEOMETRY_LAYOUT};g.opacityInfo=function(){return null};g.attributes=function(){return h.ATTRIBUTES};g.attributesInfo=function(){return h.ATTRIBUTES_INFO};return h}(u.VTLMaterial);u.ATTRIBUTES=[];u.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}];u.ATTRIBUTES_INFO={};k.VTLBackgroundMaterial=u;Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/maybe","../MemoryBuffer"],function(k,x,u,a){let h=function(){function f(c){this._locations=new Map;this._key=c}var r=f.prototype;r.defines=function(){return[]};r.getStride=function(){this._layoutInfo||this._buildAttributesInfo();return this._stride};r.getAttributeLocations=function(){0===this._locations.size&&this._buildAttributesInfo();return this._locations};r.getLayoutInfo=function(){this._layoutInfo||this._buildAttributesInfo();return this._layoutInfo};r.getEncodingInfos=
function(){this._propertyEncodingInfo||this._buildAttributesInfo();return this._propertyEncodingInfo};r.getUniforms=function(){this._uniforms||this._buildAttributesInfo();return this._uniforms};r.getShaderHeader=function(){this._shaderHeader||this._buildAttributesInfo();return this._shaderHeader};r.getShaderMain=function(){this._shaderMain||this._buildAttributesInfo();return this._shaderMain};r.setDataUniforms=function(c,n,z,G,l){var p=this.getUniforms();for(const v of p){const {name:M,type:E,getValue:I}=
v;p=I(z,n,G,l);if(null!==p)switch(E){case "float":c.setUniform1f(M,p);break;case "vec2":c.setUniform2fv(M,p);break;case "vec4":c.setUniform4fv(M,p)}}};r.encodeAttributes=function(c,n,z,G){const l=this.attributesInfo(),p=this.getEncodingInfos(),v=[];let M=0,E=0;for(const B of Object.keys(p)){var I,C=p[B];const {type:w,precisionFactor:q,isLayout:D}=l[B],F=D?z.getLayoutProperty(B):z.getPaintProperty(B),A=null==(I=F.interpolator)?void 0:I.getInterpolationRange(n);let K=0;for(const N of C){const {offset:L,
bufferElementsToAdd:Q}=N;if(0<Q){for(C=0;C<Q;C++)v.push(0);M+=E;E=N.bufferElementsToAdd}C=null!=G?G:F.getValue(A?A[K]:n,c);switch(w){case 0:case 1:v[M]|=this._encodeByte(C*(q||1),8*L);break;case 2:case 3:v[M]|=this._encodeShort(C*(q||1),8*L);break;case 4:case 5:v[M]|=this._encodeByte(C*(q||1),8*L);v[M]|=this._encodeByte(C*(q||1),8*L+8);break;case 6:case 7:v[M]|=this._encodeShort(C*(q||1),8*L);v[M]|=this._encodeShort(C*(q||1),8*L+16);break;case 8:case 9:v[M]|=this._encodeByte(C*(q||1),8*L);v[M]|=this._encodeByte(C*
(q||1),8*L+8);v[M]|=this._encodeByte(C*(q||1),8*L+16);v[M]|=this._encodeByte(C*(q||1),8*L+24);break;case 10:v[M]=this._encodeColor(C);break;case 11:case 12:this._encodePattern(M,v,C);break;default:throw Error("Unsupported encoding type");}K++}}return v};r.getAtributeState=function(c){const n=3+2*c;c=0|this._bit(n);return c|=this._bit(n+1)<<1};r._buildAttributesInfo=function(){const c=[],n={};var z={},G=-1;const l=this.attributesInfo();var p=this.attributes();let v=-1;for(const C of p){v++;p=this.getAtributeState(v);
if(0===p||3===p)continue;var M=l[C];const B=[];n[C]=B;M=M.type;for(let w=0;w<p;w++){const {dataType:q,bytesPerElement:D,count:F,normalized:A}=f._encodingInfo[M],K=D*F;let N=z[q];var E=0;!N||4<N.count+F?(G++,N={dataIndex:G,count:0,offset:0},4!==F&&(z[q]=N),c.push({location:-1,name:"a_data_"+G,count:F,type:q,normalized:A}),E=Math.ceil(Math.max(K/4,1))):(E=c[N.dataIndex],E.count+=F,E=Math.ceil(Math.max(E.count*D/4,1))-Math.ceil(Math.max(N.offset/4,1)));B.push({dataIndex:N.dataIndex,offset:N.offset,bufferElementsToAdd:E});
N.offset+=K;N.count+=F}}for(const C of c)switch(C.type){case 5120:case 5121:C.count=4;case 5122:case 5123:C.count+=C.count%2}this._buildVertexBufferLayout(c);z=0;G=this._layoutInfo.geometry;for(var I of G)this._locations.set(I.name,z++);if(I=this._layoutInfo.opacity)for(const C of I)this._locations.set(C.name,z++);this._buildShaderInfo(c,n);this._propertyEncodingInfo=n};r._buildVertexBufferLayout=function(c){const n={};var z=this.geometryInfo();let G=z[0].stride;if(0===c.length)n.geometry=z;else{const l=
[];let p=G;for(const v of c)G+=g(v.type)*v.count;for(const v of z)z={...v},z.stride=G,l.push(z);for(const v of c)l.push({name:v.name,count:v.count,type:v.type,offset:p,stride:G,normalized:v.normalized||!1,divisor:0}),p+=g(v.type)*v.count;n.geometry=l}this.opacityInfo()&&(n.opacity=this.opacityInfo());this._layoutInfo=n;this._stride=G};r._buildShaderInfo=function(c,n){let z="\n",G="\n";const l=[];for(var p of c)z+=`attribute ${this._getType(p.count)} ${p.name};\n`;var v=this.attributes();c=this.attributesInfo();
p=-1;for(const I of v){p++;const {name:C,type:B,precisionFactor:w,isLayout:q}=c[I];v=w&&1!==w?` * ${1/w}`:"";const {bytesPerElement:D,count:F}=f._encodingInfo[B];var M=A=>`a_data_${A.dataIndex}${e(F,A.offset,D)}`;switch(this.getAtributeState(p)){case 0:v=this._getType(F);var E=`u_${C}`;l.push({name:E,type:v,getValue:(A,K,N,L)=>{N=q?A.getLayoutValue(I,K):A.getPaintValue(I,K);if(11===B){A=A.getDashKey(N,A.getLayoutValue("line-cap",K));L=L.getMosaicItemPosition(A,!1);if(u.isNone(L))return null;const {tl:Q,
br:R}=L;return[Q[0],R[1],R[0],Q[1]]}if(12===B){L=L.getMosaicItemPosition(N,-1===I.indexOf("line-"));if(u.isNone(L))return null;const {tl:Q,br:R}=L;return[Q[0],R[1],R[0],Q[1]]}return 10===B?(L=N[3],[L*N[0],L*N[1],L*N[2],L]):N}});z+=`uniform ${v} ${E};\n`;G+=`${v} ${C} = ${E};\n`;break;case 1:E=M(n[I][0]);G+=`${this._getType(F)} ${C} = ${E}${v};\n`;break;case 2:{E=`u_t_${C}`;l.push({name:E,type:"float",getValue:(K,N,L,Q)=>(q?K.getLayoutProperty(I):K.getPaintProperty(I)).interpolator.interpolationUniformValue(L,
N)});z+=`uniform float ${E};\n`;const A=M(n[I][0]);M=M(n[I][1]);G+=`${this._getType(F)} ${C} = mix(${A}${v}, ${M}${v}, ${E});\n`}}}this._shaderHeader=z;this._shaderMain=G;this._uniforms=l};r._bit=function(c){return(this._key&1<<c)>>c};r._getType=function(c){switch(c){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw Error("Invalid count");};r._encodeColor=function(c){const n=255*c[3];return a.i8888to32(c[0]*n,c[1]*n,c[2]*n,n)};r._encodePattern=function(c,n,z){if(z&&
z.rect){var G=z.rect,l=z.width;z=z.height;n[c]=this._encodeShort(G.x+2,0);n[c]|=this._encodeShort(G.y+2+z,16);n[c+1]=this._encodeShort(G.x+2+l,0);n[c+1]|=this._encodeShort(G.y+2,16)}};r._encodeByte=function(c,n){return(c&255)<<n};r._encodeShort=function(c,n){return(c&65535)<<n};x._createClass(f,[{key:"key",get:function(){return this._key}},{key:"type",get:function(){return this._key&7}}]);return f}();h._encodingInfo={[0]:{dataType:5120,bytesPerElement:1,count:1,normalized:!1},[1]:{dataType:5121,bytesPerElement:1,
count:1,normalized:!1},[2]:{dataType:5122,bytesPerElement:2,count:1,normalized:!1},[3]:{dataType:5123,bytesPerElement:2,count:1,normalized:!1},[4]:{dataType:5120,bytesPerElement:1,count:2,normalized:!1},[5]:{dataType:5121,bytesPerElement:1,count:2,normalized:!1},[6]:{dataType:5122,bytesPerElement:2,count:2,normalized:!1},[7]:{dataType:5123,bytesPerElement:2,count:2,normalized:!1},[8]:{dataType:5120,bytesPerElement:1,count:4,normalized:!1},[9]:{dataType:5121,bytesPerElement:1,count:4,normalized:!1},
[10]:{dataType:5121,bytesPerElement:1,count:4,normalized:!0},[11]:{dataType:5123,bytesPerElement:2,count:4,normalized:!1},[12]:{dataType:5123,bytesPerElement:2,count:4,normalized:!1}};const g=f=>{switch(f){case 5126:return 4;case 5124:return 4;case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1}},e=(f,r,c)=>{r/=c;if(1===f)switch(r){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===f)switch(r){case 0:return".xy";case 1:return".yz";
case 2:return".zw"}else if(3===f)switch(r){case 0:return".xyz";case 1:return".yzw"}return""};k.VTLMaterial=h;Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/MemoryBuffer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(k){return function(){function x(a){this._array=[];0>=a&&console.error("strideInBytes must be positive!");this._stride=a}var u=x.prototype;u.reset=function(){this.array.length=0};u.toBuffer=function(){return(new Uint32Array(this._array)).buffer};
x.i1616to32=function(a,h){return 65535&a|h<<16};x.i8888to32=function(a,h,g,e){return a&255|(h&255)<<8|(g&255)<<16|e<<24};x.i8816to32=function(a,h,g){return a&255|(h&255)<<8|g<<16};k._createClass(x,[{key:"array",get:function(){return this._array}},{key:"index",get:function(){return 4*this._array.length/this._stride}},{key:"itemSize",get:function(){return this._stride}},{key:"sizeInBytes",get:function(){return 4*this._array.length}}]);return x}()})},"esri/views/2d/engine/vectorTiles/shaders/VTLCircleMaterial":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(k,x,u){u=function(a){function h(e){return a.call(this,e)||this}x._inheritsLoose(h,a);var g=h.prototype;g.geometryInfo=function(){return h.GEOMETRY_LAYOUT};g.opacityInfo=function(){return null};g.attributes=function(){return h.ATTRIBUTES};g.attributesInfo=function(){return h.ATTRIBUTES_INFO};return h}(u.VTLMaterial);u.ATTRIBUTES="circle-radius circle-color circle-opacity circle-stroke-width circle-stroke-color circle-stroke-opacity circle-blur".split(" ");
u.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}];u.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:1},"circle-color":{name:"color",type:10},"circle-opacity":{name:"opacity",type:1,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:1,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:10},"circle-stroke-opacity":{name:"stroke_opacity",type:1,precisionFactor:100},"circle-blur":{name:"blur",type:1,precisionFactor:32}};
k.VTLCircleMaterial=u;Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLFillMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(k,x,u){let a=function(h){function g(f){return h.call(this,f)||this}x._inheritsLoose(g,h);var e=g.prototype;e.geometryInfo=function(){return g.GEOMETRY_LAYOUT};e.opacityInfo=function(){return null};e.attributes=function(){return g.ATTRIBUTES};e.attributesInfo=function(){return g.ATTRIBUTES_INFO};
return g}(u.VTLMaterial);a.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"];a.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}];a.ATTRIBUTES_INFO={"fill-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100},"fill-pattern":{name:"tlbr",type:12,isOptional:!0}};u=function(h){function g(f,r){f=h.call(this,f)||this;f.usefillColor=r;return f}x._inheritsLoose(g,h);var e=g.prototype;e.geometryInfo=function(){return g.GEOMETRY_LAYOUT};
e.opacityInfo=function(){return null};e.attributes=function(){return this.usefillColor?g.ATTRIBUTES_FILL:g.ATTRIBUTES_OUTLINE};e.attributesInfo=function(){return this.usefillColor?g.ATTRIBUTES_INFO_FILL:g.ATTRIBUTES_INFO_OUTLINE};return g}(u.VTLMaterial);u.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"];u.ATTRIBUTES_FILL=["fill-color","fill-opacity"];u.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,
normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}];u.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100}};u.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100}};k.VTLFillMaterial=a;k.VTLOutlineMaterial=u;Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLLineMaterial":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],function(k,x,u){u=function(a){function h(e){return a.call(this,e)||this}x._inheritsLoose(h,a);var g=h.prototype;g.geometryInfo=function(){return h.GEOMETRY_LAYOUT};g.opacityInfo=function(){return null};g.attributes=function(){return h.ATTRIBUTES};g.attributesInfo=function(){return h.ATTRIBUTES_INFO};return h}(u.VTLMaterial);u.ATTRIBUTES="line-blur line-color line-gap-width line-offset line-opacity line-width line-pattern line-dasharray".split(" ");
u.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_extrude_offset",count:4,type:5120,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_dir_normal",count:4,type:5120,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:12,stride:16,normalized:!1,divisor:0}];u.ATTRIBUTES_INFO={"line-width":{name:"width",type:1,precisionFactor:2},"line-gap-width":{name:"gap_width",type:1,precisionFactor:2},"line-offset":{name:"offset",
type:0,precisionFactor:2},"line-color":{name:"color",type:10},"line-opacity":{name:"opacity",type:1,precisionFactor:100},"line-blur":{name:"blur",type:1,precisionFactor:4},"line-pattern":{name:"tlbr",type:12,isOptional:!0},"line-dasharray":{name:"tlbr",type:11,isOptional:!0}};k.VTLLineMaterial=u;Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/VTLSymbolMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial"],
function(k,x,u){const a=[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_texAngleRange",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}],h=[{name:"a_opacityInfo",count:1,type:5121,offset:0,stride:1,normalized:!1,divisor:0}];let g=function(e){function f(c){return e.call(this,c)||this}
x._inheritsLoose(f,e);var r=f.prototype;r.geometryInfo=function(){return a};r.opacityInfo=function(){return h};r.attributes=function(){return f.ATTRIBUTES};r.attributesInfo=function(){return f.ATTRIBUTES_INFO};return f}(u.VTLMaterial);g.ATTRIBUTES="icon-color icon-opacity icon-halo-blur icon-halo-color icon-halo-width icon-size".split(" ");g.ATTRIBUTES_INFO={"icon-color":{name:"color",type:10},"icon-opacity":{name:"opacity",type:1,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:10},
"icon-halo-width":{name:"halo_width",type:1,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:1,precisionFactor:4},"icon-size":{name:"size",type:1,precisionFactor:32,isLayout:!0}};u=function(e){function f(c){return e.call(this,c)||this}x._inheritsLoose(f,e);var r=f.prototype;r.geometryInfo=function(){return a};r.opacityInfo=function(){return h};r.attributes=function(){return f.ATTRIBUTES};r.attributesInfo=function(){return f.ATTRIBUTES_INFO};return f}(u.VTLMaterial);u.ATTRIBUTES="text-color text-opacity text-halo-blur text-halo-color text-halo-width text-size".split(" ");
u.ATTRIBUTES_INFO={"text-color":{name:"color",type:10},"text-opacity":{name:"opacity",type:1,precisionFactor:100},"text-halo-color":{name:"halo_color",type:10},"text-halo-width":{name:"halo_width",type:1,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:1,precisionFactor:4},"text-size":{name:"size",type:1,isLayout:!0}};k.VTLIconMaterial=g;k.VTLTextMaterial=u;Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/Filter":function(){define(["../expression/expression",
"../expression/types"],function(k,x){return function(){function u(a){this._expression=a}u.prototype.filter=function(a,h){if(!this._expression)return!0;try{return this._expression.evaluate(a,h)}catch(g){return console.log(g.message),!0}};u.createFilter=function(a){if(!a)return null;this.isLegacyFilter(a)&&(a=this.convertLegacyFilter(a));try{const h=k.createExpression(a,null,x.BooleanType);return new u(h)}catch(h){return console.log(h.message),null}};u.isLegacyFilter=function(a){if(!Array.isArray(a)||
0===a.length)return!0;switch(a[0]){case "\x3d\x3d":case "!\x3d":case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return 3===a.length&&"string"===typeof a[1]&&!Array.isArray(a[2]);case "in":return 3<=a.length&&"string"===typeof a[1]&&!Array.isArray(a[2]);case "!in":return!0;case "any":case "all":for(let h=1;h<a.length;h++)if(!this.isLegacyFilter(a[1]))return!1;return!0;case "none":return!0;case "has":return 2===a.length&&("$id"===a[1]||"$type"===a[1]);case "!has":return!0;default:return!1}};
u.convertLegacyFilter=function(a){if(!Array.isArray(a)||0===a.length)return!0;const h=a[0];if(1===a.length)return"any"!==h;switch(h){case "\x3d\x3d":return u.convertComparison("\x3d\x3d",a[1],a[2]);case "!\x3d":return u.negate(u.convertComparison("\x3d\x3d",a[1],a[2]));case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return u.convertComparison(h,a[1],a[2]);case "in":return u.convertIn(a[1],a.slice(2));case "!in":return u.negate(u.convertIn(a[1],a.slice(2)));case "any":case "all":case "none":return u.convertCombining(h,
a.slice(1));case "has":return u.convertHas(a[1]);case "!has":return u.negate(u.convertHas(a[1]));default:throw Error("Unexpected legacy filter.");}};u.convertComparison=function(a,h,g){switch(h){case "$type":return[a,["geometry-type"],g];case "$id":return[a,["id"],g];default:return[a,["get",h],g]}};u.convertIn=function(a,h){switch(a){case "$type":return["in",["geometry-type"],["literal",h]];case "$id":return["in",["id"],["literal",h]];default:return["in",["get",a],["literal",h]]}};u.convertHas=function(a){switch(a){case "$type":return!0;
case "$id":return["has-id"];default:return["has",a]}};u.convertCombining=function(a,h){return[a].concat(h.map(this.convertLegacyFilter))};u.negate=function(a){return["!",a]};return u}()})},"esri/views/2d/engine/vectorTiles/expression/expression":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../Color ../../../../../core/colorUtils ../../../unitBezier ../GeometryUtils ./types".split(" "),function(k,x,u,a,h,g,e){function f(m,b,d){var t=typeof m;if("string"===
t||"boolean"===t||"number"===t||null===m){if(d)switch(d.kind){case "string":"string"!==t&&(m=fa.toString(m));break;case "number":"number"!==t&&(m=fa.toNumber(m));break;case "color":m=fa.toColor(m)}m=["literal",m]}if(!Array.isArray(m)||0===m.length)throw Error("Expression must be a non empty array");t=m[0];if("string"!==typeof t)throw Error("First element of expression must be a string");const y=oa[t];if(void 0===y)throw Error(`Invalid expression operator "${t}"`);if(!y)throw Error(`Unimplemented expression operator "${t}"`);
return y.parse(m,b,d)}let r=function(){function m(d){this.parent=d;this.vars={}}var b=m.prototype;b.add=function(d,t){this.vars[d]=t};b.get=function(d){return this.vars[d]?this.vars[d]:this.parent?this.parent.get(d):null};return m}(),c=function(){function m(){this.type=e.ValueType}m.parse=function(b){if(1<b.length)throw Error('"id" does not expect arguments');return new m};m.prototype.evaluate=function(b,d){return null==b?void 0:b.id};return m}(),n=function(){function m(){this.type=e.StringType}m.parse=
function(b){if(1<b.length)throw Error('"geometry-type" does not expect arguments');return new m};m.prototype.evaluate=function(b,d){if(!b)return null;switch(b.type){case 1:return"Point";case 2:return"LineString";case 3:return"Polygon";default:return null}};return m}(),z=function(){function m(){this.type=e.ObjectType}m.parse=function(b){if(1<b.length)throw Error('"properties" does not expect arguments');return new m};m.prototype.evaluate=function(b,d){return null==b?void 0:b.values};return m}(),G=
function(){function m(){this.type=e.NumberType}m.parse=function(b){if(1<b.length)throw Error('"zoom" does not expect arguments');return new m};m.prototype.evaluate=function(b,d){return d};return m}(),l=function(){function m(b,d,t){this.lhs=b;this.rhs=d;this.compare=t;this.type=e.BooleanType}m.parse=function(b,d,t){if(3!==b.length&&4!==b.length)throw Error(`"${b[0]}" expects 2 or 3 arguments`);if(4===b.length)throw Error(`"${b[0]}" collator not supported`);return new m(f(b[1],d),f(b[2],d),t)};m.prototype.evaluate=
function(b,d){return this.compare(this.lhs.evaluate(b,d),this.rhs.evaluate(b,d))};return m}(),p=function(m){function b(){return m.apply(this,arguments)||this}x._inheritsLoose(b,m);b.parse=function(d,t){return l.parse(d,t,(y,J)=>y===J)};return b}(l),v=function(m){function b(){return m.apply(this,arguments)||this}x._inheritsLoose(b,m);b.parse=function(d,t){return l.parse(d,t,(y,J)=>y!==J)};return b}(l),M=function(m){function b(){return m.apply(this,arguments)||this}x._inheritsLoose(b,m);b.parse=function(d,
t){return l.parse(d,t,(y,J)=>y<J)};return b}(l),E=function(m){function b(){return m.apply(this,arguments)||this}x._inheritsLoose(b,m);b.parse=function(d,t){return l.parse(d,t,(y,J)=>y<=J)};return b}(l),I=function(m){function b(){return m.apply(this,arguments)||this}x._inheritsLoose(b,m);b.parse=function(d,t){return l.parse(d,t,(y,J)=>y>J)};return b}(l),C=function(m){function b(){return m.apply(this,arguments)||this}x._inheritsLoose(b,m);b.parse=function(d,t){return l.parse(d,t,(y,J)=>y>=J)};return b}(l),
B=function(){function m(b){this.arg=b;this.type=e.BooleanType}m.parse=function(b,d){if(2!==b.length)throw Error('"!" expects 1 argument');return new m(f(b[1],d))};m.prototype.evaluate=function(b,d){return!this.arg.evaluate(b,d)};return m}(),w=function(){function m(b){this.args=b;this.type=e.BooleanType}m.parse=function(b,d){const t=[];for(let y=1;y<b.length;y++)t.push(f(b[y],d));return new m(t)};m.prototype.evaluate=function(b,d){for(const t of this.args)if(!t.evaluate(b,d))return!1;return!0};return m}(),
q=function(){function m(b){this.args=b;this.type=e.BooleanType}m.parse=function(b,d){const t=[];for(let y=1;y<b.length;y++)t.push(f(b[y],d));return new m(t)};m.prototype.evaluate=function(b,d){for(const t of this.args)if(t.evaluate(b,d))return!0;return!1};return m}(),D=function(){function m(b){this.args=b;this.type=e.BooleanType}m.parse=function(b,d){const t=[];for(let y=1;y<b.length;y++)t.push(f(b[y],d));return new m(t)};m.prototype.evaluate=function(b,d){for(const t of this.args)if(t.evaluate(b,
d))return!1;return!0};return m}(),F=function(){function m(b,d,t){this.type=b;this.args=d;this.fallback=t}m.parse=function(b,d,t){if(4>b.length)throw Error('"case" expects at least 3 arguments');if(1===b.length%2)throw Error('"case" expects an odd number of arguments');let y;const J=[];for(let P=1;P<b.length-1;P+=2){const V=f(b[P],d),S=f(b[P+1],d,t);y||(y=S.type);J.push({condition:V,output:S})}b=f(b[b.length-1],d,t);y||(y=b.type);return new m(y,J,b)};m.prototype.evaluate=function(b,d){for(const t of this.args)if(t.condition.evaluate(b,
d))return t.output.evaluate(b,d);return this.fallback.evaluate(b,d)};return m}(),A=function(){function m(b,d){this.type=b;this.args=d}m.parse=function(b,d){if(2>b.length)throw Error('"coalesce" expects at least 1 argument');let t;const y=[];for(let J=1;J<b.length;J++){const P=f(b[J],d);t||(t=P.type);y.push(P)}return new m(t,y)};m.prototype.evaluate=function(b,d){for(const t of this.args){const y=t.evaluate(b,d);if(null!==y)return y}return null};return m}(),K=function(){function m(b,d,t,y,J){this.type=
b;this.input=d;this.labels=t;this.outputs=y;this.fallback=J}m.parse=function(b,d){if(3>b.length)throw Error('"match" expects at least 3 arguments');if(0===b.length%2)throw Error('"case" expects an even number of arguments');let t;const y=f(b[1],d),J=[],P={};let V;for(let ba=2;ba<b.length-1;ba+=2){var S=b[ba];Array.isArray(S)||(S=[S]);for(const ha of S){S=typeof ha;if("string"!==S&&"number"!==S)throw Error('"match" requires string or number literal as labels');if(!V)V=S;else if(S!==V)throw Error('"match" requires labels to have the same type');
P[ha]=J.length}S=f(b[ba+1],d);t||(t=S.type);J.push(S)}return new m(t,y,P,J,f(b[b.length-1],d))};m.prototype.evaluate=function(b,d){const t=this.input.evaluate(b,d);return(this.outputs[this.labels[t]]||this.fallback).evaluate(b,d)};return m}(),N=function(){function m(d,t,y,J,P){this.operator=d;this.type=t;this.interpolation=y;this.input=J;this.stops=P}m.parse=function(d,t,y){const J=d[0];if(5>d.length)throw Error(`"${J}" expects at least 4 arguments`);const P=d[1];if(!Array.isArray(P)||0===P.length)throw Error(`"${P}" is not a valid interpolation`);
switch(P[0]){case "linear":if(1!==P.length)throw Error("Linear interpolation cannot have parameters");break;case "exponential":if(2!==P.length||"number"!==typeof P[1])throw Error("Exponential interpolation requires one numeric argument");break;case "cubic-bezier":if(5!==P.length)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(var V=1;5>V;V++){var S=P[V];if("number"!==typeof S||0>S||1<S)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");
}break;default:throw Error(`"${d[0]}" unknown interpolation type "${P[0]}"`);}if(1!==d.length%2)throw Error(`"${J}" expects an even number of arguments`);V=f(d[2],t,e.NumberType);let ba;"interpolate-hcl"===J||"interpolate-lab"===J?ba=e.ColorType:y&&"value"!==y.kind&&(ba=y);y=[];for(S=3;S<d.length;S+=2){const ha=d[S];if("number"!==typeof ha)throw Error(`"${J}" requires stop inputs as literal numbers`);if(y.length&&y[y.length-1][0]>=ha)throw Error(`"${J}" requires strictly ascending stop inputs`);const pa=
f(d[S+1],t,ba);ba||(ba=pa.type);y.push([ha,pa])}if(ba&&ba!==e.ColorType&&ba!==e.NumberType&&("array"!==ba.kind||ba.itemType!==e.NumberType))throw Error(`"${J}" cannot interpolate type ${e.typeToString(ba)}`);return new m(J,ba,P,V,y)};var b=m.prototype;b.evaluate=function(d,t){var y=this.stops;if(1===y.length)return y[0][1].evaluate(d,t);var J=this.input.evaluate(d,t);if(J<=y[0][0])return y[0][1].evaluate(d,t);if(J>=y[y.length-1][0])return y[y.length-1][1].evaluate(d,t);let P=0;for(;++P<y.length&&
!(J<y[P][0]););const V=m.interpolationRatio(this.interpolation,J,y[P-1][0],y[P][0]);J=y[P-1][1].evaluate(d,t);const S=y[P][1].evaluate(d,t);if("interpolate"===this.operator){if("array"===this.type.kind&&Array.isArray(J)&&Array.isArray(S))return J.map((ba,ha)=>g.interpolate(ba,S[ha],V));if("color"===this.type.kind&&J instanceof u&&S instanceof u)return J=new u(J),d=new u(S),new u([g.interpolate(J.r,d.r,V),g.interpolate(J.g,d.g,V),g.interpolate(J.b,d.b,V),g.interpolate(J.a,d.a,V)]);if("number"===this.type.kind&&
"number"===typeof J&&"number"===typeof S)return g.interpolate(J,S,V);throw Error(`"${this.operator}" cannot interpolate type ${e.typeToString(this.type)}`);}if("interpolate-hcl"===this.operator)return d=a.toLCH(J),t=a.toLCH(S),y=t.h-d.h,d=a.toRGB({h:d.h+V*(180<y||-180>y?y-360*Math.round(y/360):y),c:g.interpolate(d.c,t.c,V),l:g.interpolate(d.l,t.l,V)}),new u({a:g.interpolate(J.a,S.a,V),...d});if("interpolate-lab"===this.operator)return d=a.toLAB(J),t=a.toLAB(S),d=a.toRGB({l:g.interpolate(d.l,t.l,V),
a:g.interpolate(d.a,t.a,V),b:g.interpolate(d.b,t.b,V)}),new u({a:g.interpolate(J.a,S.a,V),...d});throw Error(`Unexpected operator "${this.operator}"`);};b.interpolationUniformValue=function(d,t){const y=this.stops;if(1===y.length||d>=y[y.length-1][0])return 0;let J=0;for(;++J<y.length&&!(d<y[J][0]););return m.interpolationRatio(this.interpolation,t,y[J-1][0],y[J][0])};b.getInterpolationRange=function(d){const t=this.stops;if(1===t.length)return d=t[0][0],[d,d];var y=t[t.length-1][0];if(d>=y)return[y,
y];for(y=0;++y<t.length&&!(d<t[y][0]););return[t[y-1][0],t[y][0]]};m.interpolationRatio=function(d,t,y,J){let P=0;"linear"===d[0]?P=m.exponentialInterpolationRatio(t,1,y,J):"exponential"===d[0]?P=m.exponentialInterpolationRatio(t,d[1],y,J):"cubic-bezier"===d[0]&&(P=h.unitBezier(d[1],d[2],d[3],d[4])(m.exponentialInterpolationRatio(t,1,y,J),1E-5));0>P?P=0:1<P&&(P=1);return P};m.exponentialInterpolationRatio=function(d,t,y,J){J-=y;if(0===J)return 0;d-=y;return 1===t?d/J:(t**d-1)/(t**J-1)};return m}(),
L=function(){function m(b,d,t){this.type=b;this.input=d;this.stops=t}m.parse=function(b,d){if(5>b.length)throw Error('"step" expects at least 4 arguments');if(1!==b.length%2)throw Error('"step" expects an even number of arguments');const t=f(b[1],d,e.NumberType);let y;const J=[];J.push([-Infinity,f(b[2],d)]);for(let P=3;P<b.length;P+=2){const V=b[P];if("number"!==typeof V)throw Error('"step" requires stop inputs as literal numbers');if(J.length&&J[J.length-1][0]>=V)throw Error('"step" requires strictly ascending stop inputs');
const S=f(b[P+1],d);y||(y=S.type);J.push([V,S])}return new m(y,t,J)};m.prototype.evaluate=function(b,d){const t=this.stops;if(1===t.length)return t[0][1].evaluate(b,d);const y=this.input.evaluate(b,d);let J=0;for(;++J<t.length&&!(y<t[J][0]););return this.stops[J-1][1].evaluate(b,d)};return m}(),Q=function(){function m(b,d){this.type=b;this.output=d}m.parse=function(b,d,t){if(4>b.length)throw Error('"let" expects at least 3 arguments');if(1===b.length%2)throw Error('"let" expects an odd number of arguments');
const y=new r(d);for(let J=1;J<b.length-1;J+=2){const P=b[J];if("string"!==typeof P)throw Error(`"let" requires a string to define variable names - found ${P}`);y.add(P,f(b[J+1],d))}b=f(b[b.length-1],y,t);return new m(b.type,b)};m.prototype.evaluate=function(b,d){return this.output.evaluate(b,d)};return m}(),R=function(){function m(b,d){this.type=b;this.output=d}m.parse=function(b,d,t){if(2!==b.length||"string"!==typeof b[1])throw Error('"var" requires just one literal string argument');d=d.get(b[1]);
if(!d)throw Error(`${b[1]} must be defined before being used in a "var" expression`);return new m(t||e.ValueType,d)};m.prototype.evaluate=function(b,d){return this.output.evaluate(b,d)};return m}(),W=function(){function m(b,d,t){this.type=b;this.index=d;this.array=t}m.parse=function(b,d){if(3!==b.length)throw Error('"at" expects 2 arguments');const t=f(b[1],d,e.NumberType);b=f(b[2],d);return new m(b.type.itemType,t,b)};m.prototype.evaluate=function(b,d){const t=this.index.evaluate(b,d);b=this.array.evaluate(b,
d);if(0>t||t>=b.length)throw Error('"at" index out of bounds');if(t!==Math.floor(t))throw Error('"at" index must be an integer');return b[t]};return m}(),U=function(){function m(b,d){this.key=b;this.obj=d;this.type=e.ValueType}m.parse=function(b,d){let t;switch(b.length){case 2:return t=f(b[1],d),new m(t);case 3:return t=f(b[1],d),b=f(b[2],d),new m(t,b);default:throw Error('"get" expects 1 or 2 arguments');}};m.prototype.evaluate=function(b,d){const t=this.key.evaluate(b,d);return this.obj?this.obj.evaluate(b,
d)[t]:null==b?void 0:b.values[t]};return m}(),Y=function(){function m(b,d){this.key=b;this.obj=d;this.type=e.BooleanType}m.parse=function(b,d){let t;switch(b.length){case 2:return t=f(b[1],d),new m(t);case 3:return t=f(b[1],d),b=f(b[2],d),new m(t,b);default:throw Error('"has" expects 1 or 2 arguments');}};m.prototype.evaluate=function(b,d){const t=this.key.evaluate(b,d);return this.obj?(b=this.obj.evaluate(b,d),t in b):!(null==b||!b.values[t])};return m}(),ca=function(){function m(b,d){this.key=b;
this.vals=d;this.type=e.BooleanType}m.parse=function(b,d){if(3!==b.length)throw Error('"in" expects 2 arguments');return new m(f(b[1],d),f(b[2],d))};m.prototype.evaluate=function(b,d){const t=this.key.evaluate(b,d);return-1!==this.vals.evaluate(b,d).indexOf(t)};return m}(),da=function(){function m(b,d,t){this.item=b;this.array=d;this.from=t;this.type=e.NumberType}m.parse=function(b,d){if(3>b.length||4<b.length)throw Error('"index-of" expects 3 or 4 arguments');const t=f(b[1],d),y=f(b[2],d);return 4===
b.length?(b=f(b[3],d,e.NumberType),new m(t,y,b)):new m(t,y)};m.prototype.evaluate=function(b,d){const t=this.item.evaluate(b,d),y=this.array.evaluate(b,d);if(this.from){b=this.from.evaluate(b,d);if(b!==Math.floor(b))throw Error('"index-of" index must be an integer');return y.indexOf(t,b)}return y.indexOf(t)};return m}(),ea=function(){function m(b){this.arg=b;this.type=e.NumberType}m.parse=function(b,d){if(2!==b.length)throw Error('"length" expects 2 arguments');b=f(b[1],d);return new m(b)};m.prototype.evaluate=
function(b,d){b=this.arg.evaluate(b,d);if("string"===typeof b||Array.isArray(b))return b.length;throw Error('"length" expects string or array');};return m}(),ia=function(){function m(b,d,t,y){this.type=b;this.array=d;this.from=t;this.to=y}m.parse=function(b,d){if(3>b.length||4<b.length)throw Error('"slice" expects 2 or 3 arguments');const t=f(b[1],d),y=f(b[2],d,e.NumberType);if(y.type!==e.NumberType)throw Error('"slice" index must return a number');if(4===b.length){b=f(b[3],d,e.NumberType);if(b.type!==
e.NumberType)throw Error('"slice" index must return a number');return new m(t.type,t,y,b)}return new m(t.type,t,y)};m.prototype.evaluate=function(b,d){const t=this.array.evaluate(b,d);if(!Array.isArray(t)&&"string"!==typeof t)throw Error('"slice" input must be an array or a string');const y=this.from.evaluate(b,d);if(0>y||y>=t.length)throw Error('"slice" index out of bounds');if(y!==Math.floor(y))throw Error('"slice" index must be an integer');if(this.to){b=this.to.evaluate(b,d);if(0>b||b>=t.length)throw Error('"slice" index out of bounds');
if(b!==Math.floor(b))throw Error('"slice" index must be an integer');return t.slice(y,b)}return t.slice(y)};return m}(),X=function(){function m(){this.type=e.BooleanType}m.parse=function(b){if(1!==b.length)throw Error('"has-id" expects no arguments');return new m};m.prototype.evaluate=function(b,d){return b&&void 0!==b.id};return m}(),H=function(){function m(b,d){this.args=b;this.calculate=d;this.type=e.NumberType}m.parse=function(b,d,t){b=b.slice(1).map(y=>f(y,d));return new m(b,t)};m.prototype.evaluate=
function(b,d){let t;this.args&&(t=this.args.map(y=>y.evaluate(b,d)));return this.calculate(t)};return m}(),O=function(m){function b(){return m.apply(this,arguments)||this}x._inheritsLoose(b,m);b.parse=function(d,t){switch(d.length){case 2:return H.parse(d,t,y=>-y[0]);case 3:return H.parse(d,t,y=>y[0]-y[1]);default:throw Error('"-" expects 1 or 2 arguments');}};return b}(H),T=function(m){function b(){return m.apply(this,arguments)||this}x._inheritsLoose(b,m);b.parse=function(d,t){return H.parse(d,
t,y=>{let J=1;for(const P of y)J*=P;return J})};return b}(H),aa=function(m){function b(){return m.apply(this,arguments)||this}x._inheritsLoose(b,m);b.parse=function(d,t){if(3===d.length)return H.parse(d,t,y=>y[0]/y[1]);throw Error('"/" expects 2 arguments');};return b}(H),ja=function(m){function b(){return m.apply(this,arguments)||this}x._inheritsLoose(b,m);b.parse=function(d,t){if(3===d.length)return H.parse(d,t,y=>y[0]%y[1]);throw Error('"%" expects 2 arguments');};return b}(H),la=function(m){function b(){return m.apply(this,
arguments)||this}x._inheritsLoose(b,m);b.parse=function(d,t){if(3===d.length)return H.parse(d,t,y=>y[0]**y[1]);throw Error('"^" expects 1 or 2 arguments');};return b}(H),ma=function(m){function b(){return m.apply(this,arguments)||this}x._inheritsLoose(b,m);b.parse=function(d,t){return H.parse(d,t,y=>{let J=0;for(const P of y)J+=P;return J})};return b}(H),Z=function(){function m(b,d){this.args=b;this.calculate=d;this.type=e.NumberType}m.parse=function(b,d){const t=b.slice(1).map(y=>f(y,d));return new m(t,
m.ops[b[0]])};m.prototype.evaluate=function(b,d){let t;this.args&&(t=this.args.map(y=>y.evaluate(b,d)));return this.calculate(t)};return m}();Z.ops={abs:m=>Math.abs(m[0]),acos:m=>Math.acos(m[0]),asin:m=>Math.asin(m[0]),atan:m=>Math.atan(m[0]),ceil:m=>Math.ceil(m[0]),cos:m=>Math.cos(m[0]),e:()=>Math.E,floor:m=>Math.floor(m[0]),ln:m=>Math.log(m[0]),ln2:()=>Math.LN2,log10:m=>Math.log(m[0])/Math.LN10,log2:m=>Math.log(m[0])/Math.LN2,max:m=>Math.max(...m),min:m=>Math.min(...m),pi:()=>Math.PI,round:m=>Math.round(m[0]),
sin:m=>Math.sin(m[0]),sqrt:m=>Math.sqrt(m[0]),tan:m=>Math.tan(m[0])};let qa=function(){function m(b){this.args=b;this.type=e.StringType}m.parse=function(b,d){return new m(b.slice(1).map(t=>f(t,d)))};m.prototype.evaluate=function(b,d){return this.args.map(t=>t.evaluate(b,d)).join("")};return m}(),na=function(){function m(b,d){this.arg=b;this.calculate=d;this.type=e.StringType}m.parse=function(b,d){if(2!==b.length)throw Error(`${b[0]} expects 1 argument`);d=f(b[1],d);return new m(d,m.ops[b[0]])};m.prototype.evaluate=
function(b,d){return this.calculate(this.arg.evaluate(b,d))};return m}();na.ops={downcase:m=>m.toLowerCase(),upcase:m=>m.toUpperCase()};let ra=function(){function m(d){this.args=d;this.type=e.ColorType}m.parse=function(d,t){if(4!==d.length)throw Error('"rgb" expects 3 arguments');d=d.slice(1).map(y=>f(y,t));return new m(d)};var b=m.prototype;b.evaluate=function(d,t){const y=this._validate(this.args[0].evaluate(d,t)),J=this._validate(this.args[1].evaluate(d,t));d=this._validate(this.args[2].evaluate(d,
t));return new u({r:y,g:J,b:d})};b._validate=function(d){if("number"!==typeof d||0>d||255<d)throw Error(`${d}: invalid color component`);return Math.round(d)};return m}(),sa=function(){function m(d){this.args=d;this.type=e.ColorType}m.parse=function(d,t){if(5!==d.length)throw Error('"rgba" expects 4 arguments');d=d.slice(1).map(y=>f(y,t));return new m(d)};var b=m.prototype;b.evaluate=function(d,t){const y=this._validate(this.args[0].evaluate(d,t)),J=this._validate(this.args[1].evaluate(d,t)),P=this._validate(this.args[2].evaluate(d,
t));d=this._validateAlpha(this.args[3].evaluate(d,t));return new u({r:y,g:J,b:P,a:d})};b._validate=function(d){if("number"!==typeof d||0>d||255<d)throw Error(`${d}: invalid color component`);return Math.round(d)};b._validateAlpha=function(d){if("number"!==typeof d||0>d||1<d)throw Error(`${d}: invalid alpha color component`);return d};return m}(),ta=function(){function m(b){this.color=b;this.type=e.arrayType(e.NumberType,4)}m.parse=function(b,d){if(2!==b.length)throw Error('"to-rgba" expects 1 argument');
b=f(b[1],d);return new m(b)};m.prototype.evaluate=function(b,d){return(new u(this.color.evaluate(b,d))).toRgba()};return m}(),ka=function(){function m(b,d){this.type=b;this.args=d}m.parse=function(b,d){var t=b[0];if(2>b.length)throw Error(`${t} expects at least one argument`);let y=1,J;if("array"===t){if(2<b.length){switch(b[1]){case "string":J=e.StringType;break;case "number":J=e.NumberType;break;case "boolean":J=e.BooleanType;break;default:throw Error('"array" type argument must be string, number or boolean');
}y++}else J=e.ValueType;if(3<b.length){var P=b[2];if(null!==P&&("number"!==typeof P||0>P||P!==Math.floor(P)))throw Error('"array" length argument must be a positive integer literal');y++}J=e.arrayType(J,P)}else switch(t){case "string":J=e.StringType;break;case "number":J=e.NumberType;break;case "boolean":J=e.BooleanType;break;case "object":J=e.ObjectType}for(t=[];y<b.length;y++)P=f(b[y],d),t.push(P);return new m(J,t)};m.prototype.evaluate=function(b,d){let t;for(const y of this.args){const J=y.evaluate(b,
d);t=e.getType(J);if(e.matchType(t,this.type))return J}throw Error(`Expected ${e.typeToString(this.type)} but got ${e.typeToString(t)}`);};return m}(),fa=function(){function m(b,d){this.type=b;this.args=d}m.parse=function(b,d){var t=b[0];const y=m.types[t];if(y===e.BooleanType||y===e.StringType){if(2!==b.length)throw Error(`${t} expects one argument`);}else if(2>b.length)throw Error(`${t} expects at least one argument`);t=[];for(let J=1;J<b.length;J++){const P=f(b[J],d);t.push(P)}return new m(y,t)};
m.prototype.evaluate=function(b,d){if(this.type===e.BooleanType)return!!this.args[0].evaluate(b,d);if(this.type===e.StringType)return e.valueToString(this.args[0].evaluate(b,d));if(this.type===e.NumberType){for(const y of this.args){var t=Number(y.evaluate(b,d));if(!isNaN(t))return t}return null}if(this.type===e.ColorType){for(t of this.args)try{const y=m.toColor(t.evaluate(b,d));if(y instanceof u)return y}catch{}return null}};m.toBoolean=function(b){return!!b};m.toString=function(b){return e.valueToString(b)};
m.toNumber=function(b){const d=Number(b);if(isNaN(d))throw Error(`"${b}" is not a number`);return d};m.toColor=function(b){if(b instanceof u)return b;if("string"===typeof b){const d=u.fromString(b);if(d)return d;throw Error(`"${b}" is not a color`);}if(Array.isArray(b))return u.fromArray(b);throw Error(`"${b}" is not a color`);};return m}();fa.types={"to-boolean":e.BooleanType,"to-color":e.ColorType,"to-number":e.NumberType,"to-string":e.StringType};let ua=function(){function m(b){this.val=b;this.type=
e.getType(b)}m.parse=function(b){if(2!==b.length)throw Error('"literal" expects 1 argument');return new m(b[1])};m.prototype.evaluate=function(b,d){return this.val};return m}(),va=function(){function m(b){this.arg=b;this.type=e.StringType}m.parse=function(b,d){if(2!==b.length)throw Error('"typeof" expects 1 argument');return new m(f(b[1],d))};m.prototype.evaluate=function(b,d){return e.typeToString(e.getType(this.arg.evaluate(b,d)))};return m}();const oa={array:ka,"boolean":ka,collator:null,format:null,
image:null,literal:ua,number:ka,"number-format":null,object:ka,string:ka,"to-boolean":fa,"to-color":fa,"to-number":fa,"to-string":fa,"typeof":va,accumulated:null,"feature-state":null,"geometry-type":n,id:c,"line-progress":null,properties:z,at:W,get:U,has:Y,"in":ca,"index-of":da,length:ea,slice:ia,"!":B,"!\x3d":v,"\x3c":M,"\x3c\x3d":E,"\x3d\x3d":p,"\x3e":I,"\x3e\x3d":C,all:w,any:q,"case":F,coalesce:A,match:K,within:null,interpolate:N,"interpolate-hcl":N,"interpolate-lab":N,step:L,let:Q,"var":R,concat:qa,
downcase:na,"is-supported-script":null,"resolved-locale":null,upcase:na,rgb:ra,rgba:sa,"to-rgba":ta,"-":O,"*":T,"/":aa,"%":ja,"^":la,"+":ma,abs:Z,acos:Z,asin:Z,atan:Z,ceil:Z,cos:Z,e:Z,floor:Z,ln:Z,ln2:Z,log10:Z,log2:Z,max:Z,min:Z,pi:Z,round:Z,sin:Z,sqrt:Z,tan:Z,zoom:G,"heatmap-density":null,"has-id":X,none:D};k.ALL=w;k.ANY=q;k.Add=ma;k.Assert=ka;k.At=W;k.Calculate=Z;k.Case=F;k.Coalesce=A;k.Coerce=fa;k.Concat=qa;k.Div=aa;k.EQ=p;k.GE=C;k.GT=I;k.GeomType=n;k.Get=U;k.Has=Y;k.HasID=X;k.ID=c;k.In=ca;k.IndexOf=
da;k.Interpolate=N;k.LE=E;k.LT=M;k.Length=ea;k.Let=Q;k.Literal=ua;k.Match=K;k.Mod=ja;k.Mul=T;k.NE=v;k.NONE=D;k.NOT=B;k.Pow=la;k.Properties=z;k.Rgb=ra;k.Rgba=sa;k.Slice=ia;k.Step=L;k.String=na;k.Sub=O;k.ToRgba=ta;k.TypeOf=va;k.Var=R;k.Zoom=G;k.createExpression=f;k.ops=oa;Object.defineProperty(k,"__esModule",{value:!0})})},"esri/core/colorUtils":function(){define(["exports"],function(k){function x(c,n){const z=[];let G,l;if(c[0].length!==n.length)throw"dimensions do not match";const p=c.length,v=c[0].length;
let M=0;for(G=0;G<p;G++){for(l=M=0;l<v;l++)M+=c[G][l]*n[l];z.push(M)}return z}function u(c){c=[c.r/255,c.g/255,c.b/255].map(n=>.04045>=n?n/12.92:((n+.055)/1.055)**2.4);c=x(f,c);return{x:100*c[0],y:100*c[1],z:100*c[2]}}function a(c){c=x(r,[c.x/100,c.y/100,c.z/100]).map(n=>Math.min(1,Math.max(.0031308>=n?12.92*n:1.055*n**(1/2.4)-.055,0)));return{r:Math.round(255*c[0]),g:Math.round(255*c[1]),b:Math.round(255*c[2])}}function h(c){c=[c.x/95.047,c.y/100,c.z/108.883].map(n=>n>(6/29)**3?n**(1/3):1/3*(29/
6)**2*n+4/29);return{l:116*c[1]-16,a:500*(c[0]-c[1]),b:200*(c[1]-c[2])}}function g(c){const n=c.l;c=[(n+16)/116+c.a/500,(n+16)/116,(n+16)/116-c.b/200].map(z=>z>6/29?z**3:3*(6/29)**2*(z-4/29));return{x:95.047*c[0],y:100*c[1],z:108.883*c[2]}}function e(c){if("r"in c&&"g"in c&&"b"in c)return c;if("l"in c&&"c"in c&&"h"in c){var n=c.c;var z=c.h;n={l:c.l,a:n*Math.cos(z),b:n*Math.sin(z)};return a(g(n))}if("l"in c&&"a"in c&&"b"in c)return a(g(c));if("x"in c&&"y"in c&&"z"in c)return a(c);if("h"in c&&"s"in
c&&"v"in c){{z=(c.h+360)%360/60;n=c.v/100*255;c=c.s/100*n;const G=c*(1-Math.abs(z%2-1));switch(Math.floor(z)){case 0:z={r:c,g:G,b:0};break;case 1:z={r:G,g:c,b:0};break;case 2:z={r:0,g:c,b:G};break;case 3:z={r:0,g:G,b:c};break;case 4:z={r:G,g:0,b:c};break;case 5:case 6:z={r:c,g:0,b:G};break;default:z={r:0,g:0,b:0}}z.r=Math.round(z.r+n-c);z.g=Math.round(z.g+n-c);z.b=Math.round(z.b+n-c);n=z}return n}return c}const f=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],r=[[3.2406,-1.5372,-.4986],
[-.9689,1.8758,.0415],[.0557,-.204,1.057]];k.darken=function(c,n){c=h(u(c));c.l*=1-n;return a(g(c))};k.toHSV=function(c){if("h"in c&&"s"in c&&"v"in c)return c;var n=e(c);{c=n.r;const z=n.g,G=n.b;n=Math.max(c,z,G);const l=n-Math.min(c,z,G);c=0===l?0:n===c?(z-G)/l%6:n===z?(G-c)/l+2:(c-z)/l+4;0>c&&(c+=6);c={h:60*c,s:100*(0===l?0:l/n),v:100/255*n}}return c};k.toLAB=function(c){return"l"in c&&"a"in c&&"b"in c?c:h(u(e(c)))};k.toLCH=function(c){if(!("l"in c&&"c"in c&&"h"in c)){{var n=h(u(e(c)));c=n.l;var z=
n.a;const G=n.b;n=Math.sqrt(z*z+G*G);z=Math.atan2(G,z);z=0<z?z:z+2*Math.PI;c={l:c,c:n,h:z}}}return c};k.toRGB=e;k.toXYZ=function(c){return"x"in c&&"y"in c&&"z"in c?c:u(e(c))};Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/unitBezier":function(){define(["exports"],function(k){function x(h,g,e,f){function r(v,M){var E;let I,C;I=v;for(E=0;8>E;E++){C=((z*I+n)*I+c)*I-v;if(Math.abs(C)<M)return I;var B=(3*z*I+2*n)*I+c;if(1E-6>Math.abs(B))break;I-=C/B}B=0;E=1;I=v;if(I<B)return B;if(I>
E)return E;for(;B<E;){C=((z*I+n)*I+c)*I;if(Math.abs(C-v)<M)break;v>C?B=I:E=I;I=.5*(E-B)+B}return I}const c=3*h,n=3*(e-h)-c,z=1-c-n,G=3*g,l=3*(f-g)-G,p=1-G-l;return function(v,M=1E-6){v=r(v,M);return((p*v+l)*v+G)*v}}const u=/^cubic-bezier\((.*)\)/,a={};a.ease=x(.25,.1,.25,1);a.linear=x(0,0,1,1);a.easeIn=a["ease-in"]=x(.42,0,1,1);a.easeOut=a["ease-out"]=x(0,0,.58,1);a.easeInOut=a["ease-in-out"]=x(.42,0,.58,1);k.easingFunctions=a;k.parse=function(h){let g=a[h]||null;!g&&(h=u.exec(h))&&(h=h[1].split(",").map(e=>
parseFloat(e.trim())),4!==h.length||h.some(e=>isNaN(e))||(g=x.apply(x,h)));return g};k.unitBezier=x;Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["exports"],function(k){function x(f,r){f%=r;return 0<=f?f:f+r}const u=Number.POSITIVE_INFINITY,a=Math.PI,h=128/a,g=256/360,e=1/Math.LN2;k.C_256_TO_RAD=a/128;k.C_2PI=2*a;k.C_DEG_TO_256=g;k.C_DEG_TO_RAD=a/180;k.C_INFINITY=u;k.C_PI=a;k.C_PI_BY_2=a/2;k.C_RAD_TO_256=h;k.C_SQRT2=1.414213562;
k.C_SQRT2_INV=1/1.414213562;k.between=function(f,r,c){return f>=r&&f<=c||f>=c&&f<=r};k.degToByte=function(f){return x(f*g,256)};k.interpolate=function(f,r,c){return f*(1-c)+r*c};k.log2=function(f){return Math.log(f)*e};k.positiveMod=x;k.radToByte=function(f){return x(f*h,256)};k.sqr=function(f){return f*f};Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/expression/types":function(){define(["exports","../../../../../Color"],function(k,x){function u(p,v){return{kind:"array",
itemType:p,n:v}}function a(p){if("array"===p.kind){const v=a(p.itemType);return"number"===typeof p.n?`array<${v}, ${p.n}>`:"value"===p.itemType.kind?"array":`array<${v}>`}return p.kind}function h(p){if(null===p)return e;if("string"===typeof p)return r;if("boolean"===typeof p)return c;if("number"===typeof p)return f;if(p instanceof x)return n;if(Array.isArray(p)){let v;for(const M of p){const E=h(M);if(!v)v=E;else if(v!==E){v=G;break}}return u(v||G,p.length)}return"object"===typeof p?z:G}function g(p,
v){if("array"===v.kind)return"array"===p.kind&&(0===p.n&&"value"===p.itemType.kind||g(p.itemType,v.itemType))&&("number"!==typeof v.n||v.n===p.n);if("value"===v.kind)for(const M of l)if(g(p,M))return!0;return v.kind===p.kind}const e={kind:"null"},f={kind:"number"},r={kind:"string"},c={kind:"boolean"},n={kind:"color"},z={kind:"object"},G={kind:"value"},l=[e,f,r,c,n,z,u(G)];k.BooleanType=c;k.ColorType=n;k.NullType=e;k.NumberType=f;k.ObjectType=z;k.StringType=r;k.ValueType=G;k.arrayType=u;k.getType=
h;k.matchType=g;k.typeToString=a;k.valueToString=function(p){if(null===p)return"";const v=typeof p;return"string"===v?p:"number"===v||"boolean"===v?String(p):p instanceof x?p.toString():JSON.stringify(p)};Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleDefinition":function(){define(["exports"],function(k){let x=function(){};x.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0}};x.fillLayoutDefinition={visibility:{type:"enum",
values:["visible","none"],default:0}};x.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0},"line-cap":{type:"enum",values:["butt","round","square"],default:0},"line-join":{type:"enum",values:["bevel","round","miter"],default:2},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}};x.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",
values:["point","line","line-center"],default:0},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:0},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",
length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:2},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:0},"text-field":{type:"string"},"text-font":{type:"array",
value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:2},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,
default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:2},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:0},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[0]}};x.circleLayoutDefinition={visibility:{type:"enum",
values:["visible","none"],default:0}};x.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}};x.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",
value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:0}};x.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",
value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:0},"line-width":{type:"number",minimum:0,default:1}};x.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,
default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:0},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:0}};x.rasterPaintDefinition=
{"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};x.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,
default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:0}};
k.StyleDefinition=x;Object.defineProperty(k,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/style/StyleProperty":function(){define(["../../../../../Color","../GeometryUtils","../expression/expression","../expression/types"],function(k,x,u,a){return function(){function h(e,f){this.isDataDriven=!1;this.interpolator=null;switch(e.type){case "number":var r=!0;break;case "color":r=!0;break;case "array":r="number"===e.value;break;default:r=!1}null==f&&(f=e.default);if(Array.isArray(f)&&0<
f.length&&u.ops[f[0]]){r={number:a.NumberType,color:a.ColorType,string:a.StringType,boolean:a.BooleanType,enum:a.StringType};try{var c="array"===e.type?a.arrayType(r[e.value]||a.ValueType,e.length):r[e.type];const n=u.createExpression(f,null,c);this.getValue=this._buildExpression(n,e);this.isDataDriven=!0;n instanceof u.Interpolate&&n.input instanceof u.Zoom&&(this.interpolator=n)}catch(n){console.log(n.message),this.getValue=this._buildSimple(e.default)}}else{r&&"interval"===f.type&&(r=!1);if(c=
f&&f.stops&&0<f.stops.length)for(const n of f.stops)n[1]=this._validate(n[1],e);if(this.isDataDriven=f?!!f.property:!1)if(void 0!==f.default&&(f.default=this._validate(f.default,e)),c)switch(f.type){case "identity":this.getValue=this._buildIdentity(f,e);break;case "categorical":this.getValue=this._buildCategorical(f,e);break;default:this.getValue=r?this._buildInterpolate(f,e):this._buildInterval(f,e)}else this.getValue=this._buildIdentity(f,e);else c?this.getValue=r?this._buildZoomInterpolate(f):
this._buildZoomInterval(f):(f=this._validate(f,e),this.getValue=this._buildSimple(f))}}var g=h.prototype;g._validate=function(e,f){if("number"===f.type){if(e<f.minimum)return f.minimum;if(e>f.maximum)return f.maximum}else"color"===f.type?e=h._parseColor(e):"enum"===f.type?"string"===typeof e&&(e=f.values.indexOf(e)):"array"===f.type&&"enum"===f.value?e=e.map(r=>"string"===typeof e?f.values.indexOf(r):r):"string"===f.type&&(e=a.valueToString(e));return e};g._buildSimple=function(e){return()=>e};g._buildExpression=
function(e,f){return(r,c)=>{try{const n=e.evaluate(c,r);return void 0===n?f.default:this._validate(n,f)}catch(n){return console.log(n.message),f.default}}};g._buildIdentity=function(e,f){return(r,c)=>{let n;c&&(n=c.values[e.property]);return void 0!==n?this._validate(n,f):void 0!==e.default?e.default:f.default}};g._buildCategorical=function(e,f){return(r,c)=>{let n;c&&(n=c.values[e.property]);n=this._categorical(n,e.stops);return void 0!==n?n:void 0!==e.default?e.default:f.default}};g._buildInterval=
function(e,f){return(r,c)=>{let n;c&&(n=c.values[e.property]);return"number"===typeof n?this._interval(n,e.stops):void 0!==e.default?e.default:f.default}};g._buildInterpolate=function(e,f){return(r,c)=>{let n;c&&(n=c.values[e.property]);return"number"===typeof n?this._interpolate(n,e.stops,e.base||1):void 0!==e.default?e.default:f.default}};g._buildZoomInterpolate=function(e){return f=>this._interpolate(f,e.stops,e.base||1)};g._buildZoomInterval=function(e){return f=>this._interval(f,e.stops)};g._categorical=
function(e,f){const r=f.length;for(let c=0;c<r;c++)if(f[c][0]===e)return f[c][1]};g._interval=function(e,f){const r=f.length;let c=0;for(let n=0;n<r;n++)if(f[n][0]<=e)c=n;else break;return f[c][1]};g._interpolate=function(e,f,r){const c=f.length;for(let G=0;G<c;G++){const l=f[G];if(l[0]<=e)var n=l;else{var z=l;break}}if(n&&z){f=z[0]-n[0];e-=n[0];r=1===r?e/f:(r**e-1)/(r**f-1);if(Array.isArray(n[1])){n=n[1];z=z[1];e=[];for(f=0;f<n.length;f++)e.push(x.interpolate(n[f],z[f],r));return e}return x.interpolate(n[1],
z[1],r)}if(n)return n[1];if(z)return z[1]};h._isEmpty=function(e){for(const f in e)if(e.hasOwnProperty(f))return!1;return!0};h._parseColor=function(e){if(Array.isArray(e))return e;"string"===typeof e&&(e=new k(e));if(e instanceof k){if(!this._isEmpty(e))return k.toUnitRGBA(e)}else return e};return h}()})},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],function(k){k.ANGLE_FACTOR_256=256/360;k.ATTRIBUTE_DATA_ANIMATION=1;k.ATTRIBUTE_DATA_DD0=3;k.ATTRIBUTE_DATA_DD1=3;k.ATTRIBUTE_DATA_FILTER_FLAGS=
0;k.ATTRIBUTE_DATA_VV=2;k.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;k.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};k.BUFFER_DATA_MINIMUM_SIZE=128;k.BUFFER_DATA_POOL_SIZE=4;k.COLLISION_BOX_PADDING=16;k.COLLISION_BUCKET_SIZE=128;k.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;k.COLLISION_MAX_ZOOM_DELTA=1;k.COLLISION_PLACEMENT_PADDING=8;k.COLLISION_TILE_BOX_SIZE=4;k.DEBUG_LABELS=!1;k.DISPLAY_RECORD_INT_PER_ELEMENT=7;k.DOT_DENSITY_MAX_FIELDS=8;k.EFFECT_FLAG_0=4;k.ENABLE_EARLY_LABEL_DISCARD=
!1;k.EXTRUDE_SCALE=64;k.FILTER_FLAG_0=2;k.GLYPH_SIZE=24;k.HEURISTIC_GLYPHS_PER_FEATURE=10;k.HEURISTIC_GLYPHS_PER_LINE=50;k.HIGHLIGHT_FLAG=1;k.HITTEST_SEARCH_SIZE=6;k.MAGIC_LABEL_LINE_HEIGHT=29;k.MAX_FILTERS=2;k.MAX_GPU_UPLOADS_PER_FRAME=2;k.MIN_MAX_ZOOM_PRECISION_FACTOR=10;k.NAN_MAGIC_NUMBER=1E-30;k.PATCH_PIXEL_BUFFER_ALLOC_SIZE=500;k.PICTURE_FILL_COLOR=4294967295;k.RASTER_TILE_SIZE=256;k.SPRITE_PADDING=2;k.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;k.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;k.TEXTURE_BINDING_ATTRIBUTE_DATA_2=
3;k.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;k.TEXTURE_BINDING_BITMAP=0;k.TEXTURE_BINDING_GLYPH_ATLAS=0;k.TEXTURE_BINDING_HIGHLIGHT_0=5;k.TEXTURE_BINDING_HIGHLIGHT_1=6;k.TEXTURE_BINDING_RENDERER_0=5;k.TEXTURE_BINDING_RENDERER_1=6;k.TEXTURE_BINDING_SPRITE_ATLAS=0;k.TEXT_PLACEMENT_PADDING=8;k.THIN_LINE_HALF_WIDTH_THRESHOLD=1.05;k.TILE_SIZE=512;k.VTL_HIGH_RES_CUTOFF=1.15;k.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;k.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;k.WEBGL_MAX_INNER_STOPS=6;k.WEBGL_MAX_STOPS=8;Object.defineProperty(k,
"__esModule",{value:!0})})},"esri/views/webgl/capabilities":function(){define(["./context-util"],function(k){function x(){const a={available:!1,version:0,majorPerformanceCaveat:!1,maxTextureSize:0,supportsHighPrecisionFragment:!1,supportsVertexShaderSamplers:!1,supportsElementIndexUint:!1,supportsStandardDerivatives:!1,supportsInstancedArrays:!1,supportsTextureFloat:!1,supportsColorBufferFloat:!1};var h=document.createElement("canvas");if(!h)return a;var g=k.createContext(h,{failIfMajorPerformanceCaveat:!0},
"webgl");!g&&(g=k.createContext(h,{},"webgl"))&&(a.majorPerformanceCaveat=!0);if(!g)return a;h=g.getParameter(g.VERSION);if(!h)return a;if(h=h.match(/^WebGL\s+([\d.]*)/)){h=parseFloat(h[1]);a.available=.94<=h;if(h=g.getShaderPrecisionFormat(g.FRAGMENT_SHADER,g.HIGH_FLOAT))a.supportsHighPrecisionFragment=0<h.precision;a.supportsVertexShaderSamplers=0<g.getParameter(g.MAX_VERTEX_TEXTURE_IMAGE_UNITS);a.supportsElementIndexUint=null!==g.getExtension("OES_element_index_uint");a.supportsStandardDerivatives=
null!==g.getExtension("OES_standard_derivatives");a.supportsInstancedArrays=null!==g.getExtension("ANGLE_instanced_arrays");a.supportsTextureFloat=null!==g.getExtension("OES_texture_float");a.supportsColorBufferFloat=null!==g.getExtension("WEBGL_color_buffer_float")&&null!==g.getExtension("EXT_float_blend")}a.maxTextureSize=g.getParameter(g.MAX_TEXTURE_SIZE);g=(g=document.createElement("canvas"))&&k.createContext(g,{},"webgl2")?!0:!1;a.version=g?2:1;return a}let u;return function(){u||(u=x());return u}})},
"esri/views/webgl/context-util":function(){define(["exports"],function(k){function x(a,h={},g){switch(g){case "webgl":g=["webgl","experimental-webgl","webkit-3d","moz-webgl"];break;case "webgl2":g=["webgl2"];break;default:g=["webgl","experimental-webgl","webkit-3d","moz-webgl"]}let e=null;for(const f of g){try{e=a.getContext(f,h)}catch(r){}if(e)break}return e}function u(a,h){(a=a.parentNode)&&(a.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+
h+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}k.createContext=x;k.createContextOrErrorHTML=function(a,h={},g){if(!window.WebGLRenderingContext)return u(a,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),null;h=x(a,h,g);return h?h:(u(a,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'),
null)};Object.defineProperty(k,"__esModule",{value:!0})})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../request ../core/Error ../core/global ../core/lang ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/has ../core/Logger ../core/jsonMap ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ../geometry/Extent ../geometry/SpatialReference ./Layer ./mixins/ArcGISCachedService ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./support/imageUtils ./support/SpriteSource ./support/TileInfo ./support/TilemapCache ./support/vectorTileLayerLoader ../portal/support/jsonContext ../views/2d/engine/vectorTiles/SchemaHelper ../views/2d/engine/vectorTiles/tileInfoUtils ../views/2d/engine/vectorTiles/style/StyleRepository ../views/webgl/capabilities".split(" "),function(k,
x,u,a,h,g,e,f,r,c,n,z,G,l,p,v,M,E,I,C,B,w,q,D,F,A,K,N,L,Q,R,W,U,Y,ca,da){e=function(ea){function ia(...H){H=ea.call(this,...H)||this;H._spriteSourceMap=new Map;H.currentStyleInfo=null;H.style=null;H.isReference=null;H.operationalLayerType="VectorTileLayer";H.type="vector-tile";H.url=null;return H}k._inheritsLoose(ia,ea);var X=ia.prototype;X.normalizeCtorArgs=function(H,O){return"string"===typeof H?{url:H,...O}:H};X.destroy=function(){this._spriteSourceMap.clear()};X.prefetchResources=function(){var H=
k._asyncToGenerator(function*(O){yield this.loadSpriteSource(h.devicePixelRatio||1,O)});return function(O){return H.apply(this,arguments)}}();X.load=function(H){var O=this;const T=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},H).catch(f.throwIfAbortError).then(k._asyncToGenerator(function*(){if(O.portalItem&&O.portalItem.id){var aa=`${O.portalItem.itemUrl}/resources/styles/root.json`;(yield u(aa,{...H,query:{f:"json"}})).data&&O.read({url:aa},W.createForItem(O.portalItem))}})).catch(f.throwIfAbortError).then(()=>
this._loadStyle(H));this.addResolvingPromise(T);return Promise.resolve(this)};X.writeStyleUrl=function(H,O){H&&r.isProtocolRelative(H)&&(H=`https:${H}`);O.styleUrl=H};X.readVersion=function(H,O){return O.version?parseFloat(O.version):parseFloat(O.currentVersion)};X.loadSpriteSource=function(){var H=k._asyncToGenerator(function*(O=1,T){if(!this._spriteSourceMap.has(O)){var aa=da();aa=new N(this.styleRepository.sprite,O,aa.maxTextureSize,this.currentStyleInfo.spriteFormat);yield aa.load(T);this._spriteSourceMap.set(O,
aa)}return Promise.resolve(this._spriteSourceMap.get(O))});return function(){return H.apply(this,arguments)}}();X.loadStyle=function(){var H=k._asyncToGenerator(function*(O,T){const aa=O||this.style||this.url;if(this._loadingPromise&&"string"===typeof aa&&this.url===aa&&!f.isAborted(this._abortController))return this._loadingPromise;(O=this._abortController)&&O.abort();const ja=f.createAbortController();this._loadingPromise=new Promise((la,ma)=>{const Z={signal:ja.signal};this._spriteSourceMap.clear();
this._getSourceAndStyle(aa,Z).then(la,ma);f.onAbort(T,()=>{ja.abort()})});this._abortController=ja;return this._loadingPromise});return function(O,T){return H.apply(this,arguments)}}();X.getStyleLayerId=function(H){return this.styleRepository.getStyleLayerId(H)};X.getStyleLayerIndex=function(H){return this.styleRepository.getStyleLayerIndex(H)};X.getPaintProperties=function(H){return g.clone(this.styleRepository.getPaintProperties(H))};X.setPaintProperties=function(H,O){const T=this.styleRepository.isPainterDataDriven(H);
this.styleRepository.setPaintProperties(H,O);const aa=this.styleRepository.isPainterDataDriven(H);this.emit("paint-change",{layer:H,paint:O,isDataDriven:T||aa})};X.getStyleLayer=function(H){return g.clone(this.styleRepository.getStyleLayer(H))};X.setStyleLayer=function(H,O){this.styleRepository.setStyleLayer(H,O);this.emit("style-layer-change",{layer:H,index:O})};X.deleteStyleLayer=function(H){this.styleRepository.deleteStyleLayer(H);this.emit("delete-style-layer",{layer:H})};X.getLayoutProperties=
function(H){return g.clone(this.styleRepository.getLayoutProperties(H))};X.setLayoutProperties=function(H,O){this.styleRepository.setLayoutProperties(H,O);this.emit("layout-change",{layer:H,layout:O})};X.setStyleLayerVisibility=function(H,O){this.styleRepository.setStyleLayerVisibility(H,O);this.emit("style-layer-visibility-change",{layer:H,visibility:O})};X.getStyleLayerVisibility=function(H){return this.styleRepository.getStyleLayerVisibility(H)};X.getTileUrl=function(H,O,T){let aa=this.tileServers[O%
this.tileServers.length];return aa=aa.replace(/\{z\}/gi,H.toString()).replace(/\{y\}/gi,O.toString()).replace(/\{x\}/gi,T.toString())};X.write=function(H,O){return O&&O.origin&&!this.styleUrl?(O.messages&&O.messages.push(new a("vectortilelayer:unsupported",`VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`,{layer:this})),null):ea.prototype.write.call(this,H,O)};X._getSourceAndStyle=function(){var H=k._asyncToGenerator(function*(O,T){if(!O)throw Error("invalid style!");
T=yield R.loadMetadata(O,T);"webp"!==T.spriteFormat||(yield K.checkWebPSupport("lossy"))||(T.spriteFormat="png");this._set("currentStyleInfo",{...T});"string"===typeof O?(this.url=O,this.style=null):(this.url=null,this.style=O);this._set("sourceNameToSource",T.sourceNameToSource);this._set("primarySourceName",T.primarySourceName);this._set("styleRepository",new ca(T.style,T));this.read(T.layerDefinition,{origin:"service"});this.emit("load-style",{})});return function(O,T){return H.apply(this,arguments)}}();
X._getDefaultAttribution=function(H){var O=H.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);H="OpenStreetMap_v2 OpenStreetMap_Daylight_v2 OpenStreetMap_Export_v2 OpenStreetMap_FTS_v2 OpenStreetMap_GCS_v2 World_Basemap World_Basemap_v2 World_Basemap_Export_v2 World_Basemap_GCS_v2 World_Basemap_WGS84 World_Contours_v2".split(" ");if(O){var T=O[2]&&O[2].toLowerCase();if(T){O=O[1]||"";for(const aa of H)if(-1<
aa.toLowerCase().indexOf(T))return r.normalize(`//static.arcgis.com/attribution/Vector${O}/${aa}`)}}};X._getPrimarySource=function(){return this.sourceNameToSource&&this.primarySourceName in this.sourceNameToSource?this.sourceNameToSource[this.primarySourceName]:null};X._loadStyle=function(){var H=k._asyncToGenerator(function*(O){return this._loadingPromise?this._loadingPromise:this.loadStyle(null,O)});return function(O){return H.apply(this,arguments)}}();k._createClass(ia,[{key:"attributionDataUrl",
get:function(){var H=this.currentStyleInfo;return(H=H&&H.serviceUrl&&r.urlToObject(H.serviceUrl))?this._getDefaultAttribution(H.path):null}},{key:"capabilities",get:function(){const H=this._getPrimarySource();return H?H.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}},{key:"fullExtent",get:function(){const H=this._getPrimarySource();return H?H.fullExtent:null}},{key:"parsedUrl",get:function(){return this.serviceUrl?r.urlToObject(this.serviceUrl):null}},{key:"serviceUrl",
get:function(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null}},{key:"spatialReference",get:function(){return this.tileInfo&&this.tileInfo.spatialReference||null}},{key:"styleUrl",get:function(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null}},{key:"tileIndexType",get:function(){const H=this._getPrimarySource();return H?H.type:""}},{key:"tileIndexUrl",get:function(){const H=this._getPrimarySource();return H?H.tileMapURL:""}},{key:"tileInfo",get:function(){var H;
const O=[];for(var T in this.sourceNameToSource)O.push(this.sourceNameToSource[T]);T=(null==(H=this._getPrimarySource())?void 0:H.tileInfo)||new L;if(1<O.length)for(H=0;H<O.length;H++)Y.areSchemasOverlapping(T,O[H].tileInfo)&&(T=Y.unionTileInfos(T,O[H].tileInfo));return T}},{key:"tilemapCache",get:function(){const H=this._getPrimarySource();return H?H.capabilities.operations.supportsTileMap?H.tilemapCache:null:null}},{key:"tileServers",get:function(){const H=this._getPrimarySource();return H?H.tileServers:
[]}},{key:"compatibleTileInfo256",get:function(){return U.create256x256CompatibleTileInfo(this.tileInfo)}},{key:"compatibleTileInfo512",get:function(){return U.create512x512CompatibleTileInfo(this.tileInfo)}}]);return ia}(q.BlendLayer(A.ScaleRangeLayer(B.ArcGISCachedService(w.ArcGISService(D.OperationalLayer(F.PortalLayer(e.MultiOriginJSONMixin(C))))))));x.__decorate([c.property({readOnly:!0})],e.prototype,"attributionDataUrl",null);x.__decorate([c.property({type:["show","hide"]})],e.prototype,"listMode",
void 0);x.__decorate([c.property({readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"],json:{read:!1}})],e.prototype,"capabilities",null);x.__decorate([c.property({readOnly:!0})],e.prototype,"currentStyleInfo",void 0);x.__decorate([c.property({json:{read:!1},readOnly:!0,type:E})],e.prototype,"fullExtent",null);x.__decorate([c.property()],e.prototype,"style",void 0);x.__decorate([c.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],e.prototype,
"isReference",void 0);x.__decorate([c.property({type:["VectorTileLayer"]})],e.prototype,"operationalLayerType",void 0);x.__decorate([c.property({readOnly:!0})],e.prototype,"parsedUrl",null);x.__decorate([c.property({readOnly:!0})],e.prototype,"serviceUrl",null);x.__decorate([c.property({type:I,readOnly:!0})],e.prototype,"spatialReference",null);x.__decorate([c.property({readOnly:!0})],e.prototype,"styleRepository",void 0);x.__decorate([c.property({readOnly:!0})],e.prototype,"sourceNameToSource",void 0);
x.__decorate([c.property({readOnly:!0})],e.prototype,"primarySourceName",void 0);x.__decorate([c.property({type:String,readOnly:!0,json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],e.prototype,"styleUrl",null);x.__decorate([M.writer(["portal-item","web-document"],"styleUrl")],e.prototype,"writeStyleUrl",null);x.__decorate([c.property({json:{read:!1},readOnly:!0})],e.prototype,"tileIndexType",null);x.__decorate([c.property({json:{read:!1},readOnly:!0})],
e.prototype,"tileIndexUrl",null);x.__decorate([c.property({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:L})],e.prototype,"tileInfo",null);x.__decorate([c.property({json:{read:!1},readOnly:!0,type:Q.TilemapCache})],e.prototype,"tilemapCache",null);x.__decorate([c.property({json:{read:!1},readOnly:!0})],e.prototype,"tileServers",null);x.__decorate([c.property({json:{read:!1},readOnly:!0,value:"vector-tile"})],e.prototype,"type",void 0);x.__decorate([c.property({json:{origins:{"web-document":{read:{source:"styleUrl"}},
"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],e.prototype,"url",void 0);x.__decorate([c.property({readOnly:!0})],e.prototype,"version",void 0);x.__decorate([p.reader("version",["version","currentVersion"])],e.prototype,"readVersion",null);x.__decorate([c.property({readOnly:!0})],e.prototype,"compatibleTileInfo256",null);x.__decorate([c.property({readOnly:!0})],e.prototype,"compatibleTileInfo512",null);return e=x.__decorate([v.subclass("esri.layers.VectorTileLayer")],e)});