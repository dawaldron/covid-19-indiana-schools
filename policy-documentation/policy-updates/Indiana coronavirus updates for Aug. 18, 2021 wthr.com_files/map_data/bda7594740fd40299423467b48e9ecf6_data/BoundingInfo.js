// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/PooledArray","../../../../chunks/vec3","../../../../chunks/vec3f64","./Util"],function(y,B,t,p,q){let C=function(){function r(c,b,a,e){this.primitiveIndices=c;this._numIndexPerPrimitive=b;this.indices=a;this.position=e;this.center=p.create();q.assert(1<=c.length);q.assert(0===a.length%this._numIndexPerPrimitive);q.assert(a.length>=c.length*this._numIndexPerPrimitive);q.assert(3===e.size||4===e.size);const {data:d,size:m}=e;e=c.length;b=m*a[this._numIndexPerPrimitive*
c[0]];l.clear();l.push(b);this.bbMin=p.fromValues(d[b],d[b+1],d[b+2]);this.bbMax=p.clone(this.bbMin);for(var g=0;g<e;++g){var f=this._numIndexPerPrimitive*c[g];for(var k=0;k<this._numIndexPerPrimitive;++k){b=m*a[f+k];l.push(b);let h=d[b];this.bbMin[0]=Math.min(h,this.bbMin[0]);this.bbMax[0]=Math.max(h,this.bbMax[0]);h=d[b+1];this.bbMin[1]=Math.min(h,this.bbMin[1]);this.bbMax[1]=Math.max(h,this.bbMax[1]);h=d[b+2];this.bbMin[2]=Math.min(h,this.bbMin[2]);this.bbMax[2]=Math.max(h,this.bbMax[2])}}t.lerp(this.center,
this.bbMin,this.bbMax,.5);this.radius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);c=this.radius*this.radius;for(a=0;a<l.length;++a)b=l.getItemAt(a),e=d[b]-this.center[0],g=d[b+1]-this.center[1],b=d[b+2]-this.center[2],f=e*e+g*g+b*b,f<=c||(f=Math.sqrt(f),k=.5*(f-this.radius),this.radius+=k,c=this.radius*this.radius,f=k/f,this.center[0]+=e*f,this.center[1]+=g*f,this.center[2]+=b*f);l.clear()}var n=r.prototype;n.getCenter=function(){return this.center};
n.getBSRadius=function(){return this.radius};n.getBBMin=function(){return this.bbMin};n.getBBMax=function(){return this.bbMax};n.getChildren=function(){if(this._children)return this._children;if(1<t.squaredDistance(this.bbMin,this.bbMax)){var c=t.lerp(p.create(),this.bbMin,this.bbMax,.5),b=this.primitiveIndices.length;const m=new Uint8Array(b),g=Array(8);for(var a=0;8>a;++a)g[a]=0;const {data:f,size:k}=this.position;for(a=0;a<b;++a){var e=0;const h=this._numIndexPerPrimitive*this.primitiveIndices[a];
var d=k*this.indices[h];let u=f[d],v=f[d+1],w=f[d+2];for(let x=1;x<this._numIndexPerPrimitive;++x){d=k*this.indices[h+x];const z=f[d],A=f[d+1];d=f[d+2];z<u&&(u=z);A<v&&(v=A);d<w&&(w=d)}u<c[0]&&(e|=1);v<c[1]&&(e|=2);w<c[2]&&(e|=4);m[a]=e;++g[e]}c=0;for(a=0;8>a;++a)0<g[a]&&++c;if(2>c)return;c=Array(8);for(a=0;8>a;++a)c[a]=0<g[a]?new Uint32Array(g[a]):void 0;for(a=0;8>a;++a)g[a]=0;for(a=0;a<b;++a)e=m[a],c[e][g[e]++]=this.primitiveIndices[a];this._children=Array(8);for(b=0;8>b;++b)void 0!==c[b]&&(this._children[b]=
new r(c[b],this._numIndexPerPrimitive,this.indices,this.position))}return this._children};r.prune=function(){l.prune()};return r}();const l=new B({deallocator:null});y.BoundingInfo=C;Object.defineProperty(y,"__esModule",{value:!0})});