// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.20/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ./support/ActiveLayerInfo ../../intl/locale".split(" "),function(G,J,H,w,r,v,N,W,U,e,t,z,
A,C,O){const D=r.ofType(C),x="esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.TileLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer".split(" "),
F=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];H=function(T){function L(m){m=T.call(this,m)||this;m._handles=new v;m._layerViewByLayerId={};m._layerInfosByLayerViewId={};m._activeLayerInfosByLayerViewId={};m._activeLayerInfosWithNoParent=new r;m.activeLayerInfos=new D;m.basemapLegendVisible=!1;m.groundLegendVisible=!1;m.keepCacheOnDestroy=!1;m.respectLayerVisibility=!0;m.layerInfos=[];m.view=null;return m}G._inheritsLoose(L,
T);var Q=L.prototype;Q.initialize=function(){this._handles.add(N.init(this,"view",this._viewHandles),"view");this._handles.add(O.onLocaleChange(()=>this._refresh()))};Q.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};Q._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(N.init(this,"state",this._stateHandles),"state")};Q._stateHandles=function(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()};
Q._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};Q._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};Q._destroyViewActiveLayerInfo=function(m){this._handles.remove(m);const M=this._activeLayerInfosByLayerViewId[m];delete this._activeLayerInfosByLayerViewId[m];M&&M.parent&&M.parent.children.remove(M)};Q._watchPropertiesAndAllLayerViews=
function(){const {allLayerViews:m}=this.view;m.length&&this._refresh();this._handles.add(m.on("change",this._allLayerViewsChangeHandle.bind(this)),"all-layer-views");this._handles.add(N.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",this._propertiesChangeHandle.bind(this)),"legend-properties")};Q._allLayerViewsChangeHandle=function(m){m.removed.forEach(M=>this._destroyViewActiveLayerInfo(M.uid));this._refresh()};Q._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();
this._refresh()};Q._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};Q._sortActiveLayerInfos=function(m){if(!(2>m.length)){var M=[];m.forEach(g=>{if(!g.parent){var y=g.layer.parent;(y=(y=y&&"uid"in y&&this._layerViewByLayerId[y.uid])&&this._activeLayerInfosByLayerViewId[y.uid])&&
-1!==m.indexOf(y)&&(M.push(g),g.parent=y,y.children.add(g),this._sortActiveLayerInfos(y.children))}});m.removeMany(M);var n={};this.view.allLayerViews.forEach((g,y)=>n[g.layer.uid]=y);m.sort((g,y)=>(n[y.layer.uid]||0)-(n[g.layer.uid]||0))}};Q._generateLayerViews=function(){const m=[];F.filter(this._filterLayerViews,this).map(this.get,this).filter(M=>null!=M).forEach(this._collectLayerViews("layerViews",m));return m};Q._filterLayerViews=function(m){const M=!this.groundLegendVisible&&"view.groundView.layerViews"===
m;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===m||"view.basemapView.referenceLayerViews"===m))&&!M};Q._collectLayerViews=function(m,M){const n=g=>{g&&g.forEach(y=>{M.push(y);n(y[m])});return M};return n};Q._filterLayerViewsByLayerInfos=function(m){const M=this.layerInfos;return M&&M.length?M.some(n=>this._hasLayerInfo(n,m)):!0};Q._hasLayerInfo=function(m,M){const n=this._isLayerUIDMatching(m.layer,M.layer.uid);n&&(this._layerInfosByLayerViewId[M.uid]=m);return n};Q._isLayerUIDMatching=
function(m,M){return m&&(m.uid===M||this._hasLayerUID(m.layers,M))};Q._hasLayerUID=function(m,M){return m&&m.some(n=>this._isLayerUIDMatching(n,M))};Q._isLayerViewSupported=function(m){return x.includes(m.layer.declaredClass)?(this._layerViewByLayerId[m.layer.uid]=m,!0):!1};Q._generateActiveLayerInfo=function(m){this._isLayerActive(m)?this._buildActiveLayerInfo(m):(this._handles.remove(m.uid),this._handles.add(N.watch(m,"legendEnabled, layer.legendEnabled",()=>this._layerActiveHandle(m)),m.uid))};
Q._layerActiveHandle=function(m){this._isLayerActive(m)&&(this._handles.remove(m.uid),this._buildActiveLayerInfo(m))};Q._isLayerActive=function(m){return this.respectLayerVisibility?m.legendEnabled&&m.get("layer.legendEnabled"):!0};Q._buildActiveLayerInfo=function(m){var M,n=m.layer;const g=m.uid;var y=this._layerInfosByLayerViewId[g];let k=this._activeLayerInfosByLayerViewId[g];k||(k=new C({layer:n,layerView:m,title:y&&void 0!==y.title&&y.layer.uid===n.uid?y.title:n.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,
keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:y&&y.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[g]=k);y=n.parent&&"uid"in n.parent&&this._layerViewByLayerId[null==(M=n.parent)?void 0:M.uid];k.parent=this._activeLayerInfosByLayerViewId[null==y?void 0:y.uid];if(!this._handles.has(g)){M=N.watch(n,"title",p=>this._titleHandle(p,k));y=N.watch(n,"renderer?, opacity, pointSymbol?, lineSymbol?, polygonSymbol?",()=>this._constructLegendElements(k));const E=N.whenTrue(this.view,"stationary",
()=>this._scaleHandle(k)),l=N.watch(m,"_effectiveRenderer",()=>this._constructLegendElements(k));M=[M,y,E,l];this.respectLayerVisibility&&(m=N.watch(m,"legendEnabled",p=>this._legendEnabledHandle(p,k)),n=N.watch(n,"legendEnabled",p=>this._legendEnabledHandle(p,k)),M.push(m,n));this._handles.add(M,g)}k.isScaleDriven||this._constructLegendElements(k);this._addActiveLayerInfo(k)};Q._titleHandle=function(m,M){M.title=m;this._constructLegendElements(M)};Q._legendEnabledHandle=function(m,M){m?this._addActiveLayerInfo(M):
this._removeActiveLayerInfo(M)};Q._scaleHandle=function(m){m.isScaleDriven&&this._constructLegendElements(m)};Q._addActiveLayerInfo=function(m){const {layerView:M,layer:n}=m;if(this._isLayerActive(M)&&-1===this.activeLayerInfos.indexOf(m)){var g=m.parent;if(g)-1===g.children.indexOf(m)&&g.children.push(m),this._sortActiveLayerInfos(g.children);else{var y;g=null==(y=this.layerInfos)?void 0:y.some(k=>k.layer.uid===n.uid);n.parent&&"uid"in n.parent&&!g?this._activeLayerInfosWithNoParent.add(m):(this.activeLayerInfos.add(m),
this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const k=[];this._activeLayerInfosWithNoParent.forEach(E=>{var l=E.layer.parent;l=l&&"uid"in l&&this._layerViewByLayerId[null==l?void 0:l.uid];if(l=this._activeLayerInfosByLayerViewId[null==l?void 0:l.uid])k.push(E),E.parent=l});k.length&&(this._activeLayerInfosWithNoParent.removeMany(k),k.forEach(E=>this._addActiveLayerInfo(E)))}}};Q._removeActiveLayerInfo=function(m){const M=m.parent;M?M.children.remove(m):
this.activeLayerInfos.remove(m)};Q._constructLegendElements=function(m){const M=m.layer;"featureCollections"in M&&M.featureCollections?m.buildLegendElementsForFeatureCollections(M.featureCollections):"renderer"in M&&M.renderer?m.buildLegendElementsForRenderer(M.renderer):"url"in M&&M.url?m.buildLegendElementsForTools():m.children.forEach(n=>this._constructLegendElements(n))};G._createClass(L,[{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}}]);return L}(w);J.__decorate([W.property({type:D})],
H.prototype,"activeLayerInfos",void 0);J.__decorate([W.property()],H.prototype,"basemapLegendVisible",void 0);J.__decorate([W.property()],H.prototype,"groundLegendVisible",void 0);J.__decorate([W.property()],H.prototype,"keepCacheOnDestroy",void 0);J.__decorate([W.property()],H.prototype,"respectLayerVisibility",void 0);J.__decorate([W.property()],H.prototype,"layerInfos",void 0);J.__decorate([W.property({readOnly:!0})],H.prototype,"state",null);J.__decorate([W.property()],H.prototype,"view",void 0);
return H=J.__decorate([A.subclass("esri.widgets.Legend.LegendViewModel")],H)})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../kernel ../../../request ../../../symbols ../../../core/Accessor ../../../core/Collection ../../../core/Handles ../../../core/jsonMap ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/screenUtils ../../../core/urlUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../symbols/support/cimSymbolUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleFillSymbol".split(" "),
function(G,J,H,w,r,v,N,W,U,e,t,z,A,C,O,D,x,F,T,L,Q,m,M,n,g,y,k,E,l,p,u,P,V,c,q,b,f){function I(pa){return"esri.renderers.SimpleRenderer"===pa.declaredClass}function S(pa){return"esri.renderers.ClassBreaksRenderer"===pa.declaredClass}function Y(pa){return"esri.renderers.UniqueValueRenderer"===pa.declaredClass}function ia(pa){return"esri.renderers.HeatmapRenderer"===pa.declaredClass}function ja(pa){return"esri.renderers.PointCloudClassBreaksRenderer"===pa.declaredClass}function na(pa){return"esri.renderers.PointCloudStretchRenderer"===
pa.declaredClass}function ka(pa){return"esri.renderers.PointCloudUniqueValueRenderer"===pa.declaredClass}function Z(pa){return"esri.renderers.DotDensityRenderer"===pa.declaredClass}function ca(pa){return"esri.layers.BuildingSceneLayer"===pa.declaredClass}function ha(pa){pa="authoringInfo"in pa&&(null==pa?void 0:pa.authoringInfo);return"univariate-color-size"===(null==pa?void 0:pa.type)}function fa(pa){pa="authoringInfo"in pa&&(null==pa?void 0:pa.authoringInfo);return"univariate-color-size"===(null==
pa?void 0:pa.type)&&"above-and-below"===(null==pa?void 0:pa.univariateTheme)}const ea=z.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),sa=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,ra=new t.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),ya={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],
f32:[-3.4*1E39,3.4*1E39],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},wa=new b({size:6,outline:{color:[128,128,128,.5],width:.5}}),Fa=new f({style:"solid"}),Ga=new b({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Aa={};N=function(pa){function Ba(d){d=pa.call(this,d)||this;d._handles=new e;d._hasColorRamp=!1;d._hasOpacityRamp=!1;d._hasSizeRamp=!1;d._webStyleSymbolCache=new Map;d._dotDensityUrlCache=new Map;d._scaleDrivenSizeVariable=null;d._hasClusterSizeVariable=
!1;d.children=new U;d.layerView=null;d.layer=null;d.legendElements=[];d.parent=null;d.keepCacheOnDestroy=!1;d.respectLayerVisibility=!0;d.sublayerIds=[];d.title=null;d.view=null;return d}J._inheritsLoose(Ba,pa);var da=Ba.prototype;da.initialize=function(){const d=()=>this.notifyChange("ready");this._handles.add([x.on(this,"children","change",a=>{const {added:h,removed:B}=a,K=this._handles;h.map(R=>{const X=`activeLayerInfo-ready-watcher-${R.layer.uid}`;K.add(x.init(R,"ready",d),X)});B.forEach(R=>
K.remove(R.layer.uid));d()})]);this.keepCacheOnDestroy||(Aa={})};da.destroy=function(){this._handles.destroy();this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=this._handles=null;this.keepCacheOnDestroy||(Aa=null)};da.buildLegendElementsForFeatureCollections=function(){var d=J._asyncToGenerator(function*(a){a=a.map(h=>{if("esri.layers.FeatureLayer"===h.declaredClass)return this._getRendererLegendElements(h.renderer,{title:h.title});if(h.featureSet&&h.featureSet.features.length){var B=
h.layerDefinition,K=B&&B.drawingInfo;K=K&&n.fromJSON(K.renderer);B=ra.read(B.geometryType);return K?this._getRendererLegendElements(K,{title:h.name,geometryType:B}):(ea.warn("drawingInfo not available!"),null)}return null});try{const h=[];yield C.eachAlways(a).then(B=>{B.forEach(({value:K})=>K&&h.push(...K))});this.legendElements=h;this.notifyChange("ready")}catch(h){ea.warn("error while building legend for layer!",h)}});return function(a){return d.apply(this,arguments)}}();da.buildLegendElementsForRenderer=
function(){var d=J._asyncToGenerator(function*(a){try{this.legendElements=yield this._getRendererLegendElements(a),this.notifyChange("ready")}catch(h){ea.warn("error while building legend for layer!",h)}});return function(a){return d.apply(this,arguments)}}();da.buildLegendElementsForTools=function(){var d=J._asyncToGenerator(function*(){var a=this;const h=this.layer;if("esri.layers.WMTSLayer"===h.declaredClass)this._constructLegendElementsForWMTSlayer();else if("esri.layers.WMSLayer"===h.declaredClass)yield this._constructLegendElementsForWMSSublayers();
else if(ca(h))yield this._constructLegendElementsForBuildingSceneLayer();else if("esri.layers.MapImageLayer"===h.declaredClass||"esri.layers.TileLayer"===h.declaredClass||ca(h))yield this._constructLegendElementsForSublayers();else{this._handles.remove("imageryLayers-watcher");var B="default";if("esri.layers.ImageryLayer"===h.declaredClass){var K,R;B=(null==h?void 0:null==(K=h.renderingRule)?void 0:K.functionName)||"default";K=null!=(R=h.bandIds)&&R.length?h.bandIds.join(""):"###";B=B+"_"+K}yield this._getLegendLayers(`${h.uid}-${B}`).then(function(){var X=
J._asyncToGenerator(function*(ba){a.legendElements=[];a.notifyChange("ready");ba=ba.map(function(){var la=J._asyncToGenerator(function*(ta){if("esri.layers.ImageryLayer"===h.declaredClass||"esri.layers.ImageryTileLayer"===h.declaredClass){const va=h.watch(["renderingRule","bandIds"],()=>C.debounce(J._asyncToGenerator(function*(){Aa["default"]=null;h.renderer?yield a.buildLegendElementsForRenderer(h.renderer):yield a.buildLegendElementsForTools()}))());a._handles.add(va,"imageryLayers-watcher")}(ta=
a._generateSymbolTableElementForLegendLayer(ta))&&ta.infos.length&&("esri.layers.ImageryLayer"===h.declaredClass&&(ta.title=h.title),a.legendElements.push(ta));a.notifyChange("ready")});return function(ta){return la.apply(this,arguments)}}());yield C.eachAlways(ba)});return function(ba){return X.apply(this,arguments)}}()).catch(X=>{ea.warn("Request to server for legend has failed!",X)})}});return function(){return d.apply(this,arguments)}}();da._getParentLayerOpacity=function(d){let a=1;const h=d.parent;
h&&"uid"in h&&(a=this._getParentLayerOpacity(h));return d.opacity*a};da._isGroupActive=function(){const d=this.children;return d.length?d.some(a=>a.ready):!1};da._isScaleDrivenSizeVariable=function(d){if(d&&"size"!==d.type)return!1;const a=d.minSize,h=d.maxSize;return"object"===typeof a&&a?this._isScaleDrivenSizeVariable(a):"object"===typeof h&&h?this._isScaleDrivenSizeVariable(h):!!d.expression||sa.test(d.valueExpression)};da._isLayerScaleDriven=function(d){if("minScale"in d&&0<d.minScale||"maxScale"in
d&&0<d.maxScale)return!0;if("sublayers"in d&&d.sublayers)return d.sublayers.some(h=>this._isLayerScaleDriven(h));const a=d.parent;if(!1===d.loaded&&a&&"esri.layers.MapImageLayer"===a.declaredClass&&"source"in d&&d.source&&"map-layer"===d.source.type)for(const h of a.sourceJSON.layers)if(h.id===d.source.mapLayerId&&(0<h.minScale||0<h.maxScale))return!0;return!1};da._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");const d=this.layer.activeLayer;
this._handles.add(x.watch(this.layer,"activeLayer",()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");if(d.styleId&&d.styles){let a=null;d.styles.some(h=>d.styleId===h.id?(a=h.legendUrl,!0):!1);a&&(this.legendElements=[{type:"symbol-table",title:d.title,infos:[{src:a,opacity:this.opacity}]}])}this.notifyChange("ready")};da._constructLegendElementsForWMSSublayers=function(){var d=J._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");
const a=this.layer;let h=null;if(a.customParameters||a.customLayerParameters)h={...a.customParameters,...a.customLayerParameters};this._handles.add(x.watch(this.layer,"sublayers",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");this.legendElements=yield this._generateLegendElementsForWMSSublayers(a.sublayers,h);this.notifyChange("ready")});return function(){return d.apply(this,arguments)}}();da._generateLegendElementsForWMSSublayers=function(){var d=J._asyncToGenerator(function*(a,
h){const B=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");a=a.toArray();for(const K of a)a=K.watch(["title","visible","legendEnabled"],()=>this._constructLegendElementsForWMSSublayers()),this._handles.add(a,"wms-sublayers-watcher"),(!this.respectLayerVisibility||K.visible&&K.legendEnabled)&&(a=yield this._generateSymbolTableElementForWMSSublayer(K,h))&&a.infos.length&&B.unshift(a);return B});return function(a,h){return d.apply(this,
arguments)}}();da._generateSymbolTableElementForWMSSublayer=function(){var d=J._asyncToGenerator(function*(a,h){return!a.legendUrl&&a.sublayers?(h=(yield this._generateLegendElementsForWMSSublayers(a.sublayers,h)).filter(B=>B),{type:"symbol-table",title:a.title,infos:h}):this._generateSymbolTableElementForLegendUrl(a,h)});return function(a,h){return d.apply(this,arguments)}}();da._generateSymbolTableElementForLegendUrl=function(){var d=J._asyncToGenerator(function*(a,h){var B;let K=a.legendUrl;if(K){var R=
{type:"symbol-table",title:a.title||a.name||a.id&&a.id+"",infos:[]};h&&(K+="?"+D.objectToQuery(h));h=null;a=null==(B=a.layer)?void 0:B.opacity;try{if(h=(yield v(K,{responseType:"image"})).data)h.style.opacity=a}catch{}R.infos.push({src:K,preview:h,opacity:a});return R}});return function(a,h){return d.apply(this,arguments)}}();da._getLegendLayers=function(d,a){const h=Aa&&Aa[d];return h?Promise.resolve(h):this._legendRequest(a).then(B=>{B=B.layers;return Aa[d]=B})};da._legendRequest=function(d){var a=
this.layer;d={f:"json",dynamicLayers:d};if("esri.layers.ImageryLayer"===a.declaredClass){var h=a.exportImageServiceParameters.renderingRule;h&&(d.renderingRule=JSON.stringify(h.toJSON()));a.bandIds&&(d.bandIds=a.bandIds.join());if(a.raster||a.viewId){const {raster:B,viewId:K}=a;d={raster:B,viewId:K,...d}}}h=a.url.replace(/(\/)+$/,"");"version"in a&&10.01<=a.version?(a=h.indexOf("?"),h=-1<a?h.substring(0,a)+"/legend"+h.substring(a):h+"/legend"):(a=h.toLowerCase().indexOf("/rest/"),a=h.substring(0,
a)+h.substring(a+5,h.length),h="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(a)+"\x26returnbytes\x3dtrue");return v(h,{query:d}).then(B=>B.data)};da._constructLegendElementsForBuildingSceneLayer=function(){var d=J._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("sublayers-watcher");const a=this.layer;this._handles.add(x.watch(a,"sublayers",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=yield this._generateLegendElementsForBuildingSublayers(a.sublayers,
this.opacity),this.notifyChange("ready")}catch(h){ea.warn("Request to server for legend has failed!",h)}});return function(){return d.apply(this,arguments)}}();da._generateLegendElementsForBuildingSublayers=function(){var d=J._asyncToGenerator(function*(a,h){let B=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");a=a.toArray();for(const R of a)if(a=R.watch(["renderer","opacity","title","visible"],()=>this._constructLegendElementsForBuildingSceneLayer()),
this._handles.add(a,"sublayers-watcher"),!this.respectLayerVisibility||R.visible){a=R&&null!=R.opacity?R.opacity:null;var K=null!=a?a*h:h;"building-group"===R.type?(a={type:"symbol-table",title:R.title,infos:[]},K=yield this._generateLegendElementsForBuildingSublayers(R.sublayers,K),a.infos.push(...K),B=[a,...B]):R.renderer&&(B=[...yield this._getRendererLegendElements(R.renderer,{title:R.title,opacity:K,sublayer:R}),...B])}return B.filter(R=>!!R&&("infos"in R?0<R.infos.length:!0))});return function(a,
h){return d.apply(this,arguments)}}();da._constructLegendElementsForSublayers=function(){var d=J._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("sublayers-watcher");const a=this.layer;this._handles.add(x.watch(a,"sublayers",()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=yield this._generateLegendElementsForSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(h){ea.warn("Request to server for legend has failed!",
h)}});return function(){return d.apply(this,arguments)}}();da._generateLegendElementsForSublayers=function(){var d=J._asyncToGenerator(function*(a,h,B){const K=this.layer;let R=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");a=a.toArray();!B&&this.sublayerIds&&this.sublayerIds.length&&(a=this.sublayerIds.map(X=>K.findSublayerById(X)).filter(Boolean));for(const X of a)if(a=X.watch("renderer, opacity, title, visible, legendEnabled",()=>this._constructLegendElementsForSublayers()),
this._handles.add(a,"sublayers-watcher"),!this.respectLayerVisibility||X.visible&&X.legendEnabled&&this._isSublayerInScale(X))a=X&&null!=X.opacity?X.opacity:null,a=null!=a?a*h:h,X.renderer&&!X.sublayers&&2<X.originIdOf("renderer")?(yield X.load(),R=[...yield this._getRendererLegendElements(X.renderer,{title:X.title,opacity:a,sublayer:X}),...R]):(a=yield this._generateSymbolTableElementForSublayer(X,a,B))&&R.unshift(a);return R.filter(X=>!!X&&("infos"in X?0<X.infos.length:!0))});return function(a,
h,B){return d.apply(this,arguments)}}();da._generateSymbolTableElementForSublayer=function(){var d=J._asyncToGenerator(function*(a,h,B){if(!B){B=new Map;var K=new m.ExportImageParameters({layer:this.layer});const R=K.hasDynamicLayers?K.dynamicLayers:null;K.destroy();(yield this._getLegendLayers(R||`${this.layer.uid}-${a.id}-default`,R)).forEach(X=>B.set(X.layerId,X))}K=B.get(a.id);return!K&&a.sublayers?(h=yield this._generateLegendElementsForSublayers(a.sublayers,h,B),{type:"symbol-table",title:a.title,
infos:h}):this._generateSymbolTableElementForLegendLayer(K,a,h)});return function(a,h,B){return d.apply(this,arguments)}}();da._generateSymbolTableElementForLegendLayer=function(d,a,h){var B;if(!d||!d.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(d,a))return null;var K=null==a?void 0:a.renderer;let R=(null==a?void 0:a.title)||d.layerName;K&&(!a||2<(null==a?void 0:a.originIdOf("renderer")))&&(K=(null==a?void 0:a.title)||this._getRendererTitle(K,a))&&(R&&"string"!==typeof K&&"title"in
K&&(K.title=R),R=K);const X={type:"symbol-table",title:R,legendType:d.legendType?d.legendType:null,infos:[]},ba=a?this._sanitizeLegendForSublayer(d.legend.slice(),a):d.legend;0<(null==(B=d.legendGroups)?void 0:B.length)?d.legendGroups.forEach(la=>{var ta;const va={type:"symbol-table",title:la.heading,legendType:d.legendType?d.legendType:null,infos:this._generateSymbolTableElementInfosForLegendLayer(ba.filter(aa=>aa.groupId===la.id),d.layerId,h)};0<(null==(ta=va.infos)?void 0:ta.length)&&X.infos.push(va)}):
X.infos=this._generateSymbolTableElementInfosForLegendLayer(ba,d.layerId,h);return 0<X.infos.length?X:null};da._generateSymbolTableElementInfosForLegendLayer=function(d,a,h){return d.map(B=>{let K=B.url;if(B.imageData&&0<B.imageData.length)K=`data:image/png;base64,${B.imageData}`;else if(0!==K.indexOf("http"))K=r.addTokenParameter(`${this.layer.url}/${a}/images/${K}`);else return null;return{label:B.label,src:K,opacity:null==h?this.opacity:h,width:B.width,height:B.height}}).filter(B=>!!B)};da._isSublayerInScale=
function(d){const a=d.minScale||0;d=d.maxScale||0;return 0<a&&a<this.scale||d>this.scale?!1:!0};da._isLegendLayerInScale=function(d,a){a=a||this.layer;let h=null,B=null,K=!0;!a.minScale&&0!==a.minScale||!a.maxScale&&0!==a.maxScale?(0===d.minScale&&a.tileInfo&&(h=a.tileInfo.lods[0].scale),0===d.maxScale&&a.tileInfo&&(B=a.tileInfo.lods[a.tileInfo.lods.length-1].scale)):(h=Math.min(a.minScale,d.minScale)||a.minScale||d.minScale,B=Math.max(a.maxScale,d.maxScale));if(0<h&&h<this.scale||B>this.scale)K=
!1;return K};da._sanitizeLegendForSublayer=function(d,a){if("version"in this.layer&&10.1>this.layer.version||0===d.length)return d;a=a.renderer;let h=null,B=null;d.some(K=>K.values)&&d.some((K,R)=>{K.values||(h=R,B=K,B.label||(B.label="others"));return null!=B});a?"unique-value"===a.type?B&&(d.splice(h,1),d.push(B)):"class-breaks"===a.type&&(B&&d.splice(h,1),d.reverse(),B&&d.push(B)):B&&(d.splice(h,1),d.push(B));return d};da._getRendererLegendElements=function(){var d=J._asyncToGenerator(function*(a,
h={}){var B=this.view;B=I(a)||S(a)||Y(a)||ia(a)||Z(a)?"2d"===B.type||g.isSupportedRenderer3D(a):"raster-stretch"===a.type||"raster-colormap"===a.type||"raster-shaded-relief"===a.type||ja(a)||na(a)||ka(a)||"vector-field"===a.type;return B?ja(a)||na(a)||ka(a)||"esri.renderers.PointCloudRGBRenderer"===a.declaredClass?this._constructPointCloudRendererLegendElements(a,h):Z(a)?this._constructDotDensityRendererLegendElements(a):this._constructRendererLegendElements(a,h):(ea.warn(`Renderer of type '${a.type}' not supported!`),
[])});return function(a){return d.apply(this,arguments)}}();da._getPointCloudRendererTitle=function(d){return d.legendOptions&&d.legendOptions.title||d.field};da._constructPointCloudRendererLegendElements=function(d,a={}){a=a.title;const h=[];let B=null;var K=null;if(ja(d))B={type:"symbol-table",title:a||this._getPointCloudRendererTitle(d),infos:[]},d.colorClassBreakInfos.forEach(R=>{B.infos.unshift({label:R.label||R.minValue+" - "+R.maxValue,value:[R.minValue,R.maxValue],symbol:this._getAppliedCloneSymbol(wa,
R.color)})});else if(na(d)){K=d.stops;let R=null;if(K.length&&(1===K.length&&(R=K[0].color),!R)){const X=K[0].value,ba=K[K.length-1].value;null!=X&&null!=ba&&(R=u.getColorFromPointCloudStops(X+(ba-X)/2,K))}B={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(wa,R||wa.color)}]};K=u.getRampStopsForPointCloud(d.stops);K={type:"color-ramp",title:a||this._getPointCloudRendererTitle(d),infos:K,preview:E.renderColorRampPreviewHTML(K.map(X=>X.color))}}else ka(d)&&
(B={type:"symbol-table",title:a||this._getPointCloudRendererTitle(d),infos:[]},d.colorUniqueValueInfos.forEach(R=>{B.infos.push({label:R.label||R.values.join(", "),value:R.values.join(", "),symbol:this._getAppliedCloneSymbol(wa,R.color)})}));B&&B.infos.length&&h.push(B);K&&K.infos.length&&h.push(K);a=h.reduce((R,X)=>R.concat(X.infos),[]).filter(R=>!!R.symbol).map(R=>this._getSymbolPreview(R,this.opacity,{symbolConfig:{applyColorModulation:!!d.colorModulation}}));return C.eachAlways(a).then(()=>h)};
da._getElementInfoForDotDensity=function(d,a){const {backgroundColor:h,outline:B,dotSize:K}=d,R=K+"-"+a+"-"+h+"-"+(B&&JSON.stringify(B.toJSON())),X=this._dotDensityUrlCache;d=X.has(R)?X.get(R):E.renderDotDensityPreviewHTML(d,a);X.set(R,d);return{opacity:1,src:d.src,preview:d,width:d.width,height:d.height}};da._constructDotDensityRendererLegendElements=function(d){const a=d.calculateDotValue(this.view.scale),h={type:"symbol-table",title:{value:a&&Math.round(a),unit:d.legendOptions&&d.legendOptions.unit||
""},infos:[]};d.attributes.forEach(B=>{const K=this._getElementInfoForDotDensity(d,B.color);K.label=B.label||B.valueExpressionTitle||B.field;h.infos.push(K)});return Promise.resolve([h])};da._constructRendererLegendElements=function(){var d=J._asyncToGenerator(function*(a,h={}){const {title:B,sublayer:K}=h,R=K||this.layer;a=yield this._loadRenderer(a);this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const X=(yield this._getVisualVariableLegendElements(a,
R))||[],ba={type:"symbol-table",title:B||this._getRendererTitle(a,R),infos:[]};let la=null,ta=!1;const va=new Set;if(ha(a)){var aa=B,ma=fa(a)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",ua=X.findIndex(oa=>"color-ramp"===oa.type);ua=X.splice(ua,1)[0];var qa=X.findIndex(oa=>"size-ramp"===oa.type);qa=X.splice(qa,1)[0];var za=[];ua&&(aa=ua.title,za.push(ua));qa&&(aa=qa.title,za.push(qa));0<za.length&&X.push({type:ma,title:aa,infos:za})}else if(ia(a))aa=P.getHeatmapRampStops(a),X.push({type:"heatmap-ramp",
title:B,infos:aa,preview:E.renderColorRampPreviewHTML(aa.map(oa=>oa.color))});else if(Y(a)){if((ma=a&&a.authoringInfo)&&"relationship"===ma.type){const {focus:oa,numClasses:xa,field1:Ca,field2:Da}=ma;if(xa&&Ca&&Da){ua=[Ca,Da];ma=V.getRotationAngleForFocus(oa)||0;for(aa of ua){const {field:Ha,normalizationField:Ea,label:Ia}=aa;ua=Ia||{field:this._getFieldAlias(Ha,R),normField:Ea&&this._getFieldAlias(Ea,R)};qa=Ga.clone();qa.angle=ma;ba.infos.push({label:ua,symbol:qa});va.add(qa);ma+=90}aa=V.getRelationshipRampElement({focus:oa,
numClasses:xa,infos:a.uniqueValueInfos});X.unshift(aa)}}else{const oa=a.field;a.uniqueValueInfos.forEach(xa=>{xa.symbol&&ba.infos.push({label:xa.label||this._getDomainName(oa,xa.value,R)||xa.value,value:xa.value,symbol:xa.symbol})})}a.defaultSymbol&&(ba.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),ta=!0)}else if(S(a))la=this._isUnclassedRenderer(a),la&&this._hasSizeRamp||(a.classBreakInfos.forEach(oa=>{oa.symbol&&ba.infos.unshift({label:oa.label||(la?null:oa.minValue+" - "+
oa.maxValue),value:[oa.minValue,oa.maxValue],symbol:oa.symbol})}),la&&(ba.title=null),this._updateInfosforClassedSizeRenderer(a,ba.infos)),a.defaultSymbol&&!la&&(ba.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),ta=!0);else if("raster-stretch"===a.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass&&"Map"===(null==(qa=this.layer)?void 0:null==(za=qa.raster)?void 0:za.tileType))this._getServerSideLegend();else if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||
"esri.layers.WCSLayer"===this.layer.declaredClass)aa=this._constructTileImageryStretchRendererElements(a),"stretch-ramp"===aa.type?X.push(aa):ba.infos=aa;else{aa=this.layer;a.statistics&&a.statistics.length?(qa=null!=a.statistics[0].min?a.statistics[0].min:a.statistics[0][0],ua=null!=a.statistics[0].max?a.statistics[0].max:a.statistics[0][1]):(qa=null==(ua=a)?void 0:ua.outputMin,ua=null==(ma=a)?void 0:ma.outputMax);ma=[];ma=A.unwrap(aa.renderingRule?yield aa.generateRasterInfo(aa.renderingRule):aa.serviceRasterInfo);
const oa=ma.keyProperties.BandProperties;1===ma.bandCount?(qa=null!=qa?qa:ma.statistics&&ma.statistics[0].min,ua=null!=ua?ua:ma.statistics&&ma.statistics[0].max,qa||ua?X.push(this._getStretchLegendElements(a,{min:qa,max:ua})):this._getServerSideLegend()):aa.bandIds&&1===aa.bandIds.length?(qa=null!=qa?qa:ma.statistics&&ma.statistics[aa.bandIds[0]].min,ua=null!=ua?ua:ma.statistics&&ma.statistics[aa.bandIds[0]].max,qa||ua?X.push(this._getStretchLegendElements(a,{min:qa,max:ua})):this._getServerSideLegend()):
3<=ma.bandCount?oa&&oa.length>=ma.bandCount?aa.bandIds&&3===aa.bandIds.length?(ma=aa.bandIds.map(xa=>oa[xa].BandName),ba.infos=this._createSymbolTableElementMultiBand(ma)):"lerc"===aa.format?(ma=[0,1,2].map(xa=>oa[xa].BandName),ba.infos=this._createSymbolTableElementMultiBand(ma)):this._getServerSideLegend():"lerc"===aa.format?(ma=["band1","band2","band3"],ba.infos=this._createSymbolTableElementMultiBand(ma)):this._getServerSideLegend():this._getServerSideLegend()}else if("raster-colormap"===a.type)a.colormapInfos.forEach(oa=>
{ba.infos.push({label:oa.label,value:oa.value,symbol:this._getAppliedCloneSymbol(Fa,oa.color)})});else if(I(a)){aa=a.symbol;switch(h.geometryType){case "point":aa="pointSymbol"in R&&R.pointSymbol;break;case "polyline":aa="lineSymbol"in R&&R.lineSymbol;break;case "polygon":aa="polygonSymbol"in R&&R.polygonSymbol}a.symbol&&!this._hasSizeRamp&&ba.infos.push({label:a.label,symbol:aa})}else"vector-field"===a.type?(a.outputUnit&&(this.title="("+a.toJSON().outputUnit+")"),ba.title=a.attributeField,aa=a.getClassBreakInfos(),
null!=aa&&aa.length?aa.forEach(oa=>{ba.infos.push({label:oa.minValue+" - "+oa.maxValue,symbol:oa.symbol})}):ba.infos.push({label:a.attributeField,symbol:a.getDefaultSymbol()})):"raster-shaded-relief"===a.type&&X.push(this._getStretchLegendElements(a,{min:0,max:255}));aa=a.defaultSymbol;!aa||ta||I(a)||la&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||X.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:aa}]});ba.infos.length&&X.unshift(ba);const Ja=null==h.opacity?
this.opacity:h.opacity,Ka=this._isTallSymbol("visualVariables"in a&&a.visualVariables),La="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass;h=X.reduce((oa,xa)=>oa.concat(this._getAllInfos(xa)),[]).filter(oa=>!(!oa||!oa.symbol)).map(oa=>this._getSymbolPreview(oa,Ja,{applyScaleDrivenSize:!va.has(oa.symbol),symbolConfig:{isTall:Ka,isSquareFill:La}}));a=null;yield C.eachAlways(h);return X});return function(a){return d.apply(this,arguments)}}();
da._getServerSideLegend=function(){setTimeout(()=>this.buildLegendElementsForTools(),0)};da._getAllInfos=function(d){const a=null==d?void 0:d.infos;return a?a.reduce((h,B)=>h.concat(this._getAllInfos(B)),[]):[d]};da._constructTileImageryStretchRendererElements=function(d){function a(ta){var va;const aa=(null!=K&&null!=(va=K.bandIds)&&va.length?K.bandIds:Array.from(Array(Math.min(R.bandCount,3)).keys())).map(ma=>ta&&ta[ma]&&ta[ma].BandName||"band"+(ma+1));3>aa.length?aa.push(aa[1]):3<aa.length&&aa.splice(3);
return aa}var h,B;const K=this.layer,R=K.rasterInfo,X=R.bandCount||d.statistics.length;var ba,la=[];la=R.keyProperties&&R.keyProperties.BandProperties;(ba=null!=d&&null!=(h=d.statistics)&&h.length?d.statistics:null==R?void 0:R.statistics)?(h=void 0!==ba[0].min?ba[0].min:ba[0][0],ba=ba[0].max||ba[0][1]):(ba=ya[K.rasterInfo.pixelType.toLowerCase()],h=ba[0],ba=ba[1]);K.hasStandardTime()&&(h=K.getStandardTimeValue(h),ba=K.getStandardTimeValue(ba));if(1===R.bandCount||1===(null==(B=K.bandIds)?void 0:B.length))return this._getStretchLegendElements(d,
{min:h,max:ba});la=la&&la.length>=X?a(la):a();return this._createSymbolTableElementMultiBand(la)};da._getStretchLegendElements=function(d,a){d=u.getStrectchRampStops(d.colorRamp,a);return{type:"stretch-ramp",title:"",infos:d,preview:E.renderColorRampPreviewHTML(d.map(h=>h.color))}};da._createSymbolTableElementMultiBand=function(d){const a=[],h=["red","green","blue"];d.forEach((B,K)=>{a.push({label:{colorName:h[K],bandName:B},src:q.RGB_IMG_SOURCE[K],opacity:1})});return a};da._updateInfosforClassedSizeRenderer=
function(d,a){const h=d.authoringInfo&&"class-breaks-size"===d.authoringInfo.type,B=d.classBreakInfos.some(K=>l.isVolumetricSymbol(K.symbol));if(h&&B){const K=c.REAL_WORLD_MAX_SIZE;d=d.classBreakInfos.length;const R=(K-c.REAL_WORLD_MIN_SIZE)/(1<d?d-1:d);a.forEach((X,ba)=>{X.size=K-R*ba})}};da._isTallSymbol=function(d){let a=!1,h=!1;if(d)for(let B=0;B<d.length&&(!a||!h);B++){const K=d[B];"size"===K.type&&("height"===K.axis&&(a=!0),"width-and-depth"===K.axis&&(h=!0))}return a&&h};da._getSymbolPreview=
function(){var d=J._asyncToGenerator(function*(a,h,B){var K=null==a.size&&this._hasSizeRamp?O.px2pt(22):a.size;this._scaleDrivenSizeVariable&&null!=B&&B.applyScaleDrivenSize&&({getSize:K}=yield new Promise(function(R,X){G(["../../../renderers/visualVariables/support/visualVariableUtils"],R,X)}),K=K(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===a.symbol.type?a.symbol.style:null}));return E.renderPreviewHTML(a.symbol,{size:K,opacity:h,scale:!1,symbolConfig:null==
B?void 0:B.symbolConfig}).then(R=>{a.preview=R;return a}).catch(()=>{a.preview=null;return a})});return function(a,h,B){return d.apply(this,arguments)}}();da._loadRenderer=function(){var d=J._asyncToGenerator(function*(a){var h,B;const K=[];var R=this.layer;a=a.clone();this._hasClusterSizeVariable=!1;const X="visualVariables"in a&&(null==(h=a.visualVariables)?void 0:h.some(la=>"size"===la.type&&"outline"!==la.target&&!sa.test(la.valueExpression)));if(a&&"visualVariables"in a&&!X&&"featureReduction"in
R&&"cluster"===(null==(B=R.featureReduction)?void 0:B.type)&&(h=A.unwrap(p.getClusterSizeVariable(this.layerView._effectiveRenderer,this.view)))){R=R.featureReduction;if("clusterMinSize"in R&&"clusterMaxSize"in R){const {clusterMinSize:la,clusterMaxSize:ta}=R;h.legendOptions=new y({showLegend:la!==ta})}a.visualVariables=(a.visualVariables||[]).concat([h]);this._hasClusterSizeVariable=!0}const ba=yield this._getMedianColor(a);if(S(a)||Y(a))R=(a.classBreakInfos||a.uniqueValueInfos).map(la=>this._fetchSymbol(la.symbol,
ba).then(ta=>{la.symbol=ta}).catch(()=>{la.symbol=null})),Array.prototype.push.apply(K,R);K.push(this._fetchSymbol(a.symbol||a.defaultSymbol,a.defaultSymbol?null:ba).then(la=>{this._applySymbolToRenderer(a,la,I(a))}).catch(()=>{this._applySymbolToRenderer(a,null,I(a))}));return C.eachAlways(K).then(()=>a)});return function(a){return d.apply(this,arguments)}}();da._applySymbolToRenderer=function(d,a,h){h?d.symbol=a:d.defaultSymbol=a};da._getMedianColor=function(){var d=J._asyncToGenerator(function*(a){if(!("visualVariables"in
a&&a.visualVariables))return null;a=a.visualVariables.find(K=>"color"===K.type);if(!a)return null;var h=null,B=null;if(a.stops){if(1===a.stops.length)return a.stops[0].color;h=a.stops[0].value;B=a.stops[a.stops.length-1].value}h+=(B-h)/2;({getColor:B}=yield new Promise(function(K,R){G(["../../../renderers/visualVariables/support/visualVariableUtils"],K,R)}));return B(a,h)});return function(a){return d.apply(this,arguments)}}();da._fetchSymbol=function(d,a){if(!d)return Promise.reject();if("web-style"===
d.type){var h=d.portal;h=d.name+"-"+d.styleName+"-"+d.styleUrl+"-"+(h&&h.url)+"-"+(h&&h.user&&h.user.username);const B=this._webStyleSymbolCache;B.has(h)||("2d"===this.view.type?B.set(h,d.fetchCIMSymbol()):B.set(h,d.fetchSymbol()));return B.get(h).then(K=>this._getAppliedCloneSymbol(K,a)).catch(()=>{ea.warn("Fetching web-style failed!");return Promise.reject()})}return Promise.resolve(this._getAppliedCloneSymbol(d,a))};da._getAppliedCloneSymbol=function(d,a){if(!d||!a)return d;d=d.clone();const h=
a&&a.toRgba();-1<d.type.indexOf("3d")?this._applyColorTo3dSymbol(d,h):"cim"===d.type?k.applyCIMSymbolColor(d,a):d.color&&(d.color=new w(h||d.color));return d};da._applyColorTo3dSymbol=function(d,a){a&&d.symbolLayers.forEach(h=>{h&&(h.material||(h.material={}),h.material.color=new w(a))})};da._getVisualVariableLegendElements=function(){var d=J._asyncToGenerator(function*(a,h){var B=this;if(!("visualVariables"in a&&a.visualVariables)||"vector-field"===a.type)return null;var K=a.visualVariables,R=[];
const X=[],ba=[];for(const va of K)"color"===va.type?R.push(va):"size"===va.type?X.push(va):"opacity"===va.type&&ba.push(va);K=[...R,...X,...ba];let la;if(0===R.length&&S(a)&&a.classBreakInfos&&1===a.classBreakInfos.length)var ta=(ta=a.classBreakInfos[0])&&ta.symbol;0===R.length&&I(a)&&(ta=a.symbol);ta&&(-1<ta.type.indexOf("3d")?(R=ta.symbolLayers.getItemAt(0),"water"===R.type?A.isSome(R.color)&&(la=R.color):A.isSome(R.material)&&A.isSome(R.material.color)&&(la=R.material.color)):ta.url||(la=ta.color));
return(yield Promise.all(K.map(function(){var va=J._asyncToGenerator(function*(aa){if(!aa.legendOptions||!1!==aa.legendOptions.showLegend){const ua=B._getRampTitle(aa,h);let qa=null;var ma="getField"in h&&h.getField&&h.getField(aa.field);ma=ma&&M.isDateField(ma);"color"===aa.type?(aa=yield u.getRampStops(aa,null,ma),qa={type:"color-ramp",title:ua,infos:aa,preview:E.renderColorRampPreviewHTML(aa.map(za=>za.color))},B._hasColorRamp||(B._hasColorRamp=!(null==qa.infos||!qa.infos.length))):"size"===aa.type&&
"outline"!==aa.target?sa.test(aa.valueExpression)?B._hasClusterSizeVariable||(B._scaleDrivenSizeVariable=aa):(qa={type:"size-ramp",title:B._hasClusterSizeVariable?B._getClusterTitle(aa):ua,infos:yield c.getRampStops(a,aa,yield B._getMedianColor(a),B.scale,B.view.type,ma)},B._hasSizeRamp||(B._hasSizeRamp=!(null==qa.infos||!qa.infos.length))):"opacity"===aa.type&&(aa=yield u.getRampStops(aa,la,ma),qa={type:"opacity-ramp",title:ua,infos:aa,preview:E.renderColorRampPreviewHTML(aa.map(za=>za.color))},
B._hasOpacityRamp||(B._hasOpacityRamp=!(null==qa.infos||!qa.infos.length)));return qa&&qa.infos?qa:null}});return function(aa){return va.apply(this,arguments)}}()))).filter(va=>!!va)});return function(a,h){return d.apply(this,arguments)}}();da._getDomainName=function(d,a,h){return d&&"function"!==typeof d?(h=(d="getField"in h&&h.getField&&h.getField(d))&&"getFieldDomain"in h&&h.getFieldDomain?h.getFieldDomain(d.name):null)&&"coded-value"===h.type?h.getName(a):null:null};da._getClusterTitle=function(d){var a=
this.layer;d=d.field;if("featureReduction"in a&&a.featureReduction&&"cluster"===a.featureReduction.type&&(a=a.featureReduction,a=(a="popupTemplate"in a&&a.popupTemplate)&&a.fieldInfos))for(const h of a)if(h.fieldName===d)return"cluster_count"===d?h.label||{showCount:!0}:h.label;return{showCount:!0}};da._getRampTitle=function(d,a){let h=d.field,B=d.normalizationField,K=!1,R=!1,X=!1;var ba=null;h="function"===typeof h?null:h;B="function"===typeof B?null:B;ba=d.legendOptions&&d.legendOptions.title;if(null==
ba)if(d.valueExpressionTitle)ba=d.valueExpressionTitle;else{if("renderer"in a&&a.renderer&&"authoringInfo"in a.renderer&&a.renderer.authoringInfo&&a.renderer.authoringInfo.visualVariables)for(d=a.renderer.authoringInfo.visualVariables,ba=0;ba<d.length;ba++){const la=d[ba];if("color"===la.type){if("ratio"===la.style){K=!0;break}if("percent"===la.style){R=!0;break}if("percent-of-total"===la.style){X=!0;break}}}ba={field:h&&this._getFieldAlias(h,a),normField:B&&this._getFieldAlias(B,a),ratio:K,ratioPercent:R,
ratioPercentTotal:X}}return ba};da._getRendererTitle=function(d,a){if(d.legendOptions&&d.legendOptions.title)return d.legendOptions.title;if(d.valueExpressionTitle)return d.valueExpressionTitle;let h=d.field,B=null,K=null;S(d)&&(B=d.normalizationField,K="percent-of-total"===d.normalizationType);h="function"===typeof h?null:h;B="function"===typeof B?null:B;d=null;if(h||B)d={field:h&&this._getFieldAlias(h,a),normField:B&&this._getFieldAlias(B,a),normByPct:K};return d};da._getFieldAlias=function(d,a){var h=
"popupTemplate"in a&&a.popupTemplate;h=h&&h.fieldInfos;let B=null;h&&h.some(R=>d===R.fieldName?(B=R,!0):!1);h=null;"getField"in a&&a.getField?h=a.getField(d):"fieldsIndex"in a&&a.fieldsIndex&&(h=a.fieldsIndex.get(d));a=B||h;let K=null;a&&(K=B&&B.label||h&&h.alias||"name"in a&&a.name||"fieldName"in a&&a.fieldName);return K};da._isUnclassedRenderer=function(d){const a=d.visualVariables;let h=!1;S(d)&&d.classBreakInfos&&1===d.classBreakInfos.length&&a&&(h=d.field?a.some(B=>!(!B||d.field!==B.field||(d.normalizationField||
B.normalizationField)&&d.normalizationField!==B.normalizationField)):!!a.length);return h};J._createClass(Ba,[{key:"opacity",get:function(){var d;const a=this.layer.opacity,h=null==(d=this.parent)?void 0:d.opacity;d=(d=this.layer.parent)&&"uid"in d?this._getParentLayerOpacity(d):null;return null!=h?h*a:null!=d?d*a:a}},{key:"ready",get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}},{key:"scale",get:function(){return this.view&&this.view.scale}},
{key:"isScaleDriven",get:function(){var d=this.layer;if(null===d)return!1;if("featureReduction"in d&&d.featureReduction&&"cluster"===d.featureReduction.type)return!0;if("renderer"in d&&d.renderer){if("dot-density"===d.renderer.type)return!0;const a=d.get("renderer.valueExpression");if(sa.test(a))return!0;if(d=d.get("renderer.visualVariables"))return d.some(h=>this._isScaleDrivenSizeVariable(h))}return this._isLayerScaleDriven(this.layer)}},{key:"version",get:function(){return this._get("version")+
1}}]);return Ba}(W);H.__decorate([F.property()],N.prototype,"children",void 0);H.__decorate([F.property()],N.prototype,"layerView",void 0);H.__decorate([F.property()],N.prototype,"layer",void 0);H.__decorate([F.property()],N.prototype,"legendElements",void 0);H.__decorate([F.property({readOnly:!0})],N.prototype,"opacity",null);H.__decorate([F.property()],N.prototype,"parent",void 0);H.__decorate([F.property({readOnly:!0,dependsOn:[]})],N.prototype,"ready",null);H.__decorate([F.property()],N.prototype,
"keepCacheOnDestroy",void 0);H.__decorate([F.property()],N.prototype,"respectLayerVisibility",void 0);H.__decorate([F.property({readOnly:!0})],N.prototype,"scale",null);H.__decorate([F.property()],N.prototype,"sublayerIds",void 0);H.__decorate([F.property({readOnly:!0})],N.prototype,"isScaleDriven",null);H.__decorate([F.property()],N.prototype,"title",void 0);H.__decorate([F.property({readOnly:!0,dependsOn:["ready"],value:0})],N.prototype,"version",null);H.__decorate([F.property()],N.prototype,"view",
void 0);return N=H.__decorate([Q.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],N)})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/ensureType ../../core/Logger ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ./commonProperties ./sublayerUtils".split(" "),
function(G,J,H,w,r,v,N,W,U,e,t,z,A){const C={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};G.ExportImageParameters=function(O){function D(F){F=O.call(this,F)||this;F.scale=0;return F}J._inheritsLoose(D,O);var x=D.prototype;x.destroy=function(){this.layer=null};x.toJSON=function(){var F=
this.layer;F={dpi:F.dpi,format:F.imageFormat,transparent:F.imageTransparency,gdbVersion:F.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?F.dynamicLayers=this.dynamicLayers:F={...F,layers:this.layers,layerDefs:this.layerDefs};return F};J._createClass(D,[{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;const F=this.visibleSublayers.map(T=>T.toExportImageJSON());return F.length?JSON.stringify(F):null}},{key:"hasDynamicLayers",get:function(){return this.layer&&A.isExportDynamic(this.visibleSublayers,
this.layer.serviceSublayers,this.layer)}},{key:"layer",set:function(F){this._get("layer")!==F&&(this._set("layer",F),this.handles.remove("layer"),F&&this.handles.add([F.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),F.on("sublayer-update",T=>this.notifyChange(C[T.propertyName]))],"layer"))}},{key:"layers",get:function(){const F=this.visibleSublayers;return F?F.length?"show:"+F.map(T=>T.id).join(","):"show:-1":null}},{key:"layerDefs",get:function(){const F=this.visibleSublayers.filter(T=>
null!=T.definitionExpression);return F.length?JSON.stringify(F.reduce((T,L)=>{T[L.id]=L.definitionExpression;return T},{})):null}},{key:"version",get:function(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");this.commitProperty("timeExtent");const F=this.layer;F&&(F.commitProperty("dpi"),F.commitProperty("imageFormat"),F.commitProperty("imageTransparency"),F.commitProperty("gdbVersion"));return(this._get("version")||0)+1}},{key:"visibleSublayers",
get:function(){const F=[];if(!this.layer)return F;var T=this.layer.sublayers;const L=Q=>{const m=this.scale,M=0===Q.minScale||m<=Q.minScale,n=0===Q.maxScale||m>=Q.maxScale;Q.visible&&(0===m||M&&n)&&(Q.sublayers?Q.sublayers.forEach(L):F.unshift(Q))};T&&T.forEach(L);T=this._get("visibleSublayers");return!T||T.length!==F.length||T.some((Q,m)=>F[m]!==Q)?F:T}}]);return D}(r.HandleOwnerMixin(w));H.__decorate([v.property({readOnly:!0})],G.ExportImageParameters.prototype,"dynamicLayers",null);H.__decorate([v.property({readOnly:!0})],
G.ExportImageParameters.prototype,"hasDynamicLayers",null);H.__decorate([v.property()],G.ExportImageParameters.prototype,"layer",null);H.__decorate([v.property({readOnly:!0})],G.ExportImageParameters.prototype,"layers",null);H.__decorate([v.property({readOnly:!0})],G.ExportImageParameters.prototype,"layerDefs",null);H.__decorate([v.property({type:Number})],G.ExportImageParameters.prototype,"scale",void 0);H.__decorate([v.property(z.combinedViewLayerTimeExtentProperty)],G.ExportImageParameters.prototype,
"timeExtent",void 0);H.__decorate([v.property({readOnly:!0})],G.ExportImageParameters.prototype,"version",null);H.__decorate([v.property({readOnly:!0})],G.ExportImageParameters.prototype,"visibleSublayers",null);G.ExportImageParameters=H.__decorate([t.subclass("esri.layers.mixins.ExportImageParameters")],G.ExportImageParameters);Object.defineProperty(G,"__esModule",{value:!0})})},"esri/layers/support/sublayerUtils":function(){define(["exports"],function(G){function J(H,w){if(!H||!H.length)return!0;
w=w.slice().reverse().flatten(({sublayers:N})=>N&&N.toArray().reverse()).map(N=>N.id).toArray();if(H.length>w.length)return!1;let r=0;const v=w.length;for(const {id:N}of H){for(;r<v&&w[r]!==N;)r++;if(r>=v)return!1}return!0}G.isExportDynamic=function(H,w,r){return H.some(v=>{const N=v.source;return!(!N||"map-layer"===N.type&&N.mapLayerId===v.id&&(!N.gdbVersion||N.gdbVersion===r.gdbVersion))||2<v.originIdOf("renderer")||2<v.originIdOf("labelingInfo")||2<v.originIdOf("opacity")||2<v.originIdOf("labelsVisible")})?
!0:!J(H,w)};G.isSublayerOverhaul=function(H){return!!H&&H.some(w=>null!=w.minScale||w.layerDefinition&&null!=w.layerDefinition.minScale)};G.shouldWriteSublayerStructure=function(H,w,r){return w.flatten(({sublayers:v})=>v).length!==H.length||H.some(v=>v.originIdOf("minScale")>r||v.originIdOf("maxScale")>r||v.originIdOf("renderer")>r||v.originIdOf("labelingInfo")>r||v.originIdOf("opacity")>r||v.originIdOf("labelsVisible")>r||v.originIdOf("source")>r)?!0:!J(H,w)};Object.defineProperty(G,"__esModule",
{value:!0})})},"esri/renderers/support/rendererConversion":function(){define(["exports","../../core/has","../../core/Error","../../core/maybe","../../symbols/support/symbolConversion"],function(G,J,H,w,r){function v(e){return w.isNone(e)||"simple"===e.type||"unique-value"===e.type||"class-breaks"===e.type||"dictionary"===e.type}function N(e,t){if(!t)return null;t=Array.isArray(t)?t:[t];if(0<t.length){const z=t.map(C=>C.details.symbol.type||C.details.symbol.declaredClass).filter(C=>!!C);z.sort();const A=
[];z.forEach((C,O)=>{0!==O&&C===z[O-1]||A.push(C)});return new H("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${A.join(", ")}) which are not supported in 3D`,{renderer:e,symbolErrors:t})}return null}function W(e){const t=e.uniqueValueInfos.map(A=>r.to3D(A.symbol).error).filter(A=>!!A),z=r.to3D(e.defaultSymbol);z.error&&t.unshift(z.error);return N(e,t)}function U(e){const t=e.classBreakInfos.map(A=>r.to3D(A.symbol).error).filter(A=>!!A),z=r.to3D(e.defaultSymbol);z.error&&
t.unshift(z.error);return N(e,t)}G.isSupportedRenderer3D=v;G.validateTo3D=function(e){if(w.isNone(e))return null;if(!v(e))return new H("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${e.type||e.declaredClass}'`,{renderer:e});switch(e.type){case "simple":return N(e,r.to3D(e.symbol).error);case "unique-value":return W(e);case "class-breaks":return U(e)}return null};Object.defineProperty(G,"__esModule",{value:!0})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports",
"../../../renderers/visualVariables/SizeVariable"],function(G,J){const H=(w,r)=>{w=w.featuresTilingScheme.getClosestInfoForScale(w.scale).level;return null!=r&&r.levels?r.levels[w]:null};G.getClusterSizeVariable=function(w,r){if(!(w&&"visualVariables"in w&&w.visualVariables))return null;w=w.visualVariables.find(v=>"size"===v.type);return(r=H(r,w))?new J({field:w.field,minSize:r[2].size,minDataValue:r[2].value,maxSize:r[3].size,maxDataValue:r[3].value}):null};Object.defineProperty(G,"__esModule",{value:!0})})},
"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../chunks/_rollupPluginBabelHelpers","../../../Color","./utils"],function(G,J,H,w,r){function v(A,C){const O=[],D=A.length-1;5===A.length?O.push(0,2,4):O.push(0,D);return A.map((x,F)=>-1<O.indexOf(F)?r.createStopLabel(x,F,D,C):null)}function N(){N=H._asyncToGenerator(function*(A,C,O){let D=!1,x=[],F=[];if(A.stops){var T=A.stops;x=T.map(Q=>Q.value);(D=T.some(Q=>!!Q.label))&&(F=T.map(Q=>Q.label))}T=x[x.length-
1];if(null==x[0]&&null==T)return null;const L=D?null:v(x,O);return(yield Promise.all(x.map(function(){var Q=H._asyncToGenerator(function*(m,M){const n="opacity"===A.type?yield W(m,A,C):(yield new Promise(function(g,y){G(["../../../renderers/visualVariables/support/visualVariableUtils"],g,y)})).getColor(A,m);return{value:m,color:n,label:D?F[M]:L[M]}});return function(m,M){return Q.apply(this,arguments)}}()))).reverse()});return N.apply(this,arguments)}function W(A,C){return U.apply(this,arguments)}
function U(){U=H._asyncToGenerator(function*(A,C,O=z){O=new w(O);A=(yield new Promise(function(D,x){G(["../../../renderers/visualVariables/support/visualVariableUtils"],D,x)})).getOpacity(C,A);null!=A&&(O.a=A);return O});return U.apply(this,arguments)}function e(A,C){const {startIndex:O,endIndex:D,weight:x}=t(A,C);if(O===D)return C[O].color;A=w.blendColors(C[O].color,C[D].color,x);return new w(A)}function t(A,C){let O=0,D=C.length-1;C.some((x,F)=>{if(A<x.value)return D=F,!0;O=F;return!1});return{startIndex:O,
endIndex:D,weight:(A-C[O].value)/(C[D].value-C[O].value)}}const z=new w([64,64,64]);J.getColorFromPointCloudStops=e;J.getRampStops=function(A,C,O){return N.apply(this,arguments)};J.getRampStopsForPointCloud=function(A){let C=!1,O=[],D=[];O=A.map(T=>T.value);(C=A.some(T=>!!T.label))&&(D=A.map(T=>T.label));const x=O[O.length-1];if(null==O[0]&&null==x)return null;const F=C?null:v(O,!1);return O.map((T,L)=>{const Q=e(T,A);return{value:T,color:Q,label:C?D[L]:F[L]}}).reverse()};J.getStrectchRampStops=function(A,
C){let O=[];if(A&&"multipart"===A.type)A.colorRamps.reverse().forEach(function(D,x){0===x?O.push({value:C.max,color:new w(D.toColor),label:"high"}):O.push({value:null,color:new w(D.toColor),label:""});x===A.colorRamps.length-1?O.push({value:C.min,color:new w(D.fromColor),label:"low"}):O.push({value:null,color:new w(D.fromColor),label:""})});else{let D,x;A&&"algorithmic"===A.type?(D=A.fromColor,x=A.toColor):(D=[0,0,0,1],x=[255,255,255,1]);O=[{value:C.max,color:new w(x),label:"high"},{value:C.min,color:new w(D),
label:"low"}]}return O};Object.defineProperty(J,"__esModule",{value:!0})})},"esri/widgets/Legend/support/utils":function(){define(["exports","../../../intl/date","../../../renderers/support/numberUtils"],function(G,J,H){const w=J.convertDateFormatToIntlOptions("short-date");G.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];G.createStopLabel=function(r,v,N,W){let U="";0===v?U="\x3c ":v===N&&(U="\x3e ");v=null;v=W?J.formatDate(r,w):H.format(r);return U+v};Object.defineProperty(G,"__esModule",{value:!0})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],function(G,
J,H){function w(t,z){return t-z}function r(t,z){let A;A=Number(t.toFixed(z));A<t?t=A+1/10**z:(t=A,A-=1/10**z);A=Number(A.toFixed(z));t=Number(t.toFixed(z));return[A,t]}function v(t,z,A,C,O){t=W(t,z,A,C);z=null==t.next||t.next<=O;return(null==t.previous||t.previous<=O)&&z||t.previous+t.next<=2*O}function N(t){t=String(t);var z=t.match(U);if(z&&z[1])return{integer:z[1].split("").length,fractional:z[3]?z[3].split("").length:0};if(-1<t.toLowerCase().indexOf("e")&&(z=t.split("e"),t=z[0],z=z[1],t&&z)){t=
Number(t);z=Number(z);const A=0<z;A||(z=Math.abs(z));t=N(t);A?(t.integer+=z,t.fractional=z>t.fractional?0:t.fractional-z):(t.fractional+=z,t.integer=z>t.integer?1:t.integer-z);return t}return{integer:0,fractional:0}}function W(t,z,A,C){const O={previous:null,next:null};if(null!=A){const D=t-A;O.previous=Math.floor(Math.abs(100*(z-A-D)/D))}null!=C&&(t=C-t,O.next=Math.floor(Math.abs(100*(C-z-t)/t)));return O}const U=/^-?(\d+)(\.(\d+))?$/i,e={maximumFractionDigits:20};G.format=function(t){return H.formatNumber(t,
e)};G.numDigits=N;G.percentChange=W;G.round=function(t,z={}){t=t.slice(0);const {tolerance:A=2,strictBounds:C=!1,indexes:O=t.map((x,F)=>F)}=z;O.sort(w);for(z=0;z<O.length;z++){const x=O[z],F=t[x],T=0===x?null:t[x-1],L=x===t.length-1?null:t[x+1],Q=N(F).fractional;if(Q){let m=0,M=!1;for(var D=void 0;m<=Q&&!M;)D=r(F,m),D=C&&0===z?D[1]:D[0],M=v(F,D,T,L,A),m++;M&&(t[x]=D)}}return t};Object.defineProperty(G,"__esModule",{value:!0})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports",
"../../../renderers/support/HeatmapColorStop"],function(G,J){G.getHeatmapRampStops=function(H){H=H.colorStops;let w=H.length-1;if(H&&H[0]){const r=H[w];r&&1!==r.ratio&&(H=H.slice(0),H.push(new J({ratio:1,color:r.color})),w++)}return H.map((r,v)=>{let N="";0===v?N="low":v===w&&(N="high");return{color:r.color,label:N,ratio:r.ratio}}).reverse()};Object.defineProperty(G,"__esModule",{value:!0})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils",
"../../../symbols/support/previewSymbol3D"],function(G,J,H,w){function r(e){if(e){var {type:t}=e;return-1<t.indexOf("3d")?w.getSymbolLayerFill(e.symbolLayers.getItemAt(0)):"simple-line"===t||"simple-marker"===e.type&&("x"===e.style||"cross"===e.style)?(e=H.getStroke(e))&&e.color:H.getFill(e)}}function v(e,t){const z=t.HH.label,A=t.LL.label,C=t.HL.label;t=t.LH.label;switch(e){case "HH":return{top:z,bottom:A,left:C,right:t};case "HL":return{top:C,bottom:t,left:A,right:z};case "LL":return{top:A,bottom:z,
left:t,right:C};case "LH":return{top:t,bottom:C,left:z,right:A};default:return{top:z,bottom:A,left:C,right:t}}}function N(e){let t=W[e];e&&null==t&&(t=W.HH);return t||0}const W={HH:315,HL:45,LL:135,LH:225},U={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};G.getRelationshipRampColors2D=function(e,t){const z=[],A=e.length**.5;e=J.clone(e);var C=(t||"HH").split("");
t=C[0];for(C="H"===C[1];e.length;){const O=[];for(;O.length<A;)O.push(e.shift());C&&O.reverse();z.push(O)}"L"===t&&z.reverse();return z};G.getRelationshipRampElement=function(e){const {focus:t,infos:z,numClasses:A}=e;var C=U[A];const O={};z.forEach(D=>{O[D.value]={label:D.label,fill:r(D.symbol)}});e=[];for(let D=0;D<A;D++){const x=[];for(let F=0;F<A;F++)x.push(O[C[D][F]].fill);e.push(x)}C=v(t,O);return{type:"relationship-ramp",numClasses:A,focus:t,colors:e,labels:C,rotation:N(t)}};G.getRotationAngleForFocus=
N;Object.defineProperty(G,"__esModule",{value:!0})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./styleUtils ./utils".split(" "),function(G,J,H,w,r,v,N,W,U,e,t,z,A,C,O,D,x){function F(b){const f=
b.outline;var I=W.isSome(b.material)?b.material.color:null;I=W.isSome(I)?I.toHex():null;if(W.isNone(f))return"fill"===b.type&&"#ffffff"===I?{color:"#bdc3c7",width:.75}:null;b=e.pt2px(f.size)||0;return{color:"rgba("+(W.isSome(f.color)?f.color.toRgba():"255,255,255,1")+")",width:Math.min(b,80)}}function T(b,f){var I=f&&f.resource;I=I&&I.href;if(b.thumbnail&&b.thumbnail.url)return Promise.resolve(b.thumbnail.url);if(I&&"object"!==f.type)return Promise.resolve(x.getIconHref(b,f));const S=H.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");
return b.styleOrigin&&(b.styleOrigin.styleName||b.styleOrigin.styleUrl)?D.resolveWebStyleSymbol(b.styleOrigin,{portal:b.styleOrigin.portal},"webRef").catch(Y=>Y).then(Y=>{var ia;return(null==Y?void 0:null==(ia=Y.thumbnail)?void 0:ia.url)||S}):Promise.resolve(S)}function L(b,f=1){const I=b.a;b=w.toHSV(b);const {r:S,g:Y,b:ia}=w.toRGB({h:b.h,s:b.s/f,v:100-(100-b.v)/f});return[S,Y,ia,I]}function Q(b){return"water"===b.type?W.isNone(b.color)?null:b.color:W.isNone(b.material)||W.isNone(b.material.color)?
null:b.material.color}function m(b,f=0){var I=Q(b);if(!I){if("fill"===b.type)return null;f=C.adjustColorComponentBrightness(t.defaultThematicColor.r,f);return[f,f,f,100]}b=I.toRgba();for(I=0;3>I;I++)b[I]=C.adjustColorComponentBrightness(b[I],f);return b}function M(b,f){return n.apply(this,arguments)}function n(){n=J._asyncToGenerator(function*(b,f){b=b.style;return"none"===b?null:{type:"pattern",x:0,y:0,src:yield t.getPatternUrlWithColor(H.getAssetUrl(`esri/symbols/patterns/${b}.png`),f.toCss(!0)),
width:5,height:5}});return n.apply(this,arguments)}function g(b){return b.outline?F(b):{color:"rgba(0, 0, 0, 1)",width:1.5}}function y(b,f){b=Q(b);if(!b)return null;let I;I="rgba("+(C.adjustColorComponentBrightness(b.r,f)+",");I+=C.adjustColorComponentBrightness(b.g,f)+",";I+=C.adjustColorComponentBrightness(b.b,f)+",";return I+b.a+");"}function k(b,f){f=y(b,f);if(!f)return{};b=Math.min(b.size?e.pt2px(b.size):.75,80);return{color:f,width:b}}function E(b,f,I){I*=.75;return{type:"linear",x1:I?.25*I:
0,y1:I?.5*I:0,x2:I||4,y2:I?.5*I:4,colors:[{color:b,offset:0},{color:f,offset:1}]}}function l(b){const f=b.depth,I=b.height;return(b=b.width)&&f&&I&&b===f&&b<I}function p(b,f,I){const S=[];if(!b)return S;switch(b.type){case "icon":switch(b.resource&&b.resource.primitive||z.defaultPrimitive){case "circle":S.push({shape:{type:"circle",cx:0,cy:0,r:.5*f},fill:m(b,0),stroke:F(b)});break;case "square":S.push({shape:{type:"path",path:[{command:"M",values:[0,f]},{command:"L",values:[0,0]},{command:"L",values:[f,
0]},{command:"L",values:[f,f]},{command:"Z",values:[]}]},fill:m(b,0),stroke:F(b)});break;case "triangle":S.push({shape:{type:"path",path:[{command:"M",values:[0,f]},{command:"L",values:[.5*f,0]},{command:"L",values:[f,f]},{command:"Z",values:[]}]},fill:m(b,0),stroke:F(b)});break;case "cross":S.push({shape:{type:"path",path:[{command:"M",values:[.5*f,0]},{command:"L",values:[.5*f,f]},{command:"M",values:[0,.5*f]},{command:"L",values:[f,.5*f]}]},stroke:g(b)});break;case "x":S.push({shape:{type:"path",
path:[{command:"M",values:[0,0]},{command:"L",values:[f,f]},{command:"M",values:[f,0]},{command:"L",values:[0,f]}]},stroke:g(b)});break;case "kite":S.push({shape:{type:"path",path:[{command:"M",values:[0,.5*f]},{command:"L",values:[.5*f,0]},{command:"L",values:[f,.5*f]},{command:"L",values:[.5*f,f]},{command:"Z",values:[]}]},fill:m(b,0),stroke:F(b)})}break;case "object":switch(b.resource&&b.resource.primitive||A.defaultPrimitive){case "cone":var Y=m(b,0);b=m(b,-.6);b=E(Y,b,I?20:f);f=C.getConeShapes(f,
I);S.push({shape:f[0],fill:b});S.push({shape:f[1],fill:b});break;case "inverted-cone":I=m(b,0);b=m(b,-.6);b=E(I,b,f);f=C.getInvertedConeShapes(f);S.push({shape:f[0],fill:b});S.push({shape:f[1],fill:I});break;case "cube":f=C.getCubeShapes(f,I);S.push({shape:f[0],fill:m(b,0)});S.push({shape:f[1],fill:m(b,-.3)});S.push({shape:f[2],fill:m(b,-.5)});break;case "cylinder":{Y=m(b,0);const ia=m(b,-.6);Y=E(Y,ia,I?20:f);f=C.getCylinderShapes(f,I);S.push({shape:f[0],fill:Y});S.push({shape:f[1],fill:Y});S.push({shape:f[2],
fill:m(b,0)});break}case "diamond":f=C.getDiamondShapes(f);S.push({shape:f[0],fill:m(b,-.3)});S.push({shape:f[1],fill:m(b,0)});S.push({shape:f[2],fill:m(b,-.3)});S.push({shape:f[3],fill:m(b,-.7)});break;case "sphere":I=m(b,0);b=m(b,-.6);b=E(I,b);b.x1=0;b.y1=0;b.x2=.25*f;b.y2=.25*f;S.push({shape:{type:"circle",cx:0,cy:0,r:.5*f},fill:b});break;case "tetrahedron":f=C.getTetrahedronShapes(f),S.push({shape:f[0],fill:m(b,-.3)}),S.push({shape:f[1],fill:m(b,0)}),S.push({shape:f[2],fill:m(b,-.6)})}}return S}
function u(b,f){const I=f&&f.size?e.pt2px(f.size):null,S=f&&f.maxSize?e.pt2px(f.maxSize):null,Y=f&&f.disableUpsampling,ia=b.symbolLayers,ja=[];let na=0,ka=0;const Z=ia.getItemAt(ia.length-1);let ca;Z&&"icon"===Z.type&&(ca=Z.size&&e.pt2px(Z.size));ia.forEach(ha=>{if("icon"===ha.type||"object"===ha.type){var fa="icon"===ha.type?ha.size&&e.pt2px(ha.size):0,ea=I||fa?Math.ceil(Math.min(I||fa,S||120)):22;if(ha&&ha.resource&&ha.resource.href){var sa=T(b,ha).then(function(ra){const ya=ha.get("material.color");
var wa="icon"===ha.type?"multiply":"tint";return O.tintImageWithColor(ra,ea,ya,wa,Y)}).then(function(ra){const ya=ra.width,wa=ra.height;na=Math.max(na,ya);ka=Math.max(ka,wa);return[{shape:{type:"image",x:0,y:0,width:ya,height:wa,src:ra.url},fill:null,stroke:null}]});ja.push(sa)}else{let ra=ea;"icon"===ha.type&&ca&&I&&(ra=fa/ca*ea);fa="tall"===(null==f?void 0:f.symbolConfig)||(null==f?void 0:null==(sa=f.symbolConfig)?void 0:sa.isTall)||("object"===ha.type?l(ha):!1);na=Math.max(na,fa?20:ra);ka=Math.max(ka,
ra);ja.push(Promise.resolve(p(ha,ra,fa)))}}});return U.eachAlways(ja).then(function(ha){const fa=[];ha.forEach(function(ea){ea.value?fa.push(ea.value):ea.error&&q.warn("error while building swatchInfo!",ea.error)});return O.renderSymbol(fa,[na,ka],{node:f&&f.node,scale:!1,opacity:f&&f.opacity})})}function P(b,f){const I=b.symbolLayers,S=[];b=x.isVolumetricSymbol(b);const Y=f&&f.size?e.pt2px(f.size):null,ia=(f&&f.maxSize?e.pt2px(f.maxSize):null)||80;let ja=0,na=0,ka;I.forEach((Z,ca)=>{if(Z&&("line"===
Z.type||"path"===Z.type)){var ha=[];switch(Z.type){case "line":var fa=k(Z,0),ea=fa&&fa.width||0;0===ca&&(ka=ea);var sa=Math.min(Y||ea,ia);ca=0===ca?sa:Y?ea/ka*sa:sa;ea=20<ca?2*ca:40;na=Math.max(na,ca);ja=Math.max(ja,ea);fa.width=ca;ha.push({shape:{type:"path",path:[{command:"M",values:[0,.5*na]},{command:"L",values:[ja,.5*na]}]},stroke:fa});break;case "path":ca=Math.min(Y||22,ia);fa=m(Z,0);ea=m(Z,-.2);var ra=y(Z,-.4);ra=ra?{color:ra,width:1}:{};if("quad"===Z.profile){var ya;const wa=null!=(ya=Z.width)?
ya:Z.size;Z=null!=(sa=Z.height)?sa:Z.size;sa=C.getPathSymbolShapes(wa&&Z?wa/Z:1,0===Z,0===wa);Z={...ra,join:"bevel"};ha.push({shape:sa[0],fill:ea,stroke:Z});ha.push({shape:sa[1],fill:ea,stroke:Z});ha.push({shape:sa[2],fill:fa,stroke:Z})}else ha.push({shape:C.shapes.pathSymbol3DLayer[0],fill:ea,stroke:ra}),ha.push({shape:C.shapes.pathSymbol3DLayer[1],fill:fa,stroke:ra});ja=na=Math.max(na,ca)}S.push(ha)}});return Promise.resolve(O.renderSymbol(S,[ja,na],{node:f&&f.node,scale:b,opacity:f&&f.opacity}))}
function V(b,f){return c.apply(this,arguments)}function c(){c=J._asyncToGenerator(function*(b,f){const I="mesh-3d"===b.type;b=b.symbolLayers;var S=f&&f.size?e.pt2px(f.size):null;const Y=f&&f.maxSize?e.pt2px(f.maxSize):null;S=S||22;const ia=[];let ja=0,na=0;var ka=!1;for(let sa=0;sa<b.length;sa++){var Z=b.getItemAt(sa);const ra=[];if(!I||"fill"===Z.type){var ca=C.shapes.fill[0];switch(Z.type){case "fill":var ha=F(Z);ka=Math.min(S,Y||120);ja=Math.max(ja,ka);na=Math.max(na,ka);ka=!0;var fa=m(Z,0),ea=
"pattern"in Z&&Z.pattern;Z=Q(Z);!I&&W.isSome(ea)&&"style"===ea.type&&"solid"!==ea.style&&Z&&(fa=yield M(ea,Z));ra.push({shape:ca,fill:fa,stroke:ha});break;case "line":Z={stroke:k(Z,0),shape:ca};ja=Math.max(ja,22);na=Math.max(na,22);ra.push(Z);break;case "extrude":ca={join:"round",...k(Z,-.4)};ha=m(Z,0);Z=m(Z,-.2);fa=Math.min(S,Y||120);ea=C.getExtrudeSymbolShapes(fa);ca.width=1;ra.push({shape:ea[0],fill:Z,stroke:ca});ra.push({shape:ea[1],fill:Z,stroke:ca});ra.push({shape:ea[2],fill:ha,stroke:ca});
Z=22*.7+.5*fa;ja=Math.max(ja,22);na=Math.max(na,Z);break;case "water":ka=Q(Z),Z=L(ka),ca=L(ka,2),ha=L(ka,3),fa=C.getWaterSymbolShapes(),ka=!0,ra.push({shape:fa[0],fill:Z}),ra.push({shape:fa[1],fill:ca}),ra.push({shape:fa[2],fill:ha}),Z=Math.min(S,Y||120),ja=Math.max(ja,Z),na=Math.max(na,Z)}ia.push(ra)}}return Promise.resolve(O.renderSymbol(ia,[ja,na],{node:f&&f.node,scale:ka,opacity:f&&f.opacity}))});return c.apply(this,arguments)}const q=N.getLogger("esri.symbols.support.previewSymbol3D");G.getPatternDescriptor=
M;G.getSymbolLayerFill=m;G.previewSymbol3D=function(b,f){if(0===b.symbolLayers.length)return Promise.reject(new v("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));let I=null;switch(b.type){case "point-3d":I=u(b,f);break;case "line-3d":I=P(b,f);break;case "polygon-3d":case "mesh-3d":I=V(b,f)}return I?I:Promise.reject(new v("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(G,"__esModule",{value:!0})})},"esri/core/colorUtils":function(){define(["exports"],
function(G){function J(e,t){const z=[];let A,C;if(e[0].length!==t.length)throw"dimensions do not match";const O=e.length,D=e[0].length;let x=0;for(A=0;A<O;A++){for(C=x=0;C<D;C++)x+=e[A][C]*t[C];z.push(x)}return z}function H(e){e=[e.r/255,e.g/255,e.b/255].map(t=>.04045>=t?t/12.92:((t+.055)/1.055)**2.4);e=J(W,e);return{x:100*e[0],y:100*e[1],z:100*e[2]}}function w(e){e=J(U,[e.x/100,e.y/100,e.z/100]).map(t=>Math.min(1,Math.max(.0031308>=t?12.92*t:1.055*t**(1/2.4)-.055,0)));return{r:Math.round(255*e[0]),
g:Math.round(255*e[1]),b:Math.round(255*e[2])}}function r(e){e=[e.x/95.047,e.y/100,e.z/108.883].map(t=>t>(6/29)**3?t**(1/3):1/3*(29/6)**2*t+4/29);return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}}function v(e){const t=e.l;e=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map(z=>z>6/29?z**3:3*(6/29)**2*(z-4/29));return{x:95.047*e[0],y:100*e[1],z:108.883*e[2]}}function N(e){if("r"in e&&"g"in e&&"b"in e)return e;if("l"in e&&"c"in e&&"h"in e){var t=e.c;var z=e.h;t={l:e.l,a:t*Math.cos(z),b:t*
Math.sin(z)};return w(v(t))}if("l"in e&&"a"in e&&"b"in e)return w(v(e));if("x"in e&&"y"in e&&"z"in e)return w(e);if("h"in e&&"s"in e&&"v"in e){{z=(e.h+360)%360/60;t=e.v/100*255;e=e.s/100*t;const A=e*(1-Math.abs(z%2-1));switch(Math.floor(z)){case 0:z={r:e,g:A,b:0};break;case 1:z={r:A,g:e,b:0};break;case 2:z={r:0,g:e,b:A};break;case 3:z={r:0,g:A,b:e};break;case 4:z={r:A,g:0,b:e};break;case 5:case 6:z={r:e,g:0,b:A};break;default:z={r:0,g:0,b:0}}z.r=Math.round(z.r+t-e);z.g=Math.round(z.g+t-e);z.b=Math.round(z.b+
t-e);t=z}return t}return e}const W=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],U=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];G.darken=function(e,t){e=r(H(e));e.l*=1-t;return w(v(e))};G.toHSV=function(e){if("h"in e&&"s"in e&&"v"in e)return e;var t=N(e);{e=t.r;const z=t.g,A=t.b;t=Math.max(e,z,A);const C=t-Math.min(e,z,A);e=0===C?0:t===e?(z-A)/C%6:t===z?(A-e)/C+2:(e-z)/C+4;0>e&&(e+=6);e={h:60*e,s:100*(0===C?0:C/t),v:100/255*t}}return e};G.toLAB=function(e){return"l"in
e&&"a"in e&&"b"in e?e:r(H(N(e)))};G.toLCH=function(e){if(!("l"in e&&"c"in e&&"h"in e)){{var t=r(H(N(e)));e=t.l;var z=t.a;const A=t.b;t=Math.sqrt(z*z+A*A);z=Math.atan2(A,z);z=0<z?z:z+2*Math.PI;e={l:e,c:t,h:z}}}return e};G.toRGB=N;G.toXYZ=function(e){return"x"in e&&"y"in e&&"z"in e?e:H(N(e))};Object.defineProperty(G,"__esModule",{value:!0})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(G,J){function H(w,r){return Math.round(Math.min(Math.max(w+191.25*r,
0),255))}G.adjustColorBrightness=function(w,r){if("type"in w&&("linear"===w.type||"pattern"===w.type))return w;w=new J(w);return new J([H(w.r,r),H(w.g,r),H(w.b,r),w.a])};G.adjustColorComponentBrightness=H;G.getConeShapes=function(w,r){let v=r?20:w;r=r?4:6;v=22>=v?v-.5*r:v-r;r=.15*v;const N=v;w-=r;return[{type:"ellipse",cx:.5*v,cy:w,rx:.5*v,ry:r},{type:"path",path:[{command:"M",values:[.5*N,0]},{command:"L",values:[N,w]},{command:"L",values:[0,w]},{command:"Z",values:[]}]}]};G.getCubeShapes=function(w,
r){let v=r?20:w;var N=r?4:6;N=v=22>=v?v-.5*N:v-N;r=r?.35*v:.5*v;return[{type:"path",path:[{command:"M",values:[.5*N,0]},{command:"L",values:[N,.5*r]},{command:"L",values:[.5*N,r]},{command:"L",values:[0,.5*r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*r]},{command:"L",values:[.5*N,r]},{command:"L",values:[.5*N,w]},{command:"L",values:[0,w-.5*r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*N,r]},{command:"L",values:[.5*N,w]},{command:"L",values:[N,
w-.5*r]},{command:"L",values:[N,.5*r]},{command:"Z",values:[]}]}]};G.getCylinderShapes=function(w,r){var v=r?20:w;r=r?4:6;v=22>=v?v-.5*r:v-r;r=.5*v;const N=.15*v;w-=N;return[{type:"ellipse",cx:.5*v,cy:w,rx:r,ry:N},{type:"path",path:[{command:"M",values:[0,N]},{command:"L",values:[0,w]},{command:"L",values:[v,w]},{command:"L",values:[v,N]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*v,cy:N,rx:r,ry:N}]};G.getDiamondShapes=function(w){var r=w;r=22>r?r-2:r-4;const v=Math.floor(w/10)-1||1;return[{type:"path",
path:[{command:"M",values:[.45*r,0]},{command:"L",values:[r,.5*w-v]},{command:"L",values:[.45*r-v,.5*w+v]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*r,0]},{command:"L",values:[.45*r-v,.5*w+v]},{command:"L",values:[0,.5*w-v]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*w-v]},{command:"L",values:[.45*r-v,.5*w+v]},{command:"L",values:[.45*r,w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*r,w]},{command:"L",values:[r,.5*
w-v]},{command:"L",values:[.45*r-v,.5*w+v]},{command:"Z",values:[]}]}]};G.getExtrudeSymbolShapes=function(w){w*=.5;return[{type:"path",path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+w]},{command:"L",values:[0,22*.7+w-.7*11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+w]},{command:"L",values:[22,w]},{command:"L",values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};G.getInvertedConeShapes=function(w){let r=w;r=22>r?r-3:r-6;const v=.15*r,N=r;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[N,0]},{command:"L",values:[.5*N,w-v]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*r,cy:0,rx:.5*r,ry:v}]};G.getPathSymbolShapes=function(w,r,v){let N=22,W=22;1>w?N*=.75:1<w&&(W*=1.25);let U=w=22;r&&v&&(N=W=w=U=0);
return[{type:"path",path:[{command:"M",values:[w,0]},{command:"L",values:[v?w:.875*w,0]},{command:"L",values:[v?N-.5*w:0,W-.5*U]},{command:"L",values:[N-.5*w,W-.5*U]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[w,0]},{command:"L",values:[w,r?0:.125*U]},{command:"L",values:[N-.5*w,r?W-.5*U:U]},{command:"L",values:[N-.5*w,W-.5*U]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[N-.5*w,W-.5*U]},{command:"L",values:[v?N-.5*w:0,W-.5*U]},{command:"L",values:[v?N-
.5*w:0,r?W-.5*U:U]},{command:"L",values:[N-.5*w,r?W-.5*U:U]},{command:"Z",values:[]}]}]};G.getTetrahedronShapes=function(w){var r=w;r=22>r?r-1:r-2;return[{type:"path",path:[{command:"M",values:[.45*w,0]},{command:"L",values:[w,r]},{command:"L",values:[.45*w,.6*r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*w,0]},{command:"L",values:[.45*w,.6*r]},{command:"L",values:[0,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,r]},{command:"L",values:[.45*w,
.6*r]},{command:"L",values:[w,r]},{command:"Z",values:[]}]}]};G.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
G.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],
cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],
tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",
path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(G,"__esModule",{value:!0})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils".split(" "),
function(G,J,H,w,r,v,N,W,U){function e(z,A,C){return z?H(z,{responseType:"image"}).then(O=>{O=O.data;const D=O.width,x=O.height,F=D/x;let T=A;C&&(T=Math.min(T,Math.max(D,x)));return{image:O,width:1>=F?Math.ceil(T*F):T,height:1>=F?T:Math.ceil(T/F)}}):Promise.reject(new r("renderUtils: imageDataSize","href not provided."))}const t=W.createProjector();G.renderSymbol=function(z,A,C){const O=Math.ceil(A[0]);A=Math.ceil(A[1]);if(!z.some(x=>!!x.length))return null;const D=C&&C.node||document.createElement("div");
null!=C.opacity&&(D.style.opacity=C.opacity.toString());t.append(D,U.renderSVG.bind(null,z,O,A,C));return D};G.tintImageWithColor=function(z,A,C,O,D){return e(z,A,D).then(x=>{const F=x.width?x.width:A,T=x.height?x.height:A;var L;if(L=x.image)L=C&&"ignore"!==O?"multiply"===O&&255===C.r&&255===C.g&&255===C.b&&1===C.a?!1:!0:!1;if(L){var Q=x.image.width,m=x.image.height;v("edge")&&/\.svg$/i.test(z)&&(--Q,--m);L=Math.ceil(F);var M=Math.ceil(T);var n=document.createElement("canvas");n.width=L;n.height=
M;n.style.width=L+"px";n.style.height=M+"px";n=n.getContext("2d");n.clearRect(0,0,L,M);L=n;L.drawImage(x.image,0,0,Q,m,0,0,F,T);M=L.getImageData(0,0,F,T);n=[C.r/255,C.g/255,C.b/255,C.a];const y=w.toHSV(C);for(let k=0;k<M.data.length;k+=4){x=M.data;Q=k;m=n;var g=y;switch(O){case "multiply":x[Q+0]*=m[0];x[Q+1]*=m[1];x[Q+2]*=m[2];x[Q+3]*=m[3];break;default:{const E=w.toHSV({r:x[Q+0],g:x[Q+1],b:x[Q+2]});E.h=g.h;E.s=g.s;E.v=E.v/100*g.v;g=w.toRGB(E);x[Q+0]=g.r;x[Q+1]=g.g;x[Q+2]=g.b;x[Q+3]*=m[3]}}}L.putImageData(M,
0,0);z=L.canvas.toDataURL("image/png")}else(L=J.id&&J.id.findCredential(z))&&L.token&&(x=-1===z.indexOf("?")?"?":"\x26",z=`${z}${x}token=${L.token}`);return{url:z,width:F,height:T}}).catch(function(){return{url:z,width:A,height:A}})};Object.defineProperty(G,"__esModule",{value:!0})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../core/Logger ../../widgets/support/jsxFactory".split(" "),
function(G,J,H,w,r,v,N,W){function U(c,q){c*=V/180;return Math.abs(q*Math.sin(c))+Math.abs(q*Math.cos(c))}function e(c){return c.map(q=>`${q.command} ${q.values.join(" ")}`).join(" ").trim()}function t(c,q,b,f){if(c){if("circle"===c.type)return W.tsx("circle",{fill:q,"fill-rule":"evenodd",stroke:b.color,"stroke-width":b.width,"stroke-linecap":b.cap,"stroke-linejoin":b.join,"stroke-dasharray":b.dashArray,"stroke-miterlimit":"4",cx:c.cx,cy:c.cy,r:c.r});if("ellipse"===c.type)return W.tsx("ellipse",{fill:q,
"fill-rule":"evenodd",stroke:b.color,"stroke-width":b.width,"stroke-linecap":b.cap,"stroke-linejoin":b.join,"stroke-dasharray":b.dashArray,"stroke-miterlimit":"4",cx:c.cx,cy:c.cy,rx:c.rx,ry:c.ry});if("rect"===c.type)return W.tsx("rect",{fill:q,"fill-rule":"evenodd",stroke:b.color,"stroke-width":b.width,"stroke-linecap":b.cap,"stroke-linejoin":b.join,"stroke-dasharray":b.dashArray,"stroke-miterlimit":"4",x:c.x,y:c.y,width:c.width,height:c.height});if("image"===c.type)return W.tsx("image",{href:c.src,
x:c.x,y:c.y,width:c.width,height:c.height,preserveAspectRatio:"none"});if("path"===c.type)return c="string"!==typeof c.path?e(c.path):c.path,W.tsx("path",{fill:q,"fill-rule":"evenodd",stroke:b.color,"stroke-width":b.width,"stroke-linecap":b.cap,"stroke-linejoin":b.join,"stroke-dasharray":b.dashArray,"stroke-miterlimit":"4",d:c});if("text"===c.type)return W.tsx("text",{fill:q,"fill-rule":"evenodd",stroke:b.color,"stroke-width":b.width,"stroke-linecap":b.cap,"stroke-linejoin":b.join,"stroke-dasharray":b.dashArray,
"stroke-miterlimit":"4","text-anchor":f.align,"text-decoration":f.decoration,kerning:f.kerning,rotate:f.rotate,"text-rendering":k,"font-style":f.font.style,"font-variant":f.font.variant,"font-weight":f.font.weight,"font-size":f.font.size,"font-family":f.font.family,x:c.x,y:c.y},c.text)}return null}function z(c){const q={fill:"none",pattern:null,linearGradient:null};if(c)if("type"in c&&"pattern"===c.type){var b=`patternId-${++g}`;q.fill=`url(#${b})`;q.pattern={id:b,x:c.x,y:c.y,width:c.width,height:c.height,
image:{x:0,y:0,width:c.width,height:c.height,href:c.src}}}else"type"in c&&"linear"===c.type?(b=`linearGradientId-${++y}`,q.fill=`url(#${b})`,q.linearGradient={id:b,x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2,stops:c.colors.map(f=>({offset:f.offset,color:f.color&&(new J(f.color)).toString()}))}):c&&(c=new J(c),q.fill=c.toString());return q}function A(c){const q={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(c&&(null!=c.width&&(q.width=c.width),c.cap&&(q.cap=c.cap),c.join&&(q.join=c.join.toString()),
c.color&&(q.color=(new J(c.color)).toString()),c.style)){let f=null;c.style in P&&(f=P[c.style]);if(Array.isArray(f)){f=f.slice(0);for(var b=0;b<f.length;++b)f[b]*=c.width;if("butt"!==c.cap){for(b=0;b<f.length;b+=2)f[b]-=c.width,1>f[b]&&(f[b]=1);for(b=1;b<f.length;b+=2)f[b]+=c.width}f=f.join(",")}q.dashArray=f}return q}function C(c,q){const b={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};c&&(b.align=c.align,b.decoration=c.decoration,
b.kerning=c.kerning?"auto":"0",b.rotate=c.rotated?"90":"0",b.font.style=q.style||"normal",b.font.variant=q.variant||"normal",b.font.weight=q.weight||"normal",b.font.size=q.size&&q.size.toString()||"10pt",b.font.family=q.family||"serif");return b}function O(c){const {pattern:q,linearGradient:b}=c;return q?W.tsx("pattern",{id:q.id,patternUnits:"userSpaceOnUse",x:q.x,y:q.y,width:q.width,height:q.height},W.tsx("image",{x:q.image.x,y:q.image.y,width:q.image.width,height:q.image.height,href:q.image.href})):
b?(c=b.stops.map((f,I)=>W.tsx("stop",{key:`${I}-stop`,offset:f.offset,"stop-color":f.color})),W.tsx("linearGradient",{id:b.id,gradientUnits:"userSpaceOnUse",x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2},c)):null}function D(c,q,b){return r.translate(c,r.identity(c),[q,b])}function x(c,q,b,f,I){r.scale(c,r.identity(c),[q,b]);c[4]=c[4]*q-f*q+f;c[5]=c[5]*b-I*b+I;return c}function F(c,q,b,f){var I=q%360*Math.PI/180;r.rotate(c,r.identity(c),I);q=Math.cos(I);I=Math.sin(I);const S=c[4],Y=c[5];c[4]=S*q-Y*I+f*I-b*q+b;c[5]=
Y*q+S*I-b*I-f*q+f;return c}function T(c,q){p&&"left"in p?(p.left>c&&(p.left=c),p.right<c&&(p.right=c),p.top>q&&(p.top=q),p.bottom<q&&(p.bottom=q)):p={left:c,bottom:q,right:c,top:q}}function L(c){const q=c.args,b=q.length;switch(c.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(c=0;c<b;c+=2)T(q[c],q[c+1]);u.x=q[b-2];u.y=q[b-1];break;case "H":for(c=0;c<b;++c)T(q[c],u.y);u.x=q[b-1];break;case "V":for(c=0;c<b;++c)T(u.x,q[c]);u.y=q[b-1];break;case "m":c=0;"x"in u||(T(u.x=q[0],u.y=q[1]),
c=2);for(;c<b;c+=2)T(u.x+=q[c],u.y+=q[c+1]);break;case "l":case "t":for(c=0;c<b;c+=2)T(u.x+=q[c],u.y+=q[c+1]);break;case "h":for(c=0;c<b;++c)T(u.x+=q[c],u.y);break;case "v":for(c=0;c<b;++c)T(u.x,u.y+=q[c]);break;case "c":for(c=0;c<b;c+=6)T(u.x+q[c],u.y+q[c+1]),T(u.x+q[c+2],u.y+q[c+3]),T(u.x+=q[c+4],u.y+=q[c+5]);break;case "s":case "q":for(c=0;c<b;c+=4)T(u.x+q[c],u.y+q[c+1]),T(u.x+=q[c+2],u.y+=q[c+3]);break;case "A":for(c=0;c<b;c+=7)T(q[c+5],q[c+6]);u.x=q[b-2];u.y=q[b-1];break;case "a":for(c=0;c<b;c+=
7)T(u.x+=q[c+5],u.y+=q[c+6])}}function Q(c,q,b){const f=E[c.toLowerCase()];"number"===typeof f&&(f?q.length>=f&&(c={action:c,args:q.slice(0,q.length-q.length%f)},b.push(c),L(c)):(c={action:c,args:[]},b.push(c),L(c)))}function m(c){const q={x:0,y:0,width:0,height:0};if("circle"===c.type)q.x=c.cx-c.r,q.y=c.cy-c.r,q.width=2*c.r,q.height=2*c.r;else if("ellipse"===c.type)q.x=c.cx-c.rx,q.y=c.cy-c.ry,q.width=2*c.rx,q.height=2*c.ry;else if("image"===c.type||"rect"===c.type)q.x=c.x,q.y=c.y,q.width=c.width,
q.height=c.height;else if("path"===c.type){{const I=("string"!==typeof c.path?e(c.path):c.path).match(l),S=[];p={};u={};if(I){c="";var b=[],f=I.length;for(let Y=0;Y<f;++Y){const ia=I[Y],ja=parseFloat(ia);isNaN(ja)?(c&&Q(c,b,S),b=[],c=ia):b.push(ja)}Q(c,b,S);c={x:0,y:0,width:0,height:0};p&&"left"in p&&(c.x=p.left,c.y=p.top,c.width=p.right-p.left,c.height=p.bottom-p.top)}else c=null}q.x=c.x;q.y=c.y;q.width=c.width;q.height=c.height}return q}function M(c){const q={x:0,y:0,width:0,height:0};let b=null,
f=Number.NEGATIVE_INFINITY,I=Number.NEGATIVE_INFINITY;for(const S of c)b?(b.x=Math.min(b.x,S.x),b.y=Math.min(b.y,S.y),f=Math.max(f,S.x+S.width),I=Math.max(I,S.y+S.height)):(b=q,b.x=S.x,b.y=S.y,f=S.x+S.width,I=S.y+S.height);b&&(b.width=f-b.x,b.height=I-b.y);return b}function n(c,q,b,f,I,S,Y,ia){var ja=(Y&&S?U(S,q):q)/2;const na=(Y&&S?U(S,b):b)/2,ka=c.width+f,Z=c.height+f;Y=w.create();const ca=w.create();var ha=!1;if(I&&0!==ka&&0!==Z){I=ka/Z;ha=q>b?q:b;let fa=1,ea=1;isNaN(ha)||(1<I?(fa=ha/ka,ea=ha/
I/Z):(ea=ha/Z,fa=ha*I/ka));r.multiply(ca,ca,x(Y,fa,ea,ja,na));ha=!0}I=c.x+(ka-f)/2;c=c.y+(Z-f)/2;r.multiply(ca,ca,D(Y,ja-I,na-c));!ha&&(ka>q||Z>b)&&(ja=ka/q>Z/b,q=(ja?q:b)/(ja?ka:Z),r.multiply(ca,ca,x(Y,q,q,I,c)));S&&r.multiply(ca,ca,F(Y,S,I,c));ia&&r.multiply(ca,ca,D(Y,ia[0],ia[1]));return`matrix(${ca[0]},${ca[1]},${ca[2]},${ca[3]},${ca[4]},${ca[5]})`}let g=0,y=0;v=H("android");const k=H("chrome")||v&&4<=v?"auto":"optimizeLegibility",E={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},l=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;
let p={},u={};const P={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},V=Math.PI;G.computeBBox=M;G.generateFillAttributes=z;G.generateStrokeAttributes=A;G.generateTextAttributes=C;G.getBoundingBox=m;G.getTransformMatrix=n;G.renderDef=O;G.renderSVG=function(c,q,b,f){const I=[],S=[];for(const ia of c){c=[];var Y=[];let ja=0,na=0,ka=0;for(const Z of ia){const {shape:ca,
fill:ha,stroke:fa,font:ea,offset:sa}=Z;ja+=fa&&fa.width||0;const ra=z(ha),ya=A(fa),wa="text"===ca.type?C(ca,ea):null;I.push(O(ra));c.push(t(ca,ra.fill,ya,wa));Y.push(m(ca));sa&&(na+=sa[0],ka+=sa[1])}Y=n(M(Y),q,b,ja,null==f?void 0:f.scale,null==f?void 0:f.rotation,null==f?void 0:f.useRotationSize,[na,ka]);S.push(W.tsx("g",{transform:Y},c))}null!=f&&f.useRotationSize&&null!=f&&f.rotation&&(q=U(null==f?void 0:f.rotation,q),b=U(null==f?void 0:f.rotation,b));return W.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",
width:q,height:b},W.tsx("defs",null,I),S)};G.renderShape=t;Object.defineProperty(G,"__esModule",{value:!0})})},"esri/chunks/mat2df32":function(){define(["exports"],function(G){function J(){const U=new Float32Array(6);U[0]=1;U[3]=1;return U}function H(U){const e=new Float32Array(6);e[0]=U[0];e[1]=U[1];e[2]=U[2];e[3]=U[3];e[4]=U[4];e[5]=U[5];return e}function w(U,e,t,z,A,C){const O=new Float32Array(6);O[0]=U;O[1]=e;O[2]=t;O[3]=z;O[4]=A;O[5]=C;return O}function r(U,e){return new Float32Array(U,e,6)}
function v(U,e,t,z){const A=e[z];e=e[z+1];U[z]=t[0]*A+t[2]*e+t[4];U[z+1]=t[1]*A+t[3]*e+t[5]}function N(U,e,t,z=0,A=0,C=2){for(A=A||e.length/C;z<A;z++)v(U,e,t,z*C)}var W=Object.freeze({__proto__:null,create:J,clone:H,fromValues:w,createView:r,transform:v,transformMany:N});G.clone=H;G.create=J;G.createView=r;G.fromValues=w;G.mat2df32=W;G.transform=v;G.transformMany=N})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(G,J){function H(n,g){n[0]=g[0];n[1]=g[1];n[2]=g[2];n[3]=g[3];
n[4]=g[4];n[5]=g[5];return n}function w(n){n[0]=1;n[1]=0;n[2]=0;n[3]=1;n[4]=0;n[5]=0;return n}function r(n,g,y,k,E,l,p){n[0]=g;n[1]=y;n[2]=k;n[3]=E;n[4]=l;n[5]=p;return n}function v(n,g){const y=g[0],k=g[1],E=g[2],l=g[3],p=g[4];g=g[5];let u=y*l-k*E;if(!u)return null;u=1/u;n[0]=l*u;n[1]=-k*u;n[2]=-E*u;n[3]=y*u;n[4]=(E*g-l*p)*u;n[5]=(k*p-y*g)*u;return n}function N(n){return n[0]*n[3]-n[1]*n[2]}function W(n,g,y){const k=g[0],E=g[1],l=g[2],p=g[3],u=g[4];g=g[5];const P=y[0],V=y[1],c=y[2],q=y[3],b=y[4];
y=y[5];n[0]=k*P+l*V;n[1]=E*P+p*V;n[2]=k*c+l*q;n[3]=E*c+p*q;n[4]=k*b+l*y+u;n[5]=E*b+p*y+g;return n}function U(n,g,y){const k=g[0],E=g[1],l=g[2],p=g[3],u=g[4];g=g[5];const P=Math.sin(y);y=Math.cos(y);n[0]=k*y+l*P;n[1]=E*y+p*P;n[2]=k*-P+l*y;n[3]=E*-P+p*y;n[4]=u;n[5]=g;return n}function e(n,g,y){const k=g[1],E=g[2],l=g[3],p=g[4],u=g[5],P=y[0];y=y[1];n[0]=g[0]*P;n[1]=k*P;n[2]=E*y;n[3]=l*y;n[4]=p;n[5]=u;return n}function t(n,g,y){const k=g[0],E=g[1],l=g[2],p=g[3],u=g[4];g=g[5];const P=y[0];y=y[1];n[0]=
k;n[1]=E;n[2]=l;n[3]=p;n[4]=k*P+l*y+u;n[5]=E*P+p*y+g;return n}function z(n,g){const y=Math.sin(g);g=Math.cos(g);n[0]=g;n[1]=y;n[2]=-y;n[3]=g;n[4]=0;n[5]=0;return n}function A(n,g){n[0]=g[0];n[1]=0;n[2]=0;n[3]=g[1];n[4]=0;n[5]=0;return n}function C(n,g){n[0]=1;n[1]=0;n[2]=0;n[3]=1;n[4]=g[0];n[5]=g[1];return n}function O(n){return"mat2d("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+")"}function D(n){return Math.sqrt(n[0]**2+n[1]**2+n[2]**2+n[3]**2+n[4]**2+n[5]**2+1)}function x(n,g,y){n[0]=
g[0]+y[0];n[1]=g[1]+y[1];n[2]=g[2]+y[2];n[3]=g[3]+y[3];n[4]=g[4]+y[4];n[5]=g[5]+y[5];return n}function F(n,g,y){n[0]=g[0]-y[0];n[1]=g[1]-y[1];n[2]=g[2]-y[2];n[3]=g[3]-y[3];n[4]=g[4]-y[4];n[5]=g[5]-y[5];return n}function T(n,g,y){n[0]=g[0]*y;n[1]=g[1]*y;n[2]=g[2]*y;n[3]=g[3]*y;n[4]=g[4]*y;n[5]=g[5]*y;return n}function L(n,g,y,k){n[0]=g[0]+y[0]*k;n[1]=g[1]+y[1]*k;n[2]=g[2]+y[2]*k;n[3]=g[3]+y[3]*k;n[4]=g[4]+y[4]*k;n[5]=g[5]+y[5]*k;return n}function Q(n,g){return n[0]===g[0]&&n[1]===g[1]&&n[2]===g[2]&&
n[3]===g[3]&&n[4]===g[4]&&n[5]===g[5]}function m(n,g){const y=n[0],k=n[1],E=n[2],l=n[3],p=n[4];n=n[5];const u=g[0],P=g[1],V=g[2],c=g[3],q=g[4];g=g[5];return Math.abs(y-u)<=J.EPSILON*Math.max(1,Math.abs(y),Math.abs(u))&&Math.abs(k-P)<=J.EPSILON*Math.max(1,Math.abs(k),Math.abs(P))&&Math.abs(E-V)<=J.EPSILON*Math.max(1,Math.abs(E),Math.abs(V))&&Math.abs(l-c)<=J.EPSILON*Math.max(1,Math.abs(l),Math.abs(c))&&Math.abs(p-q)<=J.EPSILON*Math.max(1,Math.abs(p),Math.abs(q))&&Math.abs(n-g)<=J.EPSILON*Math.max(1,
Math.abs(n),Math.abs(g))}var M=Object.freeze({__proto__:null,copy:H,identity:w,set:r,invert:v,determinant:N,multiply:W,rotate:U,scale:e,translate:t,fromRotation:z,fromScaling:A,fromTranslation:C,str:O,frob:D,add:x,subtract:F,multiplyScalar:T,multiplyScalarAndAdd:L,exactEquals:Q,equals:m,mul:W,sub:F});G.add=x;G.copy=H;G.determinant=N;G.equals=m;G.exactEquals=Q;G.frob=D;G.fromRotation=z;G.fromScaling=A;G.fromTranslation=C;G.identity=w;G.invert=v;G.mat2d=M;G.mul=W;G.multiply=W;G.multiplyScalar=T;G.multiplyScalarAndAdd=
L;G.rotate=U;G.scale=e;G.set=r;G.str=O;G.sub=F;G.subtract=F;G.translate=t})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../Color ../../../symbols ../../../renderers/support/numberUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils".split(" "),function(G,J,H,w,r,v,N,W,U){function e(l,p){const u=l.length-1;return l.map((P,V)=>U.createStopLabel(P,V,u,p))}function t(){t=H._asyncToGenerator(function*(l,
p,u,P,V,c){var q,b,f=p.legendOptions;f=f&&f.customValues;const I=C(l,u);var S=null!=p.minSize&&null!=p.maxSize;u=p.stops&&1<p.stops.length;var Y=!!p.target;if(I&&(f||S||u&&!Y)){var ia=W.isVolumetricSymbol(I),ja=null,na=S=null;S=ia&&!u?v.round([p.minDataValue,p.maxDataValue]):f||(yield F(p,I,P,V));f=null==l?void 0:l.authoringInfo;var ka=(Y="univariate-color-size"===(null==f?void 0:f.type))&&"above-and-below"===(null==f?void 0:f.univariateTheme);!S&&u&&(S=p.stops.map(fa=>fa.value),(ja=p.stops.some(fa=>
!!fa.label))&&(na=p.stops.map(fa=>fa.label)));ia&&2<(null==(q=S)?void 0:q.length)&&!ka&&(S=[S[0],S[S.length-1]]);if(!S)return null;Y&&5!==(null==(b=S)?void 0:b.length)&&(S=L({minSize:S[0],maxSize:S[S.length-1]}));var Z=ia?z(l,S):null,ca=W.getSymbolOutlineSize(I),ha=ja?null:e(S,c);return(yield Promise.all(S.map(function(){var fa=H._asyncToGenerator(function*(ea,sa){const ra=ia?Z[sa]:yield M(p,I,ea,P,V),ya=g(ka&&"class-breaks"===l.type?A(l,sa):I,ra);return{value:ea,symbol:ya,label:ja?na[sa]:ha[sa],
size:ra,outlineSize:ca}});return function(ea,sa){return fa.apply(this,arguments)}}()))).reverse()}});return t.apply(this,arguments)}function z(l,p){l=null==l?void 0:l.authoringInfo;const u="univariate-color-size"===(null==l?void 0:l.type);let P=[12,30];if(u){const V=p[0],c=p[p.length-1];P=p.map(q=>12+(q-V)/(c-V)*18)}u&&"below"===(null==l?void 0:l.univariateTheme)&&P.reverse();return P}function A(l,p){const u=l.classBreakInfos,P=u.length;p=2>P||!(2<=p)?u[0].symbol.clone():u[P-1].symbol.clone();l.visualVariables.some(V=>
"color"===V.type)&&(-1<p.type.indexOf("3d")?D(p):x(p));return p}function C(l,p){let u=null,P=null;"simple"===l.type?u=l.symbol:"class-breaks"===l.type?(u=(l=l.classBreakInfos)&&l[0]&&l[0].symbol,P=1<l.length):"unique-value"===l.type&&(u=(l=l.uniqueValueInfos)&&l[0]&&l[0].symbol,P=1<l.length);if(!u||O(u))return null;u=u.clone();if(p||P)-1<u.type.indexOf("3d")?D(u):x(u);return u}function O(l){return l?r.isSymbol3D(l)?l.symbolLayers?l.symbolLayers.some(p=>p&&"fill"===p.type):!1:-1!==l.type.indexOf("fill"):
!1}function D(l){"line-3d"===l.type?l.symbolLayers.forEach(p=>{p.material={color:E}}):l.symbolLayers.forEach(p=>{"icon"!==p.type||p.resource&&p.resource.href?p.material={color:k}:(p.material={color:y},p.outline={color:E,size:1.5})})}function x(l){"cim"===l.type?N.applyCIMSymbolColor(l,new w(k)):-1!==l.type.indexOf("line")?l.color=E:(l.color=y,"simple-marker"===l.type&&(l.outline={color:E,width:1.5}))}function F(l,p,u,P){return T.apply(this,arguments)}function T(){T=H._asyncToGenerator(function*(l,
p,u,P){const V=(yield new Promise(function(b,f){G(["../../../renderers/visualVariables/support/visualVariableUtils"],b,f)})).getSizeRangeAtScale(l,u,P),c=V&&L(V);if(V||c){var q=c.map(b=>{{const f=V.minSize,I=V.maxSize,S=l.minDataValue,Y=l.maxDataValue;let ia=null;b=ia=b<=f?S:b>=I?Y:(b-f)/(I-f)*(Y-S)+S}return b});q=v.round(q);for(let b=1;b<q.length-1;b++){const f=yield Q(l,p,q[b],q[b-1],u,P);f&&(q[b]=f[0],c[b]=f[1])}return q}});return T.apply(this,arguments)}function L(l){const p=l.minSize;l=(l.maxSize-
p)/4;const u=[];for(let P=0;5>P;P++)u.push(p+l*P);return u}function Q(l,p,u,P,V,c){return m.apply(this,arguments)}function m(){m=H._asyncToGenerator(function*(l,p,u,P,V,c){const q=yield M(l,p,u,V,c);P=yield M(l,p,P,V,c);var b=v.numDigits(u),f=b.fractional,I=b.integer;let S=b=null;0<u&&1>u&&(b=10**f,u*=b,I=v.numDigits(u).integer);for(f=I-1;0<=f;f--){var Y=10**f;I=Math.floor(u/Y)*Y;Y*=Math.ceil(u/Y);null!=b&&(I/=b,Y/=b);let ia=(I+Y)/2;[,ia]=v.round([I,ia,Y],{indexes:[1]});const ja=yield M(l,p,I,V,c),
na=yield M(l,p,Y,V,c),ka=yield M(l,p,ia,V,c),Z=v.percentChange(q,ja,P,null),ca=v.percentChange(q,na,P,null),ha=v.percentChange(q,ka,P,null);let fa=20>=Z.previous,ea=20>=ca.previous;fa&&ea&&(Z.previous<=ca.previous?(fa=!0,ea=!1):(ea=!0,fa=!1));fa?S=[I,ja]:ea?S=[Y,na]:20>=ha.previous&&(S=[ia,ka]);if(S)break}return S});return m.apply(this,arguments)}function M(l,p,u,P,V){return n.apply(this,arguments)}function n(){n=H._asyncToGenerator(function*(l,p,u,P,V){const {getSize:c}=yield new Promise(function(q,
b){G(["../../../renderers/visualVariables/support/visualVariableUtils"],q,b)});return c(l,u,{scale:P,view:V,shape:"simple-marker"===p.type?p.style:null})});return n.apply(this,arguments)}function g(l,p){l=l.clone();if(r.isSymbol3D(l))W.isVolumetricSymbol(l)||l.symbolLayers.forEach(u=>{"fill"!==u.type&&(u.size=p)});else if("esri.symbols.SimpleMarkerSymbol"===l.declaredClass)l.size=p;else if("esri.symbols.PictureMarkerSymbol"===l.declaredClass){const u=l.width,P=l.height;l.height=p;l.width=u/P*p}else"esri.symbols.SimpleLineSymbol"===
l.declaredClass?l.width=p:"esri.symbols.TextSymbol"===l.declaredClass&&l.font&&(l.font.size=p);return l}const y=[255,255,255],k=[200,200,200],E=[128,128,128];J.REAL_WORLD_MAX_SIZE=30;J.REAL_WORLD_MIN_SIZE=12;J.getRampStops=function(l,p,u,P,V,c){return t.apply(this,arguments)};Object.defineProperty(J,"__esModule",{value:!0})})},"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/Handles ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../symbols/support/svgUtils ../../Widget ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../support/jsxFactory ../../support/widgetUtils ../../../intl/substitute".split(" "),
function(G,J,H,w,r,v,N,W,U,e,t,z,A,C,O,D,x,F,T,L,Q,m){const M=window.devicePixelRatio;H=function(n){function g(k,E){k=n.call(this,k,E)||this;k._handles=new w;k._hasIndicators=!1;k._selectedSectionName=null;k._sectionNames=[];k._sectionMap=new Map;k.activeLayerInfos=null;k.headingLevel=3;k.layout="stack";k.messages=null;k.messagesCommon=null;k.type="card";k.view=null;return k}G._inheritsLoose(g,n);var y=g.prototype;y.initialize=function(){this.own([this.watch("activeLayerInfos",k=>{this._handles.removeAll();
this._watchForSectionChanges(k)})])};y.destroy=function(){this._handles.destroy();this._handles=null};y.render=function(){this._hasIndicators="auto"===this.layout&&768>=this.view.container.clientWidth||"stack"===this.layout;var k=this.activeLayerInfos;k=k&&k.toArray().map(p=>this._renderLegendForLayer(p)).filter(p=>!!p);this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=
null;const E=this._sectionNames.length;var l=this._sectionNames.map((p,u)=>{u=m.substitute(this.messagesCommon.pagination.pageText,{index:u+1,total:E});return L.tsx("div",{key:p,role:"tab",id:p,"aria-label":u,"aria-controls":`${p}-panel`,"aria-selected":(this._selectedSectionName===p).toString(),tabIndex:this._selectedSectionName===p?0:-1,title:u,onclick:this._selectSection,onkeydown:this._focusSection,bind:this,class:this.classes("esri-legend--card__carousel-indicator",{["esri-legend--card__carousel-indicator--activated"]:this._selectedSectionName===
p}),"data-section-name":p})});l=this._hasIndicators&&1<E?L.tsx("div",{class:"esri-legend--card__carousel-indicator-container",key:"carousel-navigation",role:"tablist"},l):null;k=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):k&&k.length?k:null;return L.tsx("div",{class:this.classes("esri-legend--card",{["esri-legend--stacked"]:this._hasIndicators})},k?k:L.tsx("div",{class:"esri-legend--card__message"},this.messages.noLegend),l)};y._selectSection=function(k){if(k=k.target.getAttribute("data-section-name"))this._selectedSectionName=
k};y._focusSection=function(k){switch(k.key){case "ArrowLeft":case "ArrowRight":this._switchSectionOnArrowPress(k);break;case "Enter":case " ":this._selectSection(k)}};y._switchSectionOnArrowPress=function(k){const E=k.key,l="ArrowLeft"===E?-1:1;k=k.target.getAttribute("data-section-name");k=this._sectionNames.indexOf(k);const p=this._sectionNames;let u=null;-1!==k&&(p[k+l]?u=document.getElementById(p[k+l]):"ArrowLeft"===E?u=document.getElementById(p[p.length-1]):"ArrowRight"===E&&(u=document.getElementById(p[0])),
u&&u.focus())};y._watchForSectionChanges=function(k){this._generateSectionNames();k&&(k.forEach(E=>{const l=`activeLayerInfo-${E.layer.uid}-version-change`;this._handles.remove(l);this._watchForSectionChanges(E.children);this._handles.add(E.watch("version",()=>this._generateSectionNames()),l)}),this._handles.remove("activeLayerInfos-collection-change"),this._handles.add(k.on("change",()=>this._watchForSectionChanges(k)),"activeLayerInfos-collection-change"))};y._generateSectionNames=function(){this._sectionNames.length=
0;this._selectedSectionName=null;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)};y._getSectionName=function(k,E,l){return`${this.id}${k.uid}-type-${E.type}-${l}`};y._generateSectionNamesForActiveLayerInfo=function(k){k.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);k.legendElements&&k.legendElements.forEach((E,l)=>{this._sectionNames.push(this._getSectionName(k.layer,E,l))})};y._renderLegendForLayer=function(k){if(!k.ready)return null;
if(k.children.length){var E=k.children.map(l=>this._renderLegendForLayer(l)).toArray();return L.tsx("div",{key:k.layer.uid,class:this.classes("esri-legend--card__service","esri-legend--card__group-layer")},L.tsx("div",{class:"esri-legend--card__service-caption-container"},k.title),E)}{if((E=k.legendElements)&&!E.length)return null;const l=E.some(p=>"relationship-ramp"===p.type);E=E.map((p,u)=>this._renderLegendForElement(p,k,u,l)).filter(p=>!!p);return E.length?L.tsx("div",{key:k.layer.uid,class:this.classes("esri-legend--card__service",
{["esri-legend--card__group-layer-child"]:!!k.parent})},L.tsx("div",{class:"esri-legend--card__service-caption-container"},L.tsx("div",{class:"esri-legend--card__service-caption-text"},k.title)),L.tsx("div",{class:"esri-legend--card__service-content"},E)):null}};y._renderLegendForElement=function(k,E,l,p=!1){var u="color-ramp"===k.type,P="opacity-ramp"===k.type,V="size-ramp"===k.type;const c=E.layer;var q=null;"string"===typeof k.title?q=k.title:k.title&&(q=k.title,u=D.getTitle(this.messages,q,u||
P),q=q.title?`${q.title} (${u})`:u);l=this._getSectionName(c,k,l);u=this._hasIndicators?L.tsx("div",null,L.tsx(x.Heading,{level:this.headingLevel,class:"esri-legend--card__carousel-title"},E.title),L.tsx(x.Heading,{level:this.headingLevel+1,class:"esri-legend--card__layer-caption"},q)):q?L.tsx(x.Heading,{level:this.headingLevel,class:"esri-legend--card__layer-caption"},q):null;P=null;"symbol-table"===k.type?(V=k.infos.map((b,f)=>this._renderLegendForElementInfo(b,E,k.legendType,f)).filter(b=>!!b),
V.length&&(P=L.tsx("div",{class:this.classes({["esri-legend--card__label-container"]:!(V[0].properties.classes&&V[0].properties.classes["esri-legend--card__symbol-row"])&&!p,["esri-legend--card__relationship-label-container"]:p})},V))):"color-ramp"===k.type||"opacity-ramp"===k.type||"heatmap-ramp"===k.type?P=this._renderLegendForRamp(k,c.opacity):V?P=this._renderSizeRamp(k,c.opacity):"relationship-ramp"===k.type?P=C.renderRelationshipRamp(k,this.id,c.opacity):"univariate-above-and-below-ramp"===k.type?
P=this._renderUnivariateAboveAndBelowRamp(k,c.opacity):"univariate-color-size-ramp"===k.type&&(P=this._renderUnivariateColorSizeRamp(k,c.opacity));if(!P)return null;p=L.tsx("div",{key:l,class:"esri-legend--card__section",id:`${l}-panel`,role:"tabpanel","aria-labelledby":l,tabIndex:0},[u,P]);this._sectionMap.set(l,p);return p};y._renderUnivariateAboveAndBelowRamp=function(k,E){const {sizeRampElement:l,colorRampElement:p}=O.getUnivariateAboveAndBelowRampElements(k,E,"horizontal");k=O.getUnivariateSizeRampSize(l,
"full",!0,"horizontal");var u=O.getUnivariateColorRampSize(l,"above",!0,"horizontal"),P=O.getUnivariateColorRampSize(l,"below",!0,"horizontal");u=O.getUnivariateColorRampPreview(p,{width:u,height:12,rampAlignment:"horizontal",opacity:E,type:"above"});E=O.getUnivariateColorRampPreview(p,{width:P,height:12,rampAlignment:"horizontal",opacity:E,type:"below"});var V=O.getUnivariateColorRampMargin(l,"card");P=l.infos.map(q=>q.label);const c=P.length-1;P=P.map((q,b)=>0===b||b===c?L.tsx("div",{key:b},q):
null);V={marginTop:"3px",marginLeft:`${V}px`,display:"flex"};k={width:`${k}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return L.tsx("div",{class:"esri-legend--card__layer-row",key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},L.tsx("div",{class:this.classes("esri-legend--card__symbol-container","esri-legend__size-ramp--horizontal"),styles:{display:"flex",flexDirection:"row"}},l.infos.map((q,b)=>L.tsx("div",{key:b,class:"esri-legend--card__symbol",bind:q.preview,
afterCreate:D.attachToNode}))),u?L.tsx("div",{class:"esri-univariate-above-and-below-ramp__color--card",styles:V,key:"color-ramp-preview"},L.tsx("div",{bind:u,afterCreate:D.attachToNode}),L.tsx("div",{bind:E,afterCreate:D.attachToNode})):null,L.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},L.tsx("div",{class:"esri-legend__ramp-labels",styles:k},P)))};y._renderUnivariateColorSizeRamp=function(k,E){const {sizeRampElement:l,colorRampElement:p}=O.getUnivariateColorSizeRampElements(k,
"horizontal");k=O.getUnivariateSizeRampSize(l,"full",!1,"horizontal");var u=O.getUnivariateColorRampSize(l,"full",!1,"horizontal");E=O.getUnivariateColorRampPreview(p,{width:u,height:12,rampAlignment:"horizontal",opacity:E,type:"full"});var P=O.getUnivariateColorRampMargin(l,"card");const V=l.infos.length-1;u=l.infos.map((c,q)=>0===q||q===V?L.tsx("div",{key:q},c.label):null);P={marginTop:"3px",marginLeft:`${P}px`,display:"flex"};k={width:`${k}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};
return L.tsx("div",{class:"esri-legend--card__layer-row",key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},L.tsx("div",{class:this.classes("esri-legend--card__symbol-container","esri-legend__size-ramp--horizontal"),styles:{display:"flex",flexDirection:"row"}},l.infos.map((c,q)=>L.tsx("div",{key:q,class:"esri-legend--card__symbol",bind:c.preview,afterCreate:D.attachToNode}))),L.tsx("div",{class:"esri-univariate-above-and-below-ramp__color--card",styles:P,key:"color-ramp-preview"},
L.tsx("div",{bind:E,afterCreate:D.attachToNode})),L.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},L.tsx("div",{class:"esri-legend__ramp-labels",styles:k},u)))};y._renderLegendForElementInfo=function(k,E,l,p){var u=E.layer;if(k.type)return this._renderLegendForElement(k,E,p);E=D.isImageryStretchedLegend(u,l);if(k.preview){var P;if(!k.symbol||-1===k.symbol.type.indexOf("simple-fill")){if(!k.label)return L.tsx("div",{key:p,bind:k.preview,afterCreate:D.attachToNode});var V=
{["esri-legend--card__symbol-cell"]:this._hasIndicators};return L.tsx("div",{key:p,class:this.classes("esri-legend--card__layer-row",{["esri-legend--card__symbol-row"]:this._hasIndicators})},L.tsx("div",{class:this.classes(V),bind:k.preview,afterCreate:D.attachToNode}),L.tsx("div",{class:this.classes("esri-legend--card__image-label",{["esri-legend--card__label-cell"]:this._hasIndicators})},D.getTitle(this.messages,k.label,!1)||""))}let c=l=E=255,q=0,b=255,f=255,I=255,S=0;const Y=k.symbol.color&&k.symbol.color.a,
ia=k.symbol.outline&&k.symbol.outline.color&&k.symbol.outline.color.a;Y&&(E=k.symbol.color.r,l=k.symbol.color.g,c=k.symbol.color.b,q=k.symbol.color.a*u.opacity);ia&&(b=k.symbol.outline.color.r,f=k.symbol.outline.color.g,I=k.symbol.outline.color.b,S=k.symbol.outline.color.a*u.opacity);V=(u=null!=(V=null==(P=k.symbol.color)?void 0:P.isBright)?V:!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return L.tsx("div",{key:p,class:"esri-legend--card__layer-row"},L.tsx("div",{class:"esri-legend--card__label-element",
styles:{background:Y?`rgba(${E}, ${l}, ${c}, ${q})`:"none",color:u?"black":"white",textShadow:`-1px -1px 0 ${V},
                                              1px -1px 0 ${V},
                                              -1px 1px 0 ${V},
                                              1px 1px 0 ${V}`,border:ia?`1px solid rgba(${b}, ${f}, ${I}, ${S})`:"none"}}," ",k.label," "))}if(k.src)return V=this._renderImage(k,u,E),L.tsx("div",{key:p,class:"esri-legend--card__layer-row"},V,L.tsx("div",{class:"esri-legend--card__image-label"},k.label||""))};y._renderImage=function(k,E,l){const {label:p,src:u,opacity:P}=k;l={["esri-legend--card__imagery-layer-image--stretched"]:l,["esri-legend--card__symbol"]:!l};E={opacity:`${null!=P?P:E.opacity}`};
return L.tsx("img",{alt:D.getTitle(this.messages,p,!1),src:u,border:0,width:k.width,height:k.height,class:this.classes(l),styles:E})};y._renderSizeRampLines=function(k){k=k.infos;var E=k[0],l=k[k.length-1],p=E.symbol;k=this._hasIndicators;E=r.pt2px(E.size+E.outlineSize)*M;l=r.pt2px(l.size+l.outlineSize)*M;const u=k?E:E+50*M,P=k?E/2+50*M:E;var V;p?-1<p.type.indexOf("3d")?(V=p.symbolLayers&&p.symbolLayers.length)?(V=p.symbolLayers.getItemAt(V-1).get("resource.primitive"),V="triangle"===V||"cone"===
V||"tetrahedron"===V):V=void 0:V="triangle"===p.style:V=void 0;if(p)if(-1<p.type.indexOf("3d")){var c=p.symbolLayers&&p.symbolLayers.length;c?(p=p.symbolLayers.getItemAt(c-1),p=p.resource&&p.resource.primitive,p="circle"===p||"cross"===p||"kite"===p||"sphere"===p||"cube"===p||"diamond"===p):p=void 0}else p=p.style,p="circle"===p||"diamond"===p||"cross"===p;else p=void 0;c=document.createElement("canvas");c.width=u;c.height=P;c.style.width=`${c.width/M}px`;c.style.height=`${c.height/M}px`;const q=
c.getContext("2d");if(k){q.beginPath();var b=u/2-l/2;q.moveTo(0,0);q.lineTo(b,P);b=u/2+l/2;q.moveTo(u,0);q.lineTo(b,P)}else q.beginPath(),q.moveTo(0,P/2-l/2),q.lineTo(u,0),q.moveTo(0,P/2+l/2),q.lineTo(u,P);q.strokeStyle="#ddd";q.stroke();return L.tsx("div",{bind:c,afterCreate:D.attachToNode,styles:k?{display:"flex",marginTop:`-${V?0:p?E/2:0}px`,marginBottom:`-${V?l:p?l/2:0}px`}:{display:"flex",marginRight:`-${V?0:p?E/2:0}px`,marginLeft:`-${V?0:p?l/2:0}px`}})};y._renderSizeRamp=function(k,E){var l=
k.infos;const p=l[0].label,u=l[l.length-1].label;let P=l[0].preview;l=l[l.length-1].preview;const V=this._hasIndicators,c={"flex-direction":V?"column":"row-reverse"};P&&(P=P.cloneNode(!0),P.style.display="flex");l&&(l=l.cloneNode(!0),l.style.display="flex");E={opacity:null!=E?`${E}`:""};return L.tsx("div",{class:this.classes("esri-legend--card__layer-row",{["esri-legend--card__size-ramp-row"]:V})},L.tsx("div",{class:"esri-legend--card__ramp-label"},V?p:u),L.tsx("div",{class:"esri-legend--card__size-ramp-container",
styles:c},L.tsx("div",{bind:P,afterCreate:D.attachToNode,class:"esri-legend--card__size-ramp-preview",styles:E}),this._renderSizeRampLines(k),L.tsx("div",{bind:l,afterCreate:D.attachToNode,class:"esri-legend--card__size-ramp-container",styles:E})),L.tsx("div",{class:"esri-legend--card__ramp-label"},V?u:p))};y._renderLegendForRamp=function(k,E){var l=k.infos;const p="heatmap-ramp"===k.type,u=l.length-1;var P=2<u&&!p?25*u:100;const V=P+20,c=l.slice(0).reverse();c.forEach((I,S)=>{I.offset=p?I.ratio:
S/u});const q=c.length-1;k=(k=0!==c.length%2&&c[c.length/2|0])&&L.tsx("div",{class:"esri-legend--card__interval-separators-container"},L.tsx("div",{class:"esri-legend--card__interval-separator"},"|"),L.tsx("div",{class:"esri-legend--card__ramp-label"},k.label));const b=l[l.length-1].label;l=l[0].label;let f=null;null!=E&&(f=`opacity: ${E}`);E=z.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:c[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:P,height:25},fill:{type:"linear",
x1:10,y1:0,x2:P+10,y2:0,colors:c},stroke:{width:0}},{shape:{type:"path",path:`M${P+10} 0 L${V} ${12.5} L${P+10} ${25} Z`},fill:c[q].color,stroke:{width:0}}]],V,25);({messages:P}=this);return L.tsx("div",{class:"esri-legend--card__layer-row"},L.tsx("div",{class:"esri-legend--card__ramp-label"},p?P[b]:b),L.tsx("div",{class:"esri-legend--card__symbol-container"},L.tsx("div",{style:f},E),k),L.tsx("div",{class:"esri-legend--card__ramp-label"},p?P[l]:l))};return g}(A);J.__decorate([v.property()],H.prototype,
"activeLayerInfos",void 0);J.__decorate([v.property()],H.prototype,"headingLevel",void 0);J.__decorate([v.property()],H.prototype,"layout",void 0);J.__decorate([v.property(),T.messageBundle("esri/widgets/Legend/t9n/Legend")],H.prototype,"messages",void 0);J.__decorate([v.property(),T.messageBundle("esri/t9n/common")],H.prototype,"messagesCommon",void 0);J.__decorate([v.property({readOnly:!0})],H.prototype,"type",void 0);J.__decorate([v.property()],H.prototype,"view",void 0);J.__decorate([F.accessibleHandler()],
H.prototype,"_selectSection",null);return H=J.__decorate([t.subclass("esri.widgets.Legend.styles.Card")],H)})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define("exports ../../../../symbols/support/svgUtils ../../../support/widgetUtils ../../../../core/has ../../../../core/Logger ../../../support/jsxFactory".split(" "),function(G,J,H,w,r,v){function N(e,t,z){const A=`${z}_arrowStart`;z=`${z}_arrowEnd`;e="left"===e;const C={markerStart:null,markerEnd:null};switch(t){case "HL":e?
C.markerStart=`url(#${z})`:C.markerEnd=`url(#${A})`;break;case "LL":C.markerStart=`url(#${z})`;break;case "LH":e?C.markerEnd=`url(#${A})`:C.markerStart=`url(#${z})`;break;default:C.markerEnd=`url(#${A})`}return C}function W(e,t,z,A=60){const {focus:C,numClasses:O,colors:D,rotation:x}=e;e=!!C;const F=Math.sqrt(A**2+A**2)+(e?0:5);let T=null;null!=z&&(T=`opacity: ${z}`);z=[];const L=[];var Q=[],m=(A||75)/O;for(var M=0;M<O;M++){var n=M*m;for(var g=0;g<O;g++){var y=g*m;const k=J.generateFillAttributes(D[M][g]),
E=J.generateStrokeAttributes(null);y={type:"rect",x:y,y:n,width:m,height:m};z.push(J.renderDef(k));L.push(J.renderShape(y,k.fill,E,null));Q.push(J.getBoundingBox(y))}}m=null;e||(m="margin: -15px -15px -18px -15px");M=N("left",C,t);n=N("right",C,t);g=J.computeBBox(Q);Q=J.getTransformMatrix(g,F,F,0,!1,x,!1);g=J.getTransformMatrix(g,F,F,0,!1,e?-45:null,!1);return v.tsx("div",{style:T,class:e?U.diamondMidColRamp:U.squareTableCell},v.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:F,height:F,style:m},
v.tsx("defs",null,v.tsx("marker",{id:`${t}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},v.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),v.tsx("marker",{id:`${t}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},v.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),z),v.tsx("g",{transform:Q},L),v.tsx("g",{transform:g},
v.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":M.markerStart,"marker-end":M.markerEnd,x1:-10,y1:A-15,x2:-10,y2:15}),v.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":n.markerStart,"marker-end":n.markerEnd,x1:15,y1:A+10,x2:A-15,y2:A+10}))))}const U={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",
diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",
squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};G.renderRelationshipRamp=function(e,t,z){const {focus:A,labels:C}=e,O=!!A;e=W(e,t,z);return O?v.tsx("div",{class:U.diamondContainer},v.tsx("div",{class:U.diamondLeftCol},C.left),v.tsx("div",{class:U.diamondMidCol},v.tsx("div",{class:U.diamondMidColLabel},C.top),e,v.tsx("div",{class:U.diamondMidColLabel},C.bottom)),v.tsx("div",{class:U.diamondRightCol},
C.right)):v.tsx("div",{class:U.squareTable},v.tsx("div",{class:U.squareTableRow},v.tsx("div",{class:H.classes(U.squareTableCell,U.squareTableLabel,U.squareTableLabelRightBottom)},C.left),v.tsx("div",{class:U.squareTableCell}),v.tsx("div",{class:H.classes(U.squareTableCell,U.squareTableLabel,U.squareTableLabelLeftBottom)},C.top)),v.tsx("div",{class:U.squareTableRow},v.tsx("div",{class:U.squareTableCell}),e,v.tsx("div",{class:U.squareTableCell})),v.tsx("div",{class:U.squareTableRow},v.tsx("div",{class:H.classes(U.squareTableCell,
U.squareTableLabel,U.squareTableLabelRightTop)},C.bottom),v.tsx("div",{class:U.squareTableCell}),v.tsx("div",{class:H.classes(U.squareTableCell,U.squareTableLabel,U.squareTableLabelLeftTop)},C.right)))};Object.defineProperty(G,"__esModule",{value:!0})})},"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../../core/has ../../../../core/Logger ../../../support/jsxFactory".split(" "),
function(G,J,H,w,r,v,N,W,U){function e(D="vertical"){return"vertical"===D?U.tsx("svg",{height:"4",width:"10"},U.tsx("line",{x1:"0",y1:"2",x2:"10",y2:"2",style:"stroke:rgb(200, 200, 200);stroke-width:1"})):U.tsx("svg",{height:"10",width:"10"},U.tsx("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:"stroke:rgb(200, 200, 200);stroke-width:1"}))}function t(D,x="vertical"){const F=document.createElement("div");F.style.height="20px";F.className=O.univariateAboveAndBelowSymbol;null!=D&&(F.style.opacity=D.toString());
C.append(F,e.bind(null,x));return F}function z(D,x,F="vertical",T){D.infos.forEach((L,Q)=>{if(T&&2===Q)L.preview=t(x,F);else{Q=J.pt2px(L.size)+("horizontal"===F?20:10);const m="div"===L.preview.tagName.toLowerCase(),M=m?L.preview:document.createElement("div");M.className=O.univariateAboveAndBelowSymbol;"horizontal"===F?M.style.width=`${Q}px`:M.style.height=`${Q}px`;m||M.appendChild(L.preview);L.preview=M}})}function A(D,x,F,T="vertical"){let L=0;D=D.infos;const Q=Math.floor(D.length/2);var m="full"===
x||"above"===x?0:Q;for(x="full"===x||"below"===x?D.length-1:Q;m<=x;m++)if(F&&m===Q)L+="horizontal"===T?10:20;else{const M=J.pt2px(D[m].size)+("horizontal"===T?20:10);L+=M}return Math.round(L)}const C=w.createProjector(),O={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};G.getUnivariateAboveAndBelowRampElements=function(D,x,F="vertical"){var T=D.infos;D=T.filter(({type:Q})=>"size-ramp"===Q)[0];T=T.filter(({type:Q})=>"color-ramp"===Q)[0];
D&&(D={...D},D.infos=[...D.infos]);T&&(T={...T},T.infos=[...T.infos]);z(D,x,F,!0);if("horizontal"===F){var L;D.infos.reverse();null==(L=T)?void 0:L.infos.reverse()}return{sizeRampElement:D,colorRampElement:T}};G.getUnivariateColorRampMargin=function(D,x="classic"){D=D.infos;return"classic"===x?(J.pt2px(D[0].size)+10)/2:(J.pt2px(D[0].size)-J.pt2px(D[D.length-1].size))/2};G.getUnivariateColorRampPreview=function(D,x){if(!D)return null;D=D.infos.map(F=>F.color);D=r.renderColorRampPreviewHTML("full"===
x.type?D:"above"===x.type?D.slice(0,3):D.slice(2,5),{width:x.width,height:x.height,align:x.rampAlignment});D.className=O.colorRamp;null!=x.opacity&&(D.style.opacity=x.opacity.toString());return D};G.getUnivariateColorRampSize=function(D,x,F,T="vertical"){const L=A(D,x,F,T);D=D.infos;var Q=Math.floor(D.length/2);const m="full"===x||"above"===x?0:Q;Q="full"===x||"below"===x?D.length-1:Q;F=F?"vertical"===T?20:10:0;T="vertical"===T?10*("full"===x?2:1):20*("full"===x?2:1);return Math.round(L-(J.pt2px("full"===
x?D[m].size+D[Q].size:"above"===x?D[m].size:D[Q].size)/2+F/2+T/2))};G.getUnivariateColorSizeRampElements=function(D,x="vertical"){var F=D.infos;D=F.filter(({type:L})=>"size-ramp"===L)[0];F=F.filter(({type:L})=>"color-ramp"===L)[0];D&&(D={...D},D.infos=[...D.infos]);F&&(F={...F},F.infos=[...F.infos]);z(D,null,x,!1);if("horizontal"===x){var T;D.infos.reverse();null==(T=F)?void 0:T.infos.reverse()}return{sizeRampElement:D,colorRampElement:F}};G.getUnivariateSizeRampSize=A;Object.defineProperty(G,"__esModule",
{value:!0})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports","../../../intl","../../../intl/substitute"],function(G,J,H){G.attachToNode=function(w){w.appendChild(this)};G.getTitle=function(w,r,v){if(r){if("string"===typeof r||"number"===typeof r)return r;if("value"in r||"unit"in r)return H.substitute(w.dotValue,r);if("colorName"in r||"bandName"in r)return w[r.colorName]+": "+(w[r.bandName]||r.bandName);if("showCount"in r)return r.showCount?w.clusterCountTitle:null;var N=null;
v?N=r.ratioPercentTotal?"showRatioPercentTotal":r.ratioPercent?"showRatioPercent":r.ratio?"showRatio":r.normField?"showNormField":r.field?"showField":null:v||(N=r.normField?"showNormField":r.normByPct?"showNormPct":r.field?"showField":null);return N?H.substitute("showField"===N?"{field}":w[N],{field:r.field,normField:r.normField}):null}};G.isImageryStretchedLegend=function(w,r){return!!(r&&"Stretched"===r&&10.3<=w.version&&"esri.layers.ImageryLayer"===w.declaredClass)};G.isRendererTitle=function(w,
r){return!r};Object.defineProperty(G,"__esModule",{value:!0})})},"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/Logger ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../Widget ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory ../../../intl/number".split(" "),
function(G,J,H,w,r,v,N,W,U,e,t,z,A,C,O,D,x,F){const T={display:"flex",alignItems:"flex-start"},L={marginLeft:"3px"},Q={display:"table-cell",verticalAlign:"middle"};H=function(m){function M(g,y){g=m.call(this,g,y)||this;g.activeLayerInfos=null;g.headingLevel=3;g.messages=null;g.type="classic";return g}G._inheritsLoose(M,m);var n=M.prototype;n.render=function(){var g=this.activeLayerInfos;g=g&&g.toArray().map(y=>this._renderLegendForLayer(y)).filter(y=>!!y);return x.tsx("div",null,g&&g.length?g:x.tsx("div",
{class:"esri-legend__message"},this.messages.noLegend))};n._renderLegendForLayer=function(g){if(!g.ready)return null;var y=!!g.children.length;const k=`${"esri-legend__"}${g.layer.uid}-version-${g.version}`,E=g.title?C.Heading({level:this.headingLevel,class:this.classes("esri-widget__heading","esri-legend__service-label")},g.title):null;if(y)return y=g.children.map(l=>this._renderLegendForLayer(l)).toArray(),x.tsx("div",{key:k,class:this.classes("esri-legend__service","esri-legend__group-layer")},
E,y);if((y=g.legendElements)&&!y.length)return null;y=y.map(l=>this._renderLegendForElement(l,g.layer)).filter(l=>!!l);return y.length?x.tsx("div",{key:k,class:this.classes("esri-legend__service",{["esri-legend__group-layer-child"]:!!g.parent}),tabIndex:0},E,x.tsx("div",{class:"esri-legend__layer"},y)):null};n._renderLegendForElement=function(g,y,k){var E="color-ramp"===g.type,l="opacity-ramp"===g.type;const p="size-ramp"===g.type;let u=null;if("symbol-table"===g.type||p){var P=g.infos.map(c=>this._renderLegendForElementInfo(c,
y,p,g.legendType)).filter(c=>!!c);P.length&&(u=x.tsx("div",{class:"esri-legend__layer-body"},P))}else"color-ramp"===g.type||"opacity-ramp"===g.type||"heatmap-ramp"===g.type||"stretch-ramp"===g.type?u=this._renderLegendForRamp(g,y.opacity):"relationship-ramp"===g.type?u=t.renderRelationshipRamp(g,this.id,y.opacity):"univariate-above-and-below-ramp"===g.type?u=this._renderUnivariateAboveAndBelowRamp(g,y.opacity):"univariate-color-size-ramp"===g.type&&(u=this._renderUnivariateColorSizeRamp(g,y.opacity));
if(!u)return null;P=g.title;var V=null;"string"===typeof P?V=P:P&&(V=A.getTitle(this.messages,P,E||l),V=A.isRendererTitle(P,E||l)&&P.title?`${P.title} (${V})`:V);E=k?"esri-legend__layer-child-table":"esri-legend__layer-table";l=V?x.tsx("div",{class:"esri-legend__layer-caption"},V):null;return x.tsx("div",{class:this.classes(E,{["esri-legend__layer-table--size-ramp"]:p||!k})},l,u)};n._renderUnivariateAboveAndBelowRamp=function(g,y){const {sizeRampElement:k,colorRampElement:E}=z.getUnivariateAboveAndBelowRampElements(g,
y);var l=z.getUnivariateColorRampSize(k,"above",!0);g=z.getUnivariateColorRampSize(k,"below",!0);const p=z.getUnivariateColorRampPreview(E,{width:12,height:l,rampAlignment:"vertical",opacity:y,type:"above"});y=z.getUnivariateColorRampPreview(E,{width:12,height:g,rampAlignment:"vertical",opacity:y,type:"below"});var u=z.getUnivariateColorRampMargin(k);const P=k.infos.map(I=>I.label),V=P.map((I,S)=>{const Y=2===S;return 0===S?x.tsx("div",{key:S,class:I?p?"esri-univariate-above-and-below-ramp__label":
"esri-legend__ramp-label":null},I):Y?x.tsx("div",null):null}),c=P.length-1,q=Math.floor(P.length/2),b=P.map((I,S)=>{const Y=S===c;return S===q||Y?x.tsx("div",{key:S,class:I?p?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},I):null}),f={display:"table-cell",verticalAlign:"middle"};u={marginTop:`${u}px`};l={height:`${l}px`};g={height:`${g}px`};return x.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:T},x.tsx("div",{class:"esri-legend__layer-body"},k.infos.map((I,
S)=>x.tsx("div",{class:this.classes("esri-legend__layer-row","esri-legend__size-ramp")},x.tsx("div",{class:"esri-legend__symbol",styles:f,bind:I.preview,afterCreate:A.attachToNode}),p||0!==S%2?null:x.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},P[S])))),p?x.tsx("div",{styles:u,key:"color-ramp-preview"},x.tsx("div",{styles:L},x.tsx("div",{styles:Q},x.tsx("div",{class:"esri-legend__ramps",bind:p,afterCreate:A.attachToNode})),x.tsx("div",{styles:Q},x.tsx("div",{class:"esri-legend__ramp-labels",
styles:l},V))),x.tsx("div",{styles:L},x.tsx("div",{styles:Q},x.tsx("div",{class:"esri-legend__ramps",bind:y,afterCreate:A.attachToNode})),x.tsx("div",{styles:Q},x.tsx("div",{class:"esri-legend__ramp-labels",styles:g},b)))):null)};n._renderUnivariateColorSizeRamp=function(g,y){const {sizeRampElement:k,colorRampElement:E}=z.getUnivariateColorSizeRampElements(g);var l=z.getUnivariateColorRampMargin(k);g=z.getUnivariateColorRampSize(k,"full",!1);y=z.getUnivariateColorRampPreview(E,{width:12,height:g,
rampAlignment:"vertical",opacity:y,type:"full"});const p=k.infos.length-1,u=k.infos.map((V,c)=>0===c||c===p?x.tsx("div",{key:c,class:V.label?E?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},V.label):null),P={display:"table-cell",verticalAlign:"middle"};l={marginTop:`${l}px`};g={height:`${g}px`};return x.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:T},x.tsx("div",{class:"esri-legend__layer-body"},k.infos.map(V=>x.tsx("div",{class:this.classes("esri-legend__layer-row",
"esri-legend__size-ramp")},x.tsx("div",{class:"esri-legend__symbol",styles:P,bind:V.preview,afterCreate:A.attachToNode})))),x.tsx("div",{styles:l,key:"color-ramp-preview"},x.tsx("div",{styles:L},x.tsx("div",{styles:Q},x.tsx("div",{class:"esri-legend__ramps",bind:y,afterCreate:A.attachToNode})),x.tsx("div",{styles:Q},x.tsx("div",{class:"esri-legend__ramp-labels",styles:g},u)))))};n._renderLegendForRamp=function(g,y){const k=g.infos,E="heatmap-ramp"===g.type,l="stretch-ramp"===g.type,p=g.preview;p.className=
`${"esri-legend__color-ramp"} ${"opacity-ramp"===g.type?"esri-legend__opacity-ramp":""}`;null!=y&&(p.style.opacity=y.toString());g=k.map(u=>x.tsx("div",{class:u.label?"esri-legend__ramp-label":null},E?this.messages[u.label]:l?this._getStretchStopLabel(u):u.label));y={height:p.style.height};return x.tsx("div",{class:"esri-legend__layer-row"},x.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},x.tsx("div",{class:"esri-legend__ramps",bind:p,afterCreate:A.attachToNode})),
x.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},x.tsx("div",{class:"esri-legend__ramp-labels",styles:y},g)))};n._getStretchStopLabel=function(g){return g.label?this.messages[g.label]+": "+("string"===typeof g.value?g.value:F.formatNumber(g.value,{style:"decimal",notation:-1<g.value.toString().indexOf("e")?"scientific":"standard"})):""};n._renderLegendForElementInfo=function(g,y,k,E){if(g.type)return this._renderLegendForElement(g,y,!0);let l=null;E=A.isImageryStretchedLegend(y,
E);g.preview?l=x.tsx("div",{class:"esri-legend__symbol",bind:g.preview,afterCreate:A.attachToNode}):g.src&&(l=this._renderImage(g,y,E));if(!l)return null;y={["esri-legend__imagery-layer-info--stretched"]:E};return x.tsx("div",{class:"esri-legend__layer-row"},x.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",{["esri-legend__imagery-layer-info--stretched"]:E,["esri-legend__size-ramp"]:!E&&k})},l),x.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",
y)},A.getTitle(this.messages,g.label,!1)||""))};n._renderImage=function(g,y,k){const {label:E,src:l,opacity:p}=g;k={["esri-legend__imagery-layer-image--stretched"]:k,["esri-legend__symbol"]:!k};y={opacity:`${null!=p?p:y.opacity}`};return x.tsx("img",{alt:A.getTitle(this.messages,E,!1),src:l,border:0,width:g.width,height:g.height,class:this.classes(k),styles:y})};return M}(e);J.__decorate([w.property()],H.prototype,"activeLayerInfos",void 0);J.__decorate([w.property()],H.prototype,"headingLevel",void 0);
J.__decorate([w.property(),D.messageBundle("esri/widgets/Legend/t9n/Legend")],H.prototype,"messages",void 0);J.__decorate([w.property({readOnly:!0})],H.prototype,"type",void 0);return H=J.__decorate([U.subclass("esri.widgets.Legend.styles.Classic")],H)})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators/aliasOf ../core/has ../core/accessorSupport/decorators/cast ../core/Logger ../core/jsonMap ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(G,J,H,w,r,
v,N,W,U,e,t,z,A,C,O,D,x,F){v=function(T){function L(m,M){m=T.call(this,m,M)||this;m._handles=new H;m.activeLayerInfos=null;m.basemapLegendVisible=!1;m.groundLegendVisible=!1;m.headingLevel=3;m.keepCacheOnDestroy=!1;m.respectLayerVisibility=!0;m.iconClass="esri-icon-layer-list";m.label=void 0;m.layerInfos=null;m.messages=null;m.style=new O;m.view=null;m.viewModel=new A;return m}G._inheritsLoose(L,T);var Q=L.prototype;Q.initialize=function(){this.own(w.on(this,"activeLayerInfos","change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),
w.watch(this,"headingLevel",m=>{const {style:M}=this;M&&(M.headingLevel=m)}),w.init(this,"style",(m,M)=>{M&&m!==M&&M.destroy();m&&(m.activeLayerInfos=this.activeLayerInfos,"card"===m.type&&(m.view=this.view),m.headingLevel=this.headingLevel)}))};Q.destroy=function(){this._handles.destroy();this._handles=null};Q.castStyle=function(m){if(m instanceof C||m instanceof O)return m;if("string"===typeof m)return"card"===m?new C:new O;if(m&&"string"===typeof m.type){const M={...m};delete M.type;return new ("card"===
m.type?C:O)(M)}return new O};Q.render=function(){return F.tsx("div",{class:this.classes("esri-legend","esri-widget",this.style instanceof O?"esri-widget--panel":null)},this.style.render())};Q._refreshActiveLayerInfos=function(m){this._handles.removeAll();m.forEach(M=>this._renderOnActiveLayerInfoChange(M));this.scheduleRender()};Q._renderOnActiveLayerInfoChange=function(m){var M=w.init(m,"version",()=>this.scheduleRender());this._handles.add(M,`version_${m.layer.uid}`);M=w.on(m,"children","change",
()=>{m.children.forEach(n=>this._renderOnActiveLayerInfoChange(n))});this._handles.add(M,`children_${m.layer.uid}`);m.children.forEach(n=>this._renderOnActiveLayerInfoChange(n))};return L}(z);J.__decorate([r.aliasOf("viewModel.activeLayerInfos")],v.prototype,"activeLayerInfos",void 0);J.__decorate([r.aliasOf("viewModel.basemapLegendVisible")],v.prototype,"basemapLegendVisible",void 0);J.__decorate([r.aliasOf("viewModel.groundLegendVisible")],v.prototype,"groundLegendVisible",void 0);J.__decorate([e.property()],
v.prototype,"headingLevel",void 0);J.__decorate([r.aliasOf("viewModel.keepCacheOnDestroy")],v.prototype,"keepCacheOnDestroy",void 0);J.__decorate([r.aliasOf("viewModel.respectLayerVisibility")],v.prototype,"respectLayerVisibility",void 0);J.__decorate([e.property()],v.prototype,"iconClass",void 0);J.__decorate([e.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],v.prototype,"label",void 0);J.__decorate([r.aliasOf("viewModel.layerInfos")],v.prototype,"layerInfos",void 0);J.__decorate([e.property(),
x.messageBundle("esri/widgets/Legend/t9n/Legend")],v.prototype,"messages",void 0);J.__decorate([e.property()],v.prototype,"style",void 0);J.__decorate([N.cast("style")],v.prototype,"castStyle",null);J.__decorate([r.aliasOf("viewModel.view")],v.prototype,"view",void 0);J.__decorate([e.property()],v.prototype,"viewModel",void 0);return v=J.__decorate([t.subclass("esri.widgets.Legend")],v)});