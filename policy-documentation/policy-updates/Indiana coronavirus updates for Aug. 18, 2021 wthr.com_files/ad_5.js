define("ad",["module","page","utils","bem","jquery","universal-ad","jquery-utils"],function(e,t,g,m,u){const w={name:e.id,class:"."+e.id},b={sizes:[[300,250],[728,90],[300,600],[970,250],[970,90],[320,50]],positions:{desktop:["alerts_closings","alerts_weather","article_atf","article_flex_btf","article_mid1","article_mid2","article_mid3","article_mid4","article_mid5","article_mid6","article_mid7","article_universal","countdown_clock","front_atf","front_btf","front_countdownclock","front_high_impact","front_leaderboard_btf","front_mid1","front_mid2","front_mid3","front_mid4","front_mid5","front_universal","gallery_companion","leaderboard_atf"],mobile:["alerts_closings","alerts_weather","article_atf","article_btf","article_mid1","article_mid2","article_mid3","article_mid4","article_mid5","article_universal","front_atf","front_btf","front_mid","front_universal"]}};g.broadcastNoJQ(w.name,"loaded"),g.createModuleNoJQ(w.name,function(n){const s=this,i=new m(n,w.name);this.el=n,this.module=w,this.delay=1e3*parseInt(n.dataset.delay),this.refresher=null,this.refreshObserver=null,this.init=function(){const t=e=>{window.setTimeout(function(){window.googletag&&window.googletag.pubads?e():t(e)},200)};t(()=>{s.broadcast("init",{position:n.dataset.position}),p(),s.broadcast("setup",{position:n.dataset.position,id:s.id,delay:s.delay}),g.listen("_gpt","slotRenderEnded",function(e,t,i){i.request.domId===s.id&&f(i)}),e(function(){c()})}),s.broadcast("ready")};const r=(e,t)=>{var i=g.dashesToCamel(`targeting-${e}`),o=`data-targeting-${e}`;null==t?(s.broadcast("removingTargeting",{position:n.dataset.position,target:e}),n.removeAttribute(o)):n.dataset[i]!==t.toString()?(s.broadcast("settingTargeting",{position:n.dataset.position,target:e,value:t.toString()}),n.dataset[i]=t.toString()):s.broadcast("ignoringExistingTargeting",{position:n.dataset.position,target:e,value:t.toString()})};function o(e){s.refresher&&(e||s.broadcast("refreshStopped",{position:n.dataset.position}),window.clearTimeout(s.refresher),window.clearInterval(s.refreshCountdown),s.refresher=null)}function a(){var e;"true"===n.dataset.refreshEnabled&&(e=parseInt(n.dataset.refreshInterval),o(!0),s.refresher=window.setTimeout(()=>{r("refresh",!0),function e(){document.hidden?(s.broadcast("refreshBlocked",{position:n.dataset.position}),u(document).one("visibilitychange",()=>{s.broadcast("refreshUnblocked",{position:n.dataset.position}),e()})):c()}()},1e3*e),s.refreshRemaining=e,s.refreshCountdown=window.setInterval(()=>{s.refreshRemaining--,s.refreshRemaining<1?window.clearInterval(s.refreshCountdown):s.broadcast("refreshCountdown",{position:n.dataset.position,remaining:s.refreshRemaining})},1e3),s.broadcast("refreshRestarted",{position:n.dataset.position}),s.broadcast("refreshCountdown",{position:n.dataset.position,remaining:s.refreshRemaining}))}const d=()=>new Promise(a=>{var e="mobile"===u(".page")[0].dataset.platform?"mobile":"desktop";b.positions[e].includes(n.dataset.position)?(e=function(){const e=JSON.parse(n.dataset.sizes),i=b.sizes;let o=[];return e.forEach(t=>{i.forEach(e=>{t.join("x")===e.join("x")&&o.push(t)})}),o}(),e=[{code:s.id,divId:s.id,adUnitId:s.id,adUnitIndex:"0",mediaTypes:{banner:{sizes:e}}}],s.broadcast("startingOpenWrapBidding",{position:n.dataset.position,slots:e}),window.PWT&&window.PWT.requestBids?window.PWT.requestBids(e,function(e){s.broadcast("receivedOpenWrapBids",{bids:e,position:n.dataset.position});for(var t=0,i=e.length;t<i;t++){const o=e[t];o.bidData&&o.bidData.kvp&&Object.keys(o.bidData.kvp).forEach(function(e){var t=e,e=o.bidData.kvp[e];r(t,e)})}a()}):a()):(s.broadcast("blockingOpenWrapBidding",{position:n.dataset.position}),a())}),l=()=>new Promise(e=>{s.broadcast("startingA9Bidding",{position:n.dataset.position}),window.apstag.fetchBids({slots:[{slotID:s.id,slotName:n.dataset.path,sizes:JSON.parse(n.dataset.sizes)}]},function(i){0<i.length?(s.broadcast("receivedA9Bids",{bids:i,position:n.dataset.position}),window.googletag&&window.googletag.cmd&&window.googletag.cmd.push(function(){s.broadcast("refreshing",{position:n.dataset.position}),["amznbid","amzniid","amznsz","amznp"].forEach(e=>{var t=i[0][e];r(e,t)})})):window.googletag&&window.googletag.cmd&&window.googletag.cmd.push(function(){s.broadcast("noAmazonBids",{position:n.dataset.position}),s.broadcast("refreshing",{position:n.dataset.position})}),e()})}),c=()=>{const e=[{name:"a9",enabled:"apstag"in window&&"fetchBids"in window.apstag,ready:"apstag"in window&&"fetchBids"in window.apstag,request:l},{name:"pubmatic",enabled:"PWT"in window&&"requestBids"in window.PWT,ready:"PWT"in window&&"requestBids"in window.PWT,request:d}];let t=[];e.forEach(e=>{e.enabled&&e.ready?t.push(e.request()):s.broadcast(`${e.name}BiddingSkipped`,{name:e.name,enabled:e.enabled,ready:e.ready})}),Promise.allSettled(t).then(()=>{s.broadcast("refreshing",{position:n.dataset.position}),window.tegna.ads.refresh(s.id)})},e=i=>{0<s.delay?(s.timeout=window.setTimeout(function(){s.timeout=null,i()},s.delay),g.observeIntersections(n,(e,t)=>{e.isIntersecting&&(t.unobserve(e.target),null!==s.timeout&&(window.clearTimeout(s.timeout),i()))})):i()},p=()=>{var t=n.dataset.position;if(document.getElementById(t)){let e=1;for(;null!==document.getElementById(`${t}_${e}`);)e++;t+="_"+e}s.id=t,n.firstElementChild.setAttribute("id",s.id)},f=e=>{var t;s.broadcast("received",{position:n.dataset.position,payload:e}),"true"===n.dataset.collapse&&e.response.isEmpty?s.el.style.display="none":("true"===n.dataset.refreshEnabled&&(s.refreshObserver?a():g.observeIntersections(n,(e,t)=>{s.refreshObserver=t,e.isIntersectingThreshold&&!s.viewable?(s.broadcast("viewable",{position:n.dataset.position}),a()):(s.viewable=!1,s.broadcast("unviewable",{position:n.dataset.position}),o())},{threshold:1})),t=e.response.size.width,"desktop"===document.getElementsByClassName("page")[0].dataset.platform&&1080<=t&&i.selectElements("inner").setModifier("border",!1),t=e.response.isEmpty,e.response.size.width<3&&!1===t&&(i.selectElements("inner").setModifier("border",!1),i.selectElements("inner").setModifier("background",!1)))}})});
//# sourceMappingURL=ad_5.8.4.js.map