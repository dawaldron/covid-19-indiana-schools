var DEVMODE=!1,STATIC_URI_PREFIX="https://s.smore.com/";(function(){var t=this,e=t._,n={},i=Array.prototype,r=Object.prototype,o=Function.prototype,s=i.push,a=i.slice,u=i.concat,c=r.toString,l=r.hasOwnProperty,h=i.forEach,f=i.map,d=i.reduce,p=i.reduceRight,v=i.filter,g=i.every,m=i.some,y=i.indexOf,w=i.lastIndexOf,b=Array.isArray,_=Object.keys,x=o.bind,k=function(t){return t instanceof k?t:this instanceof k?void(this._wrapped=t):new k(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):(t._=k,t._underscore=k),k.VERSION="1.5.2";var C=k.each=k.forEach=function(t,e,i){if(null!=t)if(h&&t.forEach===h)t.forEach(e,i);else if(t.length===+t.length){for(var r=0,o=t.length;r<o;r++)if(e.call(i,t[r],r,t)===n)return}else{var s=k.keys(t);for(r=0,o=s.length;r<o;r++)if(e.call(i,t[s[r]],s[r],t)===n)return}};k.map=k.collect=function(t,e,n){var i=[];return null==t?i:f&&t.map===f?t.map(e,n):(C(t,(function(t,r,o){i.push(e.call(n,t,r,o))})),i)};var S="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return i&&(e=k.bind(e,i)),r?t.reduce(e,n):t.reduce(e);if(C(t,(function(t,o,s){r?n=e.call(i,n,t,o,s):(n=t,r=!0)})),!r)throw new TypeError(S);return n},k.reduceRight=k.foldr=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return i&&(e=k.bind(e,i)),r?t.reduceRight(e,n):t.reduceRight(e);var o=t.length;if(o!==+o){var s=k.keys(t);o=s.length}if(C(t,(function(a,u,c){u=s?s[--o]:--o,r?n=e.call(i,n,t[u],u,c):(n=t[u],r=!0)})),!r)throw new TypeError(S);return n},k.find=k.detect=function(t,e,n){var i;return $(t,(function(t,r,o){if(e.call(n,t,r,o))return i=t,!0})),i},k.filter=k.select=function(t,e,n){var i=[];return null==t?i:v&&t.filter===v?t.filter(e,n):(C(t,(function(t,r,o){e.call(n,t,r,o)&&i.push(t)})),i)},k.reject=function(t,e,n){return k.filter(t,(function(t,i,r){return!e.call(n,t,i,r)}),n)},k.every=k.all=function(t,e,i){e||(e=k.identity);var r=!0;return null==t?r:g&&t.every===g?t.every(e,i):(C(t,(function(t,o,s){if(!(r=r&&e.call(i,t,o,s)))return n})),!!r)};var $=k.some=k.any=function(t,e,i){e||(e=k.identity);var r=!1;return null==t?r:m&&t.some===m?t.some(e,i):(C(t,(function(t,o,s){if(r||(r=e.call(i,t,o,s)))return n})),!!r)};k.contains=k.include=function(t,e){return null!=t&&(y&&t.indexOf===y?-1!=t.indexOf(e):$(t,(function(t){return t===e})))},k.invoke=function(t,e){var n=a.call(arguments,2),i=k.isFunction(e);return k.map(t,(function(t){return(i?e:t[e]).apply(t,n)}))},k.pluck=function(t,e){return k.map(t,(function(t){return t[e]}))},k.where=function(t,e,n){return k.isEmpty(e)?n?void 0:[]:k[n?"find":"filter"](t,(function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0}))},k.findWhere=function(t,e){return k.where(t,e,!0)},k.max=function(t,e,n){if(!e&&k.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&k.isEmpty(t))return-1/0;var i={computed:-1/0,value:-1/0};return C(t,(function(t,r,o){var s=e?e.call(n,t,r,o):t;s>i.computed&&(i={value:t,computed:s})})),i.value},k.min=function(t,e,n){if(!e&&k.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&k.isEmpty(t))return 1/0;var i={computed:1/0,value:1/0};return C(t,(function(t,r,o){var s=e?e.call(n,t,r,o):t;s<i.computed&&(i={value:t,computed:s})})),i.value},k.shuffle=function(t){var e,n=0,i=[];return C(t,(function(t){e=k.random(n++),i[n-1]=i[e],i[e]=t})),i},k.sample=function(t,e,n){return arguments.length<2||n?t[k.random(t.length-1)]:k.shuffle(t).slice(0,Math.max(0,e))};var E=function(t){return k.isFunction(t)?t:function(e){return e[t]}};k.sortBy=function(t,e,n){var i=E(e);return k.pluck(k.map(t,(function(t,e,r){return{value:t,index:e,criteria:i.call(n,t,e,r)}})).sort((function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index})),"value")};var T=function(t){return function(e,n,i){var r={},o=null==n?k.identity:E(n);return C(e,(function(n,s){var a=o.call(i,n,s,e);t(r,a,n)})),r}};k.groupBy=T((function(t,e,n){(k.has(t,e)?t[e]:t[e]=[]).push(n)})),k.indexBy=T((function(t,e,n){t[e]=n})),k.countBy=T((function(t,e){k.has(t,e)?t[e]++:t[e]=1})),k.sortedIndex=function(t,e,n,i){for(var r=(n=null==n?k.identity:E(n)).call(i,e),o=0,s=t.length;o<s;){var a=o+s>>>1;n.call(i,t[a])<r?o=a+1:s=a}return o},k.toArray=function(t){return t?k.isArray(t)?a.call(t):t.length===+t.length?k.map(t,k.identity):k.values(t):[]},k.size=function(t){return null==t?0:t.length===+t.length?t.length:k.keys(t).length},k.first=k.head=k.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:a.call(t,0,e)},k.initial=function(t,e,n){return a.call(t,0,t.length-(null==e||n?1:e))},k.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},k.rest=k.tail=k.drop=function(t,e,n){return a.call(t,null==e||n?1:e)},k.compact=function(t){return k.filter(t,k.identity)};var O=function(t,e,n){return e&&k.every(t,k.isArray)?u.apply(n,t):(C(t,(function(t){k.isArray(t)||k.isArguments(t)?e?s.apply(n,t):O(t,e,n):n.push(t)})),n)};k.flatten=function(t,e){return O(t,e,[])},k.without=function(t){return k.difference(t,a.call(arguments,1))},k.uniq=k.unique=function(t,e,n,i){k.isFunction(e)&&(i=n,n=e,e=!1);var r=n?k.map(t,n,i):t,o=[],s=[];return C(r,(function(n,i){(e?i&&s[s.length-1]===n:k.contains(s,n))||(s.push(n),o.push(t[i]))})),o},k.union=function(){return k.uniq(k.flatten(arguments,!0))},k.intersection=function(t){var e=a.call(arguments,1);return k.filter(k.uniq(t),(function(t){return k.every(e,(function(e){return k.indexOf(e,t)>=0}))}))},k.difference=function(t){var e=u.apply(i,a.call(arguments,1));return k.filter(t,(function(t){return!k.contains(e,t)}))},k.zip=function(){for(var t=k.max(k.pluck(arguments,"length").concat(0)),e=new Array(t),n=0;n<t;n++)e[n]=k.pluck(arguments,""+n);return e},k.object=function(t,e){if(null==t)return{};for(var n={},i=0,r=t.length;i<r;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},k.indexOf=function(t,e,n){if(null==t)return-1;var i=0,r=t.length;if(n){if("number"!=typeof n)return t[i=k.sortedIndex(t,e)]===e?i:-1;i=n<0?Math.max(0,r+n):n}if(y&&t.indexOf===y)return t.indexOf(e,n);for(;i<r;i++)if(t[i]===e)return i;return-1},k.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(w&&t.lastIndexOf===w)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var r=i?n:t.length;r--;)if(t[r]===e)return r;return-1},k.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=0,o=new Array(i);r<i;)o[r++]=t,t+=n;return o};var F=function(){};k.bind=function(t,e){var n,i;if(x&&t.bind===x)return x.apply(t,a.call(arguments,1));if(!k.isFunction(t))throw new TypeError;return n=a.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(a.call(arguments)));F.prototype=t.prototype;var r=new F;F.prototype=null;var o=t.apply(r,n.concat(a.call(arguments)));return Object(o)===o?o:r}},k.partial=function(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)))}},k.bindAll=function(t){var e=a.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return C(e,(function(e){t[e]=k.bind(t[e],t)})),t},k.memoize=function(t,e){var n={};return e||(e=k.identity),function(){var i=e.apply(this,arguments);return k.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},k.delay=function(t,e){var n=a.call(arguments,2);return setTimeout((function(){return t.apply(null,n)}),e)},k.defer=function(t){return k.delay.apply(k,[t,1].concat(a.call(arguments,1)))},k.throttle=function(t,e,n){var i,r,o,s=null,a=0;n||(n={});var u=function(){a=!1===n.leading?0:new Date,s=null,o=t.apply(i,r)};return function(){var c=new Date;a||!1!==n.leading||(a=c);var l=e-(c-a);return i=this,r=arguments,l<=0?(clearTimeout(s),s=null,a=c,o=t.apply(i,r)):s||!1===n.trailing||(s=setTimeout(u,l)),o}},k.debounce=function(t,e,n){var i,r,o,s,a;return function(){o=this,r=arguments,s=new Date;var u=function(){var c=new Date-s;c<e?i=setTimeout(u,e-c):(i=null,n||(a=t.apply(o,r)))},c=n&&!i;return i||(i=setTimeout(u,e)),c&&(a=t.apply(o,r)),a}},k.once=function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(this,arguments),t=null),e}},k.wrap=function(t,e){return function(){var n=[t];return s.apply(n,arguments),e.apply(this,n)}},k.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},k.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},k.keys=_||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)k.has(t,n)&&e.push(n);return e},k.values=function(t){for(var e=k.keys(t),n=e.length,i=new Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i},k.pairs=function(t){for(var e=k.keys(t),n=e.length,i=new Array(n),r=0;r<n;r++)i[r]=[e[r],t[e[r]]];return i},k.invert=function(t){for(var e={},n=k.keys(t),i=0,r=n.length;i<r;i++)e[t[n[i]]]=n[i];return e},k.functions=k.methods=function(t){var e=[];for(var n in t)k.isFunction(t[n])&&e.push(n);return e.sort()},k.extend=function(t){return C(a.call(arguments,1),(function(e){if(e)for(var n in e)t[n]=e[n]})),t},k.pick=function(t){var e={},n=u.apply(i,a.call(arguments,1));return C(n,(function(n){n in t&&(e[n]=t[n])})),e},k.omit=function(t){var e={},n=u.apply(i,a.call(arguments,1));for(var r in t)k.contains(n,r)||(e[r]=t[r]);return e},k.defaults=function(t){return C(a.call(arguments,1),(function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])})),t},k.clone=function(t){return k.isObject(t)?k.isArray(t)?t.slice():k.extend({},t):t},k.tap=function(t,e){return e(t),t};var A=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof k&&(t=t._wrapped),e instanceof k&&(e=e._wrapped);var r=c.call(t);if(r!=c.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=n.length;o--;)if(n[o]==t)return i[o]==e;var s=t.constructor,a=e.constructor;if(s!==a&&!(k.isFunction(s)&&s instanceof s&&k.isFunction(a)&&a instanceof a))return!1;n.push(t),i.push(e);var u=0,l=!0;if("[object Array]"==r){if(l=(u=t.length)==e.length)for(;u--&&(l=A(t[u],e[u],n,i)););}else{for(var h in t)if(k.has(t,h)&&(u++,!(l=k.has(e,h)&&A(t[h],e[h],n,i))))break;if(l){for(h in e)if(k.has(e,h)&&!u--)break;l=!u}}return n.pop(),i.pop(),l};k.isEqual=function(t,e){return A(t,e,[],[])},k.isEmpty=function(t){if(null==t)return!0;if(k.isArray(t)||k.isString(t))return 0===t.length;for(var e in t)if(k.has(t,e))return!1;return!0},k.isElement=function(t){return!(!t||1!==t.nodeType)},k.isArray=b||function(t){return"[object Array]"==c.call(t)},k.isObject=function(t){return t===Object(t)},C(["Arguments","Function","String","Number","Date","RegExp"],(function(t){k["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}})),k.isArguments(arguments)||(k.isArguments=function(t){return!(!t||!k.has(t,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(t){return"function"==typeof t}),k.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},k.isNaN=function(t){return k.isNumber(t)&&t!=+t},k.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==c.call(t)},k.isNull=function(t){return null===t},k.isUndefined=function(t){return void 0===t},k.has=function(t,e){return l.call(t,e)},k.noConflict=function(){return t._=e,this},k.identity=function(t){return t},k.times=function(t,e,n){for(var i=Array(Math.max(0,t)),r=0;r<t;r++)i[r]=e.call(n,r);return i},k.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};P.unescape=k.invert(P.escape);var I={escape:new RegExp("["+k.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(P.unescape).join("|")+")","g")};k.each(["escape","unescape"],(function(t){k[t]=function(e){return null==e?"":(""+e).replace(I[t],(function(e){return P[t][e]}))}})),k.result=function(t,e){if(null!=t){var n=t[e];return k.isFunction(n)?n.call(t):n}},k.mixin=function(t){C(k.functions(t),(function(e){var n=k[e]=t[e];k.prototype[e]=function(){var t=[this._wrapped];return s.apply(t,arguments),R.call(this,n.apply(k,t))}}))};var M=0;k.uniqueId=function(t){var e=++M+"";return t?t+e:e},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var j=/(.)^/,V={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},H=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(t,e,n){var i;n=k.defaults({},n,k.templateSettings);var r=new RegExp([(n.escape||j).source,(n.interpolate||j).source,(n.evaluate||j).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(r,(function(e,n,i,r,a){return s+=t.slice(o,a).replace(H,(function(t){return"\\"+V[t]})),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(s+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),r&&(s+="';\n"+r+"\n__p+='"),o=a+e.length,e})),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{i=new Function(n.variable||"obj","_",s)}catch(t){throw t.source=s,t}if(e)return i(e,k);var a=function(t){return i.call(this,t,k)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},k.chain=function(t){return k(t).chain()};var R=function(t){return this._chain?k(t).chain():t};k.mixin(k),C(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=i[t];k.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],R.call(this,n)}})),C(["concat","join","slice"],(function(t){var e=i[t];k.prototype[t]=function(){return R.call(this,e.apply(this._wrapped,arguments))}})),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(window),function(t,e){"function"==typeof define&&define.amd?define(["underscore","jquery","exports"],(function(n,i,r){t.Backbone=e(t,r,n,i)})):"undefined"!=typeof exports?e(t,exports,_):t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,(function(t,e,n,i){var r=t.Backbone,o=[],s=o.slice;e.VERSION="1.1.2",e.$=i,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a=e.Events={on:function(t,e,n){return c(this,"on",t,[e,n])&&e?(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:n,ctx:n||this}),this):this},once:function(t,e,i){if(!c(this,"once",t,[e,i])||!e)return this;var r=this,o=n.once((function(){r.off(t,o),e.apply(this,arguments)}));return o._callback=e,this.on(t,o,i)},off:function(t,e,i){var r,o,s,a,u,l,h,f;if(!this._events||!c(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events=void 0,this;for(u=0,l=(a=t?[t]:n.keys(this._events)).length;u<l;u++)if(t=a[u],s=this._events[t]){if(this._events[t]=r=[],e||i)for(h=0,f=s.length;h<f;h++)o=s[h],(e&&e!==o.callback&&e!==o.callback._callback||i&&i!==o.context)&&r.push(o);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!c(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&l(n,e),i&&l(i,arguments),this},stopListening:function(t,e,i){var r=this._listeningTo;if(!r)return this;var o=!e&&!i;for(var s in i||"object"!=typeof e||(i=this),t&&((r={})[t._listenId]=t),r)(t=r[s]).off(e,i,this),(o||n.isEmpty(t._events))&&delete this._listeningTo[s];return this}},u=/\s+/,c=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i));return!1}if(u.test(n)){for(var o=n.split(u),s=0,a=o.length;s<a;s++)t[e].apply(t,[o[s]].concat(i));return!1}return!0},l=function(t,e){var n,i=-1,r=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s,a);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e);return}};n.each({listenTo:"on",listenToOnce:"once"},(function(t,e){a[e]=function(e,i,r){return(this._listeningTo||(this._listeningTo={}))[e._listenId||(e._listenId=n.uniqueId("l"))]=e,r||"object"!=typeof i||(r=this),e[t](i,r,this),this}})),a.bind=a.on,a.unbind=a.off,n.extend(e,a);var h=e.Model=function(t,e){var i=t||{};e||(e={}),this.cid=n.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var r,o,s,a,u,c,l,h;if(null==t)return this;if("object"==typeof t?(o=t,i=e):(o={})[t]=e,i||(i={}),!this._validate(o,i))return!1;for(r in s=i.unset,u=i.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=n.clone(this.attributes),this.changed={}),h=this.attributes,l=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]),o)e=o[r],n.isEqual(h[r],e)||a.push(r),n.isEqual(l[r],e)?delete this.changed[r]:this.changed[r]=e,s?delete h[r]:h[r]=e;if(!u){a.length&&(this._pending=i);for(var f=0,d=a.length;f<d;f++)this.trigger("change:"+a[f],this,h[a[f]],i)}if(c)return this;if(!u)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&n.clone(this.changed);var e,i=!1,r=this._changing?this._previousAttributes:this.attributes;for(var o in t)n.isEqual(r[o],e=t[o])||((i||(i={}))[o]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){void 0===(t=t?n.clone(t):{}).parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){if(!e.set(e.parse(n,t),t))return!1;i&&i(e,n,t),e.trigger("sync",e,n,t)},P(this,t),this.sync("read",this,t)},save:function(t,e,i){var r,o,s,a=this.attributes;if(null==t||"object"==typeof t?(r=t,i=e):(r={})[t]=e,i=n.extend({validate:!0},i),r&&!i.wait){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;r&&i.wait&&(this.attributes=n.extend({},a,r)),void 0===i.parse&&(i.parse=!0);var u=this,c=i.success;return i.success=function(t){u.attributes=a;var e=u.parse(t,i);if(i.wait&&(e=n.extend(r||{},e)),n.isObject(e)&&!u.set(e,i))return!1;c&&c(u,t,i),u.trigger("sync",u,t,i)},P(this,i),"patch"===(o=this.isNew()?"create":i.patch?"patch":"update")&&(i.attrs=r),s=this.sync(o,this,i),r&&i.wait&&(this.attributes=a),s},destroy:function(t){t=t?n.clone(t):{};var e=this,i=t.success,r=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(n){(t.wait||e.isNew())&&r(),i&&i(e,n,t),e.isNew()||e.trigger("sync",e,n,t)},this.isNew())return t.success(),!1;P(this,t);var o=this.sync("delete",this,t);return t.wait||r(),o},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||A();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1)}});n.each(["keys","values","pairs","invert","pick","omit"],(function(t){h.prototype[t]=function(){var e=s.call(arguments);return e.unshift(this.attributes),n[t].apply(n,e)}}));var f=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},d={add:!0,remove:!0,merge:!0},p={add:!0,remove:!1};n.extend(f.prototype,a,{model:h,initialize:function(){},toJSON:function(t){return this.map((function(e){return e.toJSON(t)}))},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,p))},remove:function(t,e){var i,r,o,s,a=!n.isArray(t);for(e||(e={}),i=0,r=(t=a?[t]:n.clone(t)).length;i<r;i++)(s=t[i]=this.get(t[i]))&&(delete this._byId[s.id],delete this._byId[s.cid],o=this.indexOf(s),this.models.splice(o,1),this.length--,e.silent||(e.index=o,s.trigger("remove",s,this,e)),this._removeReference(s,e));return a?t[0]:t},set:function(t,e){(e=n.defaults({},e,d)).parse&&(t=this.parse(t,e));var i,r,o,s,a,u,c,l=!n.isArray(t);t=l?t?[t]:[]:n.clone(t);var f=e.at,p=this.model,v=this.comparator&&null==f&&!1!==e.sort,g=n.isString(this.comparator)?this.comparator:null,m=[],y=[],w={},b=e.add,_=e.merge,x=e.remove,k=!(v||!b||!x)&&[];for(i=0,r=t.length;i<r;i++){if(o=(a=t[i]||{})instanceof h?s=a:a[p.prototype.idAttribute||"id"],u=this.get(o))x&&(w[u.cid]=!0),_&&(a=a===s?s.attributes:a,e.parse&&(a=u.parse(a,e)),u.set(a,e),v&&!c&&u.hasChanged(g)&&(c=!0)),t[i]=u;else if(b){if(!(s=t[i]=this._prepareModel(a,e)))continue;m.push(s),this._addReference(s,e)}s=u||s,!k||!s.isNew()&&w[s.id]||k.push(s),w[s.id]=!0}if(x){for(i=0,r=this.length;i<r;++i)w[(s=this.models[i]).cid]||y.push(s);y.length&&this.remove(y,e)}if(m.length||k&&k.length)if(v&&(c=!0),this.length+=m.length,null!=f)for(i=0,r=m.length;i<r;i++)this.models.splice(f+i,0,m[i]);else{k&&(this.models.length=0);var C=k||m;for(i=0,r=C.length;i<r;i++)this.models.push(C[i])}if(c&&this.sort({silent:!0}),!e.silent){for(i=0,r=m.length;i<r;i++)(s=m[i]).trigger("add",s,this,e);(c||k&&k.length)&&this.trigger("sort",this,e)}return l?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,r=this.models.length;i<r;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return s.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(t,e){return n.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"]((function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0}))},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return n.invoke(this.models,"get",t)},fetch:function(t){void 0===(t=t?n.clone(t):{}).parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var r=t.reset?"reset":"set";i[r](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},P(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?n.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,r=e.success;return e.success=function(t,n){e.wait&&i.add(t,e),r&&r(t,n,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof h)return t;(e=e?n.clone(e):{}).collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_addReference:function(t,e){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});n.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"],(function(t){f.prototype[t]=function(){var e=s.call(arguments);return e.unshift(this.models),n[t].apply(n,e)}}));n.each(["groupBy","countBy","sortBy","indexBy"],(function(t){f.prototype[t]=function(e,i){var r=n.isFunction(e)?e:function(t){return t.get(e)};return n[t](this.models,r,i)}}));var v=e.View=function(t){this.cid=n.uniqueId("view"),t||(t={}),n.extend(this,n.pick(t,m)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},g=/^(\S+)\s*(.*)$/,m=["model","collection","el","id","attributes","className","tagName","events"];n.extend(v.prototype,a,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],!1!==n&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=n.result(this,"events")))return this;for(var e in this.undelegateEvents(),t){var i=t[e];if(n.isFunction(i)||(i=this[t[e]]),i){var r=e.match(g),o=r[1],s=r[2];i=n.bind(i,this),o+=".delegateEvents"+this.cid,""===s?this.$el.on(o,i):this.$el.on(o,s,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t.class=n.result(this,"className"));var i=e.$("<"+n.result(this,"tagName")+">").attr(t);this.setElement(i,!1)}}}),e.sync=function(t,i,r){var o=w[t];n.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:o,dataType:"json"};if(r.url||(s.url=n.result(i,"url")||A()),null!=r.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",r.emulateJSON&&(s.data._method=o);var a=r.beforeSend;r.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===s.type||r.emulateJSON||(s.processData=!1),"PATCH"===s.type&&y&&(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var u=r.xhr=e.ajax(n.extend(s,r));return i.trigger("request",i,u,r),u};var y=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),w={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var b=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},_=/\((.*?)\)/g,x=/(\(\?)?:\w+/g,k=/\*\w+/g,C=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(b.prototype,a,{initialize:function(){},route:function(t,i,r){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var o=this;return e.history.route(t,(function(n){var s=o._extractParameters(t,n);o.execute(r,s),o.trigger.apply(o,["route:"+i].concat(s)),o.trigger("route",i,s),e.history.trigger("route",o,i,s)})),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(C,"\\$&").replace(_,"(?:$1)?").replace(x,(function(t,e){return e?t:"([^/?]+)"})).replace(k,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,(function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null}))}});var S=e.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},$=/^[#\/]|\s+$/g,E=/^\/+|\/+$/g,T=/msie [\w.]+/,O=/\/$/,F=/#.*$/;S.started=!1,n.extend(S.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(O,"");t.indexOf(n)||(t=t.slice(n.length))}else t=this.getHash();return t.replace($,"")},start:function(t){if(S.started)throw new Error("Backbone.history has already been started");S.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),r=document.documentMode,o=T.exec(navigator.userAgent.toLowerCase())&&(!r||r<=7);if(this.root=("/"+this.root+"/").replace(E,"/"),o&&this._wantsHashChange){var s=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=s.hide().appendTo("body")[0].contentWindow,this.navigate(i)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace($,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),S.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return t=this.fragment=this.getFragment(t),n.any(this.handlers,(function(e){if(e.route.test(t))return e.callback(t),!0}))},navigate:function(t,e){if(!S.started)return!1;e&&!0!==e||(e={trigger:!!e});var n=this.root+(t=this.getFragment(t||""));if(t=t.replace(F,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new S;h.extend=f.extend=b.extend=v.extend=S.extend=function(t,e){var i,r=this;i=t&&n.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,e);var o=function(){this.constructor=i};return o.prototype=r.prototype,i.prototype=new o,t&&n.extend(i.prototype,t),i.__super__=r.prototype,i};var A=function(){throw new Error('A "url" property or function must be specified')},P=function(t,e){var n=e.error;e.error=function(i){n&&n(t,i,e),t.trigger("error",t,i,e)}};return e})),define("smore/token",(function(t){return function(){var t=document.cookie.match(/_L="?([A-Za-z0-9\+\/\\]*)"?/);return!t||t.length<2?null:t[1]}})),define("smore/isAuthor",(function(t){return function(){return"true"===$('meta[name="smore:author"]').attr("value")}})),define("fire/net/safe",(function(t){"use strict";var e=$("body");function n(t,e,n,o){e=e||{},$.extend(e,{_token:c()});var s=$.extend({url:t,type:"POST",success:n,data:e},o),a=$.ajax(s),u=a.then(r,i);return u.success=u.done,u.error=u.fail,u.complete=u.always,u.abort=a.abort,u.setRequestHeader=a.setRequestHeader,u.getAllResponseHeaders=a.getAllResponseHeaders,u.getResponseHeader=a.getResponseHeader,n&&u.done(n),u}function i(t,e,n){var i=$.Deferred();return"abort"===e?i.reject(e,t,n):i.reject("Something went wrong :-/",t,n),i}function r(t,e,n){var i=$.Deferred();return(!t||t&&!t.status)&&i.resolve(t,e,n),t.status&&("success"===t.status&&i.resolve(t.result,e,n),"error"===t.status&&i.reject(t.message||"Something went wrong :-/",t,e,n)),i}function o(t,e){"smore"in window||(window.smore={}),window.smore[t]=function(t){(!t||t&&!t.status)&&e.resolve(t),t.status&&("success"===t.status&&e.resolve(t.result),"error"===t.status&&e.reject(t.message,t))},e.always((function(){delete window.smore[t]}))}var s={visibility:"hidden",width:1,height:1,position:"absolute",left:-1e4,top:-1e4},a=0;var u="";function c(t){return t&&(u=t),"function"==typeof u?u():u}function l(t,n,i,r){for(var o in n=$.extend({_token:c()},n),r||(r=$("<form/>").css(s).appendTo(e)),r.attr({method:"POST",target:i,action:t,enctype:"multipart/form-data"}),n)$("<input/>").attr({name:o,type:"hidden"}).appendTo(r).val(n[o]);r.submit()}return{token:c,post:n,postWithRecaptcha:function(t,e){return $.Deferred((function(i){grecaptcha.execute(window.__googleRecaptchaSiteKey,{action:"submit"}).then((function(i){return e["g-recaptcha-response"]=i,n(t,e)}),i.reject).then(i.resolve,i.reject)})).promise()},iframe:function(t,e,n){var i=$.Deferred(),r=function(){var t="iframe_name_"+ ++a,e=$("<iframe/>").css(s).attr("name",t);return $(document.body).append(e),e}().attr("name");o(r,i),l(t,e=$.extend({},e,{_iframe_id:r}),r,n);var u=i.promise();return u.abort=function(){i.reject("ABORT")},u},form:l,callbackForm:function(t,e,n,i,r){r=r||"cb";var s="form_cb_name_"+ ++a,u=$.Deferred();o(s,u);var c={};return c[r]=s,l(t,e=$.extend(c,e),n,i),u}}})),jQuery.extend(jQuery.easing,{easeOutQuad:function(t,e,n,i,r){return-i*(e/=r)*(e-2)+n},easeInCubic:function(t,e,n,i,r){return i*(e/=r)*e*e+n},easeOutCubic:function(t,e,n,i,r){return i*((e=e/r-1)*e*e+1)+n},easeOutQuart:function(t,e,n,i,r){return-i*((e=e/r-1)*e*e*e-1)+n},easeOutSine:function(t,e,n,i,r){return i*Math.sin(e/r*(Math.PI/2))+n},easeOutBack:function(t,e,n,i,r,o){return void 0===o&&(o=1.70158),i*((e=e/r-1)*e*((o+1)*e+o)+1)+n}}),define("fire/util/hub",(function(t){return $({})})),define("fire/util/json",(function(t){return{encode:function(t){return JSON.stringify(t)},decode:function(t){return JSON.parse(t)},path:function(t,e,n){for(var i,r=e.split("."),o=t;r.length&&(i=r.shift());){if(!(i in o))return n;if(o=o[i],!r.length)return o}return n},setPath:function(t,e,n){for(var i,r=e.split("."),o=t;r.length&&(i=r.shift());)if(i in o&&r.length)o=o[i];else{if(!r.length)return void(o[i]=n);o=o[i]={}}}}})),function(t){var e,n,i,r,o,s,a,u,c,l,h,f,d,p=0,v={},g=[],m=0,y={},w=[],b=null,_=new Image,x=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,k=/[^\.]\.(swf)\s*$/i,C=1,S=0,$="",E=!1,T=t.extend(t("<div/>")[0],{prop:0}),O=t.browser.msie&&t.browser.version<7&&!window.XMLHttpRequest,F=function(){n.hide(),_.onerror=_.onload=null,b&&b.abort(),e.empty()},A=function(){if(!1===v.onError(g,p,v))return n.hide(),void(E=!1);v.titleShow=!1,v.width="auto",v.height="auto",e.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),I()},P=function(){var i,r,o,a,u,c,l=g[p];if(F(),v=t.extend({},t.fn.fancybox.defaults,void 0===t(l).data("fancybox")?v:t(l).data("fancybox")),!1!==(c=v.onStart(g,p,v)))if("object"==typeof c&&(v=t.extend(v,c)),o=v.title||(l.nodeName?t(l).attr("title"):l.title)||"",l.nodeName&&!v.orig&&(v.orig=t(l).children("img:first").length?t(l).children("img:first"):t(l)),""===o&&v.orig&&v.titleFromAlt&&(o=v.orig.attr("alt")),i=v.href||(l.nodeName?t(l).attr("href"):l.href)||null,(/^(?:javascript)/i.test(i)||"#"==i)&&(i=null),v.type?(r=v.type,i||(i=v.content)):v.content?r="html":i&&(r=i.match(x)?"image":i.match(k)?"swf":t(l).hasClass("iframe")?"iframe":0===i.indexOf("#")?"inline":"ajax"),r)switch("inline"==r&&(l=i.substr(i.indexOf("#")),r=t(l).length>0?"inline":"ajax"),v.type=r,v.href=i,v.title=o,v.autoDimensions&&("html"==v.type||"inline"==v.type||"ajax"==v.type?(v.width="auto",v.height="auto"):v.autoDimensions=!1),v.modal&&(v.overlayShow=!0,v.hideOnOverlayClick=!1,v.hideOnContentClick=!1,v.enableEscapeButton=!1,v.showCloseButton=!1),v.padding=parseInt(v.padding,10),v.margin=parseInt(v.margin,10),e.css("padding",v.padding+v.margin),t(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",(function(){t(this).replaceWith(s.children())})),r){case"html":e.html(v.content),I();break;case"inline":if(!0===t(l).parent().is("#fancybox-content"))return void(E=!1);t('<div class="fancybox-inline-tmp" />').hide().insertBefore(t(l)).bind("fancybox-cleanup",(function(){t(this).replaceWith(s.children())})).bind("fancybox-cancel",(function(){t(this).replaceWith(e.children())})),t(l).appendTo(e),I();break;case"image":E=!1,t.fancybox.showActivity(),(_=new Image).onerror=function(){A()},_.onload=function(){E=!0,_.onerror=_.onload=null,M()},_.src=i;break;case"swf":v.scrolling="no",a='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+v.width+'" height="'+v.height+'"><param name="movie" value="'+i+'"></param>',u="",t.each(v.swf,(function(t,e){a+='<param name="'+t+'" value="'+e+'"></param>',u+=" "+t+'="'+e+'"'})),a+='<embed src="'+i+'" type="application/x-shockwave-flash" width="'+v.width+'" height="'+v.height+'"'+u+"></embed></object>",e.html(a),I();break;case"ajax":E=!1,t.fancybox.showActivity(),v.ajax.win=v.ajax.success,b=t.ajax(t.extend({},v.ajax,{url:i,data:v.ajax.data||{},error:function(t,e,n){t.status>0&&A()},success:function(t,r,o){if(200==("object"==typeof o?o:b).status){if("function"==typeof v.ajax.win){if(!1===(c=v.ajax.win(i,t,r,o)))return void n.hide();"string"!=typeof c&&"object"!=typeof c||(t=c)}e.html(t),I()}}}));break;case"iframe":j()}else A();else E=!1},I=function(){var n=v.width,i=v.height;n=n.toString().indexOf("%")>-1?parseInt((t(window).width()-2*v.margin)*parseFloat(n)/100,10)+"px":"auto"==n?"auto":n+"px",i=i.toString().indexOf("%")>-1?parseInt((t(window).height()-2*v.margin)*parseFloat(i)/100,10)+"px":"auto"==i?"auto":i+"px",e.wrapInner('<div style="width:'+n+";height:"+i+";overflow: "+("auto"==v.scrolling?"auto":"yes"==v.scrolling?"scroll":"hidden")+';position:relative;"></div>'),v.width=e.width(),v.height=e.height(),j()},M=function(){v.width=Math.max(_.width,350),v.height=_.height,t("<img />").attr({id:"fancybox-img",src:_.src,alt:v.title}).appendTo(e),j()},j=function(){var o,h;return n.hide(),r.is(":visible")&&!1===y.onCleanup(w,m,y)?(t.event.trigger("fancybox-cancel"),void(E=!1)):(E=!0,t(s.add(i)).unbind(),t(window).unbind("resize.fb scroll.fb"),t(document).unbind("keydown.fb"),r.is(":visible")&&"outside"!==y.titlePosition&&r.css("height",r.height()),w=g,m=p,(y=v).overlayShow?(i.css({"background-color":y.overlayColor,opacity:y.overlayOpacity,cursor:y.hideOnOverlayClick?"pointer":"auto",height:t(document).height()}),i.is(":visible")||(O&&t("select:not(#fancybox-tmp select)").filter((function(){return"hidden"!==this.style.visibility})).css({visibility:"hidden"}).one("fancybox-cleanup",(function(){this.style.visibility="inherit"})),i.show())):i.hide(),d=N(),V(),r.is(":visible")?(t(a.add(c).add(l)).hide(),o=r.position(),f={top:o.top,left:o.left,width:r.width(),height:r.height()},h=f.width==d.width&&f.height==d.height,void s.fadeTo(y.changeFade,.3,(function(){var n=function(){s.html(e.contents()).fadeTo(y.changeFade,1,H)};t.event.trigger("fancybox-change"),s.empty().removeAttr("filter").css({"border-width":y.padding,width:d.width-2*y.padding,height:v.autoDimensions?"auto":d.height-S-2*y.padding}),h?n():(T.prop=0,t(T).animate({prop:1},{duration:y.changeSpeed,easing:y.easingChange,step:z,complete:n}))}))):(r.removeAttr("style"),s.css("border-width",y.padding),"elastic"==y.transitionIn?(f=L(),s.html(e.contents()),r.show(),y.opacity&&(d.opacity=0),T.prop=0,void t(T).animate({prop:1},{duration:y.speedIn,easing:y.easingIn,step:z,complete:H})):("inside"==y.titlePosition&&S>0&&u.show(),s.css({width:d.width-2*y.padding,height:v.autoDimensions?"auto":d.height-S-2*y.padding}).html(e.contents()),void r.css(d).fadeIn("none"==y.transitionIn?0:y.speedIn,H))))},V=function(){if($=y.title||"",S=0,u.empty().removeAttr("style").removeClass(),!1!==y.titleShow)if(($=t.isFunction(y.titleFormat)?y.titleFormat($,w,m,y):function(t){return!(!t||!t.length)&&("float"==y.titlePosition?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+t+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+y.titlePosition+'">'+t+"</div>")}($))&&""!==$){switch(u.addClass("fancybox-title-"+y.titlePosition).html($).appendTo("body").show(),y.titlePosition){case"inside":u.css({width:d.width-2*y.padding,marginLeft:y.padding,marginRight:y.padding}),S=u.outerHeight(!0),u.appendTo(r),d.height+=S;break;case"over":u.css({marginLeft:y.padding,width:d.width-2*y.padding,bottom:y.padding}).appendTo(o);break;case"float":u.css("left",-1*parseInt((u.width()-d.width-40)/2,10)).appendTo(r);break;default:u.css({width:d.width-2*y.padding,paddingLeft:y.padding,paddingRight:y.padding}).appendTo(r)}u.hide()}else u.hide();else u.hide()},H=function(){t.support.opacity||(s.get(0).style.removeAttribute("filter"),r.get(0).style.removeAttribute("filter")),v.autoDimensions&&s.css("height","auto"),r.css("height","auto"),$&&$.length&&u.show(),y.showCloseButton&&a.show(),function(){if((y.enableEscapeButton||y.enableKeyboardNav)&&t(document).bind("keydown.fb",(function(e){27==e.keyCode&&y.enableEscapeButton?(e.preventDefault(),t.fancybox.close()):37!=e.keyCode&&39!=e.keyCode||!y.enableKeyboardNav||"INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName||"SELECT"===e.target.tagName||(e.preventDefault(),t.fancybox[37==e.keyCode?"prev":"next"]())})),!y.showNavArrows)return c.hide(),void l.hide();(y.cyclic&&w.length>1||0!==m)&&c.show(),(y.cyclic&&w.length>1||m!=w.length-1)&&l.show()}(),y.hideOnContentClick&&s.bind("click",t.fancybox.close),y.hideOnOverlayClick&&i.bind("click",t.fancybox.close),t(window).bind("resize.fb",t.fancybox.resize),y.centerOnScroll&&t(window).bind("scroll.fb",t.fancybox.center),"iframe"==y.type&&t('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(t.browser.msie?'allowtransparency="true""':"")+' scrolling="'+v.scrolling+'" src="'+y.href+'"></iframe>').appendTo(s),r.show(),E=!1,t.fancybox.center(),y.onComplete(w,m,y),R()},R=function(){var t;w.length-1>m&&void 0!==(t=w[m+1].href)&&t.match(x)&&((new Image).src=t),m>0&&void 0!==(t=w[m-1].href)&&t.match(x)&&((new Image).src=t)},z=function(t){var e={width:parseInt(f.width+(d.width-f.width)*t,10),height:parseInt(f.height+(d.height-f.height)*t,10),top:parseInt(f.top+(d.top-f.top)*t,10),left:parseInt(f.left+(d.left-f.left)*t,10)};void 0!==d.opacity&&(e.opacity=t<.5?.5:t),r.css(e),s.css({width:e.width-2*y.padding,height:e.height-S*t-2*y.padding})},D=function(){return[t(window).width()-2*y.margin,t(window).height()-2*y.margin,t(document).scrollLeft()+y.margin,t(document).scrollTop()+y.margin]},N=function(){var t,e=D(),n={},i=y.autoScale,r=2*y.padding;return y.width.toString().indexOf("%")>-1?n.width=parseInt(e[0]*parseFloat(y.width)/100,10):n.width=y.width+r,y.height.toString().indexOf("%")>-1?n.height=parseInt(e[1]*parseFloat(y.height)/100,10):n.height=y.height+r,i&&(n.width>e[0]||n.height>e[1])&&("image"==v.type||"swf"==v.type?(t=y.width/y.height,n.width>e[0]&&(n.width=e[0],n.height=parseInt((n.width-r)/t+r,10)),n.height>e[1]&&(n.height=e[1],n.width=parseInt((n.height-r)*t+r,10))):(n.width=Math.min(n.width,e[0]),n.height=Math.min(n.height,e[1]))),n.top=parseInt(Math.max(e[3]-20,e[3]+.5*(e[1]-n.height-40)),10),n.left=parseInt(Math.max(e[2]-20,e[2]+.5*(e[0]-n.width-40)),10),n},L=function(){var e,n,i=!!v.orig&&t(v.orig),r={};return i&&i.length?r={width:(e=function(t){var e=t.offset();return e.top+=parseInt(t.css("paddingTop"),10)||0,e.left+=parseInt(t.css("paddingLeft"),10)||0,e.top+=parseInt(t.css("border-top-width"),10)||0,e.left+=parseInt(t.css("border-left-width"),10)||0,e.width=t.width(),e.height=t.height(),e}(i)).width+2*y.padding,height:e.height+2*y.padding,top:e.top-y.padding-20,left:e.left-y.padding-20}:(n=D(),r={width:2*y.padding,height:2*y.padding,top:parseInt(n[3]+.5*n[1],10),left:parseInt(n[2]+.5*n[0],10)}),r},B=function(){n.is(":visible")?(t("div",n).css("top",-40*C+"px"),C=(C+1)%12):clearInterval(h)};t.fn.fancybox=function(e){return t(this).length?(t(this).data("fancybox",t.extend({},e,t.metadata?t(this).metadata():{})).unbind("click.fb").bind("click.fb",(function(e){if(e.preventDefault(),!E){E=!0,t(this).blur(),g=[],p=0;var n=t(this).attr("rel")||"";n&&""!=n&&"nofollow"!==n?(g=t("a[rel="+n+"], area[rel="+n+"]"),p=g.index(this)):g.push(this),P()}})),this):this},t.fancybox=function(e){var n;if(!E){if(E=!0,n=void 0!==arguments[1]?arguments[1]:{},g=[],p=parseInt(n.index,10)||0,t.isArray(e)){for(var i=0,r=e.length;i<r;i++)"object"==typeof e[i]?t(e[i]).data("fancybox",t.extend({},n,e[i])):e[i]=t({}).data("fancybox",t.extend({content:e[i]},n));g=jQuery.merge(g,e)}else"object"==typeof e?t(e).data("fancybox",t.extend({},n,e)):e=t({}).data("fancybox",t.extend({content:e},n)),g.push(e);(p>g.length||p<0)&&(p=0),P()}},t.fancybox.showActivity=function(){clearInterval(h),n.show(),h=setInterval(B,66)},t.fancybox.hideActivity=function(){n.hide()},t.fancybox.next=function(){return t.fancybox.pos(m+1)},t.fancybox.prev=function(){return t.fancybox.pos(m-1)},t.fancybox.pos=function(t){E||(t=parseInt(t),g=w,t>-1&&t<w.length?(p=t,P()):y.cyclic&&w.length>1&&(p=t>=w.length?0:w.length-1,P()))},t.fancybox.cancel=function(){E||(E=!0,t.event.trigger("fancybox-cancel"),F(),v.onCancel(g,p,v),E=!1)},t.fancybox.close=function(){if(!E&&!r.is(":hidden"))if(E=!0,y&&!1===y.onCleanup(w,m,y))E=!1;else if(F(),t(a.add(c).add(l)).hide(),t(s.add(i)).unbind(),t(window).unbind("resize.fb scroll.fb"),t(document).unbind("keydown.fb"),s.find("iframe").attr("src",O&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank"),"inside"!==y.titlePosition&&u.empty(),r.stop(),"elastic"==y.transitionOut){f=L();var e=r.position();d={top:e.top,left:e.left,width:r.width(),height:r.height()},y.opacity&&(d.opacity=1),u.empty().hide(),T.prop=1,t(T).animate({prop:0},{duration:y.speedOut,easing:y.easingOut,step:z,complete:n})}else r.fadeOut("none"==y.transitionOut?0:y.speedOut,n);function n(){i.fadeOut("fast"),u.empty().hide(),r.hide(),t.event.trigger("fancybox-cleanup"),s.empty(),y.onClosed(w,m,y),w=v=[],m=p=0,y=v={},E=!1}},t.fancybox.resize=function(){i.is(":visible")&&i.css("height",t(document).height()),t.fancybox.center(!0)},t.fancybox.center=function(){var t,e;E||(e=!0===arguments[0]?1:0,t=D(),!e&&(r.width()>t[0]||r.height()>t[1])||r.stop().animate({top:parseInt(Math.max(t[3]-20,t[3]+.5*(t[1]-s.height()-40)-y.padding)),left:parseInt(Math.max(t[2]-20,t[2]+.5*(t[0]-s.width()-40)-y.padding))},"number"==typeof arguments[0]?arguments[0]:200))},t.fancybox.init=function(){t("#fancybox-wrap").length||(t("body").append(e=t('<div id="fancybox-tmp"></div>'),n=t('<div id="fancybox-loading"><div></div></div>'),i=t('<div id="fancybox-overlay"></div>'),r=t('<div id="fancybox-wrap"></div>')),(o=t('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(r)).append(s=t('<div id="fancybox-content"></div>'),a=t('<a id="fancybox-close"></a>'),c=t('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico">&nbsp;</span></a>'),l=t('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico">&nbsp;</span></a>')),r.append(u=t('<div id="fancybox-title"></div>')),a.click(t.fancybox.close),n.click(t.fancybox.cancel),c.click((function(e){e.preventDefault(),t.fancybox.prev()})),l.click((function(e){e.preventDefault(),t.fancybox.next()})),t.fn.mousewheel&&r.bind("mousewheel.fb",(function(e,n){E?e.preventDefault():0!=t(e.target).get(0).clientHeight&&t(e.target).get(0).scrollHeight!==t(e.target).get(0).clientHeight||(e.preventDefault(),t.fancybox[n>0?"prev":"next"]())})),t.support.opacity||r.addClass("fancybox-ie"),O&&(n.addClass("fancybox-ie6"),r.addClass("fancybox-ie6"),t('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(o)))},t.fn.fancybox.defaults={padding:10,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}},t(document).ready((function(){t.fancybox.init()}))}(jQuery),function(t){function e(t){for(var e=t.getClientRects(),n=0,i=-1,r=0;r<e.length;r++){var o=e[r];i!==o.top&&(i=o.top,n+=1)}return n}function n(t,e){return e&&(t.style.fontSize=""),(n=getComputedStyle(t).fontSize)?Math.round(Number(n.replace("px",""))):0;var n}function i(t,e){t.style.fontSize=String(e)+"px"}function r(t,n,r,o){var s=n;i(t,n);for(var a=e(t);a>o&&s>r;)i(t,s=u(a,o,s,r)),a=e(t);return s}function o(t,e,n){return t.getAttribute("data-"+e)||n}function s(t,e,n,i){var r=o(t,n,i);if("string"!=typeof r)return r;if(r.substr(0,2)in{"+=":1,"-=":1}){var s=r[1];return r=parseInt(r.substr(2),10),"-"===s?e-r:e+r}return parseInt(r,10)}function a(t){var a=n(t,!0),l=Number(o(t,"lines",3)),h=s(t,a,"max","+=0"),f=s(t,a,"min",a),d=o(t,"priority","size");c(t,!0);var p,v=function(t,n,o,s,a){i(t,n);var c=e(t);if(c<=s&&1===c)return n;var l=u(c,s,n,o);i(t,o);var h=e(t);return h>s?"size"===a?o:r(t,l,20,s):r(t,l,o,h)}(t,h,f,l,d);return v=Math.max(v,20),c(t,!1),{baseFontSize:a,finalSize:v,maxLines:l,minFontSize:f,maxFontSize:h,ratio:(p=v/a,Math.min(p,1.6))}}function u(t,e,n,i){return t>3*e?Math.max(n/2,i):n-2}function c(t,e){e?t.className+="disable-rtl":t.className=t.className.replace("disable-rtl","")}t.fn.autofit=function(){return t.each(this,(function(){var e=t(this);if(!e.data("autofit-done")){var n=a(e[0]);e.data("ratio",n.ratio)}})),t.when()}}(jQuery),function(){var t=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},e=[].slice;!function(t,e){"function"==typeof define&&define.amd?define("waypoints",["jquery"],(function(n){return e(n,t)})):e(t.jQuery,t)}(this,(function(n,i){var r,o,s,a,u,c,l,h,f,d,p,v,g,m,y,w;return r=n(i),h=t.call(i,"ontouchstart")>=0,a={horizontal:{},vertical:{}},u=1,l={},c="waypoints-context-id",p="resize.waypoints",v="scroll.waypoints",g=1,m="waypoints-waypoint-ids",y="waypoint",w="waypoints",o=function(){function t(t){var e=this;this.$element=t,this.element=t[0],this.didResize=!1,this.didScroll=!1,this.id="context"+u++,this.oldScroll={x:t.scrollLeft(),y:t.scrollTop()},this.waypoints={horizontal:{},vertical:{}},t.data(c,this.id),l[this.id]=this,t.bind(v,(function(){var t;if(!e.didScroll&&!h)return e.didScroll=!0,t=function(){return e.doScroll(),e.didScroll=!1},i.setTimeout(t,n[w].settings.scrollThrottle)})),t.bind(p,(function(){var t;if(!e.didResize)return e.didResize=!0,t=function(){return n[w]("refresh"),e.didResize=!1},i.setTimeout(t,n[w].settings.resizeThrottle)}))}return t.prototype.doScroll=function(){var t,e=this;return t={horizontal:{newScroll:this.$element.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.$element.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}},!h||t.vertical.oldScroll&&t.vertical.newScroll||n[w]("refresh"),n.each(t,(function(t,i){var r,o,s;return s=[],o=i.newScroll>i.oldScroll,r=o?i.forward:i.backward,n.each(e.waypoints[t],(function(t,e){var n,r;return i.oldScroll<(n=e.offset)&&n<=i.newScroll||i.newScroll<(r=e.offset)&&r<=i.oldScroll?s.push(e):void 0})),s.sort((function(t,e){return t.offset-e.offset})),o||s.reverse(),n.each(s,(function(t,e){if(e.options.continuous||t===s.length-1)return e.trigger([r])}))})),this.oldScroll={x:t.horizontal.newScroll,y:t.vertical.newScroll}},t.prototype.refresh=function(){var t,e,i,r=this;return i=n.isWindow(this.element),e=this.$element.offset(),this.doScroll(),t={horizontal:{contextOffset:i?0:e.left,contextScroll:i?0:this.oldScroll.x,contextDimension:this.$element.width(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:i?0:e.top,contextScroll:i?0:this.oldScroll.y,contextDimension:i?n[w]("viewportHeight"):this.$element.height(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}},n.each(t,(function(t,e){return n.each(r.waypoints[t],(function(t,i){var r,o,s,a,u;if(r=i.options.offset,s=i.offset,o=n.isWindow(i.element)?0:i.$element.offset()[e.offsetProp],n.isFunction(r)?r=r.apply(i.element):"string"==typeof r&&(r=parseFloat(r),i.options.offset.indexOf("%")>-1&&(r=Math.ceil(e.contextDimension*r/100))),i.offset=o-e.contextOffset+e.contextScroll-r,(!i.options.onlyOnScroll||null==s)&&i.enabled)return null!==s&&s<(a=e.oldScroll)&&a<=i.offset?i.trigger([e.backward]):null!==s&&s>(u=e.oldScroll)&&u>=i.offset||null===s&&e.oldScroll>=i.offset?i.trigger([e.forward]):void 0}))}))},t.prototype.checkEmpty=function(){if(n.isEmptyObject(this.waypoints.horizontal)&&n.isEmptyObject(this.waypoints.vertical))return this.$element.unbind([p,v].join(" ")),delete l[this.id]},t}(),s=function(){function t(t,e,i){var r,o;"bottom-in-view"===(i=n.extend({},n.fn[y].defaults,i)).offset&&(i.offset=function(){var t;return t=n[w]("viewportHeight"),n.isWindow(e.element)||(t=e.$element.height()),t-n(this).outerHeight()}),this.$element=t,this.element=t[0],this.axis=i.horizontal?"horizontal":"vertical",this.callback=i.handler,this.context=e,this.enabled=i.enabled,this.id="waypoints"+g++,this.offset=null,this.options=i,e.waypoints[this.axis][this.id]=this,a[this.axis][this.id]=this,(r=null!=(o=t.data(m))?o:[]).push(this.id),t.data(m,r)}return t.prototype.trigger=function(t){if(this.enabled)return null!=this.callback&&this.callback.apply(this.element,t),this.options.triggerOnce?this.destroy():void 0},t.prototype.disable=function(){return this.enabled=!1},t.prototype.enable=function(){return this.context.refresh(),this.enabled=!0},t.prototype.destroy=function(){return delete a[this.axis][this.id],delete this.context.waypoints[this.axis][this.id],this.context.checkEmpty()},t.getWaypointsByElement=function(t){var e,i;return(i=n(t).data(m))?(e=n.extend({},a.horizontal,a.vertical),n.map(i,(function(t){return e[t]}))):[]},t}(),d={init:function(t,e){return null==e&&(e={}),null==e.handler&&(e.handler=t),this.each((function(){var t,i,r,a;return t=n(this),r=null!=(a=e.context)?a:n.fn[y].defaults.context,n.isWindow(r)||(r=t.closest(r)),r=n(r),(i=l[r.data(c)])||(i=new o(r)),new s(t,i,e)})),n[w]("refresh"),this},disable:function(){return d._invoke(this,"disable")},enable:function(){return d._invoke(this,"enable")},destroy:function(){return d._invoke(this,"destroy")},prev:function(t,e){return d._traverse.call(this,t,e,(function(t,e,n){if(e>0)return t.push(n[e-1])}))},next:function(t,e){return d._traverse.call(this,t,e,(function(t,e,n){if(e<n.length-1)return t.push(n[e+1])}))},_traverse:function(t,e,r){var o,s;return null==t&&(t="vertical"),null==e&&(e=i),s=f.aggregate(e),o=[],this.each((function(){var e;return e=n.inArray(this,s[t]),r(o,e,s[t])})),this.pushStack(o)},_invoke:function(t,e){return t.each((function(){var t;return t=s.getWaypointsByElement(this),n.each(t,(function(t,n){return n[e](),!0}))})),this}},n.fn[y]=function(){var t,i;return i=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],d[i]?d[i].apply(this,t):n.isFunction(i)?d.init.apply(this,arguments):n.isPlainObject(i)?d.init.apply(this,[null,i]):i?n.error("The "+i+" method does not exist in jQuery Waypoints."):n.error("jQuery Waypoints needs a callback function or handler option.")},n.fn[y].defaults={context:i,continuous:!0,enabled:!0,horizontal:!1,offset:0,triggerOnce:!1},f={refresh:function(){return n.each(l,(function(t,e){return e.refresh()}))},viewportHeight:function(){var t;return null!=(t=i.innerHeight)?t:r.height()},aggregate:function(t){var e,i,r;return e=a,t&&(e=null!=(r=l[n(t).data(c)])?r.waypoints:void 0),e?(i={horizontal:[],vertical:[]},n.each(i,(function(t,r){return n.each(e[t],(function(t,e){return r.push(e)})),r.sort((function(t,e){return t.offset-e.offset})),i[t]=n.map(r,(function(t){return t.element})),i[t]=n.unique(i[t])})),i):[]},above:function(t){return null==t&&(t=i),f._filter(t,"vertical",(function(t,e){return e.offset<=t.oldScroll.y}))},below:function(t){return null==t&&(t=i),f._filter(t,"vertical",(function(t,e){return e.offset>t.oldScroll.y}))},left:function(t){return null==t&&(t=i),f._filter(t,"horizontal",(function(t,e){return e.offset<=t.oldScroll.x}))},right:function(t){return null==t&&(t=i),f._filter(t,"horizontal",(function(t,e){return e.offset>t.oldScroll.x}))},enable:function(){return f._invoke("enable")},disable:function(){return f._invoke("disable")},destroy:function(){return f._invoke("destroy")},extendFn:function(t,e){return d[t]=e},_invoke:function(t){var e;return e=n.extend({},a.vertical,a.horizontal),n.each(e,(function(e,n){return n[t](),!0}))},_filter:function(t,e,i){var r,o;return(r=l[n(t).data(c)])?(o=[],n.each(r.waypoints[e],(function(t,e){if(i(r,e))return o.push(e)})),o.sort((function(t,e){return t.offset-e.offset})),n.map(o,(function(t){return t.element}))):[]}},n[w]=function(){var t,n;return n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],f[n]?f[n].apply(null,t):f.aggregate.call(null,n)},n[w].settings={resizeThrottle:100,scrollThrottle:30},r.load((function(){return n[w]("refresh")}))}))}.call(this),define("lib/waypoints",(function(){return $.waypoints})),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Clipboard=t()}}((function(){return function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};e[s][0].call(l.exports,(function(t){return r(e[s][1][t]||t)}),l,l.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e,n){var i=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var r=Element.prototype;r.matches=r.matchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||r.webkitMatchesSelector}e.exports=function(t,e){for(;t&&t.nodeType!==i;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}},{}],2:[function(t,e,n){function i(t,e,n,i){return function(n){n.delegateTarget=r(n.target,e),n.delegateTarget&&i.call(t,n)}}var r=t("./closest");e.exports=function(t,e,n,r,o){var s=i.apply(this,arguments);return t.addEventListener(n,s,o),{destroy:function(){t.removeEventListener(n,s,o)}}}},{"./closest":1}],3:[function(t,e,n){n.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},n.nodeList=function(t){var e=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===e||"[object HTMLCollection]"===e)&&"length"in t&&(0===t.length||n.node(t[0]))},n.string=function(t){return"string"==typeof t||t instanceof String},n.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},{}],4:[function(t,e,n){var i=t("./is"),r=t("delegate");e.exports=function(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!i.string(e))throw new TypeError("Second argument must be a String");if(!i.fn(n))throw new TypeError("Third argument must be a Function");if(i.node(t))return function(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}(t,e,n);if(i.nodeList(t))return function(t,e,n){return Array.prototype.forEach.call(t,(function(t){t.addEventListener(e,n)})),{destroy:function(){Array.prototype.forEach.call(t,(function(t){t.removeEventListener(e,n)}))}}}(t,e,n);if(i.string(t))return function(t,e,n){return r(document.body,t,e,n)}(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},{"./is":3,delegate:2}],5:[function(t,e,n){e.exports=function(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var n=t.hasAttribute("readonly");n||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),n||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var i=window.getSelection(),r=document.createRange();r.selectNodeContents(t),i.removeAllRanges(),i.addRange(r),e=i.toString()}return e}},{}],6:[function(t,e,n){function i(){}i.prototype={on:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){function i(){r.off(t,i),e.apply(n,arguments)}var r=this;return i._=e,this.on(t,i,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,r=n.length;i<r;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],r=[];if(i&&e)for(var o=0,s=i.length;o<s;o++)i[o].fn!==e&&i[o].fn._!==e&&r.push(i[o]);return r.length?n[t]=r:delete n[t],this}},e.exports=i},{}],7:[function(t,e,n){!function(i,r){if(void 0!==n)r(e,t("select"));else{var o={exports:{}};r(o,i.select),i.clipboardAction=o.exports}}(this,(function(t,e){"use strict";var n=function(t){return t&&t.__esModule?t:{default:t}}(e),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.resolveOptions(e),this.initSelection()}return r(t,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";var i=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=i+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,n.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,n.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==(void 0===t?"undefined":i(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),t}();t.exports=o}))},{select:5}],8:[function(t,e,n){!function(i,r){if(void 0!==n)r(e,t("./clipboard-action"),t("tiny-emitter"),t("good-listener"));else{var o={exports:{}};r(o,i.clipboardAction,i.tinyEmitter,i.goodListener),i.clipboard=o.exports}}(this,(function(t,e,n,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var n="data-clipboard-"+t;if(e.hasAttribute(n))return e.getAttribute(n)}var s=r(e),a=r(n),u=r(i),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),h=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.resolveOptions(n),i.listenClick(t),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),l(e,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===c(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=(0,u.default)(t,"click",(function(t){return e.onClick(t)}))}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new s.default({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return o("action",t)}},{key:"defaultTarget",value:function(t){var e=o("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return o("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,n=!!document.queryCommandSupported;return e.forEach((function(t){n=n&&!!document.queryCommandSupported(t)})),n}}]),e}(a.default);t.exports=h}))},{"./clipboard-action":7,"good-listener":4,"tiny-emitter":6}]},{},[8])(8)})),define("show/widgets/pictures",(function(t){var e=t("fire/util/hub");function n(t,e,n){var i=$(e[n]),r=(t=i.data("title")||"",i.data("description")||""),o=i.data("html-description")||"";if(!t&&!r)return null;var s=$('<div class="image-info "></div>');if(t&&s.append('<div class="image-title">'+t+"</div>"),r){var a="";o&&(r=decodeURIComponent(o),a+="theme-p theme-color-4  gallery-description"),s.append('<div class="image-description '+a+'">'+r+"</div>")}return s}function i(t,n,i){var o=$(t[n]),s=o.parents(".widget").first(),a={widget_id:s.attr("id"),href:o.attr("href"),title:o.data("title")||""},u=function(t){return(t.attr("class")||"").match(r)[1]||""}(s);u&&e.trigger("widgets:"+u+":picture",a)}var r=/widget-([a-zA-Z-0-9]+)/;$((function(){$(".fancy-pic").fancybox({titlePosition:"inside",titleFormat:n,onComplete:i}).find(".pic-border").append('<div class="magnify"></div>')}))})),define("show/widgets/videos",(function(t){var e=t("fire/util/hub"),n=t("fire/util/json");function i(t){var e=(t=$("#"+t)).find("iframe"),n=e.attr("src").split("?")[0];return{widget_id:t.attr("id"),src:n,title:e.data("title")}}$(window).on("message",(function(t){var s=t.originalEvent;switch(s.origin){case"http://player.vimeo.com":!function(t){var s=n.decode(t.data),a=s.player_id;switch(s.event){case"ready":o(a,{method:"addEventListener",value:"pause",player_id:a}),o(a,{method:"addEventListener",value:"play",player_id:a}),o(a,{method:"addEventListener",value:"finish",player_id:a});break;case"play":if(a in r)return;e.trigger("widgets:video:played",i(a)),r[a]=!0;break;case"finish":e.trigger("widgets:video:finished",i(a)),delete r[a]}}(s);case"http://www.youtube.com":!function(t){var o=n.decode(t.data);if("onStateChange"===o.event){var s=o.id,a=i(s);switch(o.info.playerState){case 1:if(s in r)return;e.trigger("widgets:video:played",a),r[s]=!0;break;case 0:e.trigger("widgets:video:finished",a),delete r[s]}}}(s)}}));var r={};function o(t,e){e=e||{},$("#"+t).find("iframe").first()[0].contentWindow.postMessage(n.encode(e),"*")}function s(t){var e=$(t).attr("id");o(e,{event:"command",func:"addEventListener",args:["onStateChange"],id:e})}$(window).load((function(){$(".widget-video-youtube").forEach(s)}))})),define("fire/util/array",(function(t){var e=Array.prototype;function n(t){return null===t?null:Array.isArray(t)?t.clone():[t]}e.remove=function(t){for(var e=n(t),i=0;i<e.length;i++){var r=this.indexOf(e[i]);if(-1==r)return this;this.splice(r,1)}return this},e.removeBy=function(t){return this.remove(this.where(t))},e.insert=function(t,e){this.splice(e,0,t)},e.insertBefore=function(t,e){var n=this.indexOf(e);-1!=n?this.insert(t,n):this.push(t)},e.insertAfter=function(t,e){var n=this.indexOf(e);-1==n||n+1>this.length?this.push(t):this.insert(t,n+1)},e.clone=e.slice,e.contains=function(t){return-1!=this.indexOf(t)},e.minus=function(t){return this.clone().remove(t)},Array.normalize=n,e.last=function(t){var e=t?this.filter(t):this;return e[e.length-1]},e.first=function(t){return(t?this.filter(t):this)[0]},e.setPush=function(t){return!this.contains(t)&&this.push(t)},e.random=function(){return this[Math.round((this.length-1)*Math.random())]},e.unique=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e],i=this.indexOf(n);i>-1&&i<e||t.push(n)}return t},e.sum=function(t){for(var e=0,n=0;n<this.length;n++)e+=t?t(this[n]):this[n];return e},e.flatten=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];Array.isArray(n)?n.flatten().forEach((function(e){t.push(e)})):t.push(n)}return t},Array.toObject=function(t){if(!t||!t.length)return{};for(var e={},n=0;n<t.length;n++)e[t[n]]=!0;return e},Array.isArray||(Array.isArray=function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&"function"==typeof t.splice&&!t.propertyIsEnumerable("length")}),e.indexOf||(e.indexOf=function(t){var e=this.length>>>0,n=Number(arguments[1])||0;for((n=n<0?Math.ceil(n):Math.floor(n))<0&&(n+=e);n<e;n++)if(n in this&&this[n]===t)return n;return-1}),e.some||(e.some=function(t,e){if(!t)return!1;e=e||window;for(var n=0;n<this.length;n++)if(t.call(e,this[n],n))return!0;return!1}),e.forEach||(e.forEach=function(t,e){for(var n=0,i=this.length;n<i;++n)t.call(e||this,this[n],n,this)}),e.filter||(e.filter=function(t,e){var n=[];if(!t)return n;e=e||window;for(var i=0;i<this.length;i++){var r=this[i];t.call(e,r,i)&&n.push(r)}return n}),e.every||(e.every=function(t,e){if(!t)return!0;e=e||window;for(var n=0;n<this.length;n++)if(!t.call(e,this[n],n))return!1;return!0}),e.map||(e.map=function(t,e){if(!t)return this;e=e||window;for(var n=[],i=0;i<this.length;i++)n.push(t.call(e,this[i],i));return n}),e.any=e.some,e.all=e.every,e.each=e.forEach,e.where=e.filter,"jQuery"in window&&["forEach","every","some","sum"].forEach((function(t){jQuery.fn[t]=e[t]}));var i=/\{0\}/g;return{toObject:Array.toObject,keys:function(t){var e=[];for(var n in t)e.push(n);return e},range:function(t,e,n){var r=[];e||(e=t,t=0);for(var o=t;o<e;o++)n?r.push(n.replace(i,o)):r.push(o);return r}}})),define("fire/util/eventEmitter",(function(t){return{Emitter:function(){var t,e;function n(){this.__ev={}}return t=0,e=function(){return"ev_"+(t+=1)},n.prototype.on=function(t,n){if(n&&(t in this.__ev||(this.__ev[t]=[]),!(this.__findCallbackIdx(t,n)>0)))return n.guid||(n.guid=e()),this.__ev[t].push(n),this},n.prototype.one=function(t,n){var i,r;return r=this,i=function(){return n.apply(this,arguments),r.off(t,n)},n.guid||(n.guid=e()),i.guid=n.guid,this.on(t,i)},n.prototype.off=function(t,e){var n;if(e)return(n=this.__findCallbackIdx(t,e))>-1&&this.__ev[t].splice(n,1),this;delete this.__ev[t]},n.prototype.trigger=function(t){var e,n,i;if(t in this.__ev){for(e=0,n=(i=this.__ev[t]).length;e<n;e++)i[e].apply(this,Array.prototype.slice.call(arguments,1));return this}},n.prototype.__findCallbackIdx=function(t,e){var n,i,r,o,s;if(!(t in this.__ev))return-1;for(r=i=0,o=(s=this.__ev[t]).length;i<o;r=++i){if((n=s[r])===e)return r;if(n.guid&&n.guid===e.guid)return r}return-1},n}()}}));var extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty,slice=[].slice;define("fire/ui/view",(function(t){return{View:function(t){function e(t){null==t&&(t={}),this.options=t,this.defaultOptions&&(this.options=$.extend({},this.defaultOptions,t)),e.__super__.constructor.apply(this,arguments),this._modifiers={},this.el=t.el,this.el?this.options=$.extend({},this.defaultOptions,this.el.data(),t):this.el=this.generate(),this.autoRender&&(this.render(),this.setup())}return extend(e,t),e.prototype.autoRender=!0,e.prototype.render=function(){return null},e.prototype.setup=function(){if(this.attrs&&this.el.attr(this.attrs),this.cssClass&&this.el.addClass(this.cssClass),this.events)return this.delegate(this._extractEvents(this.events))},e.prototype.remove=function(){return this.beforeRemove&&this.beforeRemove(),this.el&&this.el.remove(),this.removed=!0},e.prototype.find=function(t){return this.el.find(t)},e.prototype.delegate=function(t){var e,n,i,r;for(r=[],n=0,i=t.length;n<i;n++)e=t[n],r.push(this.el.on(e.name,e.selector,e.handler));return r},e.prototype.undelegate=function(t){var e,n,i,r;for(r=[],n=0,i=t.length;n<i;n++)e=t[n],r.push(this.el.off(e.name,e.selector,e.handler));return r},e.prototype.generate=function(){var t,e,n,i;if(this.templateSelector){if(i=_.result(this,"templateSelector"),e=(n=$(i)).html(),t=n.data("class")||"",!e)throw"Could not find html content with the selector "+i+".";return $("<div>").addClass(t).append(e)}},e.prototype._extractEvents=function(t){var e,n,i,r;return t?(r=this,e=function(t,e){var n,i,o,s;if(i=(o=t.split(" "))[0],s=2<=o.length?slice.call(o,1):[],!(n=r[e]))throw"The handler "+e+" was not found in "+r;return{name:i,selector:s.join(" "),handler:$.proxy(n,r)}},function(){var r;for(n in r=[],t)i=t[n],r.push(e(n,i));return r}()):[]},e.prototype.addModifier=function(t,e){var n,i;if(null==e&&(e=!1),!this.hasModifier(t))return this._modifiers[t]=!0,i=this,n=function(){if(i.el)return i.el.addClass("is-"+t)},e?setTimeout(n,20):n()},e.prototype.removeModifier=function(t){if(this.hasModifier(t))return delete this._modifiers[t],this.el?this.el.removeClass("is-"+t):void 0},e.prototype.hasModifier=function(t){return t in this._modifiers},e.prototype.modifiers=function(){var t;return function(){var e;for(t in e=[],this._modifiers)e.push(t);return e}.call(this)},e}(t("fire/util/eventEmitter").Emitter)}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/forms/validators",(function(t){var e,n;return n=[],e=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.message=this.field.options.required,!0===this.message&&(this.message="This field is required")}return extend(e,t),"This field is required",e.prototype.validate=function(){if(this.field.isEmpty())return this.message},e.isFieldMatch=function(t){return t.options.required},e}(function(){function t(t){this.field=t}return t.prototype.validate=function(){throw"NotImplemented"},t}()),n.push(e),{fromField:function(t){var e,i,r,o;for(r=[],e=0,i=n.length;e<i;e++)(o=n[e]).isFieldMatch(t)&&r.push(new o(t));return r}}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/forms/fieldView",(function(t){var e,n;return n=t("fire/ui/view"),e=t("./validators"),{FieldView:function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return extend(n,t),n.prototype.render=function(){return this.name=this.options.name||this.el.attr("name"),this.id=this.options.id||this.el.attr("id"),this.el.attr({name:this.name,id:this.id}),this.setupInputEvents(this.el),this.setupValidators()},n.prototype.setupInputEvents=function(t){var e;return t.on("focus",(e=this,function(t){return e.onInputFocus(t)})),t.on("blur",function(t){return function(e){return t.onInputBlur(e)}}(this))},n.prototype.setupValidators=function(){return this.validators=e.fromField(this)},n.prototype.onInputFocus=function(t){return this.addModifier("active")},n.prototype.onInputBlur=function(t){return this.removeModifier("active")},n.prototype.onChanged=function(){return this.isEmpty()?this.addModifier("empty"):this.removeModifier("empty"),this.setValid()},n.prototype.validateField=function(){var t;return this.setValid(),!(t=this.validate())||(this.setInvalid(t),!1)},n.prototype.validate=function(){var t,e,n,i;for(e=0,n=(i=this.validators).length;e<n;e++)if(t=i[e].validate())return t},n.prototype.value=function(){return $.trim(this.el.val())},n.prototype.isEmpty=function(){return!this.value()},n.prototype.errorSpan=function(){return $("#"+this.id+"-error")},n.prototype.setInvalid=function(t){return this.addModifier("invalid"),this.trigger("invalid",this),this.errorSpan().show().text(t)},n.prototype.setValid=function(){return this.removeModifier("invalid"),this.trigger("valid",this),this.errorSpan().hide()},n.prototype.enable=function(){return this.removeModifier("disabled")},n.prototype.disable=function(){return this.addModifier("disabled")},n.prototype.focus=function(){return this.el.focus()},n.fromEl=function(t){var e,i,r,o;for(t=$(t),e=0,r=(o=n.selectors).length;e<r;e++)if(i=o[e],t.is(i.selector))return new i.subclass({el:t});throw console.error("Can't find FieldView for ",t),"Can't find a FieldView for the field "+t},n.selectors=[],n.register=function(t,e){return n.selectors.push({selector:t,subclass:e})},n}(n.View)}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/forms/fields/textFieldView",(function(t){var e,n;return"input[type=text],input[type=email],input[type=search],input[type=url],input[type=password],select,textarea",e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.setupInputEvents=function(){var t;return e.__super__.setupInputEvents.apply(this,arguments),this.el.on("input keyup",(t=this,function(e){return t.onInput(e)})),this.el.on("paste cut",function(t){return function(e){return t.onClipboardTextChanged(e)}}(this))},e.prototype.onInput=function(t){return this.onChanged()},e.prototype.onClipboardTextChanged=function(t){return this.onChanged()},e.prototype.disable=function(){return e.__super__.disable.apply(this,arguments),this.el.attr("disabled",!0)},e.prototype.enable=function(){return e.__super__.enable.apply(this,arguments),this.el.removeAttr("disabled")},e}((n=t("fire/ui/forms/fieldView")).FieldView),n.FieldView.register("input[type=text],input[type=email],input[type=search],input[type=url],input[type=password],select,textarea",e),{TextFieldView:e}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/forms/fields/checkboxFieldView",(function(t){var e,n;return"input[type=checkbox]",e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.value=function(){return this.el.is(":checked")},e}((n=t("fire/ui/forms/fieldView")).FieldView),n.FieldView.register("input[type=checkbox]",e),{CheckboxFieldView:e}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/forms/fields/radioFieldView",(function(t){var e,n;return"div.radio-container",e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.value=function(){return this.el.find("input:radio:checked").val()},e.prototype.setupInputEvents=function(){var t,n;return e.__super__.setupInputEvents.apply(this,arguments),(t=this.el.find("input:radio")).on("focus",(n=this,function(t){return n.onInputFocus(t)})),t.on("blur",function(t){return function(e){return t.onInputBlur(e)}}(this)),t.on("change",function(t){return function(e){return t.onChanged()}}(this))},e}((n=t("fire/ui/forms/fieldView")).FieldView),n.FieldView.register("div.radio-container",e),{RadioFieldView:e}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/forms/fields/hiddenFieldView",(function(t){var e,n;return"input[type=hidden]",e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t),e.prototype.setupInputEvents=function(){return e.__super__.setupInputEvents.apply(this,arguments)},e.prototype.disable=function(){return e.__super__.disable.apply(this,arguments),this.el.attr("disabled",!0)},e.prototype.enable=function(){return e.__super__.enable.apply(this,arguments),this.el.removeAttr("disabled")},e}((n=t("fire/ui/forms/fieldView")).FieldView),n.FieldView.register("input[type=hidden]",e),{HiddenFieldView:e}})),define("fire/ui/forms/fields",(function(t){var e;return e=t("./fieldView"),t("./fields/textFieldView"),t("./fields/checkboxFieldView"),t("./fields/radioFieldView"),t("./fields/hiddenFieldView"),{FieldView:e.FieldView}})),define("fire/util/mobile",(function(t){var e,n,i,r,o,s,a,u;return i=function(){return r()||a()},e=function(){return u("(orientation: landscape)")},o=function(){return u("(orientation: portrait)")},r=function(){return u("only screen and (min-device-width: 320px) and (max-device-width: 480px)")},a=function(){return u("only screen and (min-device-width:768px) and (max-device-width:1024px)")},s=function(){return u("only screen and (-webkit-min-device-pixel-ratio : 1.5)")||u("only screen and (min-device-pixel-ratio : 1.5)")},n=function(){return u("only screen and (max-width: 720px)")},{mq:u=function(t){var e,n;return!!(n=window.matchMedia||window.msMatchMedia)&&((e=n(t))&&(e.matches||!1))},isMobile:i,isLandscape:e,isPortrait:o,isPhone:r,isTablet:a,isRetina:s,isMiniLayout:n}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;var indexOf=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};define("fire/ui/forms/formView",(function(t){var e,n,i,r,o,s;return t("fire/util/array"),s=t("fire/ui/view"),o=t("fire/net/safe"),i=t("./fields"),r=t("fire/util/mobile"),n=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return extend(n,t),".submit-button,input[type=submit]",".error-box",n.prototype.cssClass="form-view",n.prototype.defaultOptions={pleaseWaitText:"Please Wait...",fieldSelector:".form-field, .g-recaptcha-response",deliveryMethod:"ajax",validationErrorMessage:"Some of the fields are invalid.",deliveryDelay:300},n.prototype.render=function(){if(this.setupFields(),this.setupSubmitButton(),this.errorBox=this.find(".error-box").hide(),!this.options.action)return this.options.action=this.el.attr("action")},n.prototype.setupFields=function(){var t,e,n,r,o;for(this.fields=[],o=[],e=0,n=(r=this.find(this.options.fieldSelector)).length;e<n;e++)t=r[e],o.push(this.fields.push(new i.FieldView.fromEl(t)));return o},n.prototype.setupSubmitButton=function(){return this.submitButton=this.find(".submit-button,input[type=submit]"),this.options.submitText?this.submitButtonText(this.options.submitText):this.options.submitText=$.trim(this.submitButtonText()),this.submitButton.click((t=this,function(e){return t.onSubmitButtonClicked(e)}));var t},n.prototype.onSubmitButtonClicked=function(t){return t.stopPropagation(),t.preventDefault(),this.submit()},n.prototype.submit=function(){return!this.hasModifier("disabled")&&!this.hasModifier("submitting")&&(!!this.validateForm()&&(this.deliverForm(),!0))},n.prototype.reset=function(){return this.cleanup(),this.hideErrors(),this.el[0].reset()},n.prototype.deliverForm=function(){var t,e,n,i;switch(this.addModifier("submitting"),this.trigger("submitstart",this),this.submitButtonText(this.options.pleaseWaitText),this.disable(),e=this.values(),n=this.options.action,t=$.Deferred(),this.options.deliveryMethod){case"ajax":t=o.post(n,e);break;case"ajaxWithReCaptcha":t=o.postWithRecaptcha(n,e);break;case"form":o.form(n,e);break;case"iframe":t=o.iframe(n,e);break;default:throw"Bad deliveryMethod: "+this.options.deliveryMethod}return t.done((i=this,function(t){return i.onDeliveryCompleted(t)})),t.fail(function(t){return function(e,n){return t.onDeliveryFailed(e,n)}}(this)),t.promise()},n.prototype.onDeliveryCompleted=function(t){return this.result=t,setTimeout((e=this,function(){return e.trigger("success",e,t),e.cleanup()}),this.options.deliveryDelay);var e},n.prototype.onDeliveryFailed=function(t,n){return this.result=null,setTimeout((i=this,function(){return i.errors=new e,i.processServerErrors(t,n,i.errors),i.trigger("fail",i,i.error),i.showErrors(),i.cleanup()}),this.options.deliveryDelay);var i},n.prototype.processServerErrors=function(t,e,n){return n.add("server_error",t,"server_error")},n.prototype.cleanup=function(){return this.removeModifier("submitting"),this.trigger("submitcomplete",this),this.submitButtonText(this.options.submitText),this.enable()},n.prototype.submitButtonText=function(t){return this.submitButton.is("input")?t?this.submitButton.val(t):this.submitButton.val():t?this.submitButton.text(t):this.submitButton.text()},n.prototype.values=function(){var t,e,n,i,r;for(r=$.extend({},this.options.extraParams),e=0,n=(i=this.fields).length;e<n;e++)r[(t=i[e]).name]=t.value();return r},n.prototype.validateForm=function(){var t,n;return this.errors=new e,this.validate(this.fields,this.errors),n=function(){var e,n,i,r;for(r=[],e=0,n=(i=this.fields).length;e<n;e++)t=i[e],r.push(t.validateField());return r}.call(this),indexOf.call(n,!1)>=0&&this.errors.add("validation_error",this.options.validationErrorMessage),this.errors.length?(this.trigger("invalid",this),this.addModifier("invalid"),this.showErrors(),!1):(this.trigger("valid",this),this.removeModifier("invalid"),this.hideErrors(),!0)},n.prototype.validate=function(t,e){return null},n.prototype.showErrors=function(){var t,e,n,i,r;for(e="",n=0,i=(r=this.errors.errors).length;n<i;n++)(t=r[n]).description&&(e+="<p>"+t.description+"</p>");if(e)return this.errorBox.html(e).show()},n.prototype.setError=function(t){return this.errors=new e,this.errors.add("custom",t),this.showErrors()},n.prototype.hideErrors=function(){return this.errorBox.hide()},n.prototype.disable=function(){var t,e,n;for(this.addModifier("disabled"),t=0,e=(n=this.fields).length;t<e;t++)n[t].disable();return this.submitButton.addClass("is-disabled")},n.prototype.enable=function(){var t,e,n;for(this.removeModifier("disabled"),t=0,e=(n=this.fields).length;t<e;t++)n[t].enable();return this.submitButton.removeClass("is-disabled")},n.prototype.field=function(t){return this.fields.filter((function(e){return e.name===t}))[0]},n.prototype.focus=function(t){var e,n;if(null==t&&(t=null),!r.isPhone())return t?null!=(e=this.field(t))?e.focus():void 0:null!=(n=this.fields[0])?n.focus():void 0},n}(s.View),e=function(){function t(){this.clear()}return t.prototype.add=function(t,e,n){return null==n&&(n=null),this.errors.push({name:t,description:e,type:n}),this.length+=1},t.prototype.clear=function(){return this.errors=[],this.length=0},t}(),{FormView:n}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("show/widgets/event",(function(t){var e,n,i,r,o,s;if(r=t("smore/isAuthor"),i=t("fire/ui/forms/formView"),s=t("fire/ui/view"),"/app/flyer_actions/rsvp_attend",".event-rsvp-container",n=$("#smore_flyer_id").attr("value"))return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,t)," is now attending this event.",e.prototype.render=function(){var t;if(!r())return this.addModifier("visitor"),this._success=this.find(".success-box"),this._subEmail=this.find(".form-field.email-address"),this._form=new i.FormView({el:this.find(".event-rsvp-form"),deliveryMethod:"ajaxWithReCaptcha",action:"/app/flyer_actions/rsvp_attend",extraParams:{page:n,event:this.el.data("id")}}),this._form,this._form.on("submitstart",(t=this,function(){return t._success.hide()})),this._form.on("success",function(t){return function(){return t.onFormSucceed()}}(this));this.addModifier("author")},e.prototype.onFormSucceed=function(){return this._success.show().text(this._subEmail.val()+" is now attending this event."),this._form.reset()},e}(s.View),o=function(){var t,n,i,r,o;for(o=[],i=0,r=(n=$(".event-rsvp-container")).length;i<r;i++)t=n[i],o.push(new e({el:$(t)}));return o},$(o)})),define("show/pageEvents",(function(t){var e=t("fire/util/hub");function n(t,n){var i=window.pageId+"_reached_bottom";store.get(i)||"down"===n&&(e.trigger("show:reached_end_of_page"),store.set(i,!0))}t("smore/isAuthor")()||$((function(){$("#end-of-page").waypoint(n,{offset:"120%"})}))})),define("show/reporter",(function(t){var e=t("fire/util/hub"),n=t("smore/token"),i=t("fire/net/safe");t("fire/util/json");i.token(n);e.on("show:reached_end_of_page",(function(t){!function(t,e,n){if(window.pageId&&t){var r={event_key:t};e&&(r.widget=e),n&&(r.target=n),i.post("/app/reporting/page_event/"+window.pageId,r)}}("reached_bottom")})),e.on("widgets:video:played",(function(t,e){})),e.on("widgets:audio:played")})),define("show/mobile",(function(t){var e=t("fire/util/mobile"),n=$(".no-tablet, .only-screenshot, .remove-on-mobile");$((function(){var t,i;e.isMobile()&&$(n).remove(),e.isPhone()&&($(".no-mobile, .no-mobile iframe").remove(),window.smoreIsPhone=!0),t=$(".widget-header-text"),i=$(".mini-flyer-header"),_.each([".theme-title",".theme-subtitle"],(function(e){t.find(e+" span.rtl").length&&i.find(e).css("direction","rtl")}))}))})),fire.provide("smore.Embedder"),fire.require("fire.popover"),smore.Embedder=function(t){this._el=t,this._content=$("#embed-popover"),this._isFixed=this._el.data("fixed"),this._setupEvents()},smore.Embedder.prototype={_setupEvents:function(){this._el.click($.proxy(this._show,this)),this._content.find(".close").click(fire.popover.close),this._embedCodeBox=this._content.find(".embed-code-box"),this._content.find("input").focus((function(){var t=$(this);window.setTimeout((function(){t.select()}),50)}))},_show:function(){this._updateEmbedCode(),this._content.find(".short-url").val(this._shortUrl()),fire.popover.show(this._el,this._content,"",this._isFixed),window.setTimeout($.proxy((function(){this._setupClipboard()}),this),50)},_url:function(){return $("link[rel=canonical]").attr("href")},_shortUrl:function(){return $("meta[name=shorturl]").attr("content")},_title:function(){var t=$('meta[property="og:title"]').attr("content");return!t.match(/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uD800-\uDFFF\uFFFE-\uFFFF]/)?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):"Smore newsletter"},_updateEmbedCode:function(){this._embedCodeBox.val(this._generateEmbedCode(this._url(),"medium",this._title()))},_setupClipboard:function(){this._clipboardSet||(new Clipboard(".copy-button"),this._clipboardSet=!0)},_generateEmbedCode:function(t,e,n){var i;switch(e=e||"medium"){case"small":i=300;break;case"medium":i=600;break;case"large":i=1e3}return fire.format('<iframe width="100%" height="{0}" src="{1}?embed=1" title="{2}" scrolling="auto" frameborder="0" allowtransparency="true" style="min-width: 320px;border: none;"></iframe>',i,t,n)}},$((function(){$(".embed-button").each((function(){new smore.Embedder($(this))}))})),fire.provide("smore.clickable"),smore.clickable=function(t){var e=$("link[rel=canonical]").attr("href")+"?ref=email-content";t.each((function(){var t=$(this);if("#"===t.data("clicktarget")){var n=t.attr("id");if(!n)n=t.parents(".widget").first().attr("id");n&&t.attr("data-clicktarget",e+"#"+n)}}))},smore.clickable.setAllTarget=function(){$("a").attr("target","_blank")},fire.provide("fire.ui.tinyslide"),fire.ui.tinyslide=function(t){var e=t.browser.msie;return{slide:function(n,i){i=i||3e3,n.each((function(){var n=t(this),r=n.find(".slide-item").first();n.addClass("tiny-slide"),r.addClass("active"),setTimeout((function t(){if(n.is(":visible")){var o=r.siblings(".slide-item"),s=r.next(".slide-item");s.length||(s=o.first()),function(t){e&&t.animate({opacity:0},800),t.removeClass("active")}(r),r=function(t){return e&&t.animate({opacity:1},800),t.addClass("active")}(s)}setTimeout(t,i)}),i)}))}}}(jQuery),$((function(){fire.ui.tinyslide.slide($(".tiny-slide"))})),define("smore/widgetInfo",(function(t){var e={id:"",info:""};function n(t){return{id:(t=$(t)).attr("id")||"",info:t.data("widget-info")||""}}return{info:n,fromEl:function(t){if(!t)return e;var i=(t=$(t)).parents(".widget").first();return i&&i.length?n(i):e}}})),define("fire/util/strings",(function(t){function e(t,e){for(var n=arguments[0],i=0;i<arguments.length-1;i++){var r=new RegExp("\\{"+i+"\\}","gm");n=n.replace(r,arguments[i+1])}return n}return String.prototype.format=e,{format:e}})),define("smore/util/url",(function(t){var e,n,i;return e=document.location,n=$("#smore_base_domain").attr("value")||document.location.hostname,i=e.protocol+"//"+n,e.port&&(i+=":"+e.port),{domain:n,full:i}})),define("show/linkTracking",(function(t){t("fire/util/array");var e=t("fire/util/strings"),n=t("smore/isAuthor"),i=t("smore/widgetInfo"),r=t("smore/util/url").full+"/app/reporting/{0}/{1}?u={2}&t={3}&w={4}&i={5}&l={6}",o=$("#smore_short_key").attr("value");function s(t){var n=$(t);if(!n.hasClass("skip-tracking")&&n.attr("href")){var s=encodeURIComponent(n.attr("href")),c=$.trim(n.text().replace(/\s+/g," ")).substr(0,200),l=n.data("track-text")||encodeURIComponent(c),h=i.fromEl(n),f=n.data("id")||"",d=n.data("track-type")||"out",p=e.format(r,d,o,encodeURIComponent(s),l,h.id,h.info,f);n.attr({"o-href":s,"track-href":p}).one("touchstart",u).one("mousedown",a)}}function a(t){var e=$(t.currentTarget);e.data("isTouch")||(e.on("mousedown",c).on("mouseup",l).on("mouseout",h).on("click",f),c(t))}function u(t){var e=$(t.currentTarget);e.data("isTouch",!0),d(e,e.attr("track-href"))}function c(t){if(2===t.button){var e=$(t.currentTarget);d(e,e.attr("track-href"))}}function l(t){var e=$(t.currentTarget);d(e,e.attr("track-href"))}function h(t){var e=$(t.currentTarget);d(e,e.attr("o-href"))}function f(t){var e=$(t.currentTarget);d(e,e.attr("track-href")),setTimeout((function(){d(e,e.attr("o-href"))}),100)}function d(t,e){if(e=decodeURIComponent(e),$.browser.ie){var n=$("<span/>").appendTo(t);t.attr("href",e),n.remove()}else t.attr("href",e)}n()||$((function(){$(".post-container a").forEach(s)}))})),define("show/sidebar",(function(t){var e,n=!1;$((function(){$(".load-related").each((function(){var t=$(this),i=t.data("url");if(i){var r=t.data("count")||5;e||(e=$.ajax(i,{dataType:"jsonp",crossDomain:!0})),e.done((function(e){if(!n){t.removeClass("loading"),n=!0;var i=t.find(".sample-flyers");i.html(""),$($("<div>"+e.flyers+"</div>").children().slice(0,r)).appendTo(i),t.find(".board-name").html("More "+e.board.title),t.find(".board-link").attr("href",e.board.url)}})),window.setTimeout((function(){!function(t){n||(t.addClass("error").removeClass("loading"),n=!0)}(t)}),1e4)}}))}))})),define("fire/ui/overlay",(function(t){var e,n=$(document),i=$(n[0].body),r=$(window);function o(t){if(e)return r.off("resize",s),t&&e.animate({opacity:0},300),$.when(e).done((function(){e&&e.remove(),e=null}))}function s(){e&&(e.hide(),e.css({width:i[0].scrollWidth,height:i[0].scrollHeight}),e.show())}return{show:function(t,n,a){o(),t=t||5e3;var u=$.Deferred(),c=$("<div/>").addClass("fire-shim "+(n||""));return e=c.css({position:"absolute","z-index":t,top:0,left:0,overflow:"hidden"}),r.on("resize",s),s(),i.prepend(c),c.click((function(t){u.resolve(t),a&&o()})),u.promise()},remove:o}})),define("fire/ui/popover",(function(t){var e,n,i,r,o=t("fire/ui/overlay"),s=$(document),a=$(s[0].body),u=$(window);function c(){p&&v&&(p.css("position",h()),l())}function l(){var t,i=function(t){var n=t.offset();if(e){var i=u.scrollTop(),r=u.scrollLeft();return{left:n.left-r,top:n.top-i}}return n}(v),o=v.outerWidth(),s=p.outerWidth();if(r){var a=parseInt(d.css("right")),c=d.outerWidth()/2;t=i.left+o/2-s+a+c}else t=i.left+o/2-s/2;var l=0;l=n?i.top-p.outerHeight()-2:i.top+v.outerHeight()-2,p.css({top:l,left:t}),window.setTimeout(y,20)}function h(){return e?"fixed":"absolute"}var f,d=null,p=null,v=null;function g(){m(),p&&(i&&a.append(i.hide()),p&&p.remove(),v&&v.removeClass("active"),i=p=v=null,o.remove())}function m(){f&&(f.remove(),f=null)}function y(){var t=$.fn.placeholderPolyfill;p&&t&&t(p,!0)}return{mask:function(t,e){if(p){m();var n=p.find(".content").first(),i=$('<div class="popover-mask"><div class="mask-content">'+t+"</div></div> ");e&&i.addClass(e),i.css({width:n.outerWidth(),height:n.outerHeight()}),n.before(i),f=i}},hideMask:m,close:g,refresh:c,show:function(t,s,f,m,y,w){void 0===y&&(y=!0),g();var b,_=$.Deferred(),x=o.show();y&&($.isFunction(y)?x.done((function(){y()&&(g(),_.resolve())})):x.done(g).done(_.resolve)),w&&(window.onresize=g),e=m,n=t.hasClass("pop-above"),r=t.hasClass("pop-center-arrow"),v=t,i=s,(b=$('<div class="popover classic-box-fix"><div class="arrow"></div><div class="inner"><div class="content"></div></div></div>')).addClass(n?"popover-above":"popover-below"),b.css({"z-index":6e3,position:h()}),i.show(),b.find(".content").append(i),d=(p=b).find(".arrow"),f&&p.addClass(f),a.append(p),l(),v.addClass("active"),u.on("resize",c);var k=_.promise();return k.el=p,k}}})),fire.popover=fire.ui.popover,define("show/footer",(function(t){var e=t("fire/ui/popover"),n=$(".report-button"),i=$(".report-popover"),r=$(".translate-button"),o=$(".translate-popover"),s=i.find(".send"),a=o.find(".gray-button"),u=i.find("textarea");function c(t){e.show(n,i).done(e.close),window.setTimeout((function(){i.find("textarea").focus()}),100)}function l(t){e.show(r,o,void 0,void 0,void 0,!0).done(e.close)}function h(t){e.mask("Reporting..."),$.safePost("/app/pages/report_offensive",{page_id:window.pageId,reason:$.trim(u.val())}).always(f)}function f(){e.mask("newsletter reported! Thank you!"),setTimeout(d,1500)}function d(){e.close(),e.hideMask(),u.val("")}function p(t){27!=t.which||d()}$((function(){$(".play-smore-video").fancybox({type:"iframe",href:"https://player.vimeo.com/video/29872340?autoplay=1",orig:$(".footer-video .play-video"),width:700,height:390}),n.click(c),s.click(h),u.keyup(p),i.find(".cancel").click(d),r.click(l),a.click(e.close)}))})),define("show/stickyShare",(function(t){var e=$(".social-floater"),n=$("#end-of-page");$((function(){var t=e.outerHeight();n.waypoint((function(i,r){if("down"===r){var o=n.offset().top-t-85;o=Math.max(o,86),e.css({top:o,position:"absolute"})}else e.css({top:"auto",position:"fixed"})}),{offset:158+t+6})}))})),define("fire/ui/pleaseWait",(function(t){return{wait:function(t,e,n){return"pending"!==t.state()||(e=$(e),n&&(i=e.text()),e.addClass("disabled").attr("disabled",!0),n&&e.text(n),t.always((function(){e.removeClass("disabled").removeAttr("disabled"),i&&e.text(i)}))),t;var i},disabled:function(t){return $(t).is(".disabled")}}})),define("show/orgDuplicate",(function(t){var e=t("fire/ui/pleaseWait"),n=$(".org-duplicate-button");function i(t){document.location=t,n.addClass("disabled").attr("disabled",!0).text("Please wait...")}function r(t){alert(t.message)}n.click((function(t){if(confirm("Make a copy of this newsletter and start editing?")){var o=$.safePost("/app/pages/duplicate_to_account",{id:window.pageId});e.wait(o,n,"Please wait..."),o.done(i).fail(r)}}))})),define("smore/util/report",(function(t){var e,n;return 300,e={},{track:function(t,i,r){var o;if(null==i&&(i={}),null==r&&(r=!1),t){if(i=$.extend(n(),i),r&&window.JSON){if((o=t+"-"+JSON.stringify(i))in e)return;e[o]=!0}return DEVMODE&&console.log("%cevent:","color:green",t,i,r),$.ajax({url:"/app/users/track",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({event:t,props:i})})}DEVMODE&&console.error("Event name wasn't provided!")},ab:n=function(){var t,e,n,i,r,o;for(o={},n=0,r=(e=$(".smore-ab-test-meta")).length;n<r;n++)(i=(t=e[n]).getAttribute("key"))&&(o["ab_test_"+i]=t.getAttribute("content"));return o}}})),define("show/suggestedFlyerDuplicate",(function(t){var e=t("smore/util/report"),n=(t("fire/ui/pleaseWait"),$(".suggested-flyer-duplicate-button"));function i(t){try{e.track("FLYER: Copy suggested flyer clicked",r())}finally{window.location="/app/pages/duplicate_suggested_flyer/"+window.pageId}}function r(){return{flyer_id:window.pageId}}$((function(){if(n.click(i),window.__isSuggestedFlyer)try{e.track("FLYER: Opened suggested flyer",r())}catch(t){}}))})),define("show/signupPopover",(function(t){var e,n;return n=t("smore/isAuthor"),e=function(){function t(){this.popover=$("#signup-popover"),this.signupButton=this.popover.find(".signup-button"),this.setupEvents(),this.isClosed()||this.queue()}return 25e3,"ssp=true",t.prototype.setupEvents=function(){return this.popover.find(".close").click((t=this,function(){return t.onCloseClicked()}));var t},t.prototype.queue=function(){return setTimeout((t=this,function(){return t.show()}),25e3);var t},t.prototype.isClosed=function(){return n()||-1!==document.cookie.indexOf("ssp=true")},t.prototype.show=function(){return this.popover.addClass("active"),setTimeout((t=this,function(){return t.popover.css("opacity",1)}),100);var t},t.prototype.onCloseClicked=function(){return this.popover.removeClass("active"),document.cookie="ssp=true"},t}(),$((function(){return new e}))})),define("fire/ui/modal",(function(t){var e,n,i,r,o=t("fire/ui/overlay"),s=t("fire/util/mobile"),a={animate:!0,width:500,overlayClose:!0,loadingTitle:"Loading...",overlayClass:"",close:null,cssClass:"",loadingSubtitle:"",zIndex:101,skipOverlay:!1,containerEl:!1},u=$(window),c=$("body"),l="ontouchend"in document,h=s.isPhone();function f(t,n){var r=$.Deferred();return"resolved"===t.state()?(t.done((function(t){return d(t,n).done(r.resolve),r.promise()})),r.promise()):(d(function(t){var e=$.extend({},a,t||{});return'<div class="spinner"><h3><span></span>'+e.loadingTitle+'</h3><p class="help-text">'+e.loadingSubtitle+"</p></div>"}(n),n).done((function(){t.done((function(t){i.html(t),p(),r.resolve(e)})).fail((function(t){i.html('<div class="fire-modal-error-content" style="padding:15px"><h3 class="webfont">Oops! Something bad happened :/</h3><p>Hope we can still be friends...</p> <p style="margin-top: 15px;"><a class="fire-modal-close">Close this</a> or <a href="mailto:hello@smore.com">Contact support</a>.</div></div>'),e.addClass("fire-modal-error"),p(),r.reject(e)}))})),r.promise())}function d(t,i){var r=$.Deferred();if(n=$.extend({},a,i,{}),m(),h)return function(t){return w=c.scrollTop(),function(){y=c.children(":visible").hide()}(),e=v(t,"fire-modal-mobile",c),c.addClass("mobile-modal-body"),c.scrollTop(0),$.when(e)}(t);var s=i.containerEl||c;if(e=v(t,"fire-modal",s),i.containerEl&&e.data("containerEl",i.containerEl),e.css("width",i.width),!i.skipOverlay){var u="fire-modal-overlay";i.overlayClass&&(u+=" "+i.overlayClass);var l=o.show(n.zIndex,u,n.overlayClose);n.overlayClose&&l.done(m)}return p(),i.resolveBeforeAnimation&&r.resolve(e),n.animate&&g("show",e),$.when(e).done(r.resolve),r.promise()}function p(){if(e&&!h){var t=e.width(),n=e.height(),i=0,r=0;if(e.data("containerEl")){var o=e.data("containerEl");(r=o.height()/2-n/2)<0&&(r=50),i=o.width()/2-t/2}else{var s=u.scrollTop(),a=u.scrollLeft(),c=window.innerWidth||u.width();(r=s+(window.innerHeight||u.height())/2-n/2)<s&&(r=s+50),i=a+c/2-t/2}e.css({top:r,left:i}),window.setTimeout(b,20)}}function v(t,e,r){var o=$(t).show(),s=$("<div/>").addClass(e+"  "+(n.cssClass||"")).addClass("classic-box-fix");return i=o.wrap("<div/>").parent().addClass("fire-modal-content"),s.append(i),r.append(s),s.delegate(".fire-modal-close","click",x),s}function g(t,e){return e?(e.addClass("no-shadow"),"show"===t&&e.css({"margin-top":"-50px",opacity:0}).show().animate({"margin-top":0,opacity:1},250),"hide"===t&&e.animate({"margin-top":"50px",opacity:0},250),$.when(e).done((function(){e.removeClass("no-shadow")}))):$.when()}function m(t){if(!e)return $.when();if(h)return function(){var t=e;n&&n.close&&n.close(t);t.remove(),i=e=n=t=null,y.show(),void(y=null),c.removeClass("mobile-modal-body"),w&&(c.scrollTop(w),w=null);return $.when()}();_();var r=e;u.off("resize",p);var s=o.remove(!t&&n.animate);return n.animate&&!t&&g("hide",r),$.when(s,r).done((function(){$("div.tipsy").hide(),n&&n.close&&n.close(r),r.detach();var t=e.data("containerEl");i=e=n=r=null,t&&t.remove()}))}var y,w=null;function b(){var t=$.fn.placeholderPolyfill;e&&t&&t(e,!0)}function _(){r=!1,e&&e.removeClass("fire-modal-locked")}function x(t){t.preventDefault(),t.stopImmediatePropagation();var e=$(t.currentTarget);r||e.hasClass("disabled")||m()}l||u.on("resize",p);var k={close:m,show:d,showUrl:function(t,e){return f($.get(t),e)},showDeferred:f,position:p,lock:function(){r=!0,e&&e.addClass("fire-modal-locked")},unlock:_};return window.fire.modal=k,window.fire.modal.reposition=p,k})),define("fire/util/history",(function(t){var e,n,i,r,o;return e=0,"__history_key",i=function(){return"history_key_"+(e+=1)},r=$({}),o=function(t){var e,n;if(n=t.originalEvent.state)return(e=n.__history_key)?r.trigger(e,n):void 0},$(window).on("popstate",o),n=function(){function t(t){this.id=i(),r.on(this.id,t)}return t.prototype.push=function(t){var e;if(null==t&&(t={}),t.__history_key=this.id,history.pushState)try{if(e=JSON.stringify(history.state),JSON.stringify(t)===e)return;return history.pushState(t,document.title,document.location.href)}catch(t){}},t.prototype.pop=function(){return null},t.prototype.remove=function(){return r.off(this.id)},t}(),{getHelper:function(t){return new n(t)}}}));var bind=function(t,e){return function(){return t.apply(e,arguments)}};extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/views/ModalView",(function(t){var e,n,i;return n=t("fire/ui/modal"),i=t("fire/ui/view"),e=t("fire/util/history"),{ModalView:function(t){var i;function r(t,n){var i;this.url=t,this.onModalCompleted=bind(this.onModalCompleted,this),r.__super__.constructor.call(this,n),this.enableHistory&&(this.historyHelper=e.getHelper((i=this,function(t,e){if(e&&e.init)return i.close()}))),this.preload&&this.getContent()}return extend(r,t),i={},r.prototype.autoRender=!1,r.prototype.preload=!1,r.prototype.show=function(t){var e;return e=$.proxy(this.onClose,this),this.preload&&(t=$.extend({},{resolveBeforeAnimation:!0,close:e},t)),n.showDeferred(this.getContent(),t).always(this.onModalCompleted)},r.prototype.onModalCompleted=function(t){return this.enableHistory&&this.historyHelper.push({init:!0}),this.el=t,this.setup(),this.setupModalEvents(),this.render(),n.position()},r.prototype.close=function(t){return n.close(t)},r.prototype.onClose=function(){return this.closed=!0},r.prototype.setupModalEvents=function(){return null},r.prototype.getContent=function(){var t,e;return this._loadedContent?$.when(this._loadedContent):(t=this._loadContent(),this.preload&&t.done((e=this,function(t){return e._loadedContent=t})),t)},r.prototype._loadContent=function(){var t;return this.preload?null!=i[t=this.url]?i[t]:i[t]=$.get(this.url):$.get(this.url)},r.preloadUrl=function(t){return i[t]=$.get(t)},r}(i.View)}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("smore/ui/login/signupFormView",(function(t){return{SignupFormView:function(t){function e(){e.__super__.constructor.apply(this,arguments),this.options.validationErrorMessage=""}return extend(e,t),e.prototype.onSubmitButtonClicked=function(t){return this.setupFields(),e.__super__.onSubmitButtonClicked.apply(this,arguments)},e.prototype.processServerErrors=function(t,e,n){var i,r,o,s,a,u,c,l;switch(t){case"invalid":for(r="",o=0,s=(c=e.code).length;o<s;o++)i=(a=c[o])[0],u=a[1],null!=(l=this.field(i))&&l.setInvalid(u),r=r||u;n.add("invalid",!1);break;case"tryfacebook":n.add("tryfacebook","Try logging in with your Facebook account.");break;case"trygoogle":n.add("trygoogle","In order to login with Gmail, please use the Continue with Google button below.");break;case"tryemail":n.add("tryemail","Try logging in with your email.");break;case"invaliddomain":document.location=e.redirect_url;break;case"trysaml":e.redirect_url?document.location=e.redirect_url:n.add("trysaml","Try logging in with your SAML account.");break;case"user exists":n.add("user exists","We already have a user with that email. Try logging in instead.","field_error",{target:"email"});break;default:"google_recaptch_error"===e.code?n.add("confirm_not_a_robot","Please confirm you are not a robot"):n.add("unknown","Something is broken. Try again later :(")}if(window.grecaptcha)return grecaptcha.reset()},e}(t("fire/ui/forms/formView").FormView)}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("smore/ui/login/loginFormView",(function(t){return{LoginFormView:function(t){function e(){e.__super__.constructor.apply(this,arguments),this.options.validationErrorMessage=""}return extend(e,t),e.prototype.processServerErrors=function(t,e,n){switch(t){case"tryfacebook":n.add("tryfacebook","Try logging in with your Facebook account.");break;case"trygoogle":n.add("trygoogle","In order to login with Gmail, please use the Continue with Google button below.");break;case"trysaml":e.redirect_url?document.location=e.redirect_url:n.add("trysaml","Try logging in with your SAML account.");break;case"invaliduser":n.add("invaliduser","Please enter your email","field_error",{target:"email"});break;case"nouser":n.add("nouser","Wrong email or password","field_error",{target:"email"});break;case"tryemail":n.add("tryemail","Try logging in with your email.");break;case"badpassword":n.add("badpassword","Wrong email or password","field_error",{target:"email"});break;default:n.add("unknown","Something is broken. Try again later :(")}if(window.grecaptcha)return grecaptcha.reset()},e}(t("fire/ui/forms/formView").FormView)}})),define("fire/net/popup",(function(t){var e=t("fire/util/strings");var n=0;function i(t,n,i,r,o){var s=window.open(t,o||"",function(t,n){return e.format("width={0},height={1},location=no,status=no",t,n)}(n,i)),a=setInterval((function(){s&&!s.closed||(clearInterval(a),r())}),20);return s}return{open:function(t,e,r,o){if(!t)throw"Url must be defined!";o=o||"cb";var s=$.Deferred(),a="__pop_cb_"+ ++n;function u(t){if("pending"===s.state()){switch(t&&"object"==typeof t||s.reject("NO_DATA"),t.status){case"success":s.resolve(t.result);break;case"error":s.reject(t.message,t.redirect_url);break;default:s.reject("NO_DATA")}delete window[a]}}window[a]=u;var c=i(function(t,e,n){var i=e+"="+n;if(-1!==t.indexOf("%{cb}"))return t.replace("%{cb}",i);return-1===t.indexOf("?")?t+"?"+i:t+"&"+i}(t,o,a),e,r,(function(){u({status:"error",message:"POPUP_CLOSED"})})),l=s.promise();return l.abort=function(){!function(t,e){if("pending"!==e.state())return;try{t.close()}catch(t){}}(c,s)},l},openPopup:i}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("smore/ui/login/facebookConnectView",(function(t){var e,n;return n=t("fire/ui/view"),e=t("fire/net/popup"),{FacebookConnectView:function(t){var n;function i(){return i.__super__.constructor.apply(this,arguments)}return extend(i,t),n={width:600,height:450},i.prototype.cssClass="facebook-connect-button",i.prototype.events={click:"onConnectClicked"},i.prototype.defaultOptions={pleaseWaitText:"Please wait...",connectUrl:"/app/users/connect"},i.prototype.render=function(){return this.textSpan=this.find(".text-content"),this.options.text?this.textSpan.text(this.options.text):this.options.text=$.trim(this.textSpan.text())},i.prototype.onConnectClicked=function(t){var i;if(!this.hasModifier("disabled")&&!this.hasModifier("connecting"))return this.addModifier("connecting"),this.trigger("connectstart",this),this.disable(),this.textSpan.text(this.options.pleaseWaitText),this.popup=e.open(this.generateUrl(),n.width,n.height),this.popup.done((i=this,function(t){return i.onPopupComplete(t)})),this.popup.fail(function(t){return function(e){return t.onPopupFailed(e)}}(this))},i.prototype.generateUrl=function(){var t,e,n;return t=$.extend({},this.options.connectParams),this.options.buttonId&&(t.signup_button=this.options.buttonId),this.options.signupSegment&&(t.segment=this.options.signupSegment),!0===this.el.data("prevent-signup")&&(t.prevent_signup=!0),e=$.param(t),(n=this.options.connectUrl).indexOf("?")>0?n+="&":n+="?",n+e},i.prototype.onPopupComplete=function(t){var e;return e=t.is_new?"signup":"login",this.trigger("success",this,e,t),this.trigger(e,this,t),this.cleanup()},i.prototype.onPopupFailed=function(t){switch(t){case"POPUP_CLOSED":case"fb_cancel":this.trigger("cancel",this,{preventSignup:this.el.data("prevent-signup")});break;default:this.trigger("fail",this,t)}return this.cleanup()},i.prototype.cleanup=function(){return this.textSpan.text(this.options.text),this.removeModifier("connecting"),this.trigger("connectcomplete",this),this.enable(),this.popup.abort()},i.prototype.enable=function(){return this.removeModifier("disabled")},i.prototype.disable=function(){return this.addModifier("disabled")},i.prototype.beforeRemove=function(){var t;return null!=(t=this.popup)?t.abort():void 0},i}(n.View)}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("smore/ui/login/googleConnectView",(function(t){var e,n;return n=t("fire/ui/view"),e=t("fire/net/popup"),{GoogleConnectView:function(t){var n;function i(){return i.__super__.constructor.apply(this,arguments)}return extend(i,t),n={width:500,height:660},i.prototype.cssClass="google-connect-button",i.prototype.events={click:"onConnectClicked"},i.prototype.defaultOptions={pleaseWaitText:"Please wait...",connectUrl:"/app/users/google_connect"},i.prototype.render=function(){return this.textSpan=this.find(".text-content"),this.options.text?this.textSpan.text(this.options.text):this.options.text=$.trim(this.textSpan.text())},i.prototype.onConnectClicked=function(t){var i;if(!this.hasModifier("disabled")&&!this.hasModifier("connecting"))return this.addModifier("connecting"),this.trigger("connectstart",this),this.disable(),this.textSpan.text(this.options.pleaseWaitText),this.popup=e.open(this.generateUrl(),n.width,n.height),this.popup.done((i=this,function(t){return i.onPopupComplete(t)})),this.popup.fail(function(t){return function(e,n){return t.onPopupFailed(e,n)}}(this))},i.prototype.generateUrl=function(){var t,e,n;return t=$.extend({},this.options.connectParams),this.options.buttonId&&(t.signup_button=this.options.buttonId),this.options.signupSegment&&(t.segment=this.options.signupSegment),!0===this.el.data("prevent-signup")&&(t.prevent_signup=!0),e=$.param(t),(n=this.options.connectUrl).indexOf("?")>0?n+="&":n+="?",n+e},i.prototype.onPopupComplete=function(t){var e;return e=t.is_new?"signup":"login",this.trigger("success",this,e,t),this.trigger(e,this,t),this.cleanup()},i.prototype.onPopupFailed=function(t,e){switch(t){case"POPUP_CLOSED":case"fb_cancel":this.trigger("cancel",this,{preventSignup:this.el.data("prevent-signup")});break;default:this.trigger("fail",this,t,e)}return this.cleanup()},i.prototype.cleanup=function(){return this.textSpan.text(this.options.text),this.removeModifier("connecting"),this.trigger("connectcomplete",this),this.enable()},i.prototype.enable=function(){return this.removeModifier("disabled")},i.prototype.disable=function(){return this.addModifier("disabled")},i}(n.View)}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("smore/ui/login/modal",(function(t){var e,n,i,r,o,s,a,u,c,l,h;return c=t("fire/ui/views/ModalView"),l=t("./signupFormView"),u=t("./loginFormView"),o=t("./facebookConnectView"),s=t("./googleConnectView"),t("smore/util/report"),e="/app/users/login_modal",DEVMODE&&(e+="?_t="+Number(new Date)),i={cssClass:"base-modal login-modal",width:406,overlayClose:!0,overlayClass:"login-modal-overlay"},"/app",n=function(t){function n(t){n.__super__.constructor.call(this,e,t),this.state=this.options.state}return extend(n,t),{login_modal_open:"LOGIN MODAL: Open"},n.prototype.preload=!0,n.prototype.enableHistory=!0,n.prototype.events={"click .switch-state":"onSwitchStateClicked"},n.prototype.defaultOptions={state:"signup"},n.prototype.render=function(){var t,e,n,i;return n={signup_button:t=this.options.buttonId},(e=this._signupSegment())&&(n.segment=e),this.loginForm=new u.LoginFormView({el:this.find(".login-form")}),this.loginForm.on("success",(i=this,function(t,e){return i.onSuccess("login",e)})),this.signupForm=new l.SignupFormView({el:this.find(".signup-form"),extraParams:n}),this.signupForm.on("success",function(t){return function(e,n){return t.onSuccess("signup",n)}}(this)),this.signupGoogleConnect=new s.GoogleConnectView({el:this.find(".only-signup .google-connect-button"),buttonId:t,signupSegment:e}),this.signupGoogleConnect.on("success",function(t){return function(e,n,i){return t.onSuccess(n,i)}}(this)).on("fail",function(t){return function(e,n){return t.onSignupFailed(n)}}(this)),this.loginGoogleConnect=new s.GoogleConnectView({el:this.find(".only-login .google-connect-button"),buttonId:t,signupSegment:e}),this.loginGoogleConnect.on("success",function(t){return function(e,n,i){return t.onSuccess(n,i)}}(this)).on("fail",function(t){return function(e,n,i){return t.onLoginFailed(n,i)}}(this)),this.signupfbConnect=new o.FacebookConnectView({el:this.find(".only-signup .facebook-connect-button"),buttonId:t,signupSegment:e}),this.signupfbConnect.on("success",function(t){return function(e,n,i){return t.onSuccess(n,i)}}(this)).on("fail",function(t){return function(e,n,i){return t.onSignupFailed(n,i)}}(this)),this.loginfbConnect=new o.FacebookConnectView({el:this.find(".only-login .facebook-connect-button"),buttonId:t,signupSegment:e}),this.loginfbConnect.on("success",function(t){return function(e,n,i){return t.onSuccess(n,i)}}(this)).on("fail",function(t){return function(e,n){return t.onLoginFailed(n)}}(this)),this.setState(this.state),this.setupDisableState(this.loginForm,this.loginfbConnect,this.loginGoogleConnect),this.setupDisableState(this.signupForm,this.signupfbConnect,this.signupGoogleConnect)},n.prototype._signupSegment=function(){return $('meta[name="smore:signup_segment"]').attr("value")},n.prototype.setupDisableState=function(t,e,n){var i;return t.on("submitstart",(i=this,function(t){return e.disable(),n.disable(),i.addModifier("pending",!0)})),t.on("submitcomplete",function(t){return function(i){return e.enable(),n.enable(),t.removeModifier("pending")}}(this)),e.on("connectstart",function(e){return function(i){return t.disable(),n.disable(),e.addModifier("pending",!0)}}(this)),e.on("connectcomplete",function(e){return function(i){return t.enable(),n.enable(),e.removeModifier("pending")}}(this)),n.on("connectstart",function(n){return function(i){return t.disable(),e.disable(),n.addModifier("pending",!0)}}(this)),n.on("connectcomplete",function(n){return function(i){return t.enable(),e.enable(),n.removeModifier("pending")}}(this))},n.prototype.setState=function(t){return this.removeModifier(this.state),this.addModifier(t),this.state=t,"login"===t?this.loginForm.focus():this.signupForm.focus()},n.prototype.onSwitchStateClicked=function(t){var e;if(e=$(t.currentTarget).data("target"))return this.setState(e)},n.prototype.show=function(){if(n.__super__.show.call(this,i),window.ga)return ga("send","pageview","/app/users/signup_modal")},n.prototype.onSuccess=function(t,e){var n;if(!this.closed)return this.options.onSuccess?this.options.onSuccess(this,t,e):($("body").hide(),this.options.reloadOnly?document.location.reload():("app/reporting/report_errors"===(n=this.options.overrideRedirect||e.redirect_url||"/app")&&(n="/app"),document.location=n))},n.prototype.onLoginFailed=function(t,e){return this.handleFailure(t,this.loginForm,e)},n.prototype.onSignupFailed=function(t,e){return this.handleFailure(t,this.signupForm,e)},n.prototype.handleFailure=function(t,e,n){var i;if(i="Something is broken. Try again later: (","tryemail"===t&&(i="Try logging in with your email"),"trygoogle"===t&&(i="In order to login with Gmail, please use the Continue with Google button below."),"tryfacebook"===t&&(i="Try logging in with your Facebook account"),"trysaml"===t&&(i="Logging in with this email address requires SSO"),"recaptch"===t&&(i="Confirm you are not a robot"),"fbwithnoemail"===t&&(i="Whoops! Looks like youve prevented Facebook from sharing your email address, which is necessary to sign up. Please try again, and be sure to allow Facebook to share your email address."),n?document.location=n:e.setError(i),window.grecaptcha)return grecaptcha.reset()},n.prototype.onClose=function(){return n.__super__.onClose.apply(this,arguments),this.signupfbConnect.remove(),this.loginfbConnect.remove()},n}(c.ModalView),h=function(t,e){var i,r;return null==e&&(e={}),r=$.extend({},t.data(),e),(i=new n(r)).show(),i},a=function(){var t;return(t=document.cookie.match(/_L="?([A-Za-z0-9\+\/\\]*)"?/))&&t.length>=2||$("body.logged_in").length},r=function(){return $(".auto-quick-login").on("click",(function(t){var e;return t.preventDefault(),e=$(t.currentTarget),h(e)})),c.ModalView.preloadUrl(e)},$(r),{LoginModalView:n,show:h,isLoggedIn:a}})),define("smore/ui/views/overlay",(function(t){return{OverlayView:Backbone.View.extend({className:"smore-overlay",events:{click:"_onOverlayClicked"},initialize:function(t){this.options=t||{},this.closeOnClick=this.options.closeOnClick||!1,this.allowAccessToolbar=this.options.allowAccessToolbar||!1,this.type=this.options.type||"modal",this.scrollContainer=$("<div/>").addClass("smore-modal-scroll-wrapper").attr("id","modal-scroll-container")},_onOverlayClicked:function(t){if(t.target===this.el||t.target===this.scrollContainer.get(0)){var e=this.options.clickCallback;_.isFunction(e)&&e(),this.closeOnClick&&this.hide()}},show:function(){this.render(),this.$el.addClass("smore-overlay-"+this.type),this.allowAccessToolbar&&this.$el.addClass("smore-overlay-bellow-toolbar"),"modal"!==this.type&&"modal-fixed"!==this.type||this.$el.append(this.scrollContainer);var t=this.getContainer();"modal-fixed"!==this.type&&this.$el.css("min-height",this.getMinHeight(t[0])),t.prepend(this.el),this.$el.show().addClass("active")},hide:function(){this.$el.removeClass("active");var t=this.$el;if("popover-transparent"===this.type)t.remove(),this.trigger("close");else{function e(){t.remove(),n.trigger("close")}var n=this;t.transitionEnd?t.transitionEnd((function(){e()})):e()}},getContainer:function(){var t=$("#modal-scroll-container");return t.length&&"modal"!==this.type?t:$("body")},getMinHeight:function(t){return"BODY"===t.tagName?Math.max(t.scrollHeight,window.innerHeight):t.scrollHeight}})}})),define("fire/ui/raf",(function(t){var e=window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,n=!e,i=[];function r(t,r){r&&(t=$.proxy(t,r)),i.push(t),n?window.setTimeout(s,20):e(s)}var o=!1;function s(){if(i.length){var t=i;i=[],o=!0;for(var e=0;e<t.length;e++)t[e]();o=!1}}return{queue:r,wrap:function(t,e){return e||(e=window),function(){var n=arguments;r((function(){t.apply(e,n)}))}},queueOrInline:function(t,e){o?(e&&(t=$.proxy(t,e)),t()):r(t,e)}}})),define("smore/ui/views/modal",(function(t){var e=t("fire/net/safe"),n=t("./overlay"),i=t("fire/ui/raf"),r=t("fire/util/history"),o=t("fire/util/mobile"),s=$(window),a=$(document.body);return{ModalView:Backbone.View.extend({defaultOptions:{overlayClose:!1,loadingTitle:"Loading...",hideClose:!1,allowAccessToolbar:!1,modalType:"modal"},templateSelector:"",contentEndpoint:"",useSafePost:!1,contentParams:function(){},initialize:function(t){this.result=$.Deferred(),this.options=_.extend({},this.defaultOptions,t||{}),this.events=_.extend({},{"click .fire-modal-close":"_onCloseClicked","click .go-to-step":"_onGoStepClicked","click .go-to-next-step":"_onNextStepClicked","click .go-to-prev-step":"_onPrevStepClicked","click .go-back-step":"_onBackStepClicked"},this.events),this.overlayClose=this.options.overlayClose||!1,this.options.hideClose&&this.$el.addClass("hide-close"),s.on("resize",_.throttle($.proxy(this.position,this),50)),this._stepsStack=[]},getContent:function(){var t=$.Deferred(),n=_.result(this,"templateSelector");if(n){var i=$(n).html();return i?(i=this.renderContent(i),t.resolve(i)):t.reject("Template '"+n+'" was not found'),t}var r=_.result(this,"contentEndpoint");if(!r)return t.reject("No endpoint was defined for "+this),t;var o=_.result(this,"contentParams");return _.result(this,"useSafePost")?e.post(r,o):$.get(r,o)},renderContent:function(t){return t},isFixedModal:function(){return"modal-fixed"===this.options.modalType},show:function(t){if(this._startStep=t||(this.steps||[])[0],this.$el.addClass("smore-modal-container"),this._startStep&&this.$el.addClass("step-"+(this._startStep||"")),this.options.containerEl)this._wrapper=$("<div/>").addClass("internal-modal-container").appendTo(this.options.containerEl),this._wrapper.append(this.$el);else{this.overlay=new n.OverlayView({closeOnClick:this.overlayClose,type:this.options.modalType,allowAccessToolbar:this.options.allowAccessToolbar}),this.overlay.scrollContainer.append(this.$el),this.overlay.show();var e=this;this.overlay.on("close",(function(){e.trigger("close")}))}var i=this.getContent();return window.setTimeout($.proxy((function(){"pending"===i.state()&&this.showLoading()}),this),150),i.done($.proxy(this._onShowLoadingDone,this)),i.fail($.proxy(this._onShowLoadingFailed,this)),this.result},showLoading:function(){this._setHtml(this.getLoadingContent())},_onShowLoadingDone:function(t){this._setHtml(t,(function(){this.setupHistory(),this.setupSteps(),this.setupSubviews(),this.render(),this.onShow()}))},onShow:function(){},_onShowLoadingFailed:function(t){this._setHtml(this.getErrorContent(t))},_setHtml:function(t,e){i.queue((function(){o.isMiniLayout()&&a.addClass("smore-mobile-modal"),this.$el.html(t),this.position(),_.isFunction(e)&&e.call(this)}),this)},getLoadingContent:function(){return'<div class="smore-modal-loading"><div class="indicator"><div class="spinner"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div></div><h3><span>'+this.options.loadingTitle+"</span></h3></div>"},getErrorContent:function(t){return'<div class="smore-modal-error"><h3>Oops! Something bad happened :/</h3><p>Hope we can still be friends...</p> <p><a class="smore-modal-close fire-modal-close">Close this</a> or <a href="mailto:hello@smore.com">Contact support and tell us what happend</a>.</div></div>'},position:function(){if(this.el.parentNode){var t=this.$el.height(),e=window.innerHeight||s.height();this.options.containerEl&&(e=this.options.containerEl.height());var n=$(window).scrollTop();this.isFixedModal()&&(n=0);var i=e/2-t/2+n;i=Math.max(70,i),this.$el.css("margin-top",i).addClass("active")}},complete:function(t){this.onComplete(t),this._closeModal(),this.result.resolve(t)},onComplete:function(t){},close:function(t){this.onClose(t),this._closeModal(),this.trigger("close"),this.result.reject(t)},onClose:function(t){},_closeModal:function(){this.$el.addClass("drop"),this.overlay&&this.overlay.hide();var t=this._wrapper,e=this.$el;function n(){e.remove(),a.removeClass("smore-mobile-modal"),t&&t.remove()}e.transitionEnd?e.transitionEnd((function(){n()})):n(),this._historyHelper&&(this._historyHelper.remove(),this._historyHelper=null)},setupSubviews:function(){var t=_.result(this,"subviews"),e=this;this.$("[data-subview]").each((function(){var n=$(this),r=n.data("subview"),o=t[r];if(r&&o){var s;if(o.__super__)s=new o({el:n});else{if(_.isString(o)){var a=e[o];if(!a)throw"Cant find the key '"+o+"'";o=a}s=o.call(e,n)}s&&(s.modal=e,i.queue(s.render,s))}else console.error("Can't find view for key: ",r,"el:",n)}))},setupSteps:function(){this._stepEls=this.$("[data-step]"),this.steps=this._stepEls.map((function(){return $(this).data("step")})).get(),this.steps.length&&(this._startStep=this._startStep||(this.steps||[])[0],this.goStep(this._startStep))},_getStepEl:function(t){return this._stepEls.filter('[data-step="'+t+'"]')},goStep:function(t,e){var n=this._getStepEl(t);n.length?i.queueOrInline((function(){this._currentSection&&(this.$el.removeClass("step-"+this._currentSection),e||this._stepsStack.push(this._currentSection)),this.$el.addClass("step-"+t),this._stepEls.hide(),n.show(),this.position(),this._currentSection=t,this.currentStepEl=n,e||this._historyHelper.push({step:this._currentSection}),this.onStepActivated(t)}),this):console.error("Can't find step with key",t,"steps:",this._stepEls)},goBackStep:function(){if(this._stepsStack.length){var t=this._stepsStack.pop();this.goStep(t,!0)}},_stepIdx:function(t){return this.steps.indexOf(t)},nextStep:function(){var t=this.steps[0];if(this._currentSection){var e=this._stepIdx(this._currentSection);if(!(t=this.steps[e+1]))return}this.goStep(t)},prevStep:function(){var t=this.steps[0];if(this._currentSection){var e=this._stepIdx(this._currentSection);if(!(t=this.steps[e-1]))return}this.goStep(t)},onStepActivated:function(t){},setupHistory:function(){this._historyHelper=r.getHelper($.proxy(this._onHistoryPopState,this))},_onHistoryPopState:function(t,e){e.step&&this.goBackStep()},_onCloseClicked:function(t){t.preventDefault(),t.stopImmediatePropagation(),this.close("clicked_on_cancel")},_onNextStepClicked:function(t){$(t.currentTarget).hasClass("disabled")||this.nextStep()},_onPrevStepClicked:function(t){$(t.currentTarget).hasClass("disabled")||this.prevStep()},_onGoStepClicked:function(t){var e=$(t.currentTarget);if(!e.hasClass("disabled")){var n=e.data("key");n&&this.goStep(n)}},_onBackStepClicked:function(t){$(t.currentTarget).hasClass("disabled")||this.goBackStep()}})}})),define("lib/sha256",(function(t){var e=0;function n(t){return r(i(o(t)))}function i(t){return a(g(s(t),8*t.length))}function r(t){for(var n,i=e?"0123456789ABCDEF":"0123456789abcdef",r="",o=0;o<t.length;o++)n=t.charCodeAt(o),r+=i.charAt(n>>>4&15)+i.charAt(15&n);return r}function o(t){for(var e,n,i="",r=-1;++r<t.length;)e=t.charCodeAt(r),n=r+1<t.length?t.charCodeAt(r+1):0,55296<=e&&e<=56319&&56320<=n&&n<=57343&&(e=65536+((1023&e)<<10)+(1023&n),r++),e<=127?i+=String.fromCharCode(e):e<=2047?i+=String.fromCharCode(192|e>>>6&31,128|63&e):e<=65535?i+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):e<=2097151&&(i+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return i}function s(t){for(var e=Array(t.length>>2),n=0;n<e.length;n++)e[n]=0;for(n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<24-n%32;return e}function a(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>24-n%32&255);return e}function u(t,e){return t>>>e|t<<32-e}function c(t,e){return t>>>e}function l(t,e,n){return t&e^~t&n}function h(t,e,n){return t&e^t&n^e&n}function f(t){return u(t,2)^u(t,13)^u(t,22)}function d(t){return u(t,6)^u(t,11)^u(t,25)}function p(t){return u(t,7)^u(t,18)^c(t,3)}var v=new Array(1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998);function g(t,e){var n,i,r,o,s,a,g,y,w,b,_,x,k,C=new Array(1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225),S=new Array(64);for(t[e>>5]|=128<<24-e%32,t[15+(e+64>>9<<4)]=e,w=0;w<t.length;w+=16){for(n=C[0],i=C[1],r=C[2],o=C[3],s=C[4],a=C[5],g=C[6],y=C[7],b=0;b<64;b++)S[b]=b<16?t[b+w]:m(m(m(u(k=S[b-2],17)^u(k,19)^c(k,10),S[b-7]),p(S[b-15])),S[b-16]),_=m(m(m(m(y,d(s)),l(s,a,g)),v[b]),S[b]),x=m(f(n),h(n,i,r)),y=g,g=a,a=s,s=m(o,_),o=r,r=i,i=n,n=m(_,x);C[0]=m(n,C[0]),C[1]=m(i,C[1]),C[2]=m(r,C[2]),C[3]=m(o,C[3]),C[4]=m(s,C[4]),C[5]=m(a,C[5]),C[6]=m(g,C[6]),C[7]=m(y,C[7])}return C}function m(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return n})),define("show/actions/contactAuthorModal",(function(t){var e=t("smore/ui/views/modal").ModalView,n=t("fire/ui/forms/formView").FormView,i=t("lib/sha256");return{ContactAuthorModal:e.extend({className:"contact-author-modal",contentEndpoint:function(){return"/app/flyer_actions/contact_author_modal/"+this.options.flyerId},render:function(){this._formView=new n({el:this.$(".contact-author-form"),action:"/app/flyer_actions/contact_author/"+this.options.flyerId});var t=this.$(".contact-author-form .secure-token");t.val(i(t.val())),this._formView.on("success",$.proxy((function(){this._formView.el.hide(),this.$(".contact-author-header").hide(),this.$(".success-box").show()}),this));var e=this._formView.el.find("input").first();setTimeout((function(){e.focus()}),100)}})}}));bind=function(t,e){return function(){return t.apply(e,arguments)}};define("fire/ui/overlay2",(function(t){var e,n,i;return 5e3,"fire-shim",300,n=$(document),e=$(n[0].body),i=$(window),{Overlay:function(){function t(t,n,r){this.zIndex=null!=r?r:5e3,this.position=bind(this.position,this),this.el=$("<div>").addClass("fire-shim").addClass(n).css({position:"fixed","z-index":this.zIndex,top:0,left:0}),this.position(),e.prepend(this.el),t&&this.el.on("click",t),i.on("resize",this.position)}return t.prototype.position=function(){return this.el.css({width:n.width(),height:n.height()})},t.prototype.remove=function(t){var e;if(!this.removed)return this.removed=!0,i.off("resize",this.position),t&&this.el.animate({opacity:0},300),$.when(this.el).done((e=this,function(){return e.el.remove()}))},t}()}}));extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;define("fire/ui/views/PopoverView",(function(t){var e,n,i,r,o,s;return o=t("fire/ui/overlay2"),s=t("fire/ui/view"),e='<div class="popover"><div class="arrow"></div><div class="inner"><div class="content"></div></div></div>',"active",6e3,i=$(document),n=$(i[0].body),r=$(window),{PopoverView:function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return extend(i,t),i.prototype.overlayClose=!0,i.prototype.show=function(t){var e;return this.targetEl=t,this.overlay=new o.Overlay((e=this,function(){return e.onOverlayClicked()}),null,5999),this.position(),this.targetEl.addClass("active"),this.positionHook=function(t){return function(){return t.position()}}(this),r.on("resize",this.positionHook),this.afterShow()},i.prototype.setup=function(){var t,r;return i.__super__.setup.apply(this,arguments),t=!0===this.options.fixed?"fixed":"absolute",this.wrap=$(e).css({"z-index":6e3,position:t}).hide().appendTo(n),this.wrap.find(".content").append(this.el),this.wrap.delegate(".fire-popover-close","click",(r=this,function(){return r.close()}))},i.prototype.position=function(){var t,e,n,i,r,o,s;return n=this.targetEl.offset(),(t=this.targetEl.hasClass("pop-above")||this.options.isAbove)?this.wrap.addClass("popover-above"):this.wrap.addClass("popover-below"),this.wrap.show(),r=this.targetEl.outerWidth(),i=this.wrap.outerWidth(),e=this.calculateLeft(n.left,r,i),o=0,o=t?n.top-this.wrap.outerHeight():n.top+this.targetEl.outerHeight(),!0===this.options.fixed&&(o-=document.body.scrollTop,e-=document.body.scrollLeft),this.wrap.css({top:o-2,left:e}),setTimeout((s=this,function(){return s.fixPlaceholders()}),20)},i.prototype.calculateLeft=function(t,e,n){var i,o,s;return s=r.width(),o=i=t+e/2-n/2,i<0&&n<s&&(i=5),i+n>s&&(i=s-5-n),this.wrap.find(".arrow").css("margin-left",o-i-10),i},i.prototype.fixPlaceholders=function(){var t;if(t=$.fn.placeholderPolyfill)return t(this.wrap,!0)},i.prototype.onOverlayClicked=function(){if(this.overlayClose)return this.close()},i.prototype.close=function(){if(!1!==this.onClose())return this.unmask(),this.targetEl.removeClass("active"),this.overlay.remove(),this.wrap.hide(),r.off("resize",this.positionHook)},i.prototype.mask=function(t,e){var n;return this.unmask(),n=this.wrap.find(".content").first(),this.maskEl=$('<div class="popover-mask"><div class="mask-content">'+t+"</div></div> "),e&&this.maskEl.addClass(e),this.maskEl.css({width:n.outerWidth(),height:n.outerHeight()}),n.before(this.maskEl)},i.prototype.unmask=function(){if(this.maskEl)return this.maskEl.remove(),this.maskEl=null},i.prototype.onClose=function(){},i.prototype.afterShow=function(){},i}(s.View)}})),define("show/actions/subscribeToAuthorPopover",(function(t){var e=t("fire/ui/views/PopoverView").PopoverView,n=t("fire/ui/forms/formView").FormView;function i(t){e.call(this,t)}return i.prototype={templateSelector:"#subscribe-to-author-popover",events:{},render:function(){this._formView=new n({el:this.find("form.subscribe-to-author"),action:"/app/flyer_actions/subscribe_to_author/"+this.options.flyerId}),this._formView.on("success",$.proxy((function(){this._formView.el.hide(),this.find(".success-box").show()}),this))},afterShow:function(){var t=this.find("#subscribe-name");window.setTimeout((function(){t.focus()}),100)}},i.inherits(e),{SubscribeToAuthorPopover:i}})),define("show/actions/actions",(function(t){var e=t("./contactAuthorModal").ContactAuthorModal,n=t("./subscribeToAuthorPopover").SubscribeToAuthorPopover;function i(t){var e=$(t.currentTarget).data("flyer-id");if(e){var n=$(".like-flyer-box");n.addClass("already-likes");var i=$(".social-counter .count.likes"),r=parseInt(i.text(),10);i.text(r+1),$.ajax({url:"/app/pages/like_flyer",data:{page_id:e},error:function(){n.removeClass("already-likes"),i.text(r)}})}}function r(t){var n=$(t.currentTarget).data("flyer-id");n&&new e({flyerId:n}).show()}function o(t){var e=$(t.currentTarget),i=e.data("flyer-id");i&&new n({flyerId:i}).show(e)}$((function(){$(".open-contact-author").click(r),$(".open-subscribe-author").click(o),$(".like-flyer-button").click(i)}))})),define("show/actions/accessibilityBar",(function(t){var e=$(".accessibility-bar"),n=$("body");function i(t){var e=$(t.currentTarget),i=e.data("size");switch(e.addClass("active").siblings("a").removeClass("active"),n.removeClass("ada-medium-font-size").removeClass("ada-large-font-size"),i){case"medium":n.removeClass("ada-large-font-size").addClass("ada-medium-font-size");break;case"large":n.removeClass("ada-medium-font-size").addClass("ada-large-font-size");break;default:n.removeClass("ada-medium-font-size").removeClass("ada-large-font-size")}}function r(t){var e=$(t.currentTarget);e.hasClass("active")?(e.removeClass("active"),n.removeClass("ada-high-contrast")):(e.addClass("active"),n.addClass("ada-high-contrast"))}function o(t){}$((function(){e.find(".font-size a").click(i),e.find(".toggle-contrast").click(r),e.find(".translate").click(o)}))}));