(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{"AEu/":function(e,t,a){"use strict";a.r(t),a.d(t,"ConversationHiddenRepliesScreen",(function(){return N}));var r=a("KEM+"),n=a.n(r),o=a("ERkP"),i=a("es0u"),c=a("0KEI"),s=a("hqKg"),l=a("oEGd"),d=a("8Lfv"),u=a("G6rE");const g=Object(s.createSelector)(((e,t)=>t.match.params.screenName),((e,t)=>t.match.params.statusId),((e,t)=>"PUSH"===t.history.action),u.e.selectLoggedInUser,((e,t,a,r)=>({loggedInScreenName:r?r.screen_name:void 0,screenName:e,statusId:t,isForwardNavigation:a}))),m={createLocalApiErrorHandler:Object(c.d)("HIDDEN_REPLIES_PAGE"),clearTimelineCache:e=>Object(d.a)(e)};var p=Object(l.g)(g,m),h=a("xZXe"),b=a("QIgh"),y=a("8UdT"),_=a("IcAo"),E=a("VrCx"),f=a("yy6l");const A=e=>Object(f.a)({component:h.a,createAdditionalProps:()=>({withUnhideReply:e}),displayBlocked:!0,divider:{top:!0,bottom:!0}});var T=({withUnhideReply:e})=>Object(_.a)({},b.b,{[y.b.Tweet]:{handlers:{[E.a.Tweet]:A(e)}}}),O=a("WU0f"),w=a("oQhu"),I=a("yoO3"),S=a("fTQJ"),P=a("VS6U"),k=a("t62R"),L=a("FIs5"),v=a("7JQg"),C=a("3XMw"),x=a.n(C);const B=x.a.d806aa19,R=x.a.d80c77dc,D=x.a.ef939f4b,F=x.a.f7f2db4f,q=o.createElement(x.a.I18NFormatMessage,{$i18n:"cf1aca58"},o.createElement(k.c,{link:"https://help.twitter.com/using-twitter/mentions-and-replies#hidden-reply"},x.a.a7511618)),j=()=>o.createElement(L.a,{header:F,message:q});class N extends o.Component{constructor(e){super(e),n()(this,"_getMemoizedModule",Object(w.a)((e=>Object(O.a)(e)))),n()(this,"_getModule",(()=>{const{statusId:e}=this.props;return this._getMemoizedModule(e)})),this._clearTimelineCache()}render(){const{history:e,loggedInScreenName:t,screenName:a,statusId:r}=this.props;return a&&r?o.createElement(I.a,null,o.createElement(P.a,{backLocation:`/${a.toLowerCase()}/status/${r}`,history:e,primaryContent:this._renderPrimaryContent(),sidebarContent:o.createElement(i.a,null),subtitle:a===t?R:D({screenName:a}),title:B})):null}_renderPrimaryContent(){const{loggedInScreenName:e,screenName:t}=this.props;return o.createElement(S.a,{entryConfiguration:T({withUnhideReply:t===e}),module:this._getModule(),renderEmptyState:j,title:B})}_clearTimelineCache(e=this._getModule()){const{clearTimelineCache:t,createLocalApiErrorHandler:a,isForwardNavigation:r}=this.props;r&&t(e).catch(a({}))}}t.default=Object(v.c)({page:"tweet",section:"moderated_replies"})(p(N))},DL4F:function(e,t,a){"use strict";a.r(t),a.d(t,"ConversationAnalyticsScreen",(function(){return te}));var r=a("KEM+"),n=a.n(r),o=(a("kYxP"),a("ERkP")),i=(a("VAZu"),a("zh9S")),c=a("0KEI"),s=a("hqKg"),l=a("oEGd"),d=a("XOJV");const u=(e,t)=>t.match.params.statusId,g=Object(s.createSelector)(((e,t)=>d.a.selectFetchStatus(e,u(0,t))),u,((e,t)=>d.a.selectHydrated(e,u(0,t))),((e,t,a)=>({fetchStatus:e,statusId:t,tweet:a}))),m={createLocalApiErrorHandler:Object(c.d)("CONVERSATION_ANALYTICS_SCREEN"),fetchTweetIfNeeded:d.a.fetchOneIfNeeded,scribeAction:i.c};var p=Object(l.g)(g,m),h=a("v//M"),b=a("W5XZ"),y=a("jHSc"),_=a("3XMw"),E=a.n(_),f=a("MWbm"),A=a("t62R"),T=a("LbZ7"),O=a("rHpw"),w=a("iEUn"),I=a("jlPL"),S=a("dFWS");function P(e){const{isPromotionRunning:t,percentageValue:a}=e;return t?o.createElement(A.c,{align:"center"},Math.round(100*a),"%"):null}function k(e){const{isPromotionRunning:t}=e;return o.createElement(f.a,{style:L.actionsBar},o.createElement(T.a,null,o.createElement(f.a,{style:L.column},o.createElement(w.a,null),o.createElement(A.c,{align:"center",weight:"bold"},"16"),o.createElement(P,{isPromotionRunning:t,percentageValue:.13})),o.createElement(f.a,{style:L.column},o.createElement(I.a,null),o.createElement(A.c,{align:"center",weight:"bold"},"12"),o.createElement(P,{isPromotionRunning:t,percentageValue:.11})),o.createElement(f.a,{style:L.column},o.createElement(S.a,null),o.createElement(A.c,{align:"center",weight:"bold"},"17"),o.createElement(P,{isPromotionRunning:t,percentageValue:.1}))))}const L=O.a.create((e=>({column:{flexGrow:1,marginRight:e.spaces.space32,padding:e.componentDimensions.gutterHorizontal},actionsBar:{margin:e.spaces.space12,borderWidth:e.borderWidths.small,borderColor:e.colors.gray200,borderStyle:"solid",borderRadius:e.borderRadii.large}})));var v=a("rxPX");var C=Object(v.a)().propsFromState((()=>({isUserProfessional:()=>false,promotionStatus:()=>"not_started"}))).propsFromActions((()=>({})));const x=Object.freeze({notStarted:"not_started",underReview:"under_review",running:"running",completed:"completed"});var B=a("/yvb"),R=a("JYMr");function D(){return o.createElement(f.a,{style:M.promotionInfoView},o.createElement(A.c,{size:"headline1",weight:"heavy"},"Promote your Tweet"),o.createElement(A.c,{color:"gray700"},"Your Tweet has ",3," total impressions so far. Switch to a Professional account to promote it and reach even more people.'"),o.createElement(f.a,{style:M.CallToActionButton},o.createElement(B.a,{type:"primary"},"Switch to Twitter for Professionals")))}function F(){return o.createElement(f.a,{style:M.promotionInfoView},o.createElement(A.c,{size:"headline1",weight:"heavy"},"Promote your Tweet"),o.createElement(A.c,{color:"gray700"},"Get more impressions, follows, link clicks or media views by promoting your Tweet to a selected audience."),o.createElement(f.a,{style:M.CallToActionButton},o.createElement(B.a,{type:"primary"},"Promote this Tweet")))}function q(){return o.createElement(f.a,{style:M.promotionInfoView},o.createElement(A.c,{size:"headline1",weight:"heavy"},"Your promotion is under review"),o.createElement(A.c,{color:"gray700"},"Your tweet is under review. Your promotion will continue soon if it follows Twitter’s Ads Policy."),o.createElement(f.a,{style:M.CallToActionButton},o.createElement(B.a,{type:"text"},"Review Policy")))}function j(){return o.createElement(f.a,{style:M.promotionInfoView},o.createElement(A.c,{size:"headline1",weight:"heavy"},"Your promotion is running"),o.createElement(R.a,{progress:.5}),o.createElement(A.c,{color:"gray700"},"2 days 4 hours left"))}function N(){return o.createElement(f.a,{style:M.promotionInfoView},o.createElement(A.c,{size:"headline1",weight:"heavy"},"Your promotion is complete"),o.createElement(A.c,{color:"gray700"},"Your Tweet has earned ",2568," new impressions and ",1254," new engagements"),o.createElement(f.a,{style:M.CallToActionButton},o.createElement(B.a,{type:"primary"},"Promote again")))}class G extends o.PureComponent{constructor(...e){super(...e),n()(this,"_renderPromotionInfo",((e,t)=>{if(!e)return o.createElement(D,null);switch(t){case x.notStarted:return o.createElement(F,null);case x.underReview:return o.createElement(q,null);case x.running:return o.createElement(j,null);case x.completed:return o.createElement(N,null);default:return null}}))}render(){const{isUserProfessional:e,promotionStatus:t}=this.props;return this._renderPromotionInfo(e,t)}}const M=O.a.create((e=>({promotionInfoView:{margin:e.spaces.space12},CallToActionButton:{margin:e.spaces.space12}})));var U=C(G),H=a("b5s6"),V=a("SrIh"),z=a("Rp9C"),Q=a("v6aA"),$=a("7JQg"),W=a("E0cF"),X=a("q9Zt"),J=a("bPFD"),K=a("yE5w");const Y=E.a.g9079b93,Z=E.a.a57daeb1,ee=E.a.deaf5b15;class te extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleFetchTweet",(()=>{const{createLocalApiErrorHandler:e,fetchTweetIfNeeded:t,statusId:a}=this.props;t(a).catch(e(b.a))})),n()(this,"_render",(()=>{const{tweet:e}=this.props,t=e&&W.a.getOriginalTweet(e)||void 0,{featureSwitches:a}=this.context;if(!t||t&&t.user.id_str!==this.context.loggedInUserId)return o.createElement(X.a,{onRetry:null,title:Y});if(a.isTrue("responsive_web_tweet_analytics_migration_enabled"))return o.createElement(f.a,null,this._renderQuoteTweet(t.id_str),this._renderTweetStats(),o.createElement(k,{isPromotionRunning:!1}),o.createElement(U,{isUserProfessional:!1,promotionStatus:"not_started"}));{const e="";return o.createElement(J.a,{dangerouslyDisableSandbox:!0,onMessage:this._handleIFrameMessage,reportError:V.a,src:`${e}/i/tfb/v1/quick_promote/lite/${t.id_str}`,style:ae.iframe})}})),n()(this,"_setAppBarRef",(e=>{this._appBarRef=e})),n()(this,"_renderQuoteTweet",(e=>o.createElement(f.a,{style:ae.quoteTweet},o.createElement(H.a,{isCondensed:!0,tweetId:e,withLink:!1,withUserHoverCard:!1})))),n()(this,"_renderTweetStats",(()=>null)),n()(this,"_handleGoBack",(()=>{const{history:e,location:t}=this.props;e.goBackToNonModalRoute({location:t})})),n()(this,"_handleIFrameMessage",(e=>{if(e&&"quick_promote"===e.name)if("scribe"===e.type){const{scribeAction:t,scribeNamespace:a,tweet:r}=this.props,n=r&&W.a.getOriginalTweet(r)||void 0,o=e.scribeData||{};t({...a,component:"string"==typeof o.component?o.component:"quick_promote",action:"string"==typeof o.uiEvent?o.uiEvent:""},{...o,items:n?[z.a.getTweetItem(n)]:[]})}else if("navigation"===e.type){const{history:e,match:t,tweet:a}=this.props,r=a&&W.a.getOriginalTweet(a);r&&e.push(`/${t.params.screenName}/status/${r.id_str}/${K.a.Rweb}/${K.c.Intro}`)}else"close"===e.type&&this._appBarRef&&this._appBarRef.goBack()}))}componentDidMount(){this._handleFetchTweet()}render(){const{fetchStatus:e,history:t,tweet:a}=this.props,r=a&&W.a.getOriginalTweet(a)||void 0;return o.createElement(y.b,{appBarRef:this._setAppBarRef,backLocation:r?r.permalink:"/",history:t,onBackClick:this._handleGoBack,title:Z},o.createElement(h.a,{fetchStatus:e,render:this._render,retryMessage:ee}))}}n()(te,"contextType",Q.a);const ae=O.a.create((e=>({quoteTweet:{flexGrow:1,margin:e.spaces.space12},iframe:{flexGrow:1}})));t.default=Object($.c)({page:"tweet",section:"analytics"})(p(te))},JiIh:function(e,t,a){"use strict";var r=a("ERkP"),n=a("0GBF");t.a=e=>r.createElement(n.a,e)},aH1V:function(e,t,a){"use strict";a.r(t),a.d(t,"QuickPromoteScreen",(function(){return gn}));var r=a("KEM+"),n=a.n(r),o=(a("kYxP"),a("ERkP"));function i(e){throw new Error("Not reachable section reached!")}var c=a("BDX3"),s=a("97Jx"),l=a.n(s),d=a("rxPX"),u=a("0KEI"),g=a("RqPI"),m=a("oEOe"),p=a("kGix"),h=a("3A2y"),b=a("Ssj5");const y=Object.freeze({Any:"AnyGender",Male:"Male",Female:"Female"}),_=Object.freeze({AGE_13_TO_24:"Age13To24",AGE_13_TO_34:"Age13To34",AGE_13_TO_49:"Age13To49",AGE_13_TO_54:"Age13To54",AGE_18_TO_24:"Age18To24",AGE_18_TO_34:"Age18To34",AGE_18_TO_49:"Age18To49",AGE_18_TO_54:"Age18To54",AGE_21_TO_34:"Age21To34",AGE_21_TO_49:"Age21To49",AGE_21_TO_54:"Age21To54",AGE_25_TO_49:"Age25To49",AGE_25_TO_54:"Age25To54",AGE_35_TO_49:"Age35To49",AGE_35_TO_54:"Age35To54",AGE_OVER_13:"AgeOver13",AGE_OVER_18:"AgeOver18",AGE_OVER_21:"AgeOver21",AGE_OVER_25:"AgeOver25",AGE_OVER_35:"AgeOver35",AGE_OVER_50:"AgeOver50"}),E=Object.freeze({[_.AGE_13_TO_24]:{minAge:"13",maxAge:"24"},[_.AGE_13_TO_34]:{minAge:"13",maxAge:"34"},[_.AGE_13_TO_49]:{minAge:"13",maxAge:"49"},[_.AGE_13_TO_54]:{minAge:"13",maxAge:"54"},[_.AGE_18_TO_24]:{minAge:"18",maxAge:"24"},[_.AGE_18_TO_34]:{minAge:"18",maxAge:"34"},[_.AGE_18_TO_49]:{minAge:"18",maxAge:"49"},[_.AGE_18_TO_54]:{minAge:"18",maxAge:"54"},[_.AGE_21_TO_34]:{minAge:"21",maxAge:"34"},[_.AGE_21_TO_49]:{minAge:"21",maxAge:"49"},[_.AGE_21_TO_54]:{minAge:"21",maxAge:"54"},[_.AGE_25_TO_49]:{minAge:"25",maxAge:"49"},[_.AGE_25_TO_54]:{minAge:"25",maxAge:"54"},[_.AGE_35_TO_49]:{minAge:"35",maxAge:"49"},[_.AGE_35_TO_54]:{minAge:"35",maxAge:"54"},[_.AGE_OVER_13]:{minAge:"13"},[_.AGE_OVER_18]:{minAge:"18"},[_.AGE_OVER_21]:{minAge:"21"},[_.AGE_OVER_25]:{minAge:"25"},[_.AGE_OVER_35]:{minAge:"35"},[_.AGE_OVER_50]:{minAge:"50"}}),f=Object.freeze({13:{24:_.AGE_13_TO_24,34:_.AGE_13_TO_34,49:_.AGE_13_TO_49,54:_.AGE_13_TO_54,over:_.AGE_OVER_13},18:{24:_.AGE_18_TO_24,34:_.AGE_18_TO_34,49:_.AGE_18_TO_49,54:_.AGE_18_TO_54,over:_.AGE_OVER_18},21:{34:_.AGE_21_TO_34,49:_.AGE_21_TO_49,54:_.AGE_21_TO_54,over:_.AGE_OVER_21},25:{49:_.AGE_25_TO_49,54:_.AGE_25_TO_54,over:_.AGE_OVER_25},35:{49:_.AGE_35_TO_49,54:_.AGE_35_TO_54,over:_.AGE_OVER_35},50:{over:_.AGE_OVER_50}}),A=Object.freeze({Reach:"Reach",Followers:"Followers",WebsiteClicks:"WebsiteClicks"});a("MvUL"),a("gYAx"),a("gFSH");var T=a("3XMw"),O=a.n(T),w=a("SrIh"),I=a("9OUN"),S=a("06wh");const P=Object.freeze({});function k(e,t){const a=Object(S.a)("rweb/ads/typeahead",e);return{typeaheadApiActionTypes:a,getTypeaheadResults:(r,n)=>(o,i,{api:c})=>{const s=i().ads.typeahead[e][r];if(null!=s&&s.result)return Promise.resolve(s.result);return Object(m.b)(o,{request:t(c),params:n})({actionTypes:a,context:`ADS_TYPEAHEAD_${e}`,meta:{query:r}})},reducer:(e=P,t)=>{switch(t.type){case a.REQUEST:{const{query:a}=t.meta;return{...e,[a]:{fetchStatus:p.a.LOADING}}}case a.FAILURE:{const{error:a,meta:{query:r}}=t;return{...e,[r]:{fetchStatus:p.a.FAILED,error:a}}}case a.SUCCESS:{const{meta:{query:a},payload:r}=t;return{...e,[a]:{fetchStatus:p.a.LOADED,result:r}}}default:return e}}}}const L=k("targetingLocation",(e=>e.AaProxy.getQueriedTargetableLocations)),v=k("forecastAudience",(e=>e.QuickPromote.getAudienceEstimate)),C={targetingLocation:L.reducer,forecastAudience:v.reducer},x={typeahead:Object(I.c)(C)},B=Object(I.c)(x);b.a.register({ads:B});var R=a("yE5w");const D=O.a.i976aff3,F=[p.a.LOADING,p.a.LOADED],q=(e,t)=>(a,r,{api:n})=>{var o,i;const{dailyBudget:c,currency:s}=r().quickPromote.budget,l=_e(r()),{user_id:d}=r().session,u=null==(o=r().quickPromote.account.adsAccount)?void 0:o.id,{ageBucket:g,gender:m,targetedLocations:[{targeting_value:p}]}=r().quickPromote.targeting;if(F.includes(null==(i=r().ads.typeahead.forecastAudience[l])?void 0:i.fetchStatus)||!d||!g)return Promise.resolve();const h=Math.round(1e6*c),b=h,y=j(r());return Object(R.n)(t)(R.l.audienceEstimateCall({dailyBudgetMicros:h,totalBudgetMicros:b,ageBucket:g,gender:m,location:p})),a(v.getTypeaheadResults(l,{userId:d,adAccountId:u,tweetId:e,dailyBudgetMicros:`${h}`,totalBudgetMicros:`${b}`,currency:null!=s?s:"USD",targeting:y})).then((()=>{var e,a;const n=null==(e=r().ads.typeahead.forecastAudience[l])||null==(a=e.result)?void 0:a.estimatedImpressions;n?Object(R.n)(t)(R.l.audienceEstimateSuccess({dailyBudgetMicros:h,totalBudgetMicros:b,ageBucket:g,gender:m,location:p,estimatedImpressions:n})):Object(R.n)(t)(R.l.audienceEstimateFail({dailyBudgetMicros:h,totalBudgetMicros:b,ageBucket:g,gender:m,location:p}))}))};function j(e){const{targetedLocations:t,ageBucket:a,gender:r}=e.quickPromote.targeting;return{geos:t.map((({targeting_value:e})=>({location_id:e}))),age_buckets:[{age_bucket:a}],gender:{gender:r}}}const N=e=>(t,a,{userPersistence:r})=>{const{quickPromote:n}=a(),{targeting:{targetedLocations:o,ageBucket:i,gender:c},budget:{dailyBudget:s,durationDays:l,currency:d}}=n;return r.set("rweb.quickPromoteRedirectBack",e?{platformType:e,ageBucket:i,gender:c,targetedLocations:o,dailyBudget:s,durationDays:l,lastPersisted:(new Date).getTime(),currency:d}:null)},G=()=>(e,t,{api:a,featureSwitches:r})=>{if(!r.isTrue("responsive_web_qp_pa_signup_enabled"))return Promise.resolve();const{professionalEligibility:n,professionalEligibilityFetchStatus:o}=t().quickPromote;return o===p.a.LOADING||o===p.a.LOADED&&n?Promise.resolve():e(De({}))},M=(e,t)=>(a,r,{api:n})=>!t&&F.includes(r().quickPromote.account.accountDataFetchStatus)?Promise.resolve():(a(we(p.a.LOADING)),U(n)(e).then((e=>{if(e){const{account:t}=e;return a(Ae(t)),H(n)(t.id).then((e=>{a(Te(e)),a(Oe(e[0]||null))}))}})).then((()=>a(we(p.a.LOADED)))).catch((e=>{throw a(we(p.a.FAILED)),e}))),U=e=>t=>e.AaProxy.getAccounts().then((t=>Promise.all(t.map((t=>e.AaProxy.getPromoteableUsers(t.id).then((e=>({promoteableUsers:e,account:t}))).catch((()=>{}))))))).then((e=>e.filter(Boolean))).then((e=>e.find((({promoteableUsers:e})=>e.find((e=>e.user_id===t)))))),H=e=>t=>e.AaProxy.getFundingInstruments(t).then((e=>e.filter((({able_to_fund:e,description:t,credit_limit_local_micro:a})=>e&&!/no payment method/.test(t)&&a>0)))),V=e=>(t,a)=>{t(Pe(e));const r=Object(g.l)(a());return t(L.getTypeaheadResults(e,{query:e,lang:r}))},z=()=>(e,t,{api:a,scribe:r})=>{if(F.includes(t().quickPromote.targeting.initialTargetedLocationsFetchStatus)||t().quickPromote.targeting.targetedLocations.length)return Promise.resolve();const n=Object(g.t)(t())||"US",o=t().session.language;return e(Ie(p.a.LOADING)),a.AaProxy.getTargetableLocations({countryCode:n,lang:o,locationType:"COUNTRIES"}).then((e=>e.length?e:(Object(w.a)(`Country not found: ${n}`),a.AaProxy.getTargetableLocations({countryCode:"US",lang:o,locationType:"COUNTRIES"})))).then((a=>{if(!a.length){const e=Error("Could not find targetable country for US!");throw Object(w.a)(e),e}if(t().quickPromote.targeting.targetedLocations.length)return Promise.resolve();e(Se(a)),e(Ie(p.a.LOADED))})).catch((t=>{throw e(Ie(p.a.FAILED)),t}))},Q=()=>(e,t,{api:a})=>{if(F.includes(t().quickPromote.budget.availableBudgetsFetchStatus))return Promise.resolve();e(ve(p.a.LOADING));const r=ye(t());return a.QuickPromote.getBudgets({countryCode:r}).then((({budgets:t,currencyCode:a,defaultBudget:r})=>{e(Ce(t,a)),e(xe(r)),e(ve(p.a.LOADED))})).catch((t=>{throw e(ve(p.a.FAILED)),t}))},$={account:{adsAccount:null,accountDataFetchStatus:p.a.NONE,fundingInstruments:[],selectedFundingInstrument:null},targeting:{initialTargetedLocationsFetchStatus:p.a.NONE,targetedLocations:[],locationQuery:"",ageBucket:_.AGE_OVER_13,gender:y.Any},budget:{errorMessage:null,dailyBudget:100,durationDays:5,availableBudgets:null,availableBudgetsFetchStatus:p.a.NONE,currency:null},professionalEligibility:void 0,professionalEligibilityFetchStatus:p.a.NONE,firstLoad:!1,promoteStatus:p.a.NONE,promoteErrorCode:null,objective:A.Reach},W="rweb/quickPromote/account/set",X="rweb/quickPromote/account/setAdsAccount",J="rweb/quickPromote/account/setFundingInstruments",K="rweb/quickPromote/account/setSelectedFundingInstrument",Y="rweb/quickPromote/account/setAccountDataFetchStatus",Z="rweb/quickPromote/targeting/set",ee="rweb/quickPromote/targeting/setLocationQuery",te="rweb/quickPromote/targeting/setInitialTargetedLocationsFetchStatus",ae="rweb/quickPromote/targeting/setTargetedLocations",re="rweb/quickPromote/targeting/setTargetedAgeBucket",ne="rweb/quickPromote/targeting/setTargetedGender",oe="rweb/quickPromote/budget/set",ie="rweb/quickPromote/budget/setAvailableBudgetsFetchStatus",ce="rweb/quickPromote/budget/setAvailableBudgets",se="rweb/quickPromote/budget/setDailyBudget",le="rweb/quickPromote/budget/setBudgetDuration",de="rweb/quickPromote/budget/setBudgetErrorMessage",ue="rweb/quickPromote/budget/setObjective",ge="rweb/quickPromote/setFirstLoad",me="rweb/quickPromote/setPromoteFetchStatus",pe="rweb/quickPromote/setPromoteErrorCode",he=Object.freeze({REQUEST:"rweb/quickPromote/promotionEligibilityRequest",SUCCESS:"rweb/quickPromote/promotionEligibilitySuccess",FAILURE:"rweb/quickPromote/promotionEligibilityFailure"}),be=Object.freeze({REQUEST:"rweb/quickPromote/promoteRequest",SUCCESS:"rweb/quickPromote/promoteSuccess",FAILURE:"rweb/quickPromote/promoteFailure"}),ye=e=>{var t,a;const r=(null==(t=e.quickPromote.account)||null==(a=t.adsAccount)?void 0:a.country_code)||Object(g.t)(e)||"US";return"XX"===r?"US":r.toUpperCase()},_e=e=>{const{targeting:{targetedLocations:[{targeting_value:t}],...a},budget:{dailyBudget:r,currency:n}}=e.quickPromote,o=Object(h.a)(a,["initialTargetedLocationsFetchStatus","locationQuery"]);return JSON.stringify({...o,location:t,dailyBudget:r,currency:n})},Ee=e=>({type:Z,payload:{targeting:e}}),fe=e=>({type:oe,payload:{budget:e}}),Ae=e=>({type:X,payload:{adsAccount:e}}),Te=e=>({type:J,payload:{fundingInstruments:e}}),Oe=e=>({type:K,payload:{selectedFundingInstrument:e}}),we=e=>({type:Y,payload:{fetchStatus:e}}),Ie=e=>({type:te,payload:{fetchStatus:e}}),Se=e=>({type:ae,payload:{targetedLocations:e}}),Pe=e=>({type:ee,payload:{locationQuery:e}}),ke=e=>({type:re,payload:{ageBucket:e}}),Le=e=>({type:ne,payload:{gender:e}}),ve=e=>({type:ie,payload:{fetchStatus:e}}),Ce=(e,t)=>({type:ce,payload:{availableBudgets:e,currency:t}}),xe=e=>({type:se,payload:{dailyBudget:e}}),Be=e=>({type:le,payload:{durationDays:e}}),Re=e=>({type:de,payload:{errorMessage:e}}),De=e=>(t,a,{api:r})=>Object(m.b)(t,{request:r.QuickPromote.getProfessionalEligibility,params:e})({actionTypes:he,context:"FETCH_PROFESSIONAL_ELIGIBILITY"}),Fe=e=>({type:ge,payload:{firstLoad:e}}),qe=e=>({type:me,payload:{promoteFetchStatus:e}}),je=e=>({type:pe,payload:{promoteErrorCode:e}}),Ne=e=>(t,a,{api:r})=>Object(m.b)(t,{request:r.QuickPromote.createPromotion,params:e})({actionTypes:be,context:"FETCH_PROMOTE"});b.a.register({quickPromote:(e=$,t)=>{switch(t.type){case W:if(t.payload){const{account:a}=t.payload;return{...e,account:{...e.account,...a}}}break;case Z:if(t.payload){const{targeting:a}=t.payload;return{...e,targeting:{...e.targeting,...a}}}break;case oe:if(t.payload){const{budget:a}=t.payload;return{...e,budget:{...e.budget,...a}}}break;case ge:if(t.payload){const{firstLoad:a}=t.payload;return{...e,firstLoad:a}}break;case X:if(t.payload){const{adsAccount:a}=t.payload;return{...e,account:{...e.account,adsAccount:a}}}break;case J:if(t.payload){const{fundingInstruments:a}=t.payload;return{...e,account:{...e.account,fundingInstruments:a}}}break;case K:if(t.payload){const{selectedFundingInstrument:a}=t.payload;return{...e,account:{...e.account,selectedFundingInstrument:a}}}break;case Y:if(t.payload){const{fetchStatus:a}=t.payload;return{...e,account:{...e.account,accountDataFetchStatus:a}}}break;case te:if(t.payload){const{fetchStatus:a}=t.payload;return{...e,targeting:{...e.targeting,initialTargetedLocationsFetchStatus:a}}}break;case ee:if(t.payload){const{locationQuery:a}=t.payload;return{...e,targeting:{...e.targeting,locationQuery:a}}}break;case ae:if(t.payload){const{targetedLocations:a}=t.payload;return{...e,targeting:{...e.targeting,targetedLocations:a}}}break;case re:if(t.payload){const{ageBucket:a}=t.payload;return{...e,targeting:{...e.targeting,ageBucket:a}}}break;case ne:if(t.payload){const{gender:a}=t.payload;return{...e,targeting:{...e.targeting,gender:a}}}break;case ie:if(t.payload){const{fetchStatus:a}=t.payload;return{...e,budget:{...e.budget,availableBudgetsFetchStatus:a}}}break;case ce:if(t.payload){const{availableBudgets:a,currency:r}=t.payload;return{...e,budget:{...e.budget,availableBudgets:a,currency:r}}}break;case se:if(t.payload){const{dailyBudget:a}=t.payload;return{...e,budget:{...e.budget,dailyBudget:a}}}break;case le:if(t.payload){const{durationDays:a}=t.payload;return{...e,budget:{...e.budget,durationDays:a}}}break;case de:if(t.payload){const{errorMessage:a}=t.payload;return{...e,budget:{...e.budget,errorMessage:a}}}break;case"rweb/quickPromote/setPromotionEligibilityFetchStatus":if(t.payload){const{professionalEligibilityFetchStatus:a}=t.payload;return{...e,professionalEligibilityFetchStatus:a}}break;case he.REQUEST:return{...e,professionalEligibilityFetchStatus:p.a.LOADING};case he.FAILURE:return{...e,professionalEligibilityFetchStatus:p.a.FAILED};case he.SUCCESS:return{...e,professionalEligibility:t.payload,professionalEligibilityFetchStatus:p.a.LOADED};case ue:if(t.payload){const{objective:a}=t.payload;return{...e,objective:a}}break;case me:if(t.payload){const{promoteFetchStatus:a}=t.payload;return{...e,promoteStatus:a}}break;case pe:if(t.payload){const{promoteErrorCode:a}=t.payload;return{...e,promoteErrorCode:a}}break;case be.REQUEST:return{...e,promoteStatus:p.a.LOADING};case be.FAILURE:return{...e,promoteStatus:p.a.FAILED};case be.SUCCESS:return{...e,promoteStatus:p.a.LOADED};default:return t.type,e}return e}});const Ge=e=>e.quickPromote.budget.dailyBudget,Me=e=>e.quickPromote.budget.durationDays,Ue=e=>e.quickPromote.budget.errorMessage,He=e=>e.quickPromote.budget.availableBudgets||(e=>{throw new Error(e)})("No budgets found"),Ve=e=>e.quickPromote.budget.currency||"USD",ze=(e,t)=>{var a,r;const n=_e(e);return null==(a=e.ads.typeahead.forecastAudience[n])||null==(r=a.result)?void 0:r.estimatedImpressions};var Qe=Object(d.a)().propsFromState((()=>({dailyBudget:Ge,durationDays:Me,availableBudgets:He,lang:g.l,currency:Ve,audience:ze,errorMessage:Ue}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(u.d)("QUICK_PROMOTE_BUDGET_SELECT_SCREEN"),setDailyBudget:xe,setBudgetDuration:Be,fetchForecastedAudienceIfNeeded:q,setBudgetErrorMessage:Re}))).withAnalytics({page:"quick_promote"}),$e=a("MWbm"),We=a("t62R"),Xe=a("rHpw");const Je=({children:e,description:t,descriptionDir:a,descriptionTestID:r,label:n,withBottomBorder:i=!0})=>o.createElement($e.a,{style:[Ke.descriptionItem,i?Ke.bottomBorder:void 0]},!!n&&o.createElement(We.c,{weight:"bold"},n),!!t&&o.createElement($e.a,{style:Ke.descriptionContainer},o.createElement(We.c,{color:"gray700",dir:a,size:"subtext2",style:Ke.descriptionContainer,testID:r},t)),e),Ke=Xe.a.create((e=>({descriptionItem:{backgroundColor:e.colors.cellBackground,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},descriptionContainer:{marginTop:e.spaces.space2},bottomBorder:{borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor}})));var Ye=a("iOFy"),Ze=a("Gpeq");const et=({title:e,primaryLabel:t,subtitle:a})=>o.createElement($e.a,{style:[tt.bottomBorder,tt.titleContainer]},o.createElement(We.c,{align:"center",size:"headline1",weight:"heavy"},e),!!t&&o.createElement($e.a,{style:tt.primaryLabelContainer},o.createElement(We.c,{align:"center",color:"primary",size:"title4"},t)),o.createElement($e.a,{style:tt.subtitleContainer},o.createElement(Ye.a,{align:"center",color:"gray700"},a))),tt=Xe.a.create((e=>({titleContainer:{paddingVertical:e.spaces.space32},primaryLabelContainer:{marginTop:e.spaces.space12},subtitleContainer:{marginTop:e.spaces.space12},bottomBorder:{borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor}})));var at="introButton",rt="nextButton",nt="targetingScreen",ot="targetingLocationScreen",it="budgetSelectScreen",ct="reviewScreen",st="reviewButton",lt="reviewTargetingDescription",dt="reviewBudgetAndDurationDescription",ut="reviewPaymentPivot",gt="targetingLocationPivot",mt="backButton",pt="targetingLocationSearch",ht="targetingLocationItem",bt=a("4zmP"),yt=a("9RkS"),_t=a("v6aA"),Et=a("Xrkv");const ft=O.a.dc4a9413,At=O.a.bad70c09,Tt=O.a.c133a39b,Ot=O.a.ee5da8f4,wt=O.a.g4bf9cb7,It=O.a.gc3ce5d9,St=O.a.e542dfd6,Pt=O.a.cb51c854,kt=O.a.bb7b39e1,Lt=O.a.eb9466d0,vt=O.a.c21037d0,Ct=O.a.b07cc9f1,xt=O.a.ce309bed,Bt=O.a.c6c16a51,Rt=O.a.cc49d03f;function Dt(e){switch(e){case"AnyGender":return Pt;case"Male":return kt;case"Female":return Lt;default:return Object(w.a)(`Unknown gender: ${e}`),e}}function Ft(e){switch(e){case"COUNTRIES":return vt;case"REGIONS":return Ct;case"METROS":return xt;case"CITIES":return Bt;case"POSTAL_CODES":return Rt;default:return Object(w.a)(`Unknown targeting locationType: ${e}`),e}}function qt({totalBudgetNum:e,durationDays:t,lang:a,currency:r}){const n=e.toLocaleString(Object(Ze.a)(a),{currency:r,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0});return ft({totalBudget:n,durationLabel:Nt({durationDays:t})})}function jt({numLocations:e}){const t=O.a.ia24dc8c(e);return At({numLocations:t})}function Nt({durationDays:e}){const t=O.a.ia24dc8c(e);return wt({durationDays:t})}const Gt=O.a.a3a09d48,Mt=O.a.e7eb3683,Ut=O.a.d9f6e3cd,Ht=O.a.d9d6e10e,Vt=O.a.b3954ec9,zt=O.a.e1b48db4,Qt=Array(30).fill(null).map(((e,t)=>t+1));class $t extends o.PureComponent{constructor(...e){super(...e),n()(this,"_fetchForecastedAudienceIfNeeded",(()=>{const{analytics:e,match:{params:{statusId:t}},fetchForecastedAudienceIfNeeded:a,createLocalApiErrorHandler:r}=this.props;a(t,e).catch(r())})),n()(this,"_getSliderProps",((e,t)=>({max:e.length-1,min:0,value:e.indexOf(t)}))),n()(this,"_handleDurationSlider",(e=>{const{setBudgetDuration:t,durationDays:a,analytics:r}=this.props,n=Qt[e];a!==n&&(Object(R.n)(r)(R.l.setBudgetDuration(`${n}`)),t(n),this._fetchForecastedAudienceIfNeeded())})),n()(this,"_handleBudgetSlider",(e=>{const{setDailyBudget:t,availableBudgets:a,dailyBudget:r,analytics:n}=this.props,o=a[e];r!==o&&(Object(R.n)(n)(R.l.setDailyBudget(`${o}`)),t(o),this._fetchForecastedAudienceIfNeeded())}))}componentDidMount(){const{analytics:e}=this.props;Object(R.n)(e)(R.l.budgetSelectPageLoad()),this._fetchForecastedAudienceIfNeeded()}componentWillUnmount(){const{setBudgetErrorMessage:e}=this.props;e(null)}render(){const{durationDays:e,lang:t,dailyBudget:a,availableBudgets:r,currency:n,audience:i,errorMessage:c}=this.props,s=a.toLocaleString(Object(Ze.a)(t),{currency:n,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0}),d=r[0].toLocaleString(Object(Ze.a)(t),{currency:n,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0}),u=r.slice(-1)[0].toLocaleString(Object(Ze.a)(t),{currency:n,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0}),g=i?function({low:e,high:t}){const a=O.a.cf8abf58(e),r=O.a.cf8abf58(t);return It({audienceLow:a,audienceHigh:r})}(i):" ",m=Nt({durationDays:e}),p=Nt({durationDays:Qt[0]}),h=Nt({durationDays:Qt.slice(-1)[0]}),b=this._getSliderProps(r,a),y=this._getSliderProps(Qt,e),_=qt({totalBudgetNum:a*e,durationDays:e,lang:t,currency:n});return o.createElement($e.a,{style:Wt.qpContainer,testID:it},c&&o.createElement($e.a,{style:Wt.gutter},o.createElement(bt.a,{text:c,type:"danger"})),o.createElement(et,{primaryLabel:_,subtitle:g,title:Gt}),o.createElement(Je,{label:Mt},o.createElement($e.a,{style:Wt.childSpacing},o.createElement(yt.a,l()({accessibilityLabel:Ut,accessibilityLabelValueText:`"${s}"`},b,{maxIcon:o.createElement(We.c,{style:Wt.iconText},u),minIcon:o.createElement(We.c,{style:Wt.iconText},d),onChange:this._handleBudgetSlider,thumbLabel:s})))),o.createElement(Je,{label:Ht},o.createElement($e.a,{style:Wt.childSpacing},o.createElement(yt.a,l()({accessibilityLabel:Vt,accessibilityLabelValueText:`"${m}"`},y,{maxIcon:o.createElement(We.c,{style:Wt.iconText},h),minIcon:o.createElement(We.c,{style:Wt.iconText},p),onChange:this._handleDurationSlider,thumbLabel:m})))),o.createElement($e.a,{style:Wt.disclaimer},o.createElement(Ye.a,{align:"center",color:"gray700",size:"subtext2"},zt)))}}n()($t,"contextType",_t.a);const Wt=Xe.a.create((e=>({qpContainer:{flex:1},disclaimer:{marginVertical:e.componentDimensions.gutterVertical,marginHorizontal:e.componentDimensions.gutterHorizontal},gutter:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},childSpacing:{marginTop:e.spaces.space4},iconText:{textAlignVertical:"text-bottom"}})));var Xt=Qe($t),Jt=a("XOJV");const Kt=(e,t)=>t.match.params.statusId,Yt=(e,t)=>Jt.a.selectHydrated(e,Kt(0,t)),Zt=(e,t)=>Object(p.c)(Jt.a.selectFetchStatus(e,Kt(0,t)),e.quickPromote.budget.availableBudgetsFetchStatus,e.quickPromote.targeting.initialTargetedLocationsFetchStatus,e.quickPromote.account.accountDataFetchStatus,e.quickPromote.firstLoad?p.a.LOADED:p.a.LOADING),ea=(e,t)=>e.quickPromote.promoteStatus,ta=(e,t)=>e.quickPromote.promoteErrorCode,aa=e=>{const{match:t,history:a,analytics:r}=e,{screenName:n,statusId:o,quickPromotePlatform:i,quickPromoteScreenName:c}=t.params;return((e,t,a,r,n,o)=>(i,c,{userPersistence:s,featureSwitches:l})=>s.get("rweb.quickPromoteRedirectBack").catch((()=>{})).then((s=>{if(l.isTrue("responsive_web_qp_pa_signup_enabled")){var d;const{professionalEligibility:a}=c().quickPromote;if(!a)return Object(R.n)(o)(R.l.professionalAccountsSignup()),void n.push("/i/flow/convert_to_professional?input_flow_data=%7B%22requested_variant%22%3A%22qp%22%7D");if(!1===(null==(d=a.quick_promote_eligibility)?void 0:d.is_eligible))return Object(R.n)(o)(R.l.professionalAccountsIneligible()),void n.replace(Object(R.e)(e,t));Object(R.n)(o)(R.l.professionalAccountsEligible())}if(s&&s.platformType&&s.lastPersisted&&(new Date).getTime()-s.lastPersisted<36e5){const{ageBucket:a,gender:r,targetedLocations:o,dailyBudget:l,durationDays:d,platformType:u,currency:g}=s,{currency:m}=c().quickPromote.budget;i(Ee({ageBucket:a,gender:r,targetedLocations:o})),g===m?(i(fe({dailyBudget:l,durationDays:d})),n.replace(Object(R.h)(e,t,u,R.c.Review))):(i(fe({errorMessage:D})),n.replace(Object(R.h)(e,t,u,R.c.BudgetSelect)))}else r===R.c.Intro||c().quickPromote.firstLoad||n.replace(Object(R.h)(e,t,a,R.c.Intro));i(Fe(!0))})))(n,o,i,c,a,r)};var ra=Object(d.a)().propsFromState((()=>({statusId:Kt,fetchStatus:Zt,tweet:Yt,promoteFetchStatus:ea,promoteErrorCode:ta}))).propsFromActions((e=>({createLocalApiErrorHandler:Object(u.d)("QUICK_PROMOTE_SCREEN"),fetchTweetIfNeeded:Jt.a.fetchOneIfNeeded,fetchCurrentTargetingLocationIfNeeded:z,fetchAvailableBudgetsIfNeeded:Q,fetchAdsAccountDataIfNeeded:M,fetchProfessionalEligibilityIfNeeded:G,handleFirstLoad:()=>aa(e),setPromoteFetchStatus:qe}))).withAnalytics(R.m),na=Object(d.a)().propsFromState((()=>({}))).propsFromActions((()=>({}))).withAnalytics(R.m),oa=a("feu+");const ia=O.a.e1bca506,ca=O.a.e4a4c608,sa=O.a.a219e217;class la extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleGoToAnalytics",(()=>{const{match:e,history:t}=this.props,{screenName:a,statusId:r,quickPromotePlatform:n}=e.params;Object(R.j)(t)(a,r,n)})),n()(this,"_handleClose",(()=>{const{history:e,location:t}=this.props;e.goBackToNonModalRoute({location:t})}))}componentDidMount(){const{analytics:e}=this.props;Object(R.n)(e)(R.l.donePageLoad())}render(){return o.createElement(oa.a,{actionLabel:sa,headline:ia,isFullHeightOnMobile:!0,onAction:this._handleGoToAnalytics,onClose:this._handleClose,subtext:ca,withCloseButton:!1})}}n()(la,"contextType",_t.a);var da=na(la),ua=a("v//M"),ga=a("W5XZ"),ma=a("jHSc");const pa=e=>!!e.quickPromote.account.selectedFundingInstrument;var ha=Object(d.a)().propsFromState((()=>({hasFundingInstrument:pa}))).propsFromActions((()=>({}))).withAnalytics(R.m);const ba=O.a.dcfb0332,ya=O.a.db841200,_a=O.a.hc67be9d;class Ea extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleGoToNextPage",(()=>{const{history:e,match:t}=this.props,{screenName:a,statusId:r,quickPromotePlatform:n}=t.params;e.push(Object(R.h)(a,r,n,R.c.Targeting))})),n()(this,"_handleClose",(()=>{const{history:e,location:t}=this.props;e.goBackToNonModalRoute({location:t})}))}componentDidMount(){const{analytics:e,hasFundingInstrument:t}=this.props;Object(R.n)(e)(R.l.introPageLoad({hasFundingInstrument:t}))}render(){const{match:e}=this.props,{quickPromotePlatform:t}=e.params,a=t===R.a.Rweb;return o.createElement(oa.a,{actionLabel:_a,headline:ba,isFullHeightOnMobile:!0,onAction:this._handleGoToNextPage,onClose:this._handleClose,primaryButtonTestID:at,subtext:ya,withCloseButton:a})}}n()(Ea,"contextType",_t.a);var fa=ha(Ea),Aa=a("tI3i"),Ta=a.n(Aa),Oa=(a("VAZu"),a("zh9S"));const wa=(e,t)=>t.match.params.statusId,Ia=(e,t)=>Jt.a.selectHydrated(e,wa(0,t)),Sa=(e,t)=>Jt.a.selectFetchStatus(e,wa(0,t)),Pa=(e,t)=>e.quickPromote.account.adsAccount;var ka=Object(d.a)().propsFromState((()=>({fetchStatus:Sa,tweet:Ia,adsAccount:Pa}))).propsFromActions((e=>({createLocalApiErrorHandler:Object(u.d)("QUICK_PROMOTE_PAYMENT_SCREEN"),fetchTweetIfNeeded:Jt.a.fetchOneIfNeeded,scribeAction:Oa.c,savePlatformRedirectBackState:()=>N(e.match.params.quickPromotePlatform),fetchAdsAccountDataIfNeeded:M}))).withAnalytics(R.m),La=a("Rp9C"),va=a("E0cF"),Ca=a("bPFD");class xa extends o.PureComponent{constructor(...e){super(...e),n()(this,"_setAppBarRef",(e=>{this._appBarRef=e})),n()(this,"_handleIFrameMessage",(e=>{const{analytics:t,tweet:a}=this.props;if(e&&"quick_promote"===e.name)if("scribe"===e.type){const r=a&&va.a.getOriginalTweet(a)||void 0,n=r?[La.a.getTweetItem(r)]:[],o=e.scribeData||{},i="string"==typeof o.component?o.component:"quick_promote",c="string"==typeof o.uiEvent?o.uiEvent:"";t.scribe({component:i,action:c,data:{items:n}})}else if("navigation"===e.type){const{history:e,match:t,fetchAdsAccountDataIfNeeded:a,createLocalApiErrorHandler:r}=this.props,{screenName:n,statusId:o,quickPromotePlatform:i}=t.params;Ta()(!!this.context.loggedInUserId,"loggedInUserId must be defined"),a(this.context.loggedInUserId,!0).catch(r()),e.push(`/${n}/status/${o}/${i}/${R.c.Review}`)}else"close"===e.type&&this._appBarRef&&this._appBarRef.goBack()}))}componentDidMount(){const{savePlatformRedirectBackState:e,analytics:t,adsAccount:a,match:r}=this.props,{quickPromotePlatform:n,statusId:o}=r.params;e();const i=Object(R.g)(n,a,o);Object(R.n)(t)(R.l.paymentPageLoad(i.url)),i.isSameHost||(window.location.href=i.url)}render(){const{adsAccount:e,match:t}=this.props,{quickPromotePlatform:a,statusId:r}=t.params,n=Object(R.g)(a,e,r);return n.isSameHost?o.createElement(Ca.a,{dangerouslyDisableSandbox:!0,onMessage:this._handleIFrameMessage,reportError:w.a,src:n.url,style:Ba.iframe}):null}}n()(xa,"contextType",_t.a);const Ba=Xe.a.create((e=>({iframe:{flexGrow:1}})));var Ra=ka(xa);const Da=(e,t)=>e.quickPromote.targeting.targetedLocations,Fa=(e,t)=>e.quickPromote.targeting.ageBucket,qa=(e,t)=>e.quickPromote.targeting.gender,ja=(e,t)=>e.quickPromote.budget.dailyBudget,Na=(e,t)=>e.quickPromote.budget.durationDays,Ga=e=>e.quickPromote.budget.currency||"USD",Ma=e=>e.quickPromote.account.selectedFundingInstrument,Ua=e=>e.quickPromote.account.adsAccount,Ha=e=>e.quickPromote.promoteStatus,Va=e=>e.quickPromote.promoteErrorCode,za=({history:e,match:t})=>a=>{const{screenName:r,statusId:n,quickPromotePlatform:o}=t.params;return((e,t,a,r,n)=>(o,i,{api:c})=>{var s;const l=j(i()),{session:{user_id:d},quickPromote:{targeting:{ageBucket:u,gender:g,targetedLocations:[{targeting_value:m}]},budget:{dailyBudget:p,durationDays:h},account:{selectedFundingInstrument:b}}}=i(),y=null==(s=i().quickPromote.account.adsAccount)?void 0:s.id;if(F.includes(i().quickPromote.promoteStatus))return Promise.resolve();if(!y||!d)return Object(R.n)(n)(R.l.promotionError("Unauthorized")),o(je("Unauthorized")),Promise.resolve();if(!b)return Object(R.n)(n)(R.l.promotionError("MissingFundingInstrument")),o(je("MissingFundingInstrument")),Promise.resolve();o(je(null));const _=b.id,E=Math.round(1e6*p),f=E*h;return Object(R.n)(n)(R.l.promotionCall({dailyBudgetMicros:E,totalBudgetMicros:f,ageBucket:u,gender:g,location:m})),o(Ne({userId:d,accountId:y,fundingInstrumentId:_,tweetId:a,budget:{daily_local_micros:`${E}`,total_local_micros:`${f}`},targeting:l})).catch((()=>(o(je("NetworkError")),Object(R.n)(n)(R.l.promotionError("NetworkError")),{type:"fail"}))).then((i=>{var c,s,l;if("fail"!==i.type){var u;if("QuickPromoteError"===(null==(c=i.quick_promote_campaign_v2)?void 0:c.__typename))return o(je(i.quick_promote_campaign_v2.error_code)),Object(R.n)(n)(R.l.promotionError((null==(u=i.quick_promote_campaign_v2)?void 0:u.error_code)||"QuickPromoteError")),o(M(d,!0));if("PromotionIneligible"===(null==(s=i.quick_promote_campaign_v2)?void 0:s.response_code))Object(R.n)(n)(R.l.promotionError("PromotionIneligible")),o(je("PromotionIneligible"));else if(null!=(l=i.quick_promote_campaign_v2)&&l.response_code)return void e.push(Object(R.h)(t,a,r,R.c.Done))}}))})(e,r,n,o,a)};var Qa=Object(d.a)().propsFromState((()=>({targetedLocations:Da,ageBucket:Fa,gender:qa,dailyBudget:ja,durationDays:Na,lang:g.l,country:ye,currency:Ga,fundingInstrument:Ma,adsAccount:Ua,promoteStatus:Ha,promoteErrorCode:Va}))).propsFromActions((e=>({createLocalApiErrorHandler:Object(u.d)("QUICK_PROMOTE_REVIEW_SCREEN"),clearPersistedRedirectBackState:()=>N(),createPromotion:za(e)}))).withAnalytics(R.m),$a=a("csss"),Wa=a("/yvb"),Xa=a("shC7");const Ja=O.a.c3c57e3e,Ka=O.a.h06724b4,Ya=O.a.b069d89c,Za=O.a.a3a09d48,er=O.a.e36bce63,tr=O.a.i41612d9,ar=O.a.ed8bb5af,rr=O.a.be2dc078,nr=O.a.da2805d1,or=O.a.ef4602eb,ir=O.a.a4db098b,cr=O.a.ef7e3916;class sr extends o.PureComponent{constructor(...e){super(...e),n()(this,"_getPaymentDescription",(()=>{const{adsAccount:e}=this.props;return e&&e.timezone&&e.country_code?ar:rr})),n()(this,"_handlePromote",(()=>{const{createPromotion:e,analytics:t}=this.props;Object(R.n)(t)(R.l.promotionClick()),e(t)})),n()(this,"_getErrorMessage",(()=>{const{promoteErrorCode:e,promoteStatus:t}=this.props;if(!e)return t===p.a.LOADED?nr:null;switch(e){case"MissingFundingInstrument":case"InvalidPaymentMethod":return cr;case"CampaignCreationFailed":case"PromotionIneligible":return ir;default:return or}}))}componentDidMount(){const{analytics:e,clearPersistedRedirectBackState:t,fundingInstrument:a}=this.props;t();const r=!!a;Object(R.n)(e)(R.l.reviewPageLoad({hasFundingInstrument:r}))}render(){const{targetedLocations:e,ageBucket:t,gender:a,dailyBudget:r,durationDays:n,lang:i,country:c,currency:s,fundingInstrument:l,match:d,promoteStatus:u}=this.props,g=function({minAge:e,maxAge:t}){return t?Tt({minAge:e,maxAge:t}):Ot({minAge:e})}(E[t]),m=function({locations:e,formattedAge:t,gender:a}){const r=e.length;return St({locations:Object(Et.a)(e),locationsHeading:jt({numLocations:r}),formattedAge:t,gender:a})}({locations:e.map((({localized_name:e})=>e)),formattedAge:g,gender:Dt(a)}),p=qt({totalBudgetNum:r*n,durationDays:n,lang:i,currency:s}),{screenName:h,statusId:b,quickPromotePlatform:y}=d.params,_=this._getErrorMessage();return o.createElement(o.Fragment,null,o.createElement($e.a,{style:lr.qpContainer,testID:ct},_&&o.createElement($e.a,{style:lr.gutter},o.createElement(bt.a,{text:_,type:"danger"})),o.createElement(et,{subtitle:Ka,title:Ja}),o.createElement(Je,{description:m,descriptionTestID:lt,label:Ya}),o.createElement(Je,{description:p,descriptionDir:Xa.a.getConstants().isRTL?"rtl":"ltr",descriptionTestID:dt,label:Za}),o.createElement($a.a,{description:l?l.description:o.createElement(We.c,{color:"primary",size:"subtext2"},this._getPaymentDescription()),label:o.createElement(We.c,{weight:"bold"},er),link:l?void 0:Object(R.h)(h,b,y,R.c.Payment),testID:ut})),o.createElement($e.a,{style:lr.bottomElements},o.createElement(Wa.a,{disabled:!l||F.includes(u),onPress:this._handlePromote,size:"normalLarge",testID:st,type:"primary"},tr),o.createElement(Ye.a,{style:lr.terms},(f=c,o.createElement(O.a.I18NFormatMessage,{$i18n:"c99d7100"},o.createElement(We.c,{link:Object(R.i)(f)},O.a.d56b5ac3))))));var f}}n()(sr,"contextType",_t.a);const lr=Xe.a.create((e=>({qpContainer:{flex:1},bottomElements:{marginHorizontal:e.spaces.space12,marginVertical:e.spaces.space32},terms:{marginTop:e.spaces.space12,textAlign:"center",color:e.colors.gray700,fontSize:e.fontSizes.subtext3},gutter:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical}})));var dr=Qa(sr),ur=a("zCf4");const gr=(e,t)=>{const a=pr(e,t);return e.ads.typeahead.targetingLocation[a]},mr=(e,t)=>{var a;const r=pr(e,t);return null==(a=e.ads.typeahead.targetingLocation[r])?void 0:a.fetchStatus},pr=(e,t)=>e.quickPromote.targeting.locationQuery,hr=(e,t)=>e.quickPromote.targeting.targetedLocations;var br=Object(d.a)().propsFromState((()=>({targetingLocationQuery:pr,targetingLocations:gr,targetedLocations:hr,fetchStatus:mr,userCountry:g.t}))).propsFromActions((()=>({setTargetedLocations:Se,setAndFetchTargetingLocationQuery:V,setTargetingLocationQuery:Pe,createLocalApiErrorHandler:Object(u.d)("QUICK_PROMOTE_TARGETING_LOCATION_SCREEN")}))).withAnalytics(R.m),yr=a("SrCX"),_r=a("VwDm"),Er=a("G1WX"),fr=a("cCdp"),Ar=a("xKuM"),Tr=a("zrOZ"),Or=a("kevv");const wr=O.a.cc642518,Ir=O.a.i0e8c3c6,Sr=O.a.deaf5b15,Pr=O.a.f69ad048,kr=Object.freeze({COUNTRIES:0,REGIONS:1,METROS:2,CITIES:3,POSTAL_CODES:4}),Lr=Object.freeze({[R.d.CurrentCountryMatch]:0,[R.d.Match]:1,[R.d.NoMatch]:2});class vr extends o.PureComponent{constructor(...e){super(...e),n()(this,"state",{errorMessage:null}),n()(this,"_renderSearch",(()=>{const{fetchStatus:e,targetingLocationQuery:t}=this.props;return o.createElement(Cr,{onBack:this._handleGoBack,onChange:this._handleTargetingLocationChange,onClear:this._handleClear,targetingLocationQuery:t},o.createElement($e.a,null,o.createElement(We.c,{style:xr.headingText,weight:"heavy"},Ir)),o.createElement(Er.a,{fetchStatus:e,render:this._renderSearchList,retryMessage:Sr}))})),n()(this,"_handleClear",(()=>{const{setTargetingLocationQuery:e}=this.props;e("")})),n()(this,"_renderSearchList",(()=>{const{targetedLocations:e}=this.props,t=Object(Tr.a)(e.map((({targeting_value:e})=>e))),a=this._getTargetingLocationOptions();return o.createElement($e.a,{style:xr.overflow},a.map((({location_type:e,targeting_value:a,localized_name:r})=>o.createElement(fr.a,{checked:t.has(a),helpText:Ft(e),key:a,label:r,name:a,onChange:this._handleSearchSelect,testID:ht}))))})),n()(this,"_getTargetingLocationOptions",(()=>{var e,t,a;const{targetingLocations:r,userCountry:n,targetingLocationQuery:o}=this.props,i=null!=(e=null==r||null==(t=r.result)||null==(a=t[0])?void 0:a.locations)?e:[],c=Object(R.f)(n||"US"),s=i.filter((({country_code:e,localized_name:t})=>c(t,e,o)!==R.d.NoMatch));return Object(Or.a)(s,[({country_code:e,localized_name:t})=>{const a=c(t,e,o);return Lr[a]},({location_type:e,localized_name:t})=>{var a;return null!=(a=kr[e])?a:(e=>{Object(w.a)(`Quick Promote: Unknown location type: ${e}. Expected one of {${Object.keys(kr).join(", ")}}`)})(e)||Object.keys(kr).length},({localized_name:e})=>e],"asc")})),n()(this,"_handleSearchSelect",((e,t)=>{const{setTargetedLocations:a,analytics:r,setTargetingLocationQuery:n}=this.props;if(t){this.setState({errorMessage:null});const t=this._getTargetingLocationOptions().find((({targeting_value:t})=>t===e));t?(Object(R.n)(r)(R.l.setTargetingLocation({id:t.targeting_value,locationType:t.location_type,countryCode:t.country_code})),a([t]),this._handleGoBack()):Object(w.a)(`Quick Promote: could not find "${e}" in list of targeting options`)}else Object(R.n)(r)(R.l.targetingLocationError()),this.setState({errorMessage:Pr});n("")})),n()(this,"_renderSelected",(()=>{const{targetedLocations:e,targetingLocationQuery:t}=this.props,{errorMessage:a}=this.state;return o.createElement(Cr,{onBack:this._handleGoBack,onChange:this._handleTargetingLocationChange,onClear:this._handleClear,targetingLocationQuery:t},o.createElement($e.a,null,a&&o.createElement($e.a,{style:xr.gutter},o.createElement(bt.a,{text:a,type:"danger"})),o.createElement(We.c,{style:xr.headingText,weight:"heavy"},jt({numLocations:e.length}))),o.createElement($e.a,null,e.map((({localized_name:e,targeting_value:t,location_type:a})=>o.createElement(fr.a,{checked:!0,helpText:Ft(a),key:t,label:e,name:t,onChange:this._handleSearchSelect,testID:ht})))))})),n()(this,"_handleGoBack",(()=>{const{history:e,location:t,match:a}=this.props,{quickPromotePlatform:r,quickPromoteScreenName:n,screenName:o,statusId:i}=a.params;Object(R.k)(e,t)(o,i,r,n)})),n()(this,"_handleTargetingLocationChange",(e=>{const t=e.target.value,{createLocalApiErrorHandler:a,setAndFetchTargetingLocationQuery:r,analytics:n}=this.props;Object(R.n)(n)(R.l.targetingLocationSearch(t)),r(t).catch(a())}))}componentDidMount(){const{analytics:e}=this.props;Object(R.n)(e)(R.l.targetingLocationPageLoad())}componentWillUnmount(){this._handleClear()}render(){const{targetingLocationQuery:e}=this.props;return e?this._renderSearch():this._renderSelected()}}n()(vr,"contextType",_t.a);const Cr=({onBack:e,onChange:t,onClear:a,targetingLocationQuery:r,children:n})=>o.createElement($e.a,{style:xr.qpContainer,testID:ot},o.createElement(Ar.a,{leftControl:o.createElement(c.a,{onClick:e}),middleControl:o.createElement(yr.a,{Icon:_r.a,autoFocus:!0,name:"locationTargetingInput",onChange:t,onClear:a,placeholder:wr,style:xr.input,testID:pt,value:r,withClearButton:!0})}),n),xr=Xe.a.create((e=>({qpContainer:{flex:1},input:{marginVertical:e.spaces.space12},headingText:{fontSize:e.fontSizes.headline1,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor,borderTopWidth:1,borderTopStyle:"solid",borderTopColor:e.colors.borderColor},gutter:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},overflow:{flex:"1 1 200px",overflowY:"auto"}})));var Br=br(vr);const Rr=(e,t)=>e.quickPromote.targeting.targetedLocations,Dr=(e,t)=>e.quickPromote.targeting.gender,Fr=(e,t)=>e.quickPromote.targeting.ageBucket;var qr=Object(d.a)().propsFromState((()=>({targetedLocations:Rr,selectedGender:Dr,selectedAgeBucket:Fr}))).propsFromActions((()=>({setTargetedAgeBucket:ke,setTargetedGender:Le}))).withAnalytics(R.m),jr=a("JiIh"),Nr=a("V2ml"),Gr=a("J4ZH"),Mr=a("mN6z");const Ur=O.a.hba1d105,Hr=O.a.cba0133d,Vr=O.a.e1efbead,zr=O.a.c6ff7c1f,Qr=O.a.b555fb45,$r=O.a.a8d0108d,Wr=[y.Any,y.Female,y.Male].map((e=>({label:Dt(e),value:e}))),Xr=O.a.j2c03e12,Jr=["13","18","21","25","35","50"],Kr=[void 0,void 0,void 0,"24","34","49","54"],Yr=Object(Gr.a)((Zr=E,Object.values(Zr)),(e=>e.maxAge||"over"));var Zr;const en=Kr.length;function tn(e,t){var a;if(e&&t)return null==(a=f[e])?void 0:a[t]}class an extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleGenderChange",((e,t)=>{const{setTargetedGender:a,analytics:r}=this.props;a(t),Object(R.n)(r)(R.l.setTargetingGender(t))})),n()(this,"_handleAgeBucketChange",(([e,t],a)=>{const{selectedAgeBucket:r,setTargetedAgeBucket:n,analytics:o}=this.props,i=this._sliderValueFromSelectedAgeBucket(r);if(!Object(Mr.a)(i,[e,t]))if(a){const a=Jr[e];if(!a)return;const r=tn(a,t===en?"over":Kr[t]);if(r)Object(R.n)(o)(R.l.setTargetingAgeBucket(r)),n(r);else{const e=Object.keys(f[a])[0];this._setAgeBucket({minAge:a,maxAge:e})}}else{const a=t===en?"over":Kr[t];if(!a)return;const r=tn(Jr[e],a);if(r)Object(R.n)(o)(R.l.setTargetingAgeBucket(r)),n(r);else{const{minAge:e}=Yr[a].slice(-1)[0];this._setAgeBucket({minAge:e,maxAge:a})}}})),n()(this,"_setAgeBucket",(({minAge:e,maxAge:t})=>{const{setTargetedAgeBucket:a,analytics:r}=this.props,n=f[e][t||"over"];if(!n)throw new Error(`Age bucket not found for minAge: "${e}", maxAge: "${t||"<empty>"}"`);Object(R.n)(r)(R.l.setTargetingAgeBucket(n)),a(n)}))}componentDidMount(){const{analytics:e}=this.props;Object(R.n)(e)(R.l.targetingPageLoad())}_sliderValueFromSelectedAgeBucket(e){const{minAge:t,maxAge:a}=E[e];return[Jr.indexOf(t),a?Kr.indexOf(a):en]}render(){const{match:e,targetedLocations:t,selectedGender:a,selectedAgeBucket:r}=this.props,{screenName:n,statusId:i,quickPromotePlatform:c}=e.params,s=jt({numLocations:t.length}),{minAge:l,maxAge:d}=E[r],{minAge:u}=E[_.AGE_OVER_13],g=this._sliderValueFromSelectedAgeBucket(r),m=d||Xr;return o.createElement($e.a,{style:rn.qpContainer,testID:nt},o.createElement(et,{subtitle:Hr,title:Ur}),o.createElement($a.a,{description:Object(Et.a)(t.map((({localized_name:e})=>e))),label:o.createElement(We.c,{weight:"bold"},s),link:Object(R.h)(n,i,c,R.c.TargetingLocation),testID:gt}),o.createElement(Je,{label:Vr},o.createElement($e.a,{style:rn.childSpacing},o.createElement(jr.a,{endThumbAccessibilityLabel:Qr,endThumbAccessibilityLabelValueText:`"${m}"`,endThumbLabel:m,max:en,maxIcon:o.createElement(We.c,{style:rn.iconText},Xr),min:0,minIcon:o.createElement(We.c,{style:rn.iconText},u),onChange:this._handleAgeBucketChange,startThumbAccessibilityLabel:zr,startThumbAccessibilityLabelValueText:`"${l}"`,startThumbLabel:l,value:g}))),o.createElement(Je,{label:$r,withBottomBorder:!1},o.createElement($e.a,{style:rn.childSpacing},o.createElement(Nr.a,{name:"gender",onChange:this._handleGenderChange,options:Wr,value:a}))))}}n()(an,"contextType",_t.a);const rn=Xe.a.create((e=>({qpContainer:{flex:1},childSpacing:{marginTop:e.spaces.space4},iconText:{textAlignVertical:"text-bottom"}})));var nn=qr(an),on=a("q9Zt"),cn=a("JYMr");const sn=O.a.a065172e,ln=O.a.cfcdb4a1,dn=O.a.dcfb0332,un=O.a.c1df579e;class gn extends o.PureComponent{constructor(...e){super(...e),n()(this,"_getRetweetOrTweet",(()=>{const{tweet:e}=this.props;return e?va.a.getOriginalTweet(e):e})),n()(this,"_handleFetchTweet",(()=>{const{createLocalApiErrorHandler:e,fetchTweetIfNeeded:t,statusId:a}=this.props;return t(a).catch(e(ga.a))})),n()(this,"_handleFetchCurrentTargetingLocation",(()=>{const{createLocalApiErrorHandler:e,fetchCurrentTargetingLocationIfNeeded:t}=this.props;return t().catch(e())})),n()(this,"_handleFetchBudgetOptions",(()=>{const{createLocalApiErrorHandler:e,fetchAvailableBudgetsIfNeeded:t}=this.props;return t().catch(e())})),n()(this,"_handleFetchAdsAccountData",(()=>{const{createLocalApiErrorHandler:e,fetchAdsAccountDataIfNeeded:t}=this.props;return Ta()(!!this.context.loggedInUserId,"loggedInUserId must be defined"),t(this.context.loggedInUserId).catch(e())})),n()(this,"_handleFetchProfessionalEligibility",(()=>{const{createLocalApiErrorHandler:e,fetchProfessionalEligibilityIfNeeded:t}=this.props;return t().catch(e())})),n()(this,"_render",(()=>{const{history:e}=this.props,t=this._getRetweetOrTweet();return!t||t&&t.user.id_str!==this.context.loggedInUserId?o.createElement(ma.b,{history:e,onBackClick:this._handleGoBack,title:dn},o.createElement(on.a,{onRetry:null,title:sn})):this._renderPage()})),n()(this,"_renderHeader",(()=>null)),n()(this,"_renderPage",(()=>{const{match:e,promoteFetchStatus:t,promoteErrorCode:a}=this.props,{quickPromoteScreenName:r,screenName:n,statusId:o,quickPromotePlatform:c}=e.params,s=e=>Object(R.h)(n,o,c,e);switch(r){case"intro":return this._renderSplashPage();case"targeting":{const e=s(R.c.BudgetSelect);return this._renderProgressPage(R.b.Targeting,e)}case"budget_select":{const e=s(R.c.Review);return this._renderProgressPage(R.b.BudgetSelect,e)}case"review":{const e=[p.a.LOADING,p.a.LOADED].includes(t)&&!a;return this._renderProgressPage(e?R.b.Finish:R.b.Review)}case"payment":return this._renderProgressPage(R.b.Review);case"targeting_location":return this._renderPopupPage();case"done":return this._renderSplashPage();default:throw i()}})),n()(this,"_renderProgressPage",((e,t)=>{const{history:a}=this.props;return o.createElement(ma.b,{documentTitle:dn,history:a,renderHeader:this._renderHeader},o.createElement(Ar.a,{leftControl:o.createElement(c.a,{autofocus:!0,onClick:this._handleGoBack,testID:mt}),rightControl:t&&o.createElement(Wa.a,{link:t,pullRight:!0,testID:rt,type:"text"},un)}),o.createElement(cn.a,{progress:e,style:mn.progressBar}),o.createElement($e.a,{style:mn.noScrollView},this._renderRoutes()))})),n()(this,"_renderPopupPage",(()=>{const{history:e}=this.props;return o.createElement(ma.b,{documentTitle:dn,history:e,renderHeader:this._renderHeader},this._renderRoutes())})),n()(this,"_renderSplashPage",(()=>this._renderRoutes())),n()(this,"_renderRoutes",(()=>{const{match:e}=this.props,{quickPromoteScreenName:t}=e.params;switch(t){case"intro":return o.createElement(ur.b,{component:fa});case"targeting":return o.createElement(ur.b,{component:nn});case"targeting_location":return o.createElement(ur.b,{component:Br});case"budget_select":return o.createElement(ur.b,{component:Xt});case"review":return o.createElement(ur.b,{component:dr});case"payment":return o.createElement(ur.b,{component:Ra});case"done":return o.createElement(ur.b,{component:da});default:throw i()}})),n()(this,"_handleGoBack",(()=>{const{history:e,match:t,location:a,analytics:r}=this.props,{screenName:n,statusId:o,quickPromotePlatform:i,quickPromoteScreenName:c}=t.params;Object(R.n)(r)(R.l.back(c)),Object(R.k)(e,a)(n,o,i,c)})),n()(this,"_handleRequestRetry",(()=>{const{analytics:e,match:t}=this.props,{quickPromoteScreenName:a}=t.params;Object(R.n)(e)(R.l.reload(a)),window.location.reload()}))}componentDidMount(){const{analytics:e,promoteFetchStatus:t,setPromoteFetchStatus:a,match:r}=this.props,{quickPromoteScreenName:n}=r.params;return this.context.loggedInUserId?(p.a.LOADED===t&&n!==R.c.Done&&a(p.a.NONE),Promise.all([this._handleFetchTweet(),this._handleFetchCurrentTargetingLocation(),this._handleFetchAdsAccountData(),this._handleFetchProfessionalEligibility()]).then((()=>this._handleFetchBudgetOptions())).then((()=>{const{handleFirstLoad:e}=this.props;return e()})).catch((t=>{throw Object(R.n)(e)(R.l.pageLoadFail(t.message)),t}))):Promise.resolve()}render(){const{fetchStatus:e,history:t}=this.props;return this.context.loggedInUserId?e!==p.a.LOADED?o.createElement(ma.b,{documentTitle:dn,history:t,renderHeader:this._renderHeader},o.createElement(ua.a,{fetchStatus:e,onRequestRetry:this._handleRequestRetry,render:this._render,retryMessage:ln})):o.createElement(ua.a,{fetchStatus:e,onRequestRetry:this._handleRequestRetry,render:this._render,retryMessage:ln}):this._render()}}n()(gn,"contextType",_t.a);const mn=Xe.a.create((e=>({progressBar:{backgroundColor:e.colors.gray50},noScrollView:{overflowX:"hidden",flex:1}}))),pn=ra(gn);t.default=pn},kevv:function(e,t,a){"use strict";var r=a("BcsE"),n=a("aTAq");const o=(e,t)=>{if(Object(r.a)(e)&&Object(r.a)(t)){if(e>t)return 1;if(e<t)return-1}else if(Object(n.a)(e)&&Object(n.a)(t)){if(e>t)return 1;if(e<t)return-1}return 0};t.a=(e,t,a)=>{const i=Object(n.a)(a)?Array(t.length).fill(a):a,c=t.map((e=>Object(n.a)(e)?t=>{const a="object"==typeof t?null==t?void 0:t[e]:void 0;return Object(n.a)(a)||Object(r.a)(a)?a:void 0}:e));return e.concat().sort(((e,t)=>(a,r)=>{for(let n=0;n<e.length;n++){const i=e[n],c=t[n]||"asc",s=o(i(a),i(r));if(0!==s)return"desc"===c?-1*s:s}return 0})(c,i))}},z4TA:function(e,t,a){"use strict";a.r(t),a.d(t,"ConversationScreen",(function(){return Fe}));var r=a("KEM+"),n=a.n(r),o=(a("kYxP"),a("MvUL"),a("aeN7")),i=a("ERkP"),c=a("s4rk"),s=a("zI2C"),l=a("6ZtA"),d=a("es0u"),u=a("zh9S"),g=a("6/RC"),m=a("0KEI"),p=a("hqKg"),h=a("oEGd"),b=a("8Lfv"),y=a("QK5w"),_=a("RqPI"),E=a("If64"),f=a("pNZL"),A=a("XOJV"),T=a("Mx3A");const O=(e,t)=>e.location&&e.location.state&&e.location.state[t],w=(e,t)=>{const a=O(t,"focal");return a||I(e,t)},I=(e,t)=>{const{location:a,match:r}=t;return r.params&&r.params.statusId?r.params.statusId:a.query&&a.query.tweet_id&&"string"==typeof a.query.tweet_id?a.query.tweet_id:""},S=Object(p.createSelector)(y.a,((e,t)=>O(t,"contextTweetId")),((e,t)=>A.a.selectFetchStatus(e,w(e,t))),((e,t)=>"PUSH"===t.history.action),((e,t)=>{if(!g.canUseDOM)return!1;const{location:a}=t,r=a.query,n=Object(y.a)(e,t);return Object(T.c)({query:r,httpReferer:n?"":document.referrer||"",requestUrl:window.location.href,emptyIfServerRendered:!1}).referral_type===T.a.Web}),((e,t)=>{const a=O(t,"referrer"),r=w(e,t);return!!a&&a.includes(`/i/topics/tweet/${r}`)}),((e,t)=>O(t,"promotedContent")),((e,t)=>t.location.query&&"string"==typeof t.location.query.cxt?t.location.query.cxt:void 0),((e,t)=>{const a=w(e,t),r=A.a.selectHydrated(e,a);return r&&r.conversation_id_str?A.a.selectHydrated(e,r.conversation_id_str):null}),((e,t)=>A.a.selectHydrated(e,w(e,t))),((e,t)=>t.match.params.screenName),((e,t)=>O(t,"socialContext")),E.a,w,I,((e,t)=>O(t,"contextualClientEventInfo")),f.a,((e,t)=>O(t,"overflow")),_.l,((e,t,a,r,n,o,i,c,s,l,d,u,g,m,p,h,b,y,_)=>({contextTweetId:t,initialFetchStatus:a,isForwardNavigation:r,isInitialScreen:!e,isReferralSource:n,isReferredFromExploreTopics:o,promotedContent:i,richLandingContextId:c,rootTweet:s,focalTweet:l,screenName:d,selectedTweetId:p,socialContext:u,startLocation:g,statusId:m,contextualClientEventInfo:h,tweetDetailNav:b,overflowCount:y,userLanguage:_}))),P={createLocalApiErrorHandler:Object(m.d)("CONVERSATION_SCREEN"),googleAnalyticsPageView:u.a,scribePageImpression:u.d,clearTimelineCache:(e,t)=>Object(b.a)(e,t)};var k=Object(h.g)(S,P),L=a("ymux"),v=a("rkhm"),C=a("SrtL"),x=a("8UdT"),B=a("dwig"),R=a("kGix"),D=a("JyI6"),F=a("3XMw"),q=a.n(F),j=a("dFWS");const N=q.a.d2c7a41c,G=q.a.e20404df,M=q.a.d17df547;var U=({getLocationState:e,history:t})=>i.createElement(D.a,{accessibilityLabel:N,getLocationState:e,history:t,icon:i.createElement(j.a,null),label:M,scribeComponent:"floating_reply_button",shortLabel:G}),H=a("muX9"),V=a("zb92");var z=Object(V.a)({loader:()=>Promise.all([a.e(0),a.e(167)]).then(a.bind(null,"uo3S")),renderPlaceholder:(e,t)=>null}),Q=a("sebV"),$=a("BXlL"),W=a("Irs7"),X=a("aITJ"),J=a("/yvb"),K=a("rHpw");const Y=q.a.af9c8a3d;var Z=({isLoggedIn:e,featureSwitches:t,scribeNamespace:a,startLocation:r})=>{const n=Object(W.b)(),o=e&&X.b.isMobileOS()&&!Q.a.isStandaloneApp(),c=i.useCallback((e=>{e.preventDefault(),n.scribe({...a,element:"open_app_button",action:"click"}),Object($.b)({startLocation:r})}),[n,a,r]);return o&&t.isTrue("responsive_web_open_app_appbar_button_enabled")?i.createElement(J.a,{accessibilityLabel:Y,children:Y,onPress:c,size:"normalCompact",type:K.a.isVdlRefreshEnabled()?"experimentalPrimaryOutlined":"secondary"}):null},ee=a("rJoH"),te=a("yoO3"),ae=a("AUxQ"),re=a("QIgh"),ne=a("oQhu"),oe=a("BV3T"),ie=a("VTxf"),ce=a("7BdX"),se=a("SrIh"),le=a("fTQJ"),de=a("ZNT5");var ue=e=>{const{richLandingContextId:t,statusId:a}=e;return((e,t)=>Object(de.a)({timelineId:`rich-tweet-landing-${e}`,getEndpoint:e=>e.URT.fetchRichTweetLandingTimeline,getEndpointParams:e=>({...e,...t}),context:"FETCH_RICH_TWEET_LANDING",perfKey:"rich-tweet-landing",timelineType:"conversation"}))(t?`${a}-${t}`:a,{refsrc_tweet:a,rux_cxt:t})},ge=a("wgnn"),me=a("v6aA");const pe=e=>{switch(e){case ge.a.NOT_FOUND:return i.createElement(ie.a,null);case ge.a.NOT_ALLOWED:return i.createElement(oe.a,null);default:return Object(se.a)(`Unhandled timeline unavailable reason: ${e}`),null}},he=()=>i.createElement(ie.a,null);class be extends i.Component{constructor(...e){super(...e),n()(this,"_getMemoizedModule",Object(ne.a)(((e,t,a)=>ue({statusId:e,richLandingContextId:t})))),n()(this,"_getModule",(()=>{const{statusId:e,richLandingContextId:t}=this.props,{featureSwitches:a}=this.context;return this._getMemoizedModule(e,t,a)}))}render(){const{title:e}=this.props;return i.createElement(le.a,{entryConfiguration:re.b,module:this._getModule(),prerollDisplayLocation:ce.c.OTHER,renderEmptyState:he,renderUnavailable:pe,title:e})}}n()(be,"contextType",me.a);var ye=a("Rp9C"),_e=a("7JQg");const Ee=Object.freeze({Email:"email"});var fe=a("VS6U"),Ae=a("HBr9"),Te=a("G8HL"),Oe=a("pxuL"),we=a("mN6z");const Ie=q.a.ea831526,Se=q.a.a90e1e67({noun:""}),Pe=q.a.c299a6cf,ke=q.a.ad666301,Le=q.a.f0c37ddb,ve={page:"tweet"},Ce={page:"tweet",section:"landing"},xe=Object(ne.a)(((e,t)=>({items:[ye.a.forTweet(e,t)],tweet_id:e}))),Be=Object(ne.a)((e=>Object(v.a)(e))),Re=Object(ne.a)(((e,t,a,r,n)=>{var o,i;return{referrer:e,controller_data:e&&(null==t||null==(o=t.details)||null==(i=o.timelinesDetails)?void 0:i.controllerData),overflowCount:a,with_rux_injections:r,rux_context:n}})),De=Object(ne.a)(((e,t,a)=>Object(L.a)({focalTweetId:e,fetchOptions:t,featureSwitches:a})));class Fe extends i.Component{constructor(e,t){super(e,t),n()(this,"_getFabState",(()=>{const{promotedContent:e,statusId:t}=this.props;return{inReplyToStatusId:t,promotedContent:e}})),n()(this,"_isBucketedInRichTweetLandingExperiment",(()=>{const{isReferralSource:e,isReferredFromExploreTopics:t,richLandingContextId:a}=this.props;return!(a||!e||t)&&this.context.featureSwitches.isTrue("responsive_web_rich_tweet_landing_enabled")})),n()(this,"_shouldRedirectToOcfLiteLogin",(()=>{const{location:e}=this.props,{loggedInUserId:t}=this.context;return(({isUserLoggedIn:e,location:t})=>(e=>{const{query:t}=e;return"refsrc"in t&&"string"==typeof t.refsrc?t.refsrc:""})(t)===Ee.Email&&!e)({isUserLoggedIn:!!t,location:e})&&this._isOcfLiteLoginEnabled})),n()(this,"_getNavigationParams",(()=>{const{tweetDetailNav:e,contextualClientEventInfo:t,overflowCount:a,richLandingContextId:r}=this.props,n=this._shouldRenderRichTweetLandingTimeline();return Re(e,t,a,n,r)})),n()(this,"_getModule",(()=>{const{statusId:e}=this.props,{featureSwitches:t}=this.context,a=this._getNavigationParams();return De(e,a,t)})),n()(this,"_handleEntriesRendered",(({entries:e,fetchStatus:t})=>{const{recordTTFL:a}=this.props;if(t===R.a.FAILED&&(this._shouldRecordTTFL=!1),this._shouldRecordTTFL&&e.length){const t=e.some((({type:e})=>e===x.b.Tweet));this._shouldRecordTTFL=!1,t&&a&&a("permalink")}})),n()(this,"_shouldRedirectToCanonical",(()=>{var e;const{focalTweet:t,screenName:a,selectedTweetId:r,statusId:n}=this.props;return!(r!==n||null==t||null==(e=t.user)||!e.screen_name)&&(a&&t&&a.toLowerCase()!==t.user.screen_name.toLowerCase())})),n()(this,"_redirectToCanonical",(()=>{const{history:e,location:t}=this.props;e.replace({pathname:this._getCanonicalPath(),query:t.query,state:t.state})})),n()(this,"_getCanonicalPath",(()=>{const{focalTweet:e}=this.props;return e?`/${e.user.screen_name}/status/${e.id_str}`:"/"})),n()(this,"_getPathForTweetId",((e,t)=>`/${t||"i"}/status/${e}`)),n()(this,"_getScribeNamespace",(()=>this._shouldRenderRichTweetLandingTimeline()?Ce:ve)),this._shouldRecordTTFL=e.isInitialScreen,this._isInlineReplyEnabled=this.context.featureSwitches.isTrue("responsive_web_inline_reply_enabled"),this._isInlineReplyWithFabEnabled=this.context.featureSwitches.isTrue("responsive_web_inline_reply_with_fab_enabled"),this._isOcfLiteLoginEnabled=this.context.featureSwitches.isTrue("responsive_web_ocf_lite_login_flow_enabled"),this._isLandingPageGQL=this.context.featureSwitches.isTrue("responsive_web_graphql_rux_landing_enabled")}shouldComponentUpdate(e){return!Object(we.a)(e,this.props)}componentDidMount(){const{history:e,location:t,isForwardNavigation:a}=this.props;if(this._shouldRedirectToOcfLiteLogin())e.push("/i/flow/lite_login");else{if(this._shouldRenderRichTweetLandingTimeline()&&!this._isLandingPageGQL&&(!t.state||!t.state.isRichTweetLanding)){const a={...t,state:{...t.state,isRichTweetLanding:!0}};e.replace(a)}a&&this._clearTimelineCache()}}componentWillUnmount(){this.context.setBackgroundClickHandler(null)}componentDidUpdate(e){this._shouldRedirectToCanonical()&&!this._shouldRedirectToOcfLiteLogin()?this._redirectToCanonical():this.props.statusId!==e.statusId&&this.props.isForwardNavigation&&this._clearTimelineCache()}render(){const{loggedInUserId:e}=this.context,{focalTweet:t,history:a,promotedContent:r,statusId:n,startLocation:o,userLanguage:d}=this.props,u=t?Le({tweetText:t.text,fullName:t.user.name}):void 0,g=t&&`twitter://status?id=${t.id_str}`,m=t&&`https://twitter.com${this._getCanonicalPath()||""}`,p=t&&ke({fullName:t.user.name}),h=null==t?void 0:t.possibly_sensitive;return i.createElement(_e.b,{data:xe(n,r),namespace:this._getScribeNamespace()},i.createElement(te.a,null,h?i.createElement(H.a,null,i.createElement("meta",{content:"adult",name:"rating"})):null,m?i.createElement(H.a,null,i.createElement("link",{href:m,rel:"canonical"}),i.createElement("link",{href:`https://publish.twitter.com/oembed?url=${m}`,rel:"alternate",title:u,type:"application/json+oembed"})):null,i.createElement(ee.a,{canonical:m,description:null==t?void 0:t.full_text,image:null==t?void 0:t.user.profile_image_url_https,title:p,type:"article"}),i.createElement(l.a,{featureSwitches:this.context.featureSwitches,loggedInUserId:e,userLanguage:d}),i.createElement(s.a,{deepLink:g}),m?i.createElement(c.a,{canonical:m}):null,i.createElement(fe.a,{backLocation:"/",documentTitle:u,history:a,primaryContent:this._renderTimeline(),rightControl:i.createElement(Z,{featureSwitches:this.context.featureSwitches,isLoggedIn:!!e,scribeNamespace:this._getScribeNamespace(),startLocation:o}),sidebarContent:this._renderSidebarContent(),title:t&&t.self_thread?Pe:Se}),i.createElement(C.a,{title:u,withMeta:!1})))}_renderSidebarContent(){const{focalTweet:e}=this.props;return e&&e.user.id_str?i.createElement(d.a,{focalTweetId:null==e?void 0:e.id_str,withTopicsToFollow:!1,withWhoToFollow:!1},i.createElement(z,{focalTweetId:e.id_str})):null}_renderTimeline(){const{focalTweet:e,history:t,location:a,richLandingContextId:r,rootTweet:n,screenName:o,selectedTweetId:c,statusId:s,socialContext:l,promotedContent:d,contextTweetId:u}=this.props,g={selectedTweetId:c},m=this._isInlineReplyEnabled&&!this._isInlineReplyWithFabEnabled?null:i.createElement(U,{getLocationState:this._getFabState,history:t});return i.createElement(B.a,{fab:m},i.createElement(Ae.a,{collectionName:Ie},this._shouldRenderRichTweetLandingTimeline()&&!this._isLandingPageGQL?i.createElement(be,{richLandingContextId:r,statusId:s,title:Se}):i.createElement(ae.a,{apiErrorHandlerMap:Be(o),contextTweetId:u,fetchOptions:this._getNavigationParams(),focalTweet:e,focalTweetId:s,location:a,module:this._getModule(),onEntriesRendered:this._handleEntriesRendered,promotedContent:d,rootTweet:n||void 0,selectedTweet:g,socialContext:l})))}_shouldRenderRichTweetLandingTimeline(){const{isReferredFromExploreTopics:e,richLandingContextId:t}=this.props;return!!t||e||this._isBucketedInRichTweetLandingExperiment()}_clearTimelineCache(e=this._getModule(),t=this._getNavigationParams()){const{clearTimelineCache:a,createLocalApiErrorHandler:r,screenName:n}=this.props;a(e,t).catch(r(Be(n)))}}n()(Fe,"contextType",Oe.a),n()(Fe,"defaultProps",{recordTTFL:o.c});t.default=k(Object(Te.a)(Fe))}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web/bundle.Conversation.eba539d5.js.map