// HEADLINES SCROLLER PLUGIN
// WRITTEN BY MATT BASSETT
// VERSION 12.7.17

!function(i){i.fn.appScroller=function(t){var e={appParent:".hp",targetApp:"upcomingevents",imageNum960:4,imageNum768:2,imageNum640:2,imageNum480:2,imageNum320:1,backIconFontLetter:"l",nextIconFontLetter:"r",buttonColor:"#FFF",extraBackIconClass:"",extraNextIconClass:"",controlGutter:"0"};return t&&i.extend(e,t),this.each(function(){function t(){d(),i(".headlines-scroll-ctrl",n).length||i(n).prepend('<div role="button" aria-label="Click to go to previous slide" tabindex="0" class="headlines-scroll-ctrl back icon-font hidden '+e.extraBackIconClass+'">'+e.backIconFontLetter+"</div>").append('<div role="button" aria-label="Click to go to next slide" tabindex="0" class="headlines-scroll-ctrl next icon-font hidden '+e.extraNextIconClass+'">'+e.nextIconFontLetter+"</div>"),i(".ui-articles li",n).last().addClass("last"),i(".headlines-scroll-ctrl",n).click(function(){var t=Number(i(".ui-articles > li",n)[0].getBoundingClientRect().width.toFixed(2)),e=Number(i(".ui-articles > li",n).first()[0].getBoundingClientRect().width.toFixed(2)),l=Number(i(".ui-articles > li",n).last()[0].getBoundingClientRect().width.toFixed(2)),d=-1*Number(parseFloat(i(".ui-articles",n)[0].style.marginLeft).toFixed(2)),r=Number(i(".ui-articles",n)[0].getBoundingClientRect().width.toFixed(2))-Number(i(".ui-widget-detail",n)[0].getBoundingClientRect().width.toFixed(2)),s=r-d;s=Number(s.toFixed(2));var c=0;if(!i(".ui-widget-detail",n).hasClass("animating"))if(i(this).hasClass("next")){if(l>s)c=d+s;else{c=d+t;var u=a();u>1?(i(".ui-widget-detail  .ui-articles > li.active",n).first().attr("aria-hidden","true").find("a").attr("tabindex","-1"),i(".ui-widget-detail  .ui-articles > li.active",n).first().removeClass("active"),i(".ui-widget-detail  .ui-articles > li.active",n).last().next().addClass("active"),i(".ui-widget-detail  .ui-articles > li.active",n).last().attr("aria-hidden","false").find("a").attr("tabindex","0")):(i(".ui-widget-detail  .ui-articles > li.active",n).next().addClass("active"),i(".ui-widget-detail  .ui-articles > li.active",n).last().attr("aria-hidden","false").find("a").attr("tabindex","0"),i(".ui-widget-detail  .ui-articles > li.active",n).first().attr("aria-hidden","true").find("a").attr("tabindex","-1"),i(".ui-widget-detail  .ui-articles > li.active",n).first().removeClass("active"))}if(c=Number(c.toFixed(2)),c==d||.099>=c-d){c=0,i(".ui-widget-detail  .ui-articles > li a",n).attr("tabindex","-1"),i(".ui-widget-detail  .ui-articles > li",n).removeClass("active"),i(".ui-widget-detail  .ui-articles > li",n).attr("aria-hidden","true");var u=a();i(".ui-widget-detail  .ui-articles > li:nth-child(-n+"+a()+")",n).addClass("active").attr("aria-hidden","false"),i(".ui-widget-detail  .ui-articles > li.active a",n).attr("tabindex","0")}i(".ui-articles",n).animate({marginLeft:"-"+c+"px"},{duration:400,start:function(t){i(".ui-widget-detail",n).addClass("animating")},complete:function(t){i(".ui-widget-detail",n).removeClass("animating")}})}else if(i(this).hasClass("back")){if(0==d||.099>=d){c=r,i(".ui-widget-detail  .ui-articles > li a",n).attr("tabindex","-1"),i(".ui-widget-detail  .ui-articles > li",n).removeClass("active").attr("aria-hidden","true");var u=a();i(".ui-widget-detail  .ui-articles > li:nth-last-child(-n+"+a()+")",n).addClass("active").attr("aria-hidden","false"),i(".ui-widget-detail  .ui-articles > li.active a",n).attr("tabindex","0")}else e>d?c=0:(c=d-t,u>1?(i(".ui-widget-detail  .ui-articles > li.active",n).last().attr("aria-hidden","true").find("a").attr("tabindex","-1"),i(".ui-widget-detail  .ui-articles > li.active",n).last().removeClass("active"),i(".ui-widget-detail  .ui-articles > li.active",n).first().prev().addClass("active"),i(".ui-widget-detail  .ui-articles > li.active",n).first().attr("aria-hidden","false").find("a").attr("tabindex","0")):(i(".ui-widget-detail  .ui-articles > li.active",n).prev().addClass("active"),i(".ui-widget-detail  .ui-articles > li.active",n).first().attr("aria-hidden","false").find("a").attr("tabindex","0"),i(".ui-widget-detail  .ui-articles > li.active",n).last().attr("aria-hidden","true").find("a").attr("tabindex","-1"),i(".ui-widget-detail  .ui-articles > li.active",n).last().removeClass("active")));i(".ui-articles",n).animate({marginLeft:"-"+c+"px"},{duration:400,start:function(t){i(".ui-widget-detail",n).addClass("animating")},complete:function(t){i(".ui-widget-detail",n).removeClass("animating")}})}}).keydown(function(t){var e=t.which;(13===e||32===e)&&(t.preventDefault(),i(this).click())})}function a(){var i=0;switch(r()){case 960:i=e.imageNum960;break;case 768:i=e.imageNum768;break;case 640:i=e.imageNum640;break;case 480:i=e.imageNum480;break;case 320:i=e.imageNum320}return i}function l(){var t=i(".ui-articles > li",n).length,e=0;e=i(".ui-widget-detail",n)[0].getBoundingClientRect().width/a(),i(".ui-articles li",n).each(function(){i(this).css("width",e+"px")}),i(".ui-articles",n).css("width",e*t),i(".ui-articles",n).width()>i(".ui-widget-detail",n).width()&&i(".headlines-scroll-ctrl",n).removeClass("hidden"),i(".ui-widget-detail  .ui-articles > li",n).removeClass("active"),i(".ui-widget-detail  .ui-articles > li",n).attr("aria-hidden","true"),i(".ui-widget-detail  .ui-articles > li a",n).attr("tabindex","-1");a();i(".ui-widget-detail  .ui-articles > li:nth-child(-n+"+a()+")",n).addClass("active").attr("aria-hidden","false"),i(".ui-widget-detail  .ui-articles > li.active a",n).attr("tabindex","0")}function d(){var i=document.createElement("style");if(i){i.setAttribute("type","text/css");var t=document.getElementsByTagName("head")[0];t&&t.insertBefore(i,t.childNodes[0]);var a=e.appParent+" .headlines-scroll-ctrl {    color:"+e.buttonColor+";}"+e.appParent+" .headlines-scroll-ctrl {    position: absolute;    font-size: 30px;    width: 30px;    height: 30px;    top: 50%;    margin-top: -15px;    cursor: pointer;    text-align: center;}"+e.appParent+" .headlines-scroll-ctrl.back {    left: 0%;}"+e.appParent+" .headlines-scroll-ctrl.next {    right: 0%;}"+e.appParent+" div.ui-widget.app."+e.targetApp+"{    position: relative; }"+e.appParent+" div.ui-widget.app."+e.targetApp+" .ui-widget-detail {    overflow: hidden;    margin: 0px "+e.controlGutter+"px; }"+e.appParent+" div.ui-widget.app."+e.targetApp+" .ui-articles {    width: 100%;    margin: 0px;    position: relative;}"+e.appParent+" div.ui-widget.app."+e.targetApp+" li {    float: left;}"+e.appParent+" div.ui-widget.app."+e.targetApp+" .ui-article {    position: relative;    padding: 15px;}"+e.appParent+" div.ui-widget.app.headlines .ui-article-thumb {    float: none;    overflow: visible;}",l=document.createTextNode(a);i.styleSheet?i.styleSheet.cssText=a:i.appendChild(l)}}function r(){return i(window).width()>=1024?960:i(window).width()>=768&&i(window).width()<1024?768:i(window).width()>=640&&i(window).width()<768?640:i(window).width()>=480&&i(window).width()<640?480:i(window).width()>=320&&i(window).width()<480?320:void 0}var n=this;i(window).bind("resize",function(){i(".tab-button, .ui-widget-header").on("click",function(){l()}),l()}),t(),l(),i(window).load(function(){i(".ui-articles",n).css("margin-left","0"),l()}),i(".ui-widget-detail img",n).each(function(){i(this).css({display:"inline-block",width:"100%","max-width":i(this).attr("width")+"px",height:"auto","max-height":i(this).attr("height")+"px"})}),i(".ui-widget-detail .ui-articles > li > a.more-link",n).length&&(i(n).find("a.more-link").appendTo(i(n).find(".ui-widget-footer")),i(".ui-widget-detail  .ui-articles > li",n).last().remove()),i(".ui-widget-detail  .ui-articles > li",n).first().addClass("first-slide"),i(".ui-widget-detail  .ui-articles > li",n).last().addClass("last-slide"),i(".ui-widget-detail  .ui-articles > li",n).attr("aria-hidden","true"),i(".ui-widget-detail  .ui-articles > li a",n).attr("tabindex","-1");a();i(".ui-widget-detail  .ui-articles > li:nth-child(-n+"+a()+")",n).addClass("active").attr("aria-hidden","false"),i(".ui-widget-detail  .ui-articles > li.active a",n).attr("tabindex","0"),i(".tab-button, .ui-widget-header").on("click",function(){l()})})}}(jQuery);